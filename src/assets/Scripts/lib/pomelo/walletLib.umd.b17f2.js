(function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).walletLib={})})(this,function(e){"use strict";var t,n,r,i,o,s,a,c,l,u,h,d,f,p,g,m,y,v,w,b,O,E,_,C,N,A,R,S,T,P,D,k,I,x,M,K,L,U,B,j,H,W,X,F,J,G,q,V,z,Q,$,Y,Z,ee,te,ne,re,ie,oe,se,ae,ce,le,ue,he,de,fe,pe,ge,me,ye,ve,we,be,Oe,Ee,_e,Ce,Ne,Ae,Re,Se,Te,Pe,De,ke,Ie,xe,Me,Ke,Le,Ue,Be,je,He,We,Xe,Fe,Je,Ge,qe,Ve,ze,Qe,$e,Ye,Ze,et,tt,nt,rt,it,ot,st,at,ct,lt,ut,ht,dt,ft,pt,gt,mt,yt,vt,wt,bt,Ot,Et,_t,Ct,Nt,At,Rt,St,Tt,Pt,Dt,kt,It,xt,Mt,Kt,Lt,Ut,Bt,jt,Ht,Wt,Xt,Ft,Jt,Gt,qt,Vt,zt,Qt,$t,Yt,Zt,en,tn,nn,rn,on,sn,an,cn,ln,un,hn,dn,fn,pn=Object.defineProperty,gn=e=>{throw TypeError(e)},mn=(e,t,n)=>t in e?pn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,yn=(e,t,n)=>mn(e,"symbol"!=typeof t?t+"":t,n),vn=(e,t,n)=>t.has(e)||gn("Cannot "+n),wn=(e,t,n)=>(vn(e,t,"read from private field"),n?n.call(e):t.get(e)),bn=(e,t,n)=>t.has(e)?gn("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),On=(e,t,n,r)=>(vn(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),En=(e,t,n)=>(vn(e,t,"access private method"),n),_n=(e,t,n,r)=>({set _(r){On(e,t,r,n)},get _(){return wn(e,t,r)}});const Cn="6.15.0";function Nn(e,t,n){const r=t.split("|").map(e=>e.trim());for(let o=0;o<r.length;o++)switch(t){case"any":return;case"bigint":case"boolean":case"number":case"string":if(typeof e===t)return}const i=new Error(`invalid value for type ${t}`);throw i.code="INVALID_ARGUMENT",i.argument=`value.${n}`,i.value=e,i}async function An(e){const t=Object.keys(e);return(await Promise.all(t.map(t=>Promise.resolve(e[t])))).reduce((e,n,r)=>(e[t[r]]=n,e),{})}function Rn(e,t,n){for(let r in t){let i=t[r];const o=n?n[r]:null;o&&Nn(i,o,r),Object.defineProperty(e,r,{enumerable:!0,value:i,writable:!1})}}function Sn(e,t){if(null==e)return"null";if(null==t&&(t=new Set),"object"==typeof e){if(t.has(e))return"[Circular]";t.add(e)}if(Array.isArray(e))return"[ "+e.map(e=>Sn(e,t)).join(", ")+" ]";if(e instanceof Uint8Array){const t="0123456789abcdef";let n="0x";for(let r=0;r<e.length;r++)n+=t[e[r]>>4],n+=t[15&e[r]];return n}if("object"==typeof e&&"function"==typeof e.toJSON)return Sn(e.toJSON(),t);switch(typeof e){case"boolean":case"number":case"symbol":return e.toString();case"bigint":return BigInt(e).toString();case"string":return JSON.stringify(e);case"object":{const n=Object.keys(e);return n.sort(),"{ "+n.map(n=>`${Sn(n,t)}: ${Sn(e[n],t)}`).join(", ")+" }"}}return"[ COULD NOT SERIALIZE ]"}function Tn(e,t){return e&&e.code===t}function Pn(e){return Tn(e,"CALL_EXCEPTION")}function Dn(e,t,n){let r,i=e;{const r=[];if(n){if("message"in n||"code"in n||"name"in n)throw new Error(`value will overwrite populated values: ${Sn(n)}`);for(const e in n){if("shortMessage"===e)continue;const t=n[e];r.push(e+"="+Sn(t))}}r.push(`code=${t}`),r.push(`version=${Cn}`),r.length&&(e+=" ("+r.join(", ")+")")}switch(t){case"INVALID_ARGUMENT":r=new TypeError(e);break;case"NUMERIC_FAULT":case"BUFFER_OVERRUN":r=new RangeError(e);break;default:r=new Error(e)}return Rn(r,{code:t}),n&&Object.assign(r,n),null==r.shortMessage&&Rn(r,{shortMessage:i}),r}function kn(e,t,n,r){if(!e)throw Dn(t,n,r)}function In(e,t,n,r){kn(e,t,"INVALID_ARGUMENT",{argument:n,value:r})}function xn(e,t,n){null==n&&(n=""),n&&(n=": "+n),kn(e>=t,"missing argument"+n,"MISSING_ARGUMENT",{count:e,expectedCount:t}),kn(e<=t,"too many arguments"+n,"UNEXPECTED_ARGUMENT",{count:e,expectedCount:t})}function Mn(e,t,n){if(null==n&&(n=""),e!==t){let e=n,t="new";n&&(e+=".",t+=" "+n),kn(!1,`private constructor; use ${e}from* methods`,"UNSUPPORTED_OPERATION",{operation:t})}}function Kn(e,t,n){if(e instanceof Uint8Array)return n?new Uint8Array(e):e;if("string"==typeof e&&e.match(/^0x(?:[0-9a-f][0-9a-f])*$/i)){const t=new Uint8Array((e.length-2)/2);let n=2;for(let r=0;r<t.length;r++)t[r]=parseInt(e.substring(n,n+2),16),n+=2;return t}In(!1,"invalid BytesLike value",t||"value",e)}function Ln(e,t){return Kn(e,t,!1)}function Un(e,t){return Kn(e,t,!0)}function Bn(e,t){return!("string"!=typeof e||!e.match(/^0x[0-9A-Fa-f]*$/)||"number"==typeof t&&e.length!==2+2*t||!0===t&&e.length%2!=0)}function jn(e){return Bn(e,!0)||e instanceof Uint8Array}["NFD","NFC","NFKD","NFKC"].reduce((e,t)=>{try{if("test"!=="test".normalize(t))throw new Error("bad");if("NFD"===t&&"e\u0301"!=="\xe9".normalize("NFD"))throw new Error("broken");e.push(t)}catch{}return e},[]);const Hn="0123456789abcdef";function Wn(e){const t=Ln(e);let n="0x";for(let r=0;r<t.length;r++){const e=t[r];n+=Hn[(240&e)>>4]+Hn[15&e]}return n}function Xn(e){return"0x"+e.map(e=>Wn(e).substring(2)).join("")}function Fn(e){return Bn(e,!0)?(e.length-2)/2:Ln(e).length}function Jn(e,t,n){const r=Ln(e);return null!=n&&n>r.length&&kn(!1,"cannot slice beyond data bounds","BUFFER_OVERRUN",{buffer:r,length:r.length,offset:n}),Wn(r.slice(null==t?0:t,null==n?r.length:n))}function Gn(e,t,n){const r=Ln(e);kn(t>=r.length,"padding exceeds data length","BUFFER_OVERRUN",{buffer:new Uint8Array(r),length:t,offset:t+1});const i=new Uint8Array(t);return i.fill(0),n?i.set(r,t-r.length):i.set(r,0),Wn(i)}function qn(e,t){return Gn(e,t,!0)}function Vn(e,t){return Gn(e,t,!1)}const zn=BigInt(0),Qn=BigInt(1),$n=9007199254740991;function Yn(e,t){const n=nr(e,"value"),r=BigInt(or(t,"width"));return kn(n>>r===zn,"overflow","NUMERIC_FAULT",{operation:"fromTwos",fault:"overflow",value:e}),n>>r-Qn?-((~n&(Qn<<r)-Qn)+Qn):n}function Zn(e,t){let n=tr(e,"value");const r=BigInt(or(t,"width")),i=Qn<<r-Qn;return n<zn?(kn((n=-n)<=i,"too low","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:e}),(~n&(Qn<<r)-Qn)+Qn):(kn(n<i,"too high","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:e}),n)}function er(e,t){const n=nr(e,"value"),r=BigInt(or(t,"bits"));return n&(Qn<<r)-Qn}function tr(e,t){switch(typeof e){case"bigint":return e;case"number":return In(Number.isInteger(e),"underflow",t||"value",e),In(e>=-$n&&e<=$n,"overflow",t||"value",e),BigInt(e);case"string":try{if(""===e)throw new Error("empty string");return"-"===e[0]&&"-"!==e[1]?-BigInt(e.substring(1)):BigInt(e)}catch(n){In(!1,`invalid BigNumberish string: ${n.message}`,t||"value",e)}}In(!1,"invalid BigNumberish value",t||"value",e)}function nr(e,t){const n=tr(e,t);return kn(n>=zn,"unsigned value cannot be negative","NUMERIC_FAULT",{fault:"overflow",operation:"getUint",value:e}),n}const rr="0123456789abcdef";function ir(e){if(e instanceof Uint8Array){let t="0x0";for(const n of e)t+=rr[n>>4],t+=rr[15&n];return BigInt(t)}return tr(e)}function or(e,t){switch(typeof e){case"bigint":return In(e>=-$n&&e<=$n,"overflow",t||"value",e),Number(e);case"number":return In(Number.isInteger(e),"underflow",t||"value",e),In(e>=-$n&&e<=$n,"overflow",t||"value",e),e;case"string":try{if(""===e)throw new Error("empty string");return or(BigInt(e),t)}catch(n){In(!1,`invalid numeric string: ${n.message}`,t||"value",e)}}In(!1,"invalid numeric value",t||"value",e)}function sr(e,t){let n=nr(e,"value").toString(16);if(null==t)n.length%2&&(n="0"+n);else{const r=or(t,"width");for(kn(2*r>=n.length,`value exceeds width (${r} bytes)`,"NUMERIC_FAULT",{operation:"toBeHex",fault:"overflow",value:e});n.length<2*r;)n="0"+n}return"0x"+n}function ar(e){const t=nr(e,"value");if(t===zn)return new Uint8Array([]);let n=t.toString(16);n.length%2&&(n="0"+n);const r=new Uint8Array(n.length/2);for(let i=0;i<r.length;i++){const e=2*i;r[i]=parseInt(n.substring(e,e+2),16)}return r}function cr(e){let t=Wn(jn(e)?e:ar(e)).substring(2);for(;t.startsWith("0");)t=t.substring(1);return""===t&&(t="0"),"0x"+t}const lr="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";BigInt(0);const ur=BigInt(58);function hr(e){const t=Ln(e);let n=ir(t),r="";for(;n;)r=lr[Number(n%ur)]+r,n/=ur;for(let i=0;i<t.length&&!t[i];i++)r=lr[0]+r;return r}function dr(e){e=atob(e);const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return Ln(t)}function fr(e){const t=Ln(e);let n="";for(let r=0;r<t.length;r++)n+=String.fromCharCode(t[r]);return btoa(n)}class pr{constructor(e,n,r){yn(this,"filter"),yn(this,"emitter"),bn(this,t),On(this,t,n),Rn(this,{emitter:e,filter:r})}async removeListener(){null!=wn(this,t)&&await this.emitter.off(this.filter,wn(this,t))}}function gr(e,t,n){if("BAD_PREFIX"===e||"UNEXPECTED_CONTINUE"===e){let e=0;for(let r=t+1;r<n.length&&n[r]>>6==2;r++)e++;return e}return"OVERRUN"===e?n.length-t-1:0}t=new WeakMap;const mr=Object.freeze({error:function(e,t,n){In(!1,`invalid codepoint at offset ${t}; ${e}`,"bytes",n)},ignore:gr,replace:function(e,t,n,r,i){return"OVERLONG"===e?(In("number"==typeof i,"invalid bad code point for replacement","badCodepoint",i),r.push(i),0):(r.push(65533),gr(e,t,n))}});function yr(e,t){null==t&&(t=mr.error);const n=Ln(e,"bytes"),r=[];let i=0;for(;i<n.length;){const e=n[i++];if(e>>7==0){r.push(e);continue}let o=null,s=null;if(192==(224&e))o=1,s=127;else if(224==(240&e))o=2,s=2047;else{if(240!=(248&e)){i+=t(128==(192&e)?"UNEXPECTED_CONTINUE":"BAD_PREFIX",i-1,n,r);continue}o=3,s=65535}if(i-1+o>=n.length){i+=t("OVERRUN",i-1,n,r);continue}let a=e&(1<<8-o-1)-1;for(let c=0;c<o;c++){let e=n[i];if(128!=(192&e)){i+=t("MISSING_CONTINUE",i,n,r),a=null;break}a=a<<6|63&e,i++}if(null!==a){if(a>1114111){i+=t("OUT_OF_RANGE",i-1-o,n,r,a);continue}if(a>=55296&&a<=57343){i+=t("UTF16_SURROGATE",i-1-o,n,r,a);continue}if(a<=s){i+=t("OVERLONG",i-1-o,n,r,a);continue}r.push(a)}}return r}function vr(e){In("string"==typeof e,"invalid string value","str",e);let t=[];for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);if(r<128)t.push(r);else if(r<2048)t.push(r>>6|192),t.push(63&r|128);else if(55296==(64512&r)){n++;const i=e.charCodeAt(n);In(n<e.length&&56320==(64512&i),"invalid surrogate pair","str",e);const o=65536+((1023&r)<<10)+(1023&i);t.push(o>>18|240),t.push(o>>12&63|128),t.push(o>>6&63|128),t.push(63&o|128)}else t.push(r>>12|224),t.push(r>>6&63|128),t.push(63&r|128)}return new Uint8Array(t)}function wr(e){return e.map(e=>e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode(55296+(e>>10&1023),56320+(1023&e)))).join("")}function br(e,t){return wr(yr(e,t))}function Or(e){return async function(t,n){kn(null==n||!n.cancelled,"request cancelled before sending","CANCELLED");const r=t.url.split(":")[0].toLowerCase();kn("http"===r||"https"===r,`unsupported protocol ${r}`,"UNSUPPORTED_OPERATION",{info:{protocol:r},operation:"request"}),kn("https"===r||!t.credentials||t.allowInsecureAuthentication,"insecure authorized connections unsupported","UNSUPPORTED_OPERATION",{operation:"request"});let i=null;const o=new AbortController,s=setTimeout(()=>{i=Dn("request timeout","TIMEOUT"),o.abort()},t.timeout);n&&n.addListener(()=>{i=Dn("request cancelled","CANCELLED"),o.abort()});const a=Object.assign({},e,{method:t.method,headers:new Headers(Array.from(t)),body:t.body||void 0,signal:o.signal});let c;try{c=await fetch(t.url,a)}catch(d){throw clearTimeout(s),i||d}clearTimeout(s);const l={};c.headers.forEach((e,t)=>{l[t.toLowerCase()]=e});const u=await c.arrayBuffer(),h=null==u?null:new Uint8Array(u);return{statusCode:c.status,statusMessage:c.statusText,headers:l,body:h}}}let Er=Or();const _r=new RegExp("^data:([^;:]*)?(;base64)?,(.*)$","i"),Cr=new RegExp("^ipfs://(ipfs/)?(.*)$","i");let Nr=!1;async function Ar(e){try{const t=e.match(_r);if(!t)throw new Error("invalid data");return new Ir(200,"OK",{"content-type":t[1]||"text/plain"},t[2]?dr(t[3]):Mr(t[3]))}catch{return new Ir(599,"BAD REQUEST (invalid data: URI)",{},null,new kr(e))}}function Rr(e){return async function(t){try{const n=t.match(Cr);if(!n)throw new Error("invalid link");return new kr(`${e}${n[2]}`)}catch{return new Ir(599,"BAD REQUEST (invalid IPFS URI)",{},null,new kr(t))}}}const Sr={data:Ar,ipfs:Rr("https://gateway.ipfs.io/ipfs/")},Tr=new WeakMap;class Pr{constructor(e){bn(this,n),bn(this,r),On(this,n,[]),On(this,r,!1),Tr.set(e,()=>{if(!wn(this,r)){On(this,r,!0);for(const e of wn(this,n))setTimeout(()=>{e()},0);On(this,n,[])}})}addListener(e){kn(!wn(this,r),"singal already cancelled","UNSUPPORTED_OPERATION",{operation:"fetchCancelSignal.addCancelListener"}),wn(this,n).push(e)}get cancelled(){return wn(this,r)}checkSignal(){kn(!this.cancelled,"cancelled","CANCELLED",{})}}function Dr(e){if(null==e)throw new Error("missing signal; should not happen");return e.checkSignal(),e}n=new WeakMap,r=new WeakMap,i=new WeakMap,o=new WeakMap,s=new WeakMap,a=new WeakMap,c=new WeakMap,l=new WeakMap,u=new WeakMap,h=new WeakMap,d=new WeakMap,f=new WeakMap,p=new WeakMap,g=new WeakMap,m=new WeakMap,y=new WeakMap,v=new WeakMap,w=new WeakSet,b=async function(e,t,n,r,i){var o,s,a,c;if(e>=wn(this,y).maxAttempts)return i.makeServerError("exceeded maximum retry limit");kn(xr()<=t,"timeout","TIMEOUT",{operation:"request.send",reason:"timeout",request:r}),n>0&&await(c=n,new Promise(e=>setTimeout(e,c)));let l=this.clone();const u=(l.url.split(":")[0]||"").toLowerCase();if(u in Sr){const e=await Sr[u](l.url,Dr(wn(r,m)));if(e instanceof Ir){let t=e;if(this.processFunc){Dr(wn(r,m));try{t=await this.processFunc(l,t)}catch(f){(null==f.throttle||"number"!=typeof f.stall)&&t.makeServerError("error in post-processing function",f).assertOk()}}return t}l=e}this.preflightFunc&&(l=await this.preflightFunc(l));const h=await this.getUrlFunc(l,Dr(wn(r,m)));let d=new Ir(h.statusCode,h.statusMessage,h.headers,h.body,r);if(301===d.statusCode||302===d.statusCode){try{const n=d.headers.location||"";return En(o=l.redirect(n),w,b).call(o,e+1,t,0,r,d)}catch{}return d}if(429===d.statusCode&&(null==this.retryFunc||await this.retryFunc(l,d,e))){const n=d.headers["retry-after"];let i=wn(this,y).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return"string"==typeof n&&n.match(/^[1-9][0-9]*$/)&&(i=parseInt(n)),En(s=l.clone(),w,b).call(s,e+1,t,i,r,d)}if(this.processFunc){Dr(wn(r,m));try{d=await this.processFunc(l,d)}catch(p){(null==p.throttle||"number"!=typeof p.stall)&&d.makeServerError("error in post-processing function",p).assertOk();let n=wn(this,y).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return p.stall>=0&&(n=p.stall),En(a=l.clone(),w,b).call(a,e+1,t,n,r,d)}}return d};let kr=class e{constructor(e){bn(this,w),bn(this,i),bn(this,o),bn(this,s),bn(this,a),bn(this,c),bn(this,l),bn(this,u),bn(this,h),bn(this,d),bn(this,f),bn(this,p),bn(this,g),bn(this,m),bn(this,y),bn(this,v),On(this,l,String(e)),On(this,i,!1),On(this,o,!0),On(this,s,{}),On(this,a,""),On(this,c,3e5),On(this,y,{slotInterval:250,maxAttempts:12}),On(this,v,null)}get url(){return wn(this,l)}set url(e){On(this,l,String(e))}get body(){return null==wn(this,u)?null:new Uint8Array(wn(this,u))}set body(e){if(null==e)On(this,u,void 0),On(this,h,void 0);else if("string"==typeof e)On(this,u,vr(e)),On(this,h,"text/plain");else if(e instanceof Uint8Array)On(this,u,e),On(this,h,"application/octet-stream");else{if("object"!=typeof e)throw new Error("invalid body");On(this,u,vr(JSON.stringify(e))),On(this,h,"application/json")}}hasBody(){return null!=wn(this,u)}get method(){return wn(this,a)?wn(this,a):this.hasBody()?"POST":"GET"}set method(e){null==e&&(e=""),On(this,a,String(e).toUpperCase())}get headers(){const e=Object.assign({},wn(this,s));return wn(this,d)&&(e.authorization=`Basic ${fr(vr(wn(this,d)))}`),this.allowGzip&&(e["accept-encoding"]="gzip"),null==e["content-type"]&&wn(this,h)&&(e["content-type"]=wn(this,h)),this.body&&(e["content-length"]=String(this.body.length)),e}getHeader(e){return this.headers[e.toLowerCase()]}setHeader(e,t){wn(this,s)[String(e).toLowerCase()]=String(t)}clearHeaders(){On(this,s,{})}[Symbol.iterator](){const e=this.headers,t=Object.keys(e);let n=0;return{next:()=>{if(n<t.length){const r=t[n++];return{value:[r,e[r]],done:!1}}return{value:void 0,done:!0}}}}get credentials(){return wn(this,d)||null}setCredentials(e,t){In(!e.match(/:/),"invalid basic authentication username","username","[REDACTED]"),On(this,d,`${e}:${t}`)}get allowGzip(){return wn(this,o)}set allowGzip(e){On(this,o,!!e)}get allowInsecureAuthentication(){return!!wn(this,i)}set allowInsecureAuthentication(e){On(this,i,!!e)}get timeout(){return wn(this,c)}set timeout(e){In(e>=0,"timeout must be non-zero","timeout",e),On(this,c,e)}get preflightFunc(){return wn(this,f)||null}set preflightFunc(e){On(this,f,e)}get processFunc(){return wn(this,p)||null}set processFunc(e){On(this,p,e)}get retryFunc(){return wn(this,g)||null}set retryFunc(e){On(this,g,e)}get getUrlFunc(){return wn(this,v)||Er}set getUrlFunc(e){On(this,v,e)}toString(){return`<FetchRequest method=${JSON.stringify(this.method)} url=${JSON.stringify(this.url)} headers=${JSON.stringify(this.headers)} body=${wn(this,u)?Wn(wn(this,u)):"null"}>`}setThrottleParams(e){null!=e.slotInterval&&(wn(this,y).slotInterval=e.slotInterval),null!=e.maxAttempts&&(wn(this,y).maxAttempts=e.maxAttempts)}send(){return kn(null==wn(this,m),"request already sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.send"}),On(this,m,new Pr(this)),En(this,w,b).call(this,0,xr()+this.timeout,0,this,new Ir(0,"",{},null,this))}cancel(){kn(null!=wn(this,m),"request has not been sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.cancel"});const e=Tr.get(this);if(!e)throw new Error("missing signal; should not happen");e()}redirect(t){const n=this.url.split(":")[0].toLowerCase(),r=t.split(":")[0].toLowerCase();kn("GET"===this.method&&("https"!==n||"http"!==r)&&t.match(/^https?:/),"unsupported redirect","UNSUPPORTED_OPERATION",{operation:`redirect(${this.method} ${JSON.stringify(this.url)} => ${JSON.stringify(t)})`});const i=new e(t);return i.method="GET",i.allowGzip=this.allowGzip,i.timeout=this.timeout,On(i,s,Object.assign({},wn(this,s))),wn(this,u)&&On(i,u,new Uint8Array(wn(this,u))),On(i,h,wn(this,h)),i}clone(){const t=new e(this.url);return On(t,a,wn(this,a)),wn(this,u)&&On(t,u,wn(this,u)),On(t,h,wn(this,h)),On(t,s,Object.assign({},wn(this,s))),On(t,d,wn(this,d)),this.allowGzip&&(t.allowGzip=!0),t.timeout=this.timeout,this.allowInsecureAuthentication&&(t.allowInsecureAuthentication=!0),On(t,f,wn(this,f)),On(t,p,wn(this,p)),On(t,g,wn(this,g)),On(t,y,Object.assign({},wn(this,y))),On(t,v,wn(this,v)),t}static lockConfig(){Nr=!0}static getGateway(e){return Sr[e.toLowerCase()]||null}static registerGateway(e,t){if("http"===(e=e.toLowerCase())||"https"===e)throw new Error(`cannot intercept ${e}; use registerGetUrl`);if(Nr)throw new Error("gateways locked");Sr[e]=t}static registerGetUrl(e){if(Nr)throw new Error("gateways locked");Er=e}static createGetUrlFunc(e){return Or(e)}static createDataGateway(){return Ar}static createIpfsGatewayFunc(e){return Rr(e)}};O=new WeakMap,E=new WeakMap,_=new WeakMap,C=new WeakMap,N=new WeakMap,A=new WeakMap;let Ir=class e{constructor(e,t,n,r,i){bn(this,O),bn(this,E),bn(this,_),bn(this,C),bn(this,N),bn(this,A),On(this,O,e),On(this,E,t),On(this,_,Object.keys(n).reduce((e,t)=>(e[t.toLowerCase()]=String(n[t]),e),{})),On(this,C,null==r?null:new Uint8Array(r)),On(this,N,i||null),On(this,A,{message:""})}toString(){return`<FetchResponse status=${this.statusCode} body=${wn(this,C)?Wn(wn(this,C)):"null"}>`}get statusCode(){return wn(this,O)}get statusMessage(){return wn(this,E)}get headers(){return Object.assign({},wn(this,_))}get body(){return null==wn(this,C)?null:new Uint8Array(wn(this,C))}get bodyText(){try{return null==wn(this,C)?"":br(wn(this,C))}catch{kn(!1,"response body is not valid UTF-8 data","UNSUPPORTED_OPERATION",{operation:"bodyText",info:{response:this}})}}get bodyJson(){try{return JSON.parse(this.bodyText)}catch{kn(!1,"response body is not valid JSON","UNSUPPORTED_OPERATION",{operation:"bodyJson",info:{response:this}})}}[Symbol.iterator](){const e=this.headers,t=Object.keys(e);let n=0;return{next:()=>{if(n<t.length){const r=t[n++];return{value:[r,e[r]],done:!1}}return{value:void 0,done:!0}}}}makeServerError(t,n){let r;r=t?`CLIENT ESCALATED SERVER ERROR (${this.statusCode} ${this.statusMessage}; ${t})`:`CLIENT ESCALATED SERVER ERROR (${t=`${this.statusCode} ${this.statusMessage}`})`;const i=new e(599,r,this.headers,this.body,wn(this,N)||void 0);return On(i,A,{message:t,error:n}),i}throwThrottleError(e,t){null==t?t=-1:In(Number.isInteger(t)&&t>=0,"invalid stall timeout","stall",t);const n=new Error(e||"throttling requests");throw Rn(n,{stall:t,throttle:!0}),n}getHeader(e){return this.headers[e.toLowerCase()]}hasBody(){return null!=wn(this,C)}get request(){return wn(this,N)}ok(){return""===wn(this,A).message&&this.statusCode>=200&&this.statusCode<300}assertOk(){if(this.ok())return;let{message:e,error:t}=wn(this,A);""===e&&(e=`server response ${this.statusCode} ${this.statusMessage}`);let n=null;this.request&&(n=this.request.url);let r=null;try{wn(this,C)&&(r=br(wn(this,C)))}catch{}kn(!1,e,"SERVER_ERROR",{request:this.request||"unknown request",response:this,error:t,info:{requestUrl:n,responseBody:r,responseStatus:`${this.statusCode} ${this.statusMessage}`}})}};function xr(){return(new Date).getTime()}function Mr(e){return vr(e.replace(/%([0-9a-f][0-9a-f])/gi,(e,t)=>String.fromCharCode(parseInt(t,16))))}const Kr=BigInt(-1),Lr=BigInt(0),Ur=BigInt(1),Br=BigInt(5),jr={};let Hr="0000";for(;Hr.length<80;)Hr+=Hr;function Wr(e){let t=Hr;for(;t.length<e;)t+=t;return BigInt("1"+t.substring(0,e))}function Xr(e,t,n){const r=BigInt(t.width);if(t.signed){const t=Ur<<r-Ur;kn(null==n||e>=-t&&e<t,"overflow","NUMERIC_FAULT",{operation:n,fault:"overflow",value:e}),e=e>Lr?Yn(er(e,r),r):-Yn(er(-e,r),r)}else{const t=Ur<<r;kn(null==n||e>=0&&e<t,"overflow","NUMERIC_FAULT",{operation:n,fault:"overflow",value:e}),e=(e%t+t)%t&t-Ur}return e}function Fr(e){"number"==typeof e&&(e=`fixed128x${e}`);let t=!0,n=128,r=18;if("string"==typeof e){if("fixed"!==e)if("ufixed"===e)t=!1;else{const i=e.match(/^(u?)fixed([0-9]+)x([0-9]+)$/);In(i,"invalid fixed format","format",e),t="u"!==i[1],n=parseInt(i[2]),r=parseInt(i[3])}}else if(e){const i=e,o=(e,t,n)=>null==i[e]?n:(In(typeof i[e]===t,"invalid fixed format ("+e+" not "+t+")","format."+e,i[e]),i[e]);t=o("signed","boolean",t),n=o("width","number",n),r=o("decimals","number",r)}return In(n%8==0,"invalid FixedNumber width (not byte aligned)","format.width",n),In(r<=80,"invalid FixedNumber decimals (too large)","format.decimals",r),{signed:t,width:n,decimals:r,name:(t?"":"u")+"fixed"+String(n)+"x"+String(r)}}function Jr(e,t){let n="";e<Lr&&(n="-",e*=Kr);let r=e.toString();if(0===t)return n+r;for(;r.length<=t;)r=Hr+r;const i=r.length-t;for(r=r.substring(0,i)+"."+r.substring(i);"0"===r[0]&&"."!==r[1];)r=r.substring(1);for(;"0"===r[r.length-1]&&"."!==r[r.length-2];)r=r.substring(0,r.length-1);return n+r}const Gr=class e{constructor(e,t,n){bn(this,P),yn(this,"format"),bn(this,R),bn(this,S),bn(this,T),yn(this,"_value"),Mn(e,jr,"FixedNumber"),On(this,S,t),On(this,R,n);const r=Jr(t,n.decimals);Rn(this,{format:n.name,_value:r}),On(this,T,Wr(n.decimals))}get signed(){return wn(this,R).signed}get width(){return wn(this,R).width}get decimals(){return wn(this,R).decimals}get value(){return wn(this,S)}addUnsafe(e){return En(this,P,I).call(this,e)}add(e){return En(this,P,I).call(this,e,"add")}subUnsafe(e){return En(this,P,x).call(this,e)}sub(e){return En(this,P,x).call(this,e,"sub")}mulUnsafe(e){return En(this,P,M).call(this,e)}mul(e){return En(this,P,M).call(this,e,"mul")}mulSignal(e){En(this,P,D).call(this,e);const t=wn(this,S)*wn(e,S);return kn(t%wn(this,T)===Lr,"precision lost during signalling mul","NUMERIC_FAULT",{operation:"mulSignal",fault:"underflow",value:this}),En(this,P,k).call(this,t/wn(this,T),"mulSignal")}divUnsafe(e){return En(this,P,K).call(this,e)}div(e){return En(this,P,K).call(this,e,"div")}divSignal(e){kn(wn(e,S)!==Lr,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),En(this,P,D).call(this,e);const t=wn(this,S)*wn(this,T);return kn(t%wn(e,S)===Lr,"precision lost during signalling div","NUMERIC_FAULT",{operation:"divSignal",fault:"underflow",value:this}),En(this,P,k).call(this,t/wn(e,S),"divSignal")}cmp(e){let t=this.value,n=e.value;const r=this.decimals-e.decimals;return r>0?n*=Wr(r):r<0&&(t*=Wr(-r)),t<n?-1:t>n?1:0}eq(e){return 0===this.cmp(e)}lt(e){return this.cmp(e)<0}lte(e){return this.cmp(e)<=0}gt(e){return this.cmp(e)>0}gte(e){return this.cmp(e)>=0}floor(){let e=wn(this,S);return wn(this,S)<Lr&&(e-=wn(this,T)-Ur),e=wn(this,S)/wn(this,T)*wn(this,T),En(this,P,k).call(this,e,"floor")}ceiling(){let e=wn(this,S);return wn(this,S)>Lr&&(e+=wn(this,T)-Ur),e=wn(this,S)/wn(this,T)*wn(this,T),En(this,P,k).call(this,e,"ceiling")}round(t){if(null==t&&(t=0),t>=this.decimals)return this;const n=this.decimals-t,r=Br*Wr(n-1);let i=this.value+r;const o=Wr(n);return Xr(i=i/o*o,wn(this,R),"round"),new e(jr,i,wn(this,R))}isZero(){return wn(this,S)===Lr}isNegative(){return wn(this,S)<Lr}toString(){return this._value}toUnsafeFloat(){return parseFloat(this.toString())}toFormat(t){return e.fromString(this.toString(),t)}static fromValue(t,n,r){const i=null==n?0:or(n),o=Fr(r);let s=tr(t,"value");const a=i-o.decimals;if(a>0){const e=Wr(a);kn(s%e===Lr,"value loses precision for format","NUMERIC_FAULT",{operation:"fromValue",fault:"underflow",value:t}),s/=e}else a<0&&(s*=Wr(-a));return Xr(s,o,"fromValue"),new e(jr,s,o)}static fromString(t,n){const r=t.match(/^(-?)([0-9]*)\.?([0-9]*)$/);In(r&&r[2].length+r[3].length>0,"invalid FixedNumber string value","value",t);const i=Fr(n);let o=r[2]||"0",s=r[3]||"";for(;s.length<i.decimals;)s+=Hr;kn(s.substring(i.decimals).match(/^0*$/),"too many decimals for format","NUMERIC_FAULT",{operation:"fromString",fault:"underflow",value:t}),s=s.substring(0,i.decimals);const a=BigInt(r[1]+o+s);return Xr(a,i,"fromString"),new e(jr,a,i)}static fromBytes(t,n){let r=ir(Ln(t,"value"));const i=Fr(n);return i.signed&&(r=Yn(r,i.width)),Xr(r,i,"fromBytes"),new e(jr,r,i)}};R=new WeakMap,S=new WeakMap,T=new WeakMap,P=new WeakSet,D=function(e){In(this.format===e.format,"incompatible format; use fixedNumber.toFormat","other",e)},k=function(e,t){return e=Xr(e,wn(this,R),t),new Gr(jr,e,wn(this,R))},I=function(e,t){return En(this,P,D).call(this,e),En(this,P,k).call(this,wn(this,S)+wn(e,S),t)},x=function(e,t){return En(this,P,D).call(this,e),En(this,P,k).call(this,wn(this,S)-wn(e,S),t)},M=function(e,t){return En(this,P,D).call(this,e),En(this,P,k).call(this,wn(this,S)*wn(e,S)/wn(this,T),t)},K=function(e,t){return kn(wn(e,S)!==Lr,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),En(this,P,D).call(this,e),En(this,P,k).call(this,wn(this,S)*wn(this,T)/wn(e,S),t)};let qr=Gr;function Vr(e){let t=e.toString(16);for(;t.length<2;)t="0"+t;return"0x"+t}function zr(e,t,n){let r=0;for(let i=0;i<n;i++)r=256*r+e[t+i];return r}function Qr(e,t,n,r){const i=[];for(;n<t+1+r;){const o=$r(e,n);i.push(o.result),kn((n+=o.consumed)<=t+1+r,"child data too short","BUFFER_OVERRUN",{buffer:e,length:r,offset:t})}return{consumed:1+r,result:i}}function $r(e,t){kn(0!==e.length,"data too short","BUFFER_OVERRUN",{buffer:e,length:0,offset:1});const n=t=>{kn(t<=e.length,"data short segment too short","BUFFER_OVERRUN",{buffer:e,length:e.length,offset:t})};if(e[t]>=248){const r=e[t]-247;n(t+1+r);const i=zr(e,t+1,r);return n(t+1+r+i),Qr(e,t,t+1+r,r+i)}if(e[t]>=192){const r=e[t]-192;return n(t+1+r),Qr(e,t,t+1,r)}if(e[t]>=184){const r=e[t]-183;n(t+1+r);const i=zr(e,t+1,r);return n(t+1+r+i),{consumed:1+r+i,result:Wn(e.slice(t+1+r,t+1+r+i))}}if(e[t]>=128){const r=e[t]-128;return n(t+1+r),{consumed:1+r,result:Wn(e.slice(t+1,t+1+r))}}return{consumed:1,result:Vr(e[t])}}function Yr(e){const t=Ln(e,"data"),n=$r(t,0);return In(n.consumed===t.length,"unexpected junk after rlp payload","data",e),n.result}function Zr(e){const t=[];for(;e;)t.unshift(255&e),e>>=8;return t}function ei(e){if(Array.isArray(e)){let t=[];if(e.forEach(function(e){t=t.concat(ei(e))}),t.length<=55)return t.unshift(192+t.length),t;const n=Zr(t.length);return n.unshift(247+n.length),n.concat(t)}const t=Array.prototype.slice.call(Ln(e,"object"));if(1===t.length&&t[0]<=127)return t;if(t.length<=55)return t.unshift(128+t.length),t;const n=Zr(t.length);return n.unshift(183+n.length),n.concat(t)}const ti="0123456789abcdef";function ni(e){let t="0x";for(const n of ei(e))t+=ti[n>>4],t+=ti[15&n];return t}function ri(e,t){let n=18;return n=or(t,"unit"),qr.fromValue(e,n,{decimals:n,width:512}).toString()}function ii(e,t){In("string"==typeof e,"value must be a string","value",e);let n=18;return n=or(t,"unit"),qr.fromString(e,{decimals:n,width:512}).value}const oi=32,si=new Uint8Array(oi),ai=["then"],ci={},li=new WeakMap;function ui(e){return li.get(e)}function hi(e,t){li.set(e,t)}function di(e,t){const n=new Error(`deferred error during ABI decoding triggered accessing ${e}`);throw n.error=t,n}function fi(e,t,n){return e.indexOf(null)>=0?t.map(e=>e instanceof pi?fi(ui(e),e,n):e):e.reduce((e,r)=>{let i=t.getValue(r);return r in e||(n&&i instanceof pi&&(i=fi(ui(i),i,n)),e[r]=i),e},{})}L=new WeakMap;let pi=class e extends Array{constructor(...e){const t=e[0];let n=e[1],r=(e[2]||[]).slice(),i=!0;t!==ci&&(n=e,r=[],i=!1),super(n.length),bn(this,L),n.forEach((e,t)=>{this[t]=e});const o=r.reduce((e,t)=>("string"==typeof t&&e.set(t,(e.get(t)||0)+1),e),new Map);if(hi(this,Object.freeze(n.map((e,t)=>{const n=r[t];return null!=n&&1===o.get(n)?n:null}))),On(this,L,[]),null==wn(this,L)&&wn(this,L),!i)return;Object.freeze(this);const s=new Proxy(this,{get:(e,t,n)=>{if("string"==typeof t){if(t.match(/^[0-9]+$/)){const n=or(t,"%index");if(n<0||n>=this.length)throw new RangeError("out of result range");const r=e[n];return r instanceof Error&&di(`index ${n}`,r),r}if(ai.indexOf(t)>=0)return Reflect.get(e,t,n);const r=e[t];if(r instanceof Function)return function(...t){return r.apply(this===n?e:this,t)};if(!(t in e))return e.getValue.apply(this===n?e:this,[t])}return Reflect.get(e,t,n)}});return hi(s,ui(this)),s}toArray(t){const n=[];return this.forEach((r,i)=>{r instanceof Error&&di(`index ${i}`,r),t&&r instanceof e&&(r=r.toArray(t)),n.push(r)}),n}toObject(e){const t=ui(this);return t.reduce((n,r,i)=>(kn(null!=r,`value at index ${i} unnamed`,"UNSUPPORTED_OPERATION",{operation:"toObject()"}),fi(t,this,e)),{})}slice(t,n){null==t&&(t=0),t<0&&(t+=this.length)<0&&(t=0),null==n&&(n=this.length),n<0&&(n+=this.length)<0&&(n=0),n>this.length&&(n=this.length);const r=ui(this),i=[],o=[];for(let e=t;e<n;e++)i.push(this[e]),o.push(r[e]);return new e(ci,i,o)}filter(t,n){const r=ui(this),i=[],o=[];for(let e=0;e<this.length;e++){const s=this[e];s instanceof Error&&di(`index ${e}`,s),t.call(n,s,e,this)&&(i.push(s),o.push(r[e]))}return new e(ci,i,o)}map(e,t){const n=[];for(let r=0;r<this.length;r++){const i=this[r];i instanceof Error&&di(`index ${r}`,i),n.push(e.call(t,i,r,this))}return n}getValue(e){const t=ui(this).indexOf(e);if(-1===t)return;const n=this[t];return n instanceof Error&&di(`property ${JSON.stringify(e)}`,n.error),n}static fromItems(t,n){return new e(ci,t,n)}};function gi(e){let t=ar(e);return kn(t.length<=oi,"value out-of-bounds","BUFFER_OVERRUN",{buffer:t,length:oi,offset:t.length}),t.length!==oi&&(t=Un(Xn([si.slice(t.length%oi),t]))),t}class mi{constructor(e,t,n,r){yn(this,"name"),yn(this,"type"),yn(this,"localName"),yn(this,"dynamic"),Rn(this,{name:e,type:t,localName:n,dynamic:r},{name:"string",type:"string",localName:"string",dynamic:"boolean"})}_throwError(e,t){In(!1,e,this.localName,t)}}class yi{constructor(){bn(this,j),bn(this,U),bn(this,B),On(this,U,[]),On(this,B,0)}get data(){return Xn(wn(this,U))}get length(){return wn(this,B)}appendWriter(e){return En(this,j,H).call(this,Un(e.data))}writeBytes(e){let t=Un(e);const n=t.length%oi;return n&&(t=Un(Xn([t,si.slice(n)]))),En(this,j,H).call(this,t)}writeValue(e){return En(this,j,H).call(this,gi(e))}writeUpdatableValue(){const e=wn(this,U).length;return wn(this,U).push(si),On(this,B,wn(this,B)+oi),t=>{wn(this,U)[e]=gi(t)}}}U=new WeakMap,B=new WeakMap,j=new WeakSet,H=function(e){return wn(this,U).push(e),On(this,B,wn(this,B)+e.length),e.length},W=new WeakMap,X=new WeakMap,F=new WeakMap,J=new WeakMap,G=new WeakMap,q=new WeakSet,V=function(e){var t;if(wn(this,J))return En(t=wn(this,J),q,V).call(t,e);On(this,F,wn(this,F)+e),kn(wn(this,G)<1||wn(this,F)<=wn(this,G)*this.dataLength,`compressed ABI data exceeds inflation ratio of ${wn(this,G)} ( see: https://github.com/ethers-io/ethers.js/issues/4537 )`,"BUFFER_OVERRUN",{buffer:Un(wn(this,W)),offset:wn(this,X),length:e,info:{bytesRead:wn(this,F),dataLength:this.dataLength}})},z=function(e,t,n){let r=Math.ceil(t/oi)*oi;return wn(this,X)+r>wn(this,W).length&&(this.allowLoose&&n&&wn(this,X)+t<=wn(this,W).length?r=t:kn(!1,"data out-of-bounds","BUFFER_OVERRUN",{buffer:Un(wn(this,W)),length:wn(this,W).length,offset:wn(this,X)+r})),wn(this,W).slice(wn(this,X),wn(this,X)+r)};function vi(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function wi(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function bi(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");vi(e.outputLen),vi(e.blockLen)}function Oi(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Ei(e,t){wi(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const _i="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,Ci=e=>e instanceof Uint8Array,Ni=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),Ai=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),Ri=(e,t)=>e<<32-t|e>>>t;if(68!==new Uint8Array(new Uint32Array([287454020]).buffer)[0])throw new Error("Non little-endian hardware is not supported");function Si(e){if("string"!=typeof e)throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array((new TextEncoder).encode(e))}function Ti(e){if("string"==typeof e&&(e=Si(e)),!Ci(e))throw new Error(`expected Uint8Array, got ${typeof e}`);return e}function Pi(...e){const t=new Uint8Array(e.reduce((e,t)=>e+t.length,0));let n=0;return e.forEach(e=>{if(!Ci(e))throw new Error("Uint8Array expected");t.set(e,n),n+=e.length}),t}class Di{clone(){return this._cloneInto()}}function ki(e){const t=t=>e().update(Ti(t)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function Ii(e=32){if(_i&&"function"==typeof _i.getRandomValues)return _i.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}class xi extends Di{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,bi(e);const n=Ti(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const r=this.blockLen,i=new Uint8Array(r);i.set(n.length>r?e.create().update(n).digest():n);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),i.fill(0)}update(e){return Oi(this),this.iHash.update(e),this}digestInto(e){Oi(this),wi(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:r,destroyed:i,blockLen:o,outputLen:s}=this;return(e=e).finished=r,e.destroyed=i,e.blockLen=o,e.outputLen=s,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Mi=(e,t,n)=>new xi(e,t).update(n).digest();function Ki(e,t,n,r){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,n,r);const i=BigInt(32),o=BigInt(4294967295),s=Number(n>>i&o),a=Number(n&o),c=r?4:0,l=r?0:4;e.setUint32(t+c,s,r),e.setUint32(t+l,a,r)}Mi.create=(e,t)=>new xi(e,t);class Li extends Di{constructor(e,t,n,r){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Ai(this.buffer)}update(e){Oi(this);const{view:t,buffer:n,blockLen:r}=this,i=(e=Ti(e)).length;for(let o=0;o<i;){const s=Math.min(r-this.pos,i-o);if(s!==r)n.set(e.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===r&&(this.process(t,0),this.pos=0);else{const t=Ai(e);for(;r<=i-o;o+=r)this.process(t,o)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){Oi(this),Ei(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:r,isLE:i}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>r-o&&(this.process(n,0),o=0);for(let u=o;u<r;u++)t[u]=0;Ki(n,r-8,BigInt(8*this.length),i),this.process(n,0);const s=Ai(e),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,l=this.get();if(c>l.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<c;u++)s.setUint32(4*u,l[u],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:r,finished:i,destroyed:o,pos:s}=this;return e.length=r,e.pos=s,e.finished=i,e.destroyed=o,r%t&&e.buffer.set(n),e}}const Ui=(e,t,n)=>e&t^~e&n,Bi=(e,t,n)=>e&t^e&n^t&n,ji=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Hi=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Wi=new Uint32Array(64);class Xi extends Li{constructor(){super(64,32,8,!1),this.A=0|Hi[0],this.B=0|Hi[1],this.C=0|Hi[2],this.D=0|Hi[3],this.E=0|Hi[4],this.F=0|Hi[5],this.G=0|Hi[6],this.H=0|Hi[7]}get(){const{A:e,B:t,C:n,D:r,E:i,F:o,G:s,H:a}=this;return[e,t,n,r,i,o,s,a]}set(e,t,n,r,i,o,s,a){this.A=0|e,this.B=0|t,this.C=0|n,this.D=0|r,this.E=0|i,this.F=0|o,this.G=0|s,this.H=0|a}process(e,t){for(let u=0;u<16;u++,t+=4)Wi[u]=e.getUint32(t,!1);for(let u=16;u<64;u++){const e=Wi[u-15],t=Wi[u-2],n=Ri(e,7)^Ri(e,18)^e>>>3,r=Ri(t,17)^Ri(t,19)^t>>>10;Wi[u]=r+Wi[u-7]+n+Wi[u-16]|0}let{A:n,B:r,C:i,D:o,E:s,F:a,G:c,H:l}=this;for(let u=0;u<64;u++){const e=l+(Ri(s,6)^Ri(s,11)^Ri(s,25))+Ui(s,a,c)+ji[u]+Wi[u]|0,t=(Ri(n,2)^Ri(n,13)^Ri(n,22))+Bi(n,r,i)|0;l=c,c=a,a=s,s=o+e|0,o=i,i=r,r=n,n=e+t|0}n=n+this.A|0,r=r+this.B|0,i=i+this.C|0,o=o+this.D|0,s=s+this.E|0,a=a+this.F|0,c=c+this.G|0,l=l+this.H|0,this.set(n,r,i,o,s,a,c,l)}roundClean(){Wi.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const Fi=ki(()=>new Xi),Ji=BigInt(2**32-1),Gi=BigInt(32);function qi(e,t=!1){return t?{h:Number(e&Ji),l:Number(e>>Gi&Ji)}:{h:0|Number(e>>Gi&Ji),l:0|Number(e&Ji)}}function Vi(e,t=!1){let n=new Uint32Array(e.length),r=new Uint32Array(e.length);for(let i=0;i<e.length;i++){const{h:o,l:s}=qi(e[i],t);[n[i],r[i]]=[o,s]}return[n,r]}const zi=(e,t,n)=>e<<n|t>>>32-n,Qi=(e,t,n)=>t<<n|e>>>32-n,$i=(e,t,n)=>t<<n-32|e>>>64-n,Yi=(e,t,n)=>e<<n-32|t>>>64-n,Zi={fromBig:qi,split:Vi,toBig:(e,t)=>BigInt(e>>>0)<<Gi|BigInt(t>>>0),shrSH:(e,t,n)=>e>>>n,shrSL:(e,t,n)=>e<<32-n|t>>>n,rotrSH:(e,t,n)=>e>>>n|t<<32-n,rotrSL:(e,t,n)=>e<<32-n|t>>>n,rotrBH:(e,t,n)=>e<<64-n|t>>>n-32,rotrBL:(e,t,n)=>e>>>n-32|t<<64-n,rotr32H:(e,t)=>t,rotr32L:e=>e,rotlSH:zi,rotlSL:Qi,rotlBH:$i,rotlBL:Yi,add:function(e,t,n,r){const i=(t>>>0)+(r>>>0);return{h:e+n+(i/2**32|0)|0,l:0|i}},add3L:(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),add3H:(e,t,n,r)=>t+n+r+(e/2**32|0)|0,add4L:(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),add4H:(e,t,n,r,i)=>t+n+r+i+(e/2**32|0)|0,add5H:(e,t,n,r,i,o)=>t+n+r+i+o+(e/2**32|0)|0,add5L:(e,t,n,r,i)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(i>>>0)},[eo,to]=Zi.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),no=new Uint32Array(80),ro=new Uint32Array(80);class io extends Li{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:n,Bl:r,Ch:i,Cl:o,Dh:s,Dl:a,Eh:c,El:l,Fh:u,Fl:h,Gh:d,Gl:f,Hh:p,Hl:g}=this;return[e,t,n,r,i,o,s,a,c,l,u,h,d,f,p,g]}set(e,t,n,r,i,o,s,a,c,l,u,h,d,f,p,g){this.Ah=0|e,this.Al=0|t,this.Bh=0|n,this.Bl=0|r,this.Ch=0|i,this.Cl=0|o,this.Dh=0|s,this.Dl=0|a,this.Eh=0|c,this.El=0|l,this.Fh=0|u,this.Fl=0|h,this.Gh=0|d,this.Gl=0|f,this.Hh=0|p,this.Hl=0|g}process(e,t){for(let v=0;v<16;v++,t+=4)no[v]=e.getUint32(t),ro[v]=e.getUint32(t+=4);for(let v=16;v<80;v++){const e=0|no[v-15],t=0|ro[v-15],n=Zi.rotrSH(e,t,1)^Zi.rotrSH(e,t,8)^Zi.shrSH(e,t,7),r=Zi.rotrSL(e,t,1)^Zi.rotrSL(e,t,8)^Zi.shrSL(e,t,7),i=0|no[v-2],o=0|ro[v-2],s=Zi.rotrSH(i,o,19)^Zi.rotrBH(i,o,61)^Zi.shrSH(i,o,6),a=Zi.rotrSL(i,o,19)^Zi.rotrBL(i,o,61)^Zi.shrSL(i,o,6),c=Zi.add4L(r,a,ro[v-7],ro[v-16]),l=Zi.add4H(c,n,s,no[v-7],no[v-16]);no[v]=0|l,ro[v]=0|c}let{Ah:n,Al:r,Bh:i,Bl:o,Ch:s,Cl:a,Dh:c,Dl:l,Eh:u,El:h,Fh:d,Fl:f,Gh:p,Gl:g,Hh:m,Hl:y}=this;for(let v=0;v<80;v++){const e=Zi.rotrSH(u,h,14)^Zi.rotrSH(u,h,18)^Zi.rotrBH(u,h,41),t=Zi.rotrSL(u,h,14)^Zi.rotrSL(u,h,18)^Zi.rotrBL(u,h,41),w=u&d^~u&p,b=h&f^~h&g,O=Zi.add5L(y,t,b,to[v],ro[v]),E=Zi.add5H(O,m,e,w,eo[v],no[v]),_=0|O,C=Zi.rotrSH(n,r,28)^Zi.rotrBH(n,r,34)^Zi.rotrBH(n,r,39),N=Zi.rotrSL(n,r,28)^Zi.rotrBL(n,r,34)^Zi.rotrBL(n,r,39),A=n&i^n&s^i&s,R=r&o^r&a^o&a;m=0|p,y=0|g,p=0|d,g=0|f,d=0|u,f=0|h,({h:u,l:h}=Zi.add(0|c,0|l,0|E,0|_)),c=0|s,l=0|a,s=0|i,a=0|o,i=0|n,o=0|r;const S=Zi.add3L(_,N,R);n=Zi.add3H(S,E,C,A),r=0|S}({h:n,l:r}=Zi.add(0|this.Ah,0|this.Al,0|n,0|r)),({h:i,l:o}=Zi.add(0|this.Bh,0|this.Bl,0|i,0|o)),({h:s,l:a}=Zi.add(0|this.Ch,0|this.Cl,0|s,0|a)),({h:c,l:l}=Zi.add(0|this.Dh,0|this.Dl,0|c,0|l)),({h:u,l:h}=Zi.add(0|this.Eh,0|this.El,0|u,0|h)),({h:d,l:f}=Zi.add(0|this.Fh,0|this.Fl,0|d,0|f)),({h:p,l:g}=Zi.add(0|this.Gh,0|this.Gl,0|p,0|g)),({h:m,l:y}=Zi.add(0|this.Hh,0|this.Hl,0|m,0|y)),this.set(n,r,i,o,s,a,c,l,u,h,d,f,p,g,m,y)}roundClean(){no.fill(0),ro.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const oo=ki(()=>new io),so=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")}();function ao(e){switch(e){case"sha256":return Fi.create();case"sha512":return oo.create()}In(!1,"invalid hashing algorithm name","algorithm",e)}so.crypto||so.msCrypto;const[co,lo,uo]=[[],[],[]],ho=BigInt(0),fo=BigInt(1),po=BigInt(2),go=BigInt(7),mo=BigInt(256),yo=BigInt(113);for(let KC=0,LC=fo,UC=1,BC=0;KC<24;KC++){[UC,BC]=[BC,(2*UC+3*BC)%5],co.push(2*(5*BC+UC)),lo.push((KC+1)*(KC+2)/2%64);let e=ho;for(let t=0;t<7;t++)(LC=(LC<<fo^(LC>>go)*yo)%mo)&po&&(e^=fo<<(fo<<BigInt(t))-fo);uo.push(e)}const[vo,wo]=Vi(uo,!0),bo=(e,t,n)=>n>32?$i(e,t,n):zi(e,t,n),Oo=(e,t,n)=>n>32?Yi(e,t,n):Qi(e,t,n);function Eo(e,t=24){const n=new Uint32Array(10);for(let r=24-t;r<24;r++){for(let r=0;r<10;r++)n[r]=e[r]^e[r+10]^e[r+20]^e[r+30]^e[r+40];for(let r=0;r<10;r+=2){const t=(r+8)%10,i=(r+2)%10,o=n[i],s=n[i+1],a=bo(o,s,1)^n[t],c=Oo(o,s,1)^n[t+1];for(let n=0;n<50;n+=10)e[r+n]^=a,e[r+n+1]^=c}let t=e[2],i=e[3];for(let n=0;n<24;n++){const r=lo[n],o=bo(t,i,r),s=Oo(t,i,r),a=co[n];t=e[a],i=e[a+1],e[a]=o,e[a+1]=s}for(let r=0;r<50;r+=10){for(let t=0;t<10;t++)n[t]=e[r+t];for(let t=0;t<10;t++)e[r+t]^=~n[(t+2)%10]&n[(t+4)%10]}e[0]^=vo[r],e[1]^=wo[r]}n.fill(0)}class _o extends Di{constructor(e,t,n,r=!1,i=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=n,this.enableXOF=r,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,vi(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=Ni(this.state)}keccak(){Eo(this.state32,this.rounds),this.posOut=0,this.pos=0}update(e){Oi(this);const{blockLen:t,state:n}=this,r=(e=Ti(e)).length;for(let i=0;i<r;){const o=Math.min(t-this.pos,r-i);for(let t=0;t<o;t++)n[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:n,blockLen:r}=this;e[n]^=t,0!=(128&t)&&n===r-1&&this.keccak(),e[r-1]^=128,this.keccak()}writeInto(e){Oi(this,!1),wi(e),this.finish();const t=this.state,{blockLen:n}=this;for(let r=0,i=e.length;r<i;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,i-r);e.set(t.subarray(this.posOut,this.posOut+o),r),this.posOut+=o,r+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return vi(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(Ei(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:n,outputLen:r,rounds:i,enableXOF:o}=this;return e||(e=new _o(t,n,r,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=n,e.outputLen=r,e.enableXOF=o,e.destroyed=this.destroyed,e}}const Co=(()=>ki(()=>new _o(136,1,32)))();let No=!1;const Ao=function(e){return Co(e)};let Ro=Ao;function So(e){const t=Ln(e,"data");return Wn(Ro(t))}So._=Ao,So.lock=function(){No=!0},So.register=function(e){if(No)throw new TypeError("keccak256 is locked");Ro=e},Object.freeze(So);const To=function(e){return ao("sha256").update(e).digest()};let Po=To,Do=!1;function ko(e){const t=Ln(e,"data");return Wn(Po(t))}ko._=To,ko.lock=function(){Do=!0},ko.register=function(e){if(Do)throw new Error("sha256 is locked");Po=e},Object.freeze(ko),Object.freeze(ko);const Io=BigInt(0),xo=BigInt(1),Mo=BigInt(2),Ko=e=>e instanceof Uint8Array,Lo=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Uo(e){if(!Ko(e))throw new Error("Uint8Array expected");let t="";for(let n=0;n<e.length;n++)t+=Lo[e[n]];return t}function Bo(e){const t=e.toString(16);return 1&t.length?`0${t}`:t}function jo(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);return BigInt(""===e?"0":`0x${e}`)}function Ho(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);const t=e.length;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(t/2);for(let r=0;r<n.length;r++){const t=2*r,i=e.slice(t,t+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");n[r]=o}return n}function Wo(e){return jo(Uo(e))}function Xo(e){if(!Ko(e))throw new Error("Uint8Array expected");return jo(Uo(Uint8Array.from(e).reverse()))}function Fo(e,t){return Ho(e.toString(16).padStart(2*t,"0"))}function Jo(e,t){return Fo(e,t).reverse()}function Go(e,t,n){let r;if("string"==typeof t)try{r=Ho(t)}catch(o){throw new Error(`${e} must be valid hex string, got "${t}". Cause: ${o}`)}else{if(!Ko(t))throw new Error(`${e} must be hex string or Uint8Array`);r=Uint8Array.from(t)}const i=r.length;if("number"==typeof n&&i!==n)throw new Error(`${e} expected ${n} bytes, got ${i}`);return r}function qo(...e){const t=new Uint8Array(e.reduce((e,t)=>e+t.length,0));let n=0;return e.forEach(e=>{if(!Ko(e))throw new Error("Uint8Array expected");t.set(e,n),n+=e.length}),t}const Vo=e=>(Mo<<BigInt(e-1))-xo,zo=e=>new Uint8Array(e),Qo=e=>Uint8Array.from(e);function $o(e,t,n){if("number"!=typeof e||e<2)throw new Error("hashLen must be a number");if("number"!=typeof t||t<2)throw new Error("qByteLen must be a number");if("function"!=typeof n)throw new Error("hmacFn must be a function");let r=zo(e),i=zo(e),o=0;const s=()=>{r.fill(1),i.fill(0),o=0},a=(...e)=>n(i,r,...e),c=(e=zo())=>{i=a(Qo([0]),e),r=a(),0!==e.length&&(i=a(Qo([1]),e),r=a())},l=()=>{if(o++>=1e3)throw new Error("drbg: tried 1000 values");let e=0;const n=[];for(;e<t;){const t=(r=a()).slice();n.push(t),e+=r.length}return qo(...n)};return(e,t)=>{let n;for(s(),c(e);!(n=t(l()));)c();return s(),n}}const Yo={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||e instanceof Uint8Array,isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)};function Zo(e,t,n={}){const r=(t,n,r)=>{const i=Yo[n];if("function"!=typeof i)throw new Error(`Invalid validator "${n}", expected function`);const o=e[t];if(!(r&&void 0===o||i(o,e)))throw new Error(`Invalid param ${String(t)}=${o} (${typeof o}), expected ${n}`)};for(const[i,o]of Object.entries(t))r(i,o,!1);for(const[i,o]of Object.entries(n))r(i,o,!0);return e}const es=Object.freeze(Object.defineProperty({__proto__:null,bitGet:function(e,t){return e>>BigInt(t)&xo},bitLen:function(e){let t;for(t=0;e>Io;e>>=xo,t+=1);return t},bitMask:Vo,bitSet:(e,t,n)=>e|(n?xo:Io)<<BigInt(t),bytesToHex:Uo,bytesToNumberBE:Wo,bytesToNumberLE:Xo,concatBytes:qo,createHmacDrbg:$o,ensureBytes:Go,equalBytes:function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0},hexToBytes:Ho,hexToNumber:jo,numberToBytesBE:Fo,numberToBytesLE:Jo,numberToHexUnpadded:Bo,numberToVarBytesBE:function(e){return Ho(Bo(e))},utf8ToBytes:function(e){if("string"!=typeof e)throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array((new TextEncoder).encode(e))},validateObject:Zo},Symbol.toStringTag,{value:"Module"})),ts=BigInt(0),ns=BigInt(1),rs=BigInt(2),is=BigInt(3),os=BigInt(4),ss=BigInt(5),as=BigInt(8);function cs(e,t){const n=e%t;return n>=ts?n:t+n}function ls(e,t,n){if(n<=ts||t<ts)throw new Error("Expected power/modulo > 0");if(n===ns)return ts;let r=ns;for(;t>ts;)t&ns&&(r=r*e%n),e=e*e%n,t>>=ns;return r}function us(e,t,n){let r=e;for(;t-- >ts;)r*=r,r%=n;return r}function hs(e,t){if(e===ts||t<=ts)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let n=cs(e,t),r=t,i=ts,o=ns;for(;n!==ts;){const e=r%n,t=i-o*(r/n);r=n,n=e,i=o,o=t}if(r!==ns)throw new Error("invert: does not exist");return cs(i,t)}function ds(e){const t=(e-ns)/rs;let n,r,i;for(n=e-ns,r=0;n%rs===ts;n/=rs,r++);for(i=rs;i<e&&ls(i,t,e)!==e-ns;i++);if(1===r){const t=(e+ns)/os;return function(e,n){const r=e.pow(n,t);if(!e.eql(e.sqr(r),n))throw new Error("Cannot find square root");return r}}const o=(n+ns)/rs;return function(e,s){if(e.pow(s,t)===e.neg(e.ONE))throw new Error("Cannot find square root");let a=r,c=e.pow(e.mul(e.ONE,i),n),l=e.pow(s,o),u=e.pow(s,n);for(;!e.eql(u,e.ONE);){if(e.eql(u,e.ZERO))return e.ZERO;let t=1;for(let r=e.sqr(u);t<a&&!e.eql(r,e.ONE);t++)r=e.sqr(r);const n=e.pow(c,ns<<BigInt(a-t-1));c=e.sqr(n),l=e.mul(l,n),u=e.mul(u,c),a=t}return l}}function fs(e){if(e%os===is){const t=(e+ns)/os;return function(e,n){const r=e.pow(n,t);if(!e.eql(e.sqr(r),n))throw new Error("Cannot find square root");return r}}if(e%as===ss){const t=(e-ss)/as;return function(e,n){const r=e.mul(n,rs),i=e.pow(r,t),o=e.mul(n,i),s=e.mul(e.mul(o,rs),i),a=e.mul(o,e.sub(s,e.ONE));if(!e.eql(e.sqr(a),n))throw new Error("Cannot find square root");return a}}return ds(e)}BigInt(9),BigInt(16);const ps=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function gs(e){return Zo(e,ps.reduce((e,t)=>(e[t]="function",e),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"}))}function ms(e,t,n){if(n<ts)throw new Error("Expected power > 0");if(n===ts)return e.ONE;if(n===ns)return t;let r=e.ONE,i=t;for(;n>ts;)n&ns&&(r=e.mul(r,i)),i=e.sqr(i),n>>=ns;return r}function ys(e,t){const n=new Array(t.length),r=t.reduce((t,r,i)=>e.is0(r)?t:(n[i]=t,e.mul(t,r)),e.ONE),i=e.inv(r);return t.reduceRight((t,r,i)=>e.is0(r)?t:(n[i]=e.mul(t,n[i]),e.mul(t,r)),i),n}function vs(e,t){const n=void 0!==t?t:e.toString(2).length;return{nBitLength:n,nByteLength:Math.ceil(n/8)}}function ws(e){if("bigint"!=typeof e)throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function bs(e){const t=ws(e);return t+Math.ceil(t/2)}function Os(e,t,n=!1){const r=e.length,i=ws(t),o=bs(t);if(r<16||r<o||r>1024)throw new Error(`expected ${o}-1024 bytes of input, got ${r}`);const s=cs(n?Wo(e):Xo(e),t-ns)+ns;return n?Jo(s,i):Fo(s,i)}const Es=BigInt(0),_s=BigInt(1);function Cs(e,t){const n=(e,t)=>{const n=t.negate();return e?n:t},r=e=>({windows:Math.ceil(t/e)+1,windowSize:2**(e-1)});return{constTimeNegate:n,unsafeLadder(t,n){let r=e.ZERO,i=t;for(;n>Es;)n&_s&&(r=r.add(i)),i=i.double(),n>>=_s;return r},precomputeWindow(e,t){const{windows:n,windowSize:i}=r(t),o=[];let s=e,a=s;for(let r=0;r<n;r++){a=s,o.push(a);for(let e=1;e<i;e++)a=a.add(s),o.push(a);s=a.double()}return o},wNAF(t,i,o){const{windows:s,windowSize:a}=r(t);let c=e.ZERO,l=e.BASE;const u=BigInt(2**t-1),h=2**t,d=BigInt(t);for(let e=0;e<s;e++){const t=e*a;let r=Number(o&u);o>>=d,r>a&&(r-=h,o+=_s);const s=t,f=t+Math.abs(r)-1,p=e%2!=0,g=r<0;0===r?l=l.add(n(p,i[s])):c=c.add(n(g,i[f]))}return{p:c,f:l}},wNAFCached(e,t,n,r){const i=e._WINDOW_SIZE||1;let o=t.get(e);return o||(o=this.precomputeWindow(e,i),1!==i&&t.set(e,r(o))),this.wNAF(i,o,n)}}}function Ns(e){return gs(e.Fp),Zo(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...vs(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}function As(e){const t=Ns(e);Zo(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:n,Fp:r,a:i}=t;if(n){if(!r.eql(i,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if("object"!=typeof n||"bigint"!=typeof n.beta||"function"!=typeof n.splitScalar)throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}const{bytesToNumberBE:Rs,hexToBytes:Ss}=es,Ts={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(e){const{Err:t}=Ts;if(e.length<2||2!==e[0])throw new t("Invalid signature integer tag");const n=e[1],r=e.subarray(2,n+2);if(!n||r.length!==n)throw new t("Invalid signature integer: wrong length");if(128&r[0])throw new t("Invalid signature integer: negative");if(0===r[0]&&!(128&r[1]))throw new t("Invalid signature integer: unnecessary leading zero");return{d:Rs(r),l:e.subarray(n+2)}},toSig(e){const{Err:t}=Ts,n="string"==typeof e?Ss(e):e;if(!(n instanceof Uint8Array))throw new Error("ui8a expected");let r=n.length;if(r<2||48!=n[0])throw new t("Invalid signature tag");if(n[1]!==r-2)throw new t("Invalid signature: incorrect length");const{d:i,l:o}=Ts._parseInt(n.subarray(2)),{d:s,l:a}=Ts._parseInt(o);if(a.length)throw new t("Invalid signature: left bytes after parsing");return{r:i,s:s}},hexFromSig(e){const t=e=>8&Number.parseInt(e[0],16)?"00"+e:e,n=e=>{const t=e.toString(16);return 1&t.length?`0${t}`:t},r=t(n(e.s)),i=t(n(e.r)),o=r.length/2,s=i.length/2,a=n(o),c=n(s);return`30${n(s+o+4)}02${c}${i}02${a}${r}`}},Ps=BigInt(0),Ds=BigInt(1);BigInt(2);const ks=BigInt(3);function Is(e){const t=As(e),{Fp:n}=t,r=t.toBytes||((e,t)=>{const r=t.toAffine();return qo(Uint8Array.from([4]),n.toBytes(r.x),n.toBytes(r.y))}),i=t.fromBytes||(e=>{const t=e.subarray(1);return{x:n.fromBytes(t.subarray(0,n.BYTES)),y:n.fromBytes(t.subarray(n.BYTES,2*n.BYTES))}});function o(e){const{a:r,b:i}=t,o=n.sqr(e),s=n.mul(o,e);return n.add(n.add(s,n.mul(e,r)),i)}if(!n.eql(n.sqr(t.Gy),o(t.Gx)))throw new Error("bad generator point: equation left != right");function s(e){return"bigint"==typeof e&&Ps<e&&e<t.n}function a(e){if(!s(e))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(e){const{allowedPrivateKeyLengths:n,nByteLength:r,wrapPrivateKey:i,n:o}=t;if(n&&"bigint"!=typeof e){if(e instanceof Uint8Array&&(e=Uo(e)),"string"!=typeof e||!n.includes(e.length))throw new Error("Invalid key");e=e.padStart(2*r,"0")}let s;try{s="bigint"==typeof e?e:Wo(Go("private key",e,r))}catch{throw new Error(`private key must be ${r} bytes, hex or bigint, not ${typeof e}`)}return i&&(s=cs(s,o)),a(s),s}const l=new Map;function u(e){if(!(e instanceof h))throw new Error("ProjectivePoint expected")}class h{constructor(e,t,r){if(this.px=e,this.py=t,this.pz=r,null==e||!n.isValid(e))throw new Error("x required");if(null==t||!n.isValid(t))throw new Error("y required");if(null==r||!n.isValid(r))throw new Error("z required")}static fromAffine(e){const{x:t,y:r}=e||{};if(!e||!n.isValid(t)||!n.isValid(r))throw new Error("invalid affine point");if(e instanceof h)throw new Error("projective point not allowed");const i=e=>n.eql(e,n.ZERO);return i(t)&&i(r)?h.ZERO:new h(t,r,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(e){const t=n.invertBatch(e.map(e=>e.pz));return e.map((e,n)=>e.toAffine(t[n])).map(h.fromAffine)}static fromHex(e){const t=h.fromAffine(i(Go("pointHex",e)));return t.assertValidity(),t}static fromPrivateKey(e){return h.BASE.multiply(c(e))}_setWindowSize(e){this._WINDOW_SIZE=e,l.delete(this)}assertValidity(){if(this.is0()){if(t.allowInfinityPoint&&!n.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:e,y:r}=this.toAffine();if(!n.isValid(e)||!n.isValid(r))throw new Error("bad point: x or y not FE");const i=n.sqr(r),s=o(e);if(!n.eql(i,s))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:e}=this.toAffine();if(n.isOdd)return!n.isOdd(e);throw new Error("Field doesn't support isOdd")}equals(e){u(e);const{px:t,py:r,pz:i}=this,{px:o,py:s,pz:a}=e,c=n.eql(n.mul(t,a),n.mul(o,i)),l=n.eql(n.mul(r,a),n.mul(s,i));return c&&l}negate(){return new h(this.px,n.neg(this.py),this.pz)}double(){const{a:e,b:r}=t,i=n.mul(r,ks),{px:o,py:s,pz:a}=this;let c=n.ZERO,l=n.ZERO,u=n.ZERO,d=n.mul(o,o),f=n.mul(s,s),p=n.mul(a,a),g=n.mul(o,s);return g=n.add(g,g),u=n.mul(o,a),u=n.add(u,u),c=n.mul(e,u),l=n.mul(i,p),l=n.add(c,l),c=n.sub(f,l),l=n.add(f,l),l=n.mul(c,l),c=n.mul(g,c),u=n.mul(i,u),p=n.mul(e,p),g=n.sub(d,p),g=n.mul(e,g),g=n.add(g,u),u=n.add(d,d),d=n.add(u,d),d=n.add(d,p),d=n.mul(d,g),l=n.add(l,d),p=n.mul(s,a),p=n.add(p,p),d=n.mul(p,g),c=n.sub(c,d),u=n.mul(p,f),u=n.add(u,u),u=n.add(u,u),new h(c,l,u)}add(e){u(e);const{px:r,py:i,pz:o}=this,{px:s,py:a,pz:c}=e;let l=n.ZERO,d=n.ZERO,f=n.ZERO;const p=t.a,g=n.mul(t.b,ks);let m=n.mul(r,s),y=n.mul(i,a),v=n.mul(o,c),w=n.add(r,i),b=n.add(s,a);w=n.mul(w,b),b=n.add(m,y),w=n.sub(w,b),b=n.add(r,o);let O=n.add(s,c);return b=n.mul(b,O),O=n.add(m,v),b=n.sub(b,O),O=n.add(i,o),l=n.add(a,c),O=n.mul(O,l),l=n.add(y,v),O=n.sub(O,l),f=n.mul(p,b),l=n.mul(g,v),f=n.add(l,f),l=n.sub(y,f),f=n.add(y,f),d=n.mul(l,f),y=n.add(m,m),y=n.add(y,m),v=n.mul(p,v),b=n.mul(g,b),y=n.add(y,v),v=n.sub(m,v),v=n.mul(p,v),b=n.add(b,v),m=n.mul(y,b),d=n.add(d,m),m=n.mul(O,b),l=n.mul(w,l),l=n.sub(l,m),m=n.mul(w,y),f=n.mul(O,f),f=n.add(f,m),new h(l,d,f)}subtract(e){return this.add(e.negate())}is0(){return this.equals(h.ZERO)}wNAF(e){return f.wNAFCached(this,l,e,e=>{const t=n.invertBatch(e.map(e=>e.pz));return e.map((e,n)=>e.toAffine(t[n])).map(h.fromAffine)})}multiplyUnsafe(e){const r=h.ZERO;if(e===Ps)return r;if(a(e),e===Ds)return this;const{endo:i}=t;if(!i)return f.unsafeLadder(this,e);let{k1neg:o,k1:s,k2neg:c,k2:l}=i.splitScalar(e),u=r,d=r,p=this;for(;s>Ps||l>Ps;)s&Ds&&(u=u.add(p)),l&Ds&&(d=d.add(p)),p=p.double(),s>>=Ds,l>>=Ds;return o&&(u=u.negate()),c&&(d=d.negate()),d=new h(n.mul(d.px,i.beta),d.py,d.pz),u.add(d)}multiply(e){a(e);let r,i,o=e;const{endo:s}=t;if(s){const{k1neg:e,k1:t,k2neg:a,k2:c}=s.splitScalar(o);let{p:l,f:u}=this.wNAF(t),{p:d,f:p}=this.wNAF(c);l=f.constTimeNegate(e,l),d=f.constTimeNegate(a,d),d=new h(n.mul(d.px,s.beta),d.py,d.pz),r=l.add(d),i=u.add(p)}else{const{p:e,f:t}=this.wNAF(o);r=e,i=t}return h.normalizeZ([r,i])[0]}multiplyAndAddUnsafe(e,t,n){const r=h.BASE,i=(e,t)=>t!==Ps&&t!==Ds&&e.equals(r)?e.multiply(t):e.multiplyUnsafe(t),o=i(this,t).add(i(e,n));return o.is0()?void 0:o}toAffine(e){const{px:t,py:r,pz:i}=this,o=this.is0();null==e&&(e=o?n.ONE:n.inv(i));const s=n.mul(t,e),a=n.mul(r,e),c=n.mul(i,e);if(o)return{x:n.ZERO,y:n.ZERO};if(!n.eql(c,n.ONE))throw new Error("invZ was invalid");return{x:s,y:a}}isTorsionFree(){const{h:e,isTorsionFree:n}=t;if(e===Ds)return!0;if(n)return n(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:e,clearCofactor:n}=t;return e===Ds?this:n?n(h,this):this.multiplyUnsafe(t.h)}toRawBytes(e=!0){return this.assertValidity(),r(h,this,e)}toHex(e=!0){return Uo(this.toRawBytes(e))}}h.BASE=new h(t.Gx,t.Gy,n.ONE),h.ZERO=new h(n.ZERO,n.ONE,n.ZERO);const d=t.nBitLength,f=Cs(h,t.endo?Math.ceil(d/2):d);return{CURVE:t,ProjectivePoint:h,normPrivateKeyToScalar:c,weierstrassEquation:o,isWithinCurveOrder:s}}function xs(e){const t=Ns(e);return Zo(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function Ms(e){const t=xs(e),{Fp:n,n:r}=t,i=n.BYTES+1,o=2*n.BYTES+1;function s(e){return Ps<e&&e<n.ORDER}function a(e){return cs(e,r)}function c(e){return hs(e,r)}const{ProjectivePoint:l,normPrivateKeyToScalar:u,weierstrassEquation:h,isWithinCurveOrder:d}=Is({...t,toBytes(e,t,r){const i=t.toAffine(),o=n.toBytes(i.x),s=qo;return r?s(Uint8Array.from([t.hasEvenY()?2:3]),o):s(Uint8Array.from([4]),o,n.toBytes(i.y))},fromBytes(e){const t=e.length,r=e[0],a=e.subarray(1);if(t!==i||2!==r&&3!==r){if(t===o&&4===r)return{x:n.fromBytes(a.subarray(0,n.BYTES)),y:n.fromBytes(a.subarray(n.BYTES,2*n.BYTES))};throw new Error(`Point of length ${t} was invalid. Expected ${i} compressed bytes or ${o} uncompressed bytes`)}{const e=Wo(a);if(!s(e))throw new Error("Point is not on curve");const t=h(e);let i=n.sqrt(t);return 1==(1&r)!=((i&Ds)===Ds)&&(i=n.neg(i)),{x:e,y:i}}}}),f=e=>Uo(Fo(e,t.nByteLength));function p(e){return e>r>>Ds}function g(e){return p(e)?a(-e):e}const m=(e,t,n)=>Wo(e.slice(t,n));class y{constructor(e,t,n){this.r=e,this.s=t,this.recovery=n,this.assertValidity()}static fromCompact(e){const n=t.nByteLength;return e=Go("compactSignature",e,2*n),new y(m(e,0,n),m(e,n,2*n))}static fromDER(e){const{r:t,s:n}=Ts.toSig(Go("DER",e));return new y(t,n)}assertValidity(){if(!d(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!d(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(e){return new y(this.r,this.s,e)}recoverPublicKey(e){const{r:r,s:i,recovery:o}=this,s=O(Go("msgHash",e));if(null==o||![0,1,2,3].includes(o))throw new Error("recovery id invalid");const u=2===o||3===o?r+t.n:r;if(u>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");const h=0==(1&o)?"02":"03",d=l.fromHex(h+f(u)),p=c(u),g=a(-s*p),m=a(i*p),y=l.BASE.multiplyAndAddUnsafe(d,g,m);if(!y)throw new Error("point at infinify");return y.assertValidity(),y}hasHighS(){return p(this.s)}normalizeS(){return this.hasHighS()?new y(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return Ho(this.toDERHex())}toDERHex(){return Ts.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Ho(this.toCompactHex())}toCompactHex(){return f(this.r)+f(this.s)}}const v={isValidPrivateKey(e){try{return u(e),!0}catch{return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{const e=bs(t.n);return Os(t.randomBytes(e),t.n)},precompute:(e=8,t=l.BASE)=>(t._setWindowSize(e),t.multiply(BigInt(3)),t)};function w(e){const t=e instanceof Uint8Array,n="string"==typeof e,r=(t||n)&&e.length;return t?r===i||r===o:n?r===2*i||r===2*o:e instanceof l}const b=t.bits2int||function(e){const n=Wo(e),r=8*e.length-t.nBitLength;return r>0?n>>BigInt(r):n},O=t.bits2int_modN||function(e){return a(b(e))},E=Vo(t.nBitLength);function _(e){if("bigint"!=typeof e)throw new Error("bigint expected");if(!(Ps<=e&&e<E))throw new Error(`bigint expected < 2^${t.nBitLength}`);return Fo(e,t.nByteLength)}function C(e,r,i=N){if(["recovered","canonical"].some(e=>e in i))throw new Error("sign() legacy options not supported");const{hash:o,randomBytes:s}=t;let{lowS:h,prehash:f,extraEntropy:m}=i;null==h&&(h=!0),e=Go("msgHash",e),f&&(e=Go("prehashed msgHash",o(e)));const v=O(e),w=u(r),E=[_(w),_(v)];if(null!=m){const e=!0===m?s(n.BYTES):m;E.push(Go("extraEntropy",e))}const C=qo(...E),A=v;return{seed:C,k2sig:function(e){const t=b(e);if(!d(t))return;const n=c(t),r=l.BASE.multiply(t).toAffine(),i=a(r.x);if(i===Ps)return;const o=a(n*a(A+i*w));if(o===Ps)return;let s=(r.x===i?0:2)|Number(r.y&Ds),u=o;return h&&p(o)&&(u=g(o),s^=1),new y(i,u,s)}}}const N={lowS:t.lowS,prehash:!1},A={lowS:t.lowS,prehash:!1};return l.BASE._setWindowSize(8),{CURVE:t,getPublicKey:function(e,t=!0){return l.fromPrivateKey(e).toRawBytes(t)},getSharedSecret:function(e,t,n=!0){if(w(e))throw new Error("first arg must be private key");if(!w(t))throw new Error("second arg must be public key");return l.fromHex(t).multiply(u(e)).toRawBytes(n)},sign:function(e,n,r=N){const{seed:i,k2sig:o}=C(e,n,r),s=t;return $o(s.hash.outputLen,s.nByteLength,s.hmac)(i,o)},verify:function(e,n,r,i=A){var o;const s=e;if(n=Go("msgHash",n),r=Go("publicKey",r),"strict"in i)throw new Error("options.strict was renamed to lowS");const{lowS:u,prehash:h}=i;let d,f;try{if("string"==typeof s||s instanceof Uint8Array)try{d=y.fromDER(s)}catch(_){if(!(_ instanceof Ts.Err))throw _;d=y.fromCompact(s)}else{if("object"!=typeof s||"bigint"!=typeof s.r||"bigint"!=typeof s.s)throw new Error("PARSE");{const{r:e,s:t}=s;d=new y(e,t)}}f=l.fromHex(r)}catch(_){if("PARSE"===_.message)throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(u&&d.hasHighS())return!1;h&&(n=t.hash(n));const{r:p,s:g}=d,m=O(n),v=c(g),w=a(m*v),b=a(p*v),E=null==(o=l.BASE.multiplyAndAddUnsafe(f,w,b))?void 0:o.toAffine();return!!E&&a(E.x)===p},ProjectivePoint:l,Signature:y,utils:v}}function Ks(e){return{hash:e,hmac:(t,...n)=>Mi(e,t,Pi(...n)),randomBytes:Ii}}BigInt(4);const Ls=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Us=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Bs=BigInt(1),js=BigInt(2),Hs=(e,t)=>(e+t/js)/t,Ws=function(e,t,n=!1,r={}){if(e<=ts)throw new Error(`Expected Field ORDER > 0, got ${e}`);const{nBitLength:i,nByteLength:o}=vs(e,void 0);if(o>2048)throw new Error("Field lengths over 2048 bytes are not supported");const s=fs(e),a=Object.freeze({ORDER:e,BITS:i,BYTES:o,MASK:Vo(i),ZERO:ts,ONE:ns,create:t=>cs(t,e),isValid:t=>{if("bigint"!=typeof t)throw new Error(`Invalid field element: expected bigint, got ${typeof t}`);return ts<=t&&t<e},is0:e=>e===ts,isOdd:e=>(e&ns)===ns,neg:t=>cs(-t,e),eql:(e,t)=>e===t,sqr:t=>cs(t*t,e),add:(t,n)=>cs(t+n,e),sub:(t,n)=>cs(t-n,e),mul:(t,n)=>cs(t*n,e),pow:(e,t)=>ms(a,e,t),div:(t,n)=>cs(t*hs(n,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>hs(t,e),sqrt:r.sqrt||(e=>s(a,e)),invertBatch:e=>ys(a,e),cmov:(e,t,n)=>n?t:e,toBytes:e=>n?Jo(e,o):Fo(e,o),fromBytes:e=>{if(e.length!==o)throw new Error(`Fp.fromBytes: expected ${o}, got ${e.length}`);return n?Xo(e):Wo(e)}});return Object.freeze(a)}(Ls,0,void 0,{sqrt:function(e){const t=Ls,n=BigInt(3),r=BigInt(6),i=BigInt(11),o=BigInt(22),s=BigInt(23),a=BigInt(44),c=BigInt(88),l=e*e*e%t,u=l*l*e%t,h=us(u,n,t)*u%t,d=us(h,n,t)*u%t,f=us(d,js,t)*l%t,p=us(f,i,t)*f%t,g=us(p,o,t)*p%t,m=us(g,a,t)*g%t,y=us(m,c,t)*m%t,v=us(y,a,t)*g%t,w=us(v,n,t)*u%t,b=us(w,s,t)*p%t,O=us(b,r,t)*l%t,E=us(O,js,t);if(!Ws.eql(Ws.sqr(E),e))throw new Error("Cannot find square root");return E}}),Xs=function(e,t){const n=t=>Ms({...e,...Ks(t)});return Object.freeze({...n(t),create:n})}({a:BigInt(0),b:BigInt(7),Fp:Ws,n:Us,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{const t=Us,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-Bs*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=n,s=BigInt("0x100000000000000000000000000000000"),a=Hs(o*e,t),c=Hs(-r*e,t);let l=cs(e-a*n-c*i,t),u=cs(-a*r-c*o,t);const h=l>s,d=u>s;if(h&&(l=t-l),d&&(u=t-u),l>s||u>s)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:h,k1:l,k2neg:d,k2:u}}}},Fi);BigInt(0),Xs.ProjectivePoint;const Fs="0x0000000000000000000000000000000000000000",Js="0x0000000000000000000000000000000000000000000000000000000000000000",Gs=BigInt(0),qs=BigInt(1),Vs=BigInt(2),zs=BigInt(27),Qs=BigInt(28),$s=BigInt(35),Ys={};function Zs(e){return qn(ar(e),32)}Q=new WeakMap,$=new WeakMap,Y=new WeakMap,Z=new WeakMap;let ea=class e{constructor(e,t,n,r){bn(this,Q),bn(this,$),bn(this,Y),bn(this,Z),Mn(e,Ys,"Signature"),On(this,Q,t),On(this,$,n),On(this,Y,r),On(this,Z,null)}get r(){return wn(this,Q)}set r(e){In(32===Fn(e),"invalid r","value",e),On(this,Q,Wn(e))}get s(){return In(parseInt(wn(this,$).substring(0,3))<8,"non-canonical s; use ._s","s",wn(this,$)),wn(this,$)}set s(e){In(32===Fn(e),"invalid s","value",e),On(this,$,Wn(e))}get _s(){return wn(this,$)}isValid(){return parseInt(wn(this,$).substring(0,3))<8}get v(){return wn(this,Y)}set v(e){const t=or(e,"value");In(27===t||28===t,"invalid v","v",e),On(this,Y,t)}get networkV(){return wn(this,Z)}get legacyChainId(){const t=this.networkV;return null==t?null:e.getChainId(t)}get yParity(){return 27===this.v?0:1}get yParityAndS(){const e=Ln(this.s);return this.yParity&&(e[0]|=128),Wn(e)}get compactSerialized(){return Xn([this.r,this.yParityAndS])}get serialized(){return Xn([this.r,this.s,this.yParity?"0x1c":"0x1b"])}[Symbol.for("nodejs.util.inspect.custom")](){return`Signature { r: "${this.r}", s: "${this._s}"${this.isValid()?"":', valid: "false"'}, yParity: ${this.yParity}, networkV: ${this.networkV} }`}clone(){const t=new e(Ys,this.r,this._s,this.v);return this.networkV&&On(t,Z,this.networkV),t}toJSON(){const e=this.networkV;return{_type:"signature",networkV:null!=e?e.toString():null,r:this.r,s:this._s,v:this.v}}static getChainId(e){const t=tr(e,"v");return t==zs||t==Qs?Gs:(In(t>=$s,"invalid EIP-155 v","v",e),(t-$s)/Vs)}static getChainIdV(e,t){return tr(e)*Vs+BigInt(35+t-27)}static getNormalizedV(e){const t=tr(e);return t===Gs||t===zs?27:t===qs||t===Qs?28:(In(t>=$s,"invalid v","v",e),t&qs?27:28)}static from(t){function n(e,n){In(e,n,"signature",t)}if(null==t)return new e(Ys,Js,Js,27);if("string"==typeof t){const r=Ln(t,"signature");if(64===r.length){const t=Wn(r.slice(0,32)),n=r.slice(32,64),i=128&n[0]?28:27;return n[0]&=127,new e(Ys,t,Wn(n),i)}if(65===r.length){const t=Wn(r.slice(0,32)),n=Wn(r.slice(32,64)),i=e.getNormalizedV(r[64]);return new e(Ys,t,n,i)}n(!1,"invalid raw signature length")}if(t instanceof e)return t.clone();const r=t.r;n(null!=r,"missing r");const i=Zs(r),o=function(e,t){if(null!=e)return Zs(e);if(null!=t){n(Bn(t,32),"invalid yParityAndS");const e=Ln(t);return e[0]&=127,Wn(e)}n(!1,"missing s")}(t.s,t.yParityAndS),{networkV:s,v:a}=function(t,r,i){if(null!=t){const n=tr(t);return{networkV:n>=$s?n:void 0,v:e.getNormalizedV(n)}}if(null!=r)return n(Bn(r,32),"invalid yParityAndS"),{v:128&Ln(r)[0]?28:27};if(null!=i){switch(or(i,"sig.yParity")){case 0:return{v:27};case 1:return{v:28}}n(!1,"invalid yParity")}n(!1,"missing v")}(t.v,t.yParityAndS,t.yParity),c=new e(Ys,i,o,a);return s&&On(c,Z,s),n(null==t.yParity||or(t.yParity,"sig.yParity")===c.yParity,"yParity mismatch"),n(null==t.yParityAndS||t.yParityAndS===c.yParityAndS,"yParityAndS mismatch"),c}};ee=new WeakMap;let ta=class e{constructor(e){bn(this,ee),In(32===Fn(e),"invalid private key","privateKey","[REDACTED]"),On(this,ee,Wn(e))}get privateKey(){return wn(this,ee)}get publicKey(){return e.computePublicKey(wn(this,ee))}get compressedPublicKey(){return e.computePublicKey(wn(this,ee),!0)}sign(e){In(32===Fn(e),"invalid digest length","digest",e);const t=Xs.sign(Un(e),Un(wn(this,ee)),{lowS:!0});return ea.from({r:sr(t.r,32),s:sr(t.s,32),v:t.recovery?28:27})}computeSharedSecret(t){const n=e.computePublicKey(t);return Wn(Xs.getSharedSecret(Un(wn(this,ee)),Ln(n),!1))}static computePublicKey(e,t){let n=Ln(e,"key");if(32===n.length)return Wn(Xs.getPublicKey(n,!!t));if(64===n.length){const e=new Uint8Array(65);e[0]=4,e.set(n,1),n=e}return Wn(Xs.ProjectivePoint.fromHex(n).toRawBytes(t))}static recoverPublicKey(e,t){In(32===Fn(e),"invalid digest length","digest",e);const n=ea.from(t);let r=Xs.Signature.fromCompact(Un(Xn([n.r,n.s])));const i=(r=r.addRecoveryBit(n.yParity)).recoverPublicKey(Un(e));return In(null!=i,"invalid signature for digest","signature",t),"0x"+i.toHex(!1)}static addPoints(t,n,r){const i=Xs.ProjectivePoint.fromHex(e.computePublicKey(t).substring(2)),o=Xs.ProjectivePoint.fromHex(e.computePublicKey(n).substring(2));return"0x"+i.add(o).toHex(!!r)}};const na=BigInt(0),ra=BigInt(36);function ia(e){const t=(e=e.toLowerCase()).substring(2).split(""),n=new Uint8Array(40);for(let i=0;i<40;i++)n[i]=t[i].charCodeAt(0);const r=Ln(So(n));for(let i=0;i<40;i+=2)r[i>>1]>>4>=8&&(t[i]=t[i].toUpperCase()),(15&r[i>>1])>=8&&(t[i+1]=t[i+1].toUpperCase());return"0x"+t.join("")}const oa={};for(let KC=0;KC<10;KC++)oa[String(KC)]=String(KC);for(let KC=0;KC<26;KC++)oa[String.fromCharCode(65+KC)]=String(10+KC);const sa=15;function aa(e){let t=(e=(e=e.toUpperCase()).substring(4)+e.substring(0,2)+"00").split("").map(e=>oa[e]).join("");for(;t.length>=sa;){let e=t.substring(0,sa);t=parseInt(e,10)%97+t.substring(e.length)}let n=String(98-parseInt(t,10)%97);for(;n.length<2;)n="0"+n;return n}const ca=function(){const e={};for(let t=0;t<36;t++)e["0123456789abcdefghijklmnopqrstuvwxyz"[t]]=BigInt(t);return e}();function la(e){e=e.toLowerCase();let t=na;for(let n=0;n<e.length;n++)t=t*ra+ca[e[n]];return t}function ua(e){if(In("string"==typeof e,"invalid address","address",e),e.match(/^(0x)?[0-9a-fA-F]{40}$/)){e.startsWith("0x")||(e="0x"+e);const t=ia(e);return In(!e.match(/([A-F].*[a-f])|([a-f].*[A-F])/)||t===e,"bad address checksum","address",e),t}if(e.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){In(e.substring(2,4)===aa(e),"bad icap checksum","address",e);let t=la(e.substring(4)).toString(16);for(;t.length<40;)t="0"+t;return ia("0x"+t)}In(!1,"invalid address","address",e)}function ha(e){const t=ua(e.from);let n=tr(e.nonce,"tx.nonce").toString(16);return ua(Jn(So(ni([t,n="0"===n?"0x":n.length%2?"0x0"+n:"0x"+n])),12))}function da(e){return e&&"function"==typeof e.getAddress}async function fa(e,t){const n=await t;return(null==n||"0x0000000000000000000000000000000000000000"===n)&&(kn("string"!=typeof e,"unconfigured name","UNCONFIGURED_NAME",{value:e}),In(!1,"invalid AddressLike value; did not resolve to a value address","target",e)),ua(n)}function pa(e,t){return"string"==typeof e?e.match(/^0x[0-9a-f]{40}$/i)?ua(e):(kn(null!=t,"ENS resolution requires a provider","UNSUPPORTED_OPERATION",{operation:"resolveName"}),fa(e,t.resolveName(e))):da(e)?fa(e,e.getAddress()):e&&"function"==typeof e.then?fa(e,e):void In(!1,"unsupported addressable value","target",e)}const ga={};function ma(e,t){let n=!1;return t<0&&(n=!0,t*=-1),new wa(ga,`${n?"":"u"}int${t}`,e,{signed:n,width:t})}function ya(e,t){return new wa(ga,`bytes${t||""}`,e,{size:t})}const va=Symbol.for("_ethers_typed");te=new WeakMap;let wa=class e{constructor(e,t,n,r){yn(this,"type"),yn(this,"value"),bn(this,te),yn(this,"_typedSymbol"),null==r&&(r=null),Mn(ga,e,"Typed"),Rn(this,{_typedSymbol:va,type:t,value:n}),On(this,te,r),this.format()}format(){if("array"===this.type)throw new Error("");if("dynamicArray"===this.type)throw new Error("");return"tuple"===this.type?`tuple(${this.value.map(e=>e.format()).join(",")})`:this.type}defaultValue(){return 0}minValue(){return 0}maxValue(){return 0}isBigInt(){return!!this.type.match(/^u?int[0-9]+$/)}isData(){return this.type.startsWith("bytes")}isString(){return"string"===this.type}get tupleName(){if("tuple"!==this.type)throw TypeError("not a tuple");return wn(this,te)}get arrayLength(){if("array"!==this.type)throw TypeError("not an array");return!0===wn(this,te)?-1:!1===wn(this,te)?this.value.length:null}static from(t,n){return new e(ga,t,n)}static uint8(e){return ma(e,8)}static uint16(e){return ma(e,16)}static uint24(e){return ma(e,24)}static uint32(e){return ma(e,32)}static uint40(e){return ma(e,40)}static uint48(e){return ma(e,48)}static uint56(e){return ma(e,56)}static uint64(e){return ma(e,64)}static uint72(e){return ma(e,72)}static uint80(e){return ma(e,80)}static uint88(e){return ma(e,88)}static uint96(e){return ma(e,96)}static uint104(e){return ma(e,104)}static uint112(e){return ma(e,112)}static uint120(e){return ma(e,120)}static uint128(e){return ma(e,128)}static uint136(e){return ma(e,136)}static uint144(e){return ma(e,144)}static uint152(e){return ma(e,152)}static uint160(e){return ma(e,160)}static uint168(e){return ma(e,168)}static uint176(e){return ma(e,176)}static uint184(e){return ma(e,184)}static uint192(e){return ma(e,192)}static uint200(e){return ma(e,200)}static uint208(e){return ma(e,208)}static uint216(e){return ma(e,216)}static uint224(e){return ma(e,224)}static uint232(e){return ma(e,232)}static uint240(e){return ma(e,240)}static uint248(e){return ma(e,248)}static uint256(e){return ma(e,256)}static uint(e){return ma(e,256)}static int8(e){return ma(e,-8)}static int16(e){return ma(e,-16)}static int24(e){return ma(e,-24)}static int32(e){return ma(e,-32)}static int40(e){return ma(e,-40)}static int48(e){return ma(e,-48)}static int56(e){return ma(e,-56)}static int64(e){return ma(e,-64)}static int72(e){return ma(e,-72)}static int80(e){return ma(e,-80)}static int88(e){return ma(e,-88)}static int96(e){return ma(e,-96)}static int104(e){return ma(e,-104)}static int112(e){return ma(e,-112)}static int120(e){return ma(e,-120)}static int128(e){return ma(e,-128)}static int136(e){return ma(e,-136)}static int144(e){return ma(e,-144)}static int152(e){return ma(e,-152)}static int160(e){return ma(e,-160)}static int168(e){return ma(e,-168)}static int176(e){return ma(e,-176)}static int184(e){return ma(e,-184)}static int192(e){return ma(e,-192)}static int200(e){return ma(e,-200)}static int208(e){return ma(e,-208)}static int216(e){return ma(e,-216)}static int224(e){return ma(e,-224)}static int232(e){return ma(e,-232)}static int240(e){return ma(e,-240)}static int248(e){return ma(e,-248)}static int256(e){return ma(e,-256)}static int(e){return ma(e,-256)}static bytes1(e){return ya(e,1)}static bytes2(e){return ya(e,2)}static bytes3(e){return ya(e,3)}static bytes4(e){return ya(e,4)}static bytes5(e){return ya(e,5)}static bytes6(e){return ya(e,6)}static bytes7(e){return ya(e,7)}static bytes8(e){return ya(e,8)}static bytes9(e){return ya(e,9)}static bytes10(e){return ya(e,10)}static bytes11(e){return ya(e,11)}static bytes12(e){return ya(e,12)}static bytes13(e){return ya(e,13)}static bytes14(e){return ya(e,14)}static bytes15(e){return ya(e,15)}static bytes16(e){return ya(e,16)}static bytes17(e){return ya(e,17)}static bytes18(e){return ya(e,18)}static bytes19(e){return ya(e,19)}static bytes20(e){return ya(e,20)}static bytes21(e){return ya(e,21)}static bytes22(e){return ya(e,22)}static bytes23(e){return ya(e,23)}static bytes24(e){return ya(e,24)}static bytes25(e){return ya(e,25)}static bytes26(e){return ya(e,26)}static bytes27(e){return ya(e,27)}static bytes28(e){return ya(e,28)}static bytes29(e){return ya(e,29)}static bytes30(e){return ya(e,30)}static bytes31(e){return ya(e,31)}static bytes32(e){return ya(e,32)}static address(t){return new e(ga,"address",t)}static bool(t){return new e(ga,"bool",!!t)}static bytes(t){return new e(ga,"bytes",t)}static string(t){return new e(ga,"string",t)}static array(e,t){throw new Error("not implemented yet")}static tuple(e,t){throw new Error("not implemented yet")}static overrides(t){return new e(ga,"overrides",Object.assign({},t))}static isTyped(e){return e&&"object"==typeof e&&"_typedSymbol"in e&&e._typedSymbol===va}static dereference(t,n){if(e.isTyped(t)){if(t.type!==n)throw new Error(`invalid type: expecetd ${n}, got ${t.type}`);return t.value}return t}};class ba extends mi{constructor(e){super("address","address",e,!1)}defaultValue(){return"0x0000000000000000000000000000000000000000"}encode(e,t){let n=wa.dereference(t,"string");try{n=ua(n)}catch(r){return this._throwError(r.message,t)}return e.writeValue(n)}decode(e){return ua(sr(e.readValue(),20))}}class Oa extends mi{constructor(e){super(e.name,e.type,"_",e.dynamic),yn(this,"coder"),this.coder=e}defaultValue(){return this.coder.defaultValue()}encode(e,t){return this.coder.encode(e,t)}decode(e){return this.coder.decode(e)}}function Ea(e,t,n){let r=[];if(Array.isArray(n))r=n;else if(n&&"object"==typeof n){let e={};r=t.map(t=>{const r=t.localName;return kn(r,"cannot encode object for signature with missing names","INVALID_ARGUMENT",{argument:"values",info:{coder:t},value:n}),kn(!e[r],"cannot encode object for signature with duplicate names","INVALID_ARGUMENT",{argument:"values",info:{coder:t},value:n}),e[r]=!0,n[r]})}else In(!1,"invalid tuple value","tuple",n);In(t.length===r.length,"types/value length mismatch","tuple",n);let i=new yi,o=new yi,s=[];return t.forEach((e,t)=>{let n=r[t];if(e.dynamic){let t=o.length;e.encode(o,n);let r=i.writeUpdatableValue();s.push(e=>{r(e+t)})}else e.encode(i,n)}),s.forEach(e=>{e(i.length)}),e.appendWriter(i)+e.appendWriter(o)}function _a(e,t){let n=[],r=[],i=e.subReader(0);return t.forEach(t=>{let o=null;if(t.dynamic){let n=e.readIndex(),r=i.subReader(n);try{o=t.decode(r)}catch(s){if(Tn(s,"BUFFER_OVERRUN"))throw s;(o=s).baseType=t.name,o.name=t.localName,o.type=t.type}}else try{o=t.decode(e)}catch(a){if(Tn(a,"BUFFER_OVERRUN"))throw a;(o=a).baseType=t.name,o.name=t.localName,o.type=t.type}if(null==o)throw new Error("investigate");n.push(o),r.push(t.localName||null)}),pi.fromItems(n,r)}class Ca extends mi{constructor(e,t,n){super("array",e.type+"["+(t>=0?t:"")+"]",n,-1===t||e.dynamic),yn(this,"coder"),yn(this,"length"),Rn(this,{coder:e,length:t})}defaultValue(){const e=this.coder.defaultValue(),t=[];for(let n=0;n<this.length;n++)t.push(e);return t}encode(e,t){const n=wa.dereference(t,"array");Array.isArray(n)||this._throwError("expected array value",n);let r=this.length;-1===r&&(r=n.length,e.writeValue(n.length)),xn(n.length,r,"coder array"+(this.localName?" "+this.localName:""));let i=[];for(let o=0;o<n.length;o++)i.push(this.coder);return Ea(e,i,n)}decode(e){let t=this.length;-1===t&&kn((t=e.readIndex())*oi<=e.dataLength,"insufficient data length","BUFFER_OVERRUN",{buffer:e.bytes,offset:t*oi,length:e.dataLength});let n=[];for(let r=0;r<t;r++)n.push(new Oa(this.coder));return _a(e,n)}}class Na extends mi{constructor(e){super("bool","bool",e,!1)}defaultValue(){return!1}encode(e,t){const n=wa.dereference(t,"bool");return e.writeValue(n?1:0)}decode(e){return!!e.readValue()}}class Aa extends mi{constructor(e,t){super(e,e,t,!0)}defaultValue(){return"0x"}encode(e,t){return t=Un(t),e.writeValue(t.length)+e.writeBytes(t)}decode(e){return e.readBytes(e.readIndex(),!0)}}class Ra extends Aa{constructor(e){super("bytes",e)}decode(e){return Wn(super.decode(e))}}class Sa extends mi{constructor(e,t){let n="bytes"+String(e);super(n,n,t,!1),yn(this,"size"),Rn(this,{size:e},{size:"number"})}defaultValue(){return"0x0000000000000000000000000000000000000000000000000000000000000000".substring(0,2+2*this.size)}encode(e,t){let n=Un(wa.dereference(t,this.type));return n.length!==this.size&&this._throwError("incorrect data length",t),e.writeBytes(n)}decode(e){return Wn(e.readBytes(this.size))}}const Ta=new Uint8Array([]);class Pa extends mi{constructor(e){super("null","",e,!1)}defaultValue(){return null}encode(e,t){return null!=t&&this._throwError("not null",t),e.writeBytes(Ta)}decode(e){return e.readBytes(0),null}}const Da=BigInt(0),ka=BigInt(1),Ia=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");class xa extends mi{constructor(e,t,n){const r=(t?"int":"uint")+8*e;super(r,r,n,!1),yn(this,"size"),yn(this,"signed"),Rn(this,{size:e,signed:t},{size:"number",signed:"boolean"})}defaultValue(){return 0}encode(e,t){let n=tr(wa.dereference(t,this.type)),r=er(Ia,8*oi);if(this.signed){let e=er(r,8*this.size-1);(n>e||n<-(e+ka))&&this._throwError("value out-of-bounds",t),n=Zn(n,8*oi)}else(n<Da||n>er(r,8*this.size))&&this._throwError("value out-of-bounds",t);return e.writeValue(n)}decode(e){let t=er(e.readValue(),8*this.size);return this.signed&&(t=Yn(t,8*this.size)),t}}class Ma extends Aa{constructor(e){super("string",e)}defaultValue(){return""}encode(e,t){return super.encode(e,vr(wa.dereference(t,"string")))}decode(e){return br(super.decode(e))}}class Ka extends mi{constructor(e,t){let n=!1;const r=[];e.forEach(e=>{e.dynamic&&(n=!0),r.push(e.type)}),super("tuple","tuple("+r.join(",")+")",t,n),yn(this,"coders"),Rn(this,{coders:Object.freeze(e.slice())})}defaultValue(){const e=[];this.coders.forEach(t=>{e.push(t.defaultValue())});const t=this.coders.reduce((e,t)=>{const n=t.localName;return n&&(e[n]||(e[n]=0),e[n]++),e},{});return this.coders.forEach((n,r)=>{let i=n.localName;!i||1!==t[i]||("length"===i&&(i="_length"),null==e[i]&&(e[i]=e[r]))}),Object.freeze(e)}encode(e,t){const n=wa.dereference(t,"tuple");return Ea(e,this.coders,n)}decode(e){return _a(e,this.coders)}}function La(e,t){return{address:ua(e),storageKeys:t.map((e,t)=>(In(Bn(e,32),"invalid slot",`storageKeys[${t}]`,e),e.toLowerCase()))}}function Ua(e){if(Array.isArray(e))return e.map((t,n)=>Array.isArray(t)?(In(2===t.length,"invalid slot set",`value[${n}]`,t),La(t[0],t[1])):(In(null!=t&&"object"==typeof t,"invalid address-slot set","value",e),La(t.address,t.storageKeys)));In(null!=e&&"object"==typeof e,"invalid access list","value",e);const t=Object.keys(e).map(t=>{const n=e[t].reduce((e,t)=>(e[t]=!0,e),{});return La(t,Object.keys(n).sort())});return t.sort((e,t)=>e.address.localeCompare(t.address)),t}function Ba(e){return{address:ua(e.address),nonce:tr(null!=e.nonce?e.nonce:0),chainId:tr(null!=e.chainId?e.chainId:0),signature:ea.from(e.signature)}}function ja(e){let t;return ua(So("0x"+(t="string"==typeof e?ta.computePublicKey(e,!1):e.publicKey).substring(4)).substring(26))}const Ha=BigInt(0),Wa=BigInt(2),Xa=BigInt(27),Fa=BigInt(28),Ja=BigInt(35),Ga=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),qa=131072;function Va(e,t){let n=e.toString(16);for(;n.length<2;)n="0"+n;return"0x"+(n+ko(t).substring(4))}function za(e){return"0x"===e?null:ua(e)}function Qa(e,t){try{return Ua(e)}catch(n){In(!1,n.message,t,e)}}function $a(e,t){try{if(!Array.isArray(e))throw new Error("authorizationList: invalid array");const r=[];for(let t=0;t<e.length;t++){const n=e[t];if(!Array.isArray(n))throw new Error(`authorization[${t}]: invalid array`);if(6!==n.length)throw new Error(`authorization[${t}]: wrong length`);if(!n[1])throw new Error(`authorization[${t}]: null address`);r.push({address:za(n[1]),nonce:Za(n[2],"nonce"),chainId:Za(n[0],"chainId"),signature:ea.from({yParity:Ya(n[3],"yParity"),r:qn(n[4],32),s:qn(n[5],32)})})}return r}catch(n){In(!1,n.message,t,e)}}function Ya(e,t){return"0x"===e?0:or(e,t)}function Za(e,t){if("0x"===e)return Ha;const n=tr(e,t);return In(n<=Ga,"value exceeds uint size",t,n),n}function ec(e,t){const n=tr(e,"value"),r=ar(n);return In(r.length<=32,"value too large",`tx.${t}`,n),r}function tc(e){return Ua(e).map(e=>[e.address,e.storageKeys])}function nc(e){return e.map(e=>[ec(e.chainId,"chainId"),e.address,ec(e.nonce,"nonce"),ec(e.signature.yParity,"yParity"),ar(e.signature.r),ar(e.signature.s)])}function rc(e,t){In(Array.isArray(e),`invalid ${t}`,"value",e);for(let n=0;n<e.length;n++)In(Bn(e[n],32),"invalid ${ param } hash",`value[${n}]`,e[n]);return e}function ic(e){const t=Yr(e);In(Array.isArray(t)&&(9===t.length||6===t.length),"invalid field count for legacy transaction","data",e);const n={type:0,nonce:Ya(t[0],"nonce"),gasPrice:Za(t[1],"gasPrice"),gasLimit:Za(t[2],"gasLimit"),to:za(t[3]),value:Za(t[4],"value"),data:Wn(t[5]),chainId:Ha};if(6===t.length)return n;const r=Za(t[6],"v"),i=Za(t[7],"r"),o=Za(t[8],"s");if(i===Ha&&o===Ha)n.chainId=r;else{let e=(r-Ja)/Wa;e<Ha&&(e=Ha),n.chainId=e,In(e!==Ha||r===Xa||r===Fa,"non-canonical legacy v","v",t[6]),n.signature=ea.from({r:qn(t[7],32),s:qn(t[8],32),v:r})}return n}function oc(e,t){const n=[ec(e.nonce,"nonce"),ec(e.gasPrice||0,"gasPrice"),ec(e.gasLimit,"gasLimit"),e.to||"0x",ec(e.value,"value"),e.data];let r=Ha;if(e.chainId!=Ha)r=tr(e.chainId,"tx.chainId"),In(!t||null==t.networkV||t.legacyChainId===r,"tx.chainId/sig.v mismatch","sig",t);else if(e.signature){const t=e.signature.legacyChainId;null!=t&&(r=t)}if(!t)return r!==Ha&&(n.push(ar(r)),n.push("0x"),n.push("0x")),ni(n);let i=BigInt(27+t.yParity);return r!==Ha?i=ea.getChainIdV(r,t.v):BigInt(t.v)!==i&&In(!1,"tx.chainId/sig.v mismatch","sig",t),n.push(ar(i)),n.push(ar(t.r)),n.push(ar(t.s)),ni(n)}function sc(e,t){let n;try{if(0!==(n=Ya(t[0],"yParity"))&&1!==n)throw new Error("bad yParity")}catch{In(!1,"invalid yParity","yParity",t[0])}const r=qn(t[1],32),i=qn(t[2],32),o=ea.from({r:r,s:i,yParity:n});e.signature=o}function ac(e){const t=Yr(Ln(e).slice(1));In(Array.isArray(t)&&(9===t.length||12===t.length),"invalid field count for transaction type: 2","data",Wn(e));const n={type:2,chainId:Za(t[0],"chainId"),nonce:Ya(t[1],"nonce"),maxPriorityFeePerGas:Za(t[2],"maxPriorityFeePerGas"),maxFeePerGas:Za(t[3],"maxFeePerGas"),gasPrice:null,gasLimit:Za(t[4],"gasLimit"),to:za(t[5]),value:Za(t[6],"value"),data:Wn(t[7]),accessList:Qa(t[8],"accessList")};return 9===t.length||sc(n,t.slice(9)),n}function cc(e,t){const n=[ec(e.chainId,"chainId"),ec(e.nonce,"nonce"),ec(e.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),ec(e.maxFeePerGas||0,"maxFeePerGas"),ec(e.gasLimit,"gasLimit"),e.to||"0x",ec(e.value,"value"),e.data,tc(e.accessList||[])];return t&&(n.push(ec(t.yParity,"yParity")),n.push(ar(t.r)),n.push(ar(t.s))),Xn(["0x02",ni(n)])}function lc(e){const t=Yr(Ln(e).slice(1));In(Array.isArray(t)&&(8===t.length||11===t.length),"invalid field count for transaction type: 1","data",Wn(e));const n={type:1,chainId:Za(t[0],"chainId"),nonce:Ya(t[1],"nonce"),gasPrice:Za(t[2],"gasPrice"),gasLimit:Za(t[3],"gasLimit"),to:za(t[4]),value:Za(t[5],"value"),data:Wn(t[6]),accessList:Qa(t[7],"accessList")};return 8===t.length||sc(n,t.slice(8)),n}function uc(e,t){const n=[ec(e.chainId,"chainId"),ec(e.nonce,"nonce"),ec(e.gasPrice||0,"gasPrice"),ec(e.gasLimit,"gasLimit"),e.to||"0x",ec(e.value,"value"),e.data,tc(e.accessList||[])];return t&&(n.push(ec(t.yParity,"recoveryParam")),n.push(ar(t.r)),n.push(ar(t.s))),Xn(["0x01",ni(n)])}function hc(e){let t=Yr(Ln(e).slice(1)),n="3",r=null;if(4===t.length&&Array.isArray(t[0])){n="3 (network format)";const e=t[1],i=t[2],o=t[3];In(Array.isArray(e),"invalid network format: blobs not an array","fields[1]",e),In(Array.isArray(i),"invalid network format: commitments not an array","fields[2]",i),In(Array.isArray(o),"invalid network format: proofs not an array","fields[3]",o),In(e.length===i.length,"invalid network format: blobs/commitments length mismatch","fields",t),In(e.length===o.length,"invalid network format: blobs/proofs length mismatch","fields",t),r=[];for(let n=0;n<t[1].length;n++)r.push({data:e[n],commitment:i[n],proof:o[n]});t=t[0]}In(Array.isArray(t)&&(11===t.length||14===t.length),`invalid field count for transaction type: ${n}`,"data",Wn(e));const i={type:3,chainId:Za(t[0],"chainId"),nonce:Ya(t[1],"nonce"),maxPriorityFeePerGas:Za(t[2],"maxPriorityFeePerGas"),maxFeePerGas:Za(t[3],"maxFeePerGas"),gasPrice:null,gasLimit:Za(t[4],"gasLimit"),to:za(t[5]),value:Za(t[6],"value"),data:Wn(t[7]),accessList:Qa(t[8],"accessList"),maxFeePerBlobGas:Za(t[9],"maxFeePerBlobGas"),blobVersionedHashes:t[10]};r&&(i.blobs=r),In(null!=i.to,`invalid address for transaction type: ${n}`,"data",e),In(Array.isArray(i.blobVersionedHashes),"invalid blobVersionedHashes: must be an array","data",e);for(let o=0;o<i.blobVersionedHashes.length;o++)In(Bn(i.blobVersionedHashes[o],32),`invalid blobVersionedHash at index ${o}: must be length 32`,"data",e);return 11===t.length||sc(i,t.slice(11)),i}function dc(e,t,n){const r=[ec(e.chainId,"chainId"),ec(e.nonce,"nonce"),ec(e.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),ec(e.maxFeePerGas||0,"maxFeePerGas"),ec(e.gasLimit,"gasLimit"),e.to||Fs,ec(e.value,"value"),e.data,tc(e.accessList||[]),ec(e.maxFeePerBlobGas||0,"maxFeePerBlobGas"),rc(e.blobVersionedHashes||[],"blobVersionedHashes")];return t&&(r.push(ec(t.yParity,"yParity")),r.push(ar(t.r)),r.push(ar(t.s)),n)?Xn(["0x03",ni([r,n.map(e=>e.data),n.map(e=>e.commitment),n.map(e=>e.proof)])]):Xn(["0x03",ni(r)])}function fc(e){const t=Yr(Ln(e).slice(1));In(Array.isArray(t)&&(10===t.length||13===t.length),"invalid field count for transaction type: 4","data",Wn(e));const n={type:4,chainId:Za(t[0],"chainId"),nonce:Ya(t[1],"nonce"),maxPriorityFeePerGas:Za(t[2],"maxPriorityFeePerGas"),maxFeePerGas:Za(t[3],"maxFeePerGas"),gasPrice:null,gasLimit:Za(t[4],"gasLimit"),to:za(t[5]),value:Za(t[6],"value"),data:Wn(t[7]),accessList:Qa(t[8],"accessList"),authorizationList:$a(t[9],"authorizationList")};return 10===t.length||sc(n,t.slice(10)),n}function pc(e,t){const n=[ec(e.chainId,"chainId"),ec(e.nonce,"nonce"),ec(e.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),ec(e.maxFeePerGas||0,"maxFeePerGas"),ec(e.gasLimit,"gasLimit"),e.to||"0x",ec(e.value,"value"),e.data,tc(e.accessList||[]),nc(e.authorizationList||[])];return t&&(n.push(ec(t.yParity,"yParity")),n.push(ar(t.r)),n.push(ar(t.s))),Xn(["0x04",ni(n)])}ne=new WeakMap,re=new WeakMap,ie=new WeakMap,oe=new WeakMap,se=new WeakMap,ae=new WeakMap,ce=new WeakMap,le=new WeakMap,ue=new WeakMap,he=new WeakMap,de=new WeakMap,fe=new WeakMap,pe=new WeakMap,ge=new WeakMap,me=new WeakMap,ye=new WeakMap,ve=new WeakMap,we=new WeakSet,be=function(e,t){kn(!e||null!=this.signature,"cannot serialize unsigned transaction; maybe you meant .unsignedSerialized","UNSUPPORTED_OPERATION",{operation:".serialized"});const n=e?this.signature:null;switch(this.inferType()){case 0:return oc(this,n);case 1:return uc(this,n);case 2:return cc(this,n);case 3:return dc(this,n,t?this.blobs:null);case 4:return pc(this,n)}kn(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:".serialized"})};let gc=class e{constructor(){bn(this,we),bn(this,ne),bn(this,re),bn(this,ie),bn(this,oe),bn(this,se),bn(this,ae),bn(this,ce),bn(this,le),bn(this,ue),bn(this,he),bn(this,de),bn(this,fe),bn(this,pe),bn(this,ge),bn(this,me),bn(this,ye),bn(this,ve),On(this,ne,null),On(this,re,null),On(this,oe,0),On(this,se,Ha),On(this,ae,null),On(this,ce,null),On(this,le,null),On(this,ie,"0x"),On(this,ue,Ha),On(this,he,Ha),On(this,de,null),On(this,fe,null),On(this,pe,null),On(this,ge,null),On(this,me,null),On(this,ye,null),On(this,ve,null)}get type(){return wn(this,ne)}set type(e){switch(e){case null:On(this,ne,null);break;case 0:case"legacy":On(this,ne,0);break;case 1:case"berlin":case"eip-2930":On(this,ne,1);break;case 2:case"london":case"eip-1559":On(this,ne,2);break;case 3:case"cancun":case"eip-4844":On(this,ne,3);break;case 4:case"pectra":case"eip-7702":On(this,ne,4);break;default:In(!1,"unsupported transaction type","type",e)}}get typeName(){switch(this.type){case 0:return"legacy";case 1:return"eip-2930";case 2:return"eip-1559";case 3:return"eip-4844";case 4:return"eip-7702"}return null}get to(){const e=wn(this,re);return null==e&&3===this.type?Fs:e}set to(e){On(this,re,null==e?null:ua(e))}get nonce(){return wn(this,oe)}set nonce(e){On(this,oe,or(e,"value"))}get gasLimit(){return wn(this,se)}set gasLimit(e){On(this,se,tr(e))}get gasPrice(){const e=wn(this,ae);return null!=e||0!==this.type&&1!==this.type?e:Ha}set gasPrice(e){On(this,ae,null==e?null:tr(e,"gasPrice"))}get maxPriorityFeePerGas(){const e=wn(this,ce);return null==e?2===this.type||3===this.type?Ha:null:e}set maxPriorityFeePerGas(e){On(this,ce,null==e?null:tr(e,"maxPriorityFeePerGas"))}get maxFeePerGas(){const e=wn(this,le);return null==e?2===this.type||3===this.type?Ha:null:e}set maxFeePerGas(e){On(this,le,null==e?null:tr(e,"maxFeePerGas"))}get data(){return wn(this,ie)}set data(e){On(this,ie,Wn(e))}get value(){return wn(this,ue)}set value(e){On(this,ue,tr(e,"value"))}get chainId(){return wn(this,he)}set chainId(e){On(this,he,tr(e))}get signature(){return wn(this,de)||null}set signature(e){On(this,de,null==e?null:ea.from(e))}get accessList(){const e=wn(this,fe)||null;return null==e?1===this.type||2===this.type||3===this.type?[]:null:e}set accessList(e){On(this,fe,null==e?null:Ua(e))}get authorizationList(){const e=wn(this,ve)||null;return null==e&&4===this.type?[]:e}set authorizationList(e){On(this,ve,null==e?null:e.map(e=>Ba(e)))}get maxFeePerBlobGas(){const e=wn(this,pe);return null==e&&3===this.type?Ha:e}set maxFeePerBlobGas(e){On(this,pe,null==e?null:tr(e,"maxFeePerBlobGas"))}get blobVersionedHashes(){let e=wn(this,ge);return null==e&&3===this.type?[]:e}set blobVersionedHashes(e){if(null!=e){In(Array.isArray(e),"blobVersionedHashes must be an Array","value",e),e=e.slice();for(let t=0;t<e.length;t++)In(Bn(e[t],32),"invalid blobVersionedHash",`value[${t}]`,e[t])}On(this,ge,e)}get blobs(){return null==wn(this,ye)?null:wn(this,ye).map(e=>Object.assign({},e))}set blobs(e){if(null==e)return void On(this,ye,null);const t=[],n=[];for(let r=0;r<e.length;r++){const i=e[r];if(jn(i)){kn(wn(this,me),"adding a raw blob requires a KZG library","UNSUPPORTED_OPERATION",{operation:"set blobs()"});let e=Ln(i);if(In(e.length<=qa,"blob is too large",`blobs[${r}]`,i),e.length!==qa){const t=new Uint8Array(qa);t.set(e),e=t}const o=wn(this,me).blobToKzgCommitment(e),s=Wn(wn(this,me).computeBlobKzgProof(e,o));t.push({data:Wn(e),commitment:Wn(o),proof:s}),n.push(Va(1,o))}else{const e=Wn(i.commitment);t.push({data:Wn(i.data),commitment:e,proof:Wn(i.proof)}),n.push(Va(1,e))}}On(this,ye,t),On(this,ge,n)}get kzg(){return wn(this,me)}set kzg(e){var t;On(this,me,null==e?null:(t=e,{blobToKzgCommitment:e=>{if("computeBlobProof"in t){if("blobToKzgCommitment"in t&&"function"==typeof t.blobToKzgCommitment)return Ln(t.blobToKzgCommitment(Wn(e)))}else if("blobToKzgCommitment"in t&&"function"==typeof t.blobToKzgCommitment)return Ln(t.blobToKzgCommitment(e));if("blobToKZGCommitment"in t&&"function"==typeof t.blobToKZGCommitment)return Ln(t.blobToKZGCommitment(Wn(e)));In(!1,"unsupported KZG library","kzg",t)},computeBlobKzgProof:(e,n)=>"computeBlobProof"in t&&"function"==typeof t.computeBlobProof?Ln(t.computeBlobProof(Wn(e),Wn(n))):"computeBlobKzgProof"in t&&"function"==typeof t.computeBlobKzgProof?t.computeBlobKzgProof(e,n):"computeBlobKZGProof"in t&&"function"==typeof t.computeBlobKZGProof?Ln(t.computeBlobKZGProof(Wn(e),Wn(n))):void In(!1,"unsupported KZG library","kzg",t)}))}get hash(){return null==this.signature?null:So(En(this,we,be).call(this,!0,!1))}get unsignedHash(){return So(this.unsignedSerialized)}get from(){return null==this.signature?null:(e=this.unsignedHash,t=this.signature,ja(ta.recoverPublicKey(e,t)));var e,t}get fromPublicKey(){return null==this.signature?null:ta.recoverPublicKey(this.unsignedHash,this.signature)}isSigned(){return null!=this.signature}get serialized(){return En(this,we,be).call(this,!0,!0)}get unsignedSerialized(){return En(this,we,be).call(this,!1,!1)}inferType(){const e=this.inferTypes();return e.indexOf(2)>=0?2:e.pop()}inferTypes(){const e=null!=this.gasPrice,t=null!=this.maxFeePerGas||null!=this.maxPriorityFeePerGas,n=null!=this.accessList,r=null!=wn(this,pe)||wn(this,ge);null!=this.maxFeePerGas&&null!=this.maxPriorityFeePerGas&&kn(this.maxFeePerGas>=this.maxPriorityFeePerGas,"priorityFee cannot be more than maxFee","BAD_DATA",{value:this}),kn(!t||0!==this.type&&1!==this.type,"transaction type cannot have maxFeePerGas or maxPriorityFeePerGas","BAD_DATA",{value:this}),kn(0!==this.type||!n,"legacy transaction cannot have accessList","BAD_DATA",{value:this});const i=[];return null!=this.type?i.push(this.type):this.authorizationList&&this.authorizationList.length?i.push(4):t?i.push(2):e?(i.push(1),n||i.push(0)):n?(i.push(1),i.push(2)):(r&&this.to||(i.push(0),i.push(1),i.push(2)),i.push(3)),i.sort(),i}isLegacy(){return 0===this.type}isBerlin(){return 1===this.type}isLondon(){return 2===this.type}isCancun(){return 3===this.type}clone(){return e.from(this)}toJSON(){const e=e=>null==e?null:e.toString();return{type:this.type,to:this.to,data:this.data,nonce:this.nonce,gasLimit:e(this.gasLimit),gasPrice:e(this.gasPrice),maxPriorityFeePerGas:e(this.maxPriorityFeePerGas),maxFeePerGas:e(this.maxFeePerGas),value:e(this.value),chainId:e(this.chainId),sig:this.signature?this.signature.toJSON():null,accessList:this.accessList}}static from(t){if(null==t)return new e;if("string"==typeof t){const n=Ln(t);if(n[0]>=127)return e.from(ic(n));switch(n[0]){case 1:return e.from(lc(n));case 2:return e.from(ac(n));case 3:return e.from(hc(n));case 4:return e.from(fc(n))}kn(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:"from"})}const n=new e;return null!=t.type&&(n.type=t.type),null!=t.to&&(n.to=t.to),null!=t.nonce&&(n.nonce=t.nonce),null!=t.gasLimit&&(n.gasLimit=t.gasLimit),null!=t.gasPrice&&(n.gasPrice=t.gasPrice),null!=t.maxPriorityFeePerGas&&(n.maxPriorityFeePerGas=t.maxPriorityFeePerGas),null!=t.maxFeePerGas&&(n.maxFeePerGas=t.maxFeePerGas),null!=t.maxFeePerBlobGas&&(n.maxFeePerBlobGas=t.maxFeePerBlobGas),null!=t.data&&(n.data=t.data),null!=t.value&&(n.value=t.value),null!=t.chainId&&(n.chainId=t.chainId),null!=t.signature&&(n.signature=ea.from(t.signature)),null!=t.accessList&&(n.accessList=t.accessList),null!=t.authorizationList&&(n.authorizationList=t.authorizationList),null!=t.blobVersionedHashes&&(n.blobVersionedHashes=t.blobVersionedHashes),null!=t.kzg&&(n.kzg=t.kzg),null!=t.blobs&&(n.blobs=t.blobs),null!=t.hash&&(In(n.isSigned(),"unsigned transaction cannot define '.hash'","tx",t),In(n.hash===t.hash,"hash mismatch","tx",t)),null!=t.from&&(In(n.isSigned(),"unsigned transaction cannot define '.from'","tx",t),In(n.from.toLowerCase()===(t.from||"").toLowerCase(),"from mismatch","tx",t)),n}};function mc(e){return So(vr(e))}var yc="AEEUdwmgDS8BxQKKAP4BOgDjATAAngDUAIMAoABoAOAAagCOAEQAhABMAHIAOwA9ACsANgAmAGIAHgAuACgAJwAXAC0AGgAjAB8ALwAUACkAEgAeAAkAGwARABkAFgA5ACgALQArADcAFQApABAAHgAiABAAGgAeABMAGAUhBe8BFxREN8sF2wC5AK5HAW8ArQkDzQCuhzc3NzcBP68NEfMABQdHBuw5BV8FYAA9MzkI9r4ZBg7QyQAWA9CeOwLNCjcCjqkChuA/lm+RAsXTAoP6ASfnEQDytQFJAjWVCkeXAOsA6godAB/cwdAUE0WlBCN/AQUCQRjFD/MRBjHxDQSJbw0jBzUAswBxme+tnIcAYwabAysG8QAjAEMMmxcDqgPKQyDXCMMxA7kUQwD3NXOrAKmFIAAfBC0D3x4BJQDBGdUFAhEgVD8JnwmQJiNWYUzrg0oAGwAUAB0AFnNcACkAFgBP9h3gPfsDOWDKneY2ChglX1UDYD30ABsAFAAdABZzIGRAnwDD8wAjAEEMzRbDqgMB2sAFYwXqAtCnAsS4AwpUJKRtFHsadUz9AMMVbwLpABM1NJEX0ZkCgYMBEyMAxRVvAukAEzUBUFAtmUwSAy4DBTER33EftQHfSwB5MxJ/AjkWKQLzL8E/cwBB6QH9LQDPDtO9ASNriQC5DQANAwCK21EFI91zHwCoL9kBqQcHBwcHKzUDowBvAQohPvU3fAQgHwCyAc8CKQMA5zMSezr7ULgFmDp/LzVQBgEGAi8FYQVgt8AFcTtlQhpCWEmfe5tmZ6IAExsDzQ8t+X8rBKtTAltbAn0jsy8Bl6utPWMDTR8Ei2kRANkDBrNHNysDBzECQWUAcwFpJ3kAiyUhAJ0BUb8AL3EfAbfNAz81KUsFWwF3YQZtAm0A+VEfAzEJDQBRSQCzAQBlAHsAM70GD/v3IZWHBwARKQAxALsjTwHZAeMPEzmXgIHwABIAGQA8AEUAQDt3gdvIEGcQZAkGTRFMdEIVEwK0D64L7REdDNkq09PgADSxB/MDWwfzA1sDWwfzB/MDWwfzA1sDWwNbA1scEvAi28gQZw9QBHUFlgWTBN4IiyZREYkHMAjaVBV0JhxPA00BBCMtSSQ7mzMTJUpMFE0LCAQ2SmyvfUADTzGzVP2QqgPTMlc5dAkGHnkSqAAyD3skNb1OhnpPcagKU0+2tYdJak5vAsY6sEAACikJm2/Dd1YGRRAfJ6kQ+ww3AbkBPw3xS9wE9QY/BM0fgRkdD9GVoAipLeEM8SbnLqWAXiP5KocF8Uv4POELUVFsD10LaQnnOmeBUgMlAREijwrhDT0IcRD3Cs1vDekRSQc9A9lJngCpBwULFR05FbkmFGKwCw05ewb/GvoLkyazEy17AAXXGiUGUQEtGwMA0y7rhbRaNVwgT2MGBwspI8sUrFAkDSlAu3hMGh8HGSWtApVDdEqLUToelyH6PEENai4XUYAH+TwJGVMLhTyiRq9FEhHWPpE9TCJNTDAEOYMsMyePCdMPiQy9fHYBXQklCbUMdRM1ERs3yQg9Bx0xlygnGQglRplgngT7owP3E9UDDwVDCUUHFwO5HDETMhUtBRGBKNsC9zbZLrcCk1aEARsFzw8pH+MQVEfkDu0InwJpA4cl7wAxFSUAGyKfCEdnAGOP3FMJLs8Iy2pwI3gDaxTrZRF3B5UOWwerHDcVwxzlcMxeD4YMKKezCV8BeQmdAWME5wgNNV+MpCBFZ1eLXBifIGVBQ14AAjUMaRWjRMGHfAKPD28SHwE5AXcHPQ0FAnsR8RFvEJkI74YINbkz/DopBFMhhyAVCisDU2zSCysm/Qz8bQGnEmYDEDRBd/Jnr2C6KBgBBx0yyUFkIfULlk/RDKAaxRhGVDIZ6AfDA/ca9yfuQVsGAwOnBxc6UTPyBMELbQiPCUMATQ6nGwfbGG4KdYzUATWPAbudA1uVhwJzkwY7Bw8Aaw+LBX3pACECqwinAAkA0wNbAD0CsQehAB0AiUUBQQMrMwEl6QKTA5cINc8BmTMB9y0EH8cMGQD7O25OAsO1AoBuZqYF4VwCkgJNOQFRKQQJUktVA7N15QDfAE8GF+NLARmvTs8e50cB43MvAMsA/wAJOQcJRQHRAfdxALsBYws1Caa3uQFR7S0AhwAZbwHbAo0A4QA5AIP1AVcAUQVd/QXXAlNNARU1HC9bZQG/AyMBNwERAH0Gz5GpzQsjBHEH1wIQHxXlAu8yB7kFAyLjE9FCyQK94lkAMhoKPAqrCqpgX2Q3CjV2PVQAEh+sPss/UgVVO1c7XDtXO1w7VztcO1c7XDtXO1wDm8Pmw+YKcF9JYe8Mqg3YRMw6TRPfYFVgNhPMLbsUxRXSJVoZQRrAJwkl6FUNDwgt12Y0CDA0eRfAAEMpbINFY4oeNApPHOtTlVT8LR8AtUumM7MNsBsZREQFS3XxYi4WEgomAmSFAmJGX1GzAV83JAKh+wJonAJmDQKfiDgfDwJmPwJmKgRyBIMDfxcDfpY5Cjl7GzmGOicnAmwhAjI6OA4CbcsCbbLzjgM3a0kvAWsA4gDlAE4JB5wMkQECD8YAEbkCdzMCdqZDAnlPRwJ4viFg30WyRvcCfEMCeswCfQ0CfPRIBEiBZygALxlJXEpfGRtK0ALRBQLQ0EsrA4hTA4fqRMmRNgLypV0HAwOyS9JMMSkH001QTbMCi0MCitzFHwshR2sJuwKOOwKOYESbhQKO3QKOYHxRuFM5AQ5S2FSJApP/ApMQAO0AIFUiVbNV1AosHymZijLleGpFPz0Cl6MC77ZYJawAXSkClpMCloCgAK1ZsFoNhVEAPwKWuQKWUlxIXNUCmc8CmWhczl0LHQKcnznGOqECnBoCn58CnryOACETNS4TAp31Ap6WALlBYThh8wKe1wKgcgGtAp6jIwKeUqljzGQrKS8CJ7MCJoICoP8CoFDbAqYzAqXSAqgDAIECp/ZogGi1AAdNaiBq1QKs5wKssgKtawKtBgJXIQJV4AKx5dsDH1JsmwKywRECsuwbbORtZ21MYwMl0QK2YD9DbpQDKUkCuGICuUsZArkue3A6cOUCvR0DLbYDMhUCvoxyBgMzdQK+HnMmc1MCw88CwwhzhnRPOUl05AM8qwEDPJ4DPcMCxYACxksCxhSNAshtVQLISALJUwLJMgJkoQLd1nh9ZXiyeSlL1AMYp2cGAmH4GfeVKHsPXpZevxUCz28Cz3AzT1fW9xejAMqxAs93AS3uA04Wfk8JAtwrAtuOAtJTA1JgA1NjAQUDVZCAjUMEzxrxZEl5A4LSg5EC2ssC2eKEFIRNp0ADhqkAMwNkEoZ1Xf0AWQLfaQLevHd7AuIz7RgB8zQrAfSfAfLWiwLr9wLpdH0DAur9AuroAP1LAb0C7o0C66CWrpcHAu5DA4XkmH1w5HGlAvMHAG0DjhqZlwL3FwORcgOSiwL3nAL53QL4apogmq+/O5siA52HAv7+AR8APZ8gAZ+3AwWRA6ZuA6bdANXJAwZuoYyiCQ0DDE0BEwEjB3EGZb1rCQC/BG/DFY8etxEAG3k9ACcDNxJRA42DAWcrJQCM8wAlAOanC6OVCLsGI6fJBgCvBRnDBvElRUYFFoAFcD9GSDNCKUK8X3kZX8QAls0FOgCQVCGbwTsuYDoZutcONxjOGJHJ/gVfBWAFXwVgBWsFYAVfBWAFXwVgBV8FYAVfBWBOHQjfjW8KCgoKbF7xMwTRA7kGN8PDAMMEr8MA70gxFroFTj5xPnhCR0K+X30/X/AAWBkzswCNBsxzzASm70aCRS4rDDMeLz49fnXfcsH5GcoscQFz13Y4HwVnBXLJycnACNdRYwgICAqEXoWTxgA7P4kACxbZBu21Kw0AjMsTAwkVAOVtJUUsJ1JCuULESUArXy9gPi9AKwnJRQYKTD9LPoA+iT54PnkCkULEUUpDX9NWV3JVEjQAc1w3A3IBE3YnX+g7QiMJb6MKaiszRCUuQrNCxDPMCcwEX9EWJzYREBEEBwIHKn6l33JCNVIfybPJtAltydPUCmhBZw/tEKsZAJOVJU1CLRuxbUHOQAo7P0s+eEJHHA8SJVRPdGM0NVrpvBoKhfUlM0JHHGUQUhEWO1xLSj8MO0ucNAqJIzVCRxv9EFsqKyA4OQgNj2nwZgp5ZNFgE2A1K3YHS2AhQQojJmC7DgpzGG1WYFUZCQYHZO9gHWCdYIVgu2BTYJlwFh8GvRbcXbG8YgtDHrMBwzPVyQonHQgkCyYBgQJ0Ajc4nVqIAwGSCsBPIgDsK3SWEtIVBa5N8gGjAo+kVwVIZwD/AEUSCDweX4ITrRQsJ8K3TwBXFDwEAB0TvzVcAtoTS20RIwDgVgZ9BBImYgA5AL4Coi8LFnezOkCnIQFjAY4KBAPh9RcGsgZSBsEAJctdsWIRu2kTkQstRw7DAcMBKgpPBGIGMDAwKCYnKTQaLg4AKRSVAFwCdl+YUZ0JdicFD3lPAdt1F9ZZKCGxuE3yBxkFVGcA/wBFEgiCBwAOLHQSjxOtQDg1z7deFRMAZ8QTAGtKb1ApIiPHADkAvgKiLy1DFtYCmBiDAlDDWNB0eo7fpaMO/aEVRRv0ATEQZBIODyMEAc8JQhCbDRgzFD4TAEMAu9YBCgCsAOkAm5I3ABwAYxvONnR+MhXJAxgKQyxL2+kkJhMbhQKDBMkSsvF0AD9BNQ6uQC7WqSQHwxEAEEIu1hkhAH2z4iQPwyJPHNWpdyYBRSpnJALzoBAEVPPsH20MxA0CCEQKRgAFyAtFAlMNwwjEDUQJRArELtapMg7DDZgJIw+TGukEIwvDFkMAqAtDEMMMBhioe+QAO3MMRAACrgnEBSPY9Q0FDnbSBoMAB8MSYxkSxAEJAPIJAAB8FWMOFtMc/HcXwxhDAC7DAvOowwAewwJdKDKHAAHDAALrFUQVwwAbwyvzpWMWv8wA/ABpAy++bcYDUKPD0KhDCwKmJ1MAAmMA5+UZwxAagwipBRL/eADfw6fDGOMCGsOjk3l6BwOpo4sAEsMOGxMAA5sAbcMOAAvDp0MJGkMDwgipnNIPAwfIqUMGAOGDAAPzABXDAAcDAAnDAGmTABrDAA7DChjDjnEWAwABYwAOcwAuUyYABsMAF8MIKQANUgC6wy4AA8MADqMq8wCyYgAcIwAB8wqpAAXOCx0V4wAHowBCwwEKAGnDAAuDAB3DAAjDCakABdIAbqcZ3QCZCCkABdIAAAFDAAfjAB2jCCkABqIACYMAGzMAbSMA5sOIAAhjAAhDABTDBAkpAAbSAOOTAAlDC6kOzPtnAAdDAG6kQFAATwAKwwwAA0MACbUDPwAHIwAZgwACE6cDAAojAApDAAoDp/MGwwAJIwADEwAQQwgAFEMAEXMAD5MADfMADcMAGRMOFiMAFUMAbqMWuwHDAMIAE0MLAGkzEgDhUwACQwAEWgAXgwUjAAbYABjDBSYBgzBaAEFNALcQBxUMegAwMngBrA0IZgJ0KxQHBREPd1N0ZzKRJwaIHAZqNT4DqQq8BwngAB4DAwt2AX56T1ocKQNXAh1GATQGC3tOxYNagkgAMQA5CQADAQEAWxLjAIOYNAEzAH7tFRk6TglSAF8NAAlYAQ+S1ACAQwQorQBiAN4dAJ1wPyeTANVzuQDX3AIeEMp9eyMgXiUAEdkBkJizKltbVVAaRMqRAAEAhyQ/SDEz6BmfVwB6ATEsOClKIRcDOF0E/832AFNt5AByAnkCRxGCOs94NjXdAwINGBonDBwPALW2AwICAgAAAAAAAAYDBQMDARrUAwAtAAAAAgEGBgYGBgYFBQUFBQUEBQYHCAkEBQUFBQQAAAICAAAAIgCNAJAAlT0A6gC7ANwApEQAwgCyAK0AqADuAKYA2gCjAOcBCAEDAMcAgQBiANIA1AEDAN4A8gCQAKkBMQDqAN8A3AsBCQ8yO9ra2tq8xuLT1tRJOB0BUgFcNU0BWgFpAWgBWwFMUUlLbhMBUxsNEAs6PhMOACcUKy0vMj5AQENDQ0RFFEYGJFdXV1dZWVhZL1pbXVxcI2NnZ2ZoZypsbnZ1eHh4eHh4enp6enp6enp6enp8fH18e2IARPIASQCaAHgAMgBm+ACOAFcAVwA3AnbvAIsABfj4AGQAk/IAnwBPAGIAZP//sACFAIUAaQBWALEAJAC2AIMCQAJDAPwA5wD+AP4A6AD/AOkA6QDoAOYALwJ7AVEBQAE+AVQBPgE+AT4BOQE4ATgBOAEcAVgXADEQCAEAUx8SHgsdHhYAjgCWAKYAUQBqIAIxAHYAbwCXAxUDJzIDIUlGTzEAkQJPAMcCVwKkAMAClgKWApYClgKWApYCiwKWApYClgKWApYClgKVApUCmAKgApcClgKWApQClAKUApQCkgKVAnUB1AKXAp8ClgKWApUeAIETBQD+DQOfAmECOh8BVBg9AuIZEjMbAU4/G1WZAXusRAFpYQEFA0FPAQYAmTEeIJdyADFoAHEANgCRA5zMk/C2jGINwjMWygIZCaXdfDILBCs5dAE7YnQBugDlhoiHhoiGiYqKhouOjIaNkI6Ij4qQipGGkoaThpSSlYaWhpeKmIaZhpqGm4aci52QnoqfhuIC4XTpAt90AIp0LHSoAIsAdHQEQwRABEIERQRDBEkERgRBBEcESQRIBEQERgRJAJ5udACrA490ALxuAQ10ANFZdHQA13QCFHQA/mJ0AP4BIQD+APwA/AD9APwDhGZ03ASMK23HAP4A/AD8AP0A/CR0dACRYnQA/gCRASEA/gCRAvQA/gCRA4RmdNwEjCttxyR0AP9idAEhAP4A/gD8APwA/QD8AP8A/AD8AP0A/AOEZnTcBIwrbcckdHQAkWJ0ASEA/gCRAP4AkQL0AP4AkQOEZnTcBIwrbcckdAJLAT50AlIBQXQCU8l0dAJfdHQDpgL0A6YDpgOnA6cDpwOnA4RmdNwEjCttxyR0dACRYnQBIQOmAJEDpgCRAvQDpgCRA4RmdNwEjCttxyR0BDh0AJEEOQCRDpU5dSgCADR03gV2CwArdAEFAM5iCnR0AF1iAAYcOgp0dACRCnQAXAEIwWZ0CnRmdHQAkWZ0CnRmdEXgAFF03gp0dEY0tlT2u3SOAQTwscwhjZZKrhYcBSfFp9XNbKiVDOD2b+cpe4/Z17mQnbtzzhaeQtE2GGj0IDNTjRUSyTxxw/RPHW/+vS7d1NfRt9z9QPZg4X7QFfhCnkvgNPIItOsC2eV6hPannZNHlZ9xrwZXIMOlu3jSoQSq78WEjwLjw1ELSlF1aBvfzwk5ZX7AUvQzjPQKbDuQ+sm4wNOp4A6AdVuRS0t1y/DZpg4R6m7FNjM9HgvW7Bi88zaMjOo6lM8wtBBdj8LP4ylv3zCXPhebMKJc066o9sF71oFW/8JXu86HJbwDID5lzw5GWLR/LhT0Qqnp2JQxNZNfcbLIzPy+YypqRm/lBmGmex+82+PisxUumSeJkALIT6rJezxMH+CTJmQtt5uwTVbL3ptmjDUQzlSIvWi8Tl7ng1NpuRn1Ng4n14Qc+3Iil7OwkvNWogLSPkn3pihIFytyIGmMhOe3n1tWsuMy9BdKyqF4Z3v2SgggTL9KVvMXPnCbRe+oOuFFP3HejBG/w9gvmfNYvg6JuWia2lcSSN1uIjBktzoIazOHPJZ7kKHPz8mRWVdW3lA8WGF9dQF6Bm673boov3BUWDU2JNcahR23GtfHKLOz/viZ+rYnZFaIznXO67CYEJ1fXuTRpZhYZkKe54xeoagkNGLs+NTZHE0rX45/XvQ2RGADX6vcAvdxIUBV27wxGm2zjZo4X3ILgAlrOFheuZ6wtsvaIj4yLY7qqawlliaIcrz2G+c3vscAnCkCuMzMmZvMfu9lLwTvfX+3cVSyPdN9ZwgDZhfjRgNJcLiJ67b9xx8JHswprbiE3v9UphotAPIgnXVIN5KmMc0piXhc6cChPnN+MRhG9adtdttQTTwSIpl8I4/j//d3sz1326qTBTpPRM/Hgh3kzqEXs8ZAk4ErQhNO8hzrQ0DLkWMA/N+91tn2MdOJnWC2FCZehkQrwzwbKOjhvZsbM95QoeL9skYyMf4srVPVJSgg7pOLUtr/n9eT99oe9nLtFRpjA9okV2Kj8h9k5HaC0oivRD8VyXkJ81tcd4fHNXPCfloIQasxsuO18/46dR2jgul/UIet2G0kRvnyONMKhHs6J26FEoqSqd+rfYjeEGwHWVDpX1fh1jBBcKGMqRepju9Y00mDVHC+Xdij/j44rKfvfjGinNs1jO/0F3jB83XCDINN/HB84axlP+3E/klktRo+vl3U/aiyMJbIodE1XSsDn6UAzIoMtUObY2+k/4gY/l+AkZJ5Sj2vQrkyLm3FoxjhDX+31UXBFf9XrAH31fFqoBmDEZvhvvpnZ87N+oZEu7U9O/nnk+QWj3x8uyoRbEnf+O5UMr9i0nHP38IF5AvzrBW8YWBUR0mIAzIvndQq9N3v/Jto3aPjPXUPl8ASdPPyAp7jENf8bk7VMM9ol9XGmlBmeDMuGqt+WzuL6CXAxXjIhCPM5vACchgMJ/8XBGLO/D1isVvGhwwHHr1DLaI5mn2Jr/b1pUD90uciDaS8cXNDzCWvNmT/PhQe5e8nTnnnkt8Ds/SIjibcum/fqDhKopxAY8AkSrPn+IGDEKOO+U3XOP6djFs2H5N9+orhOahiQk5KnEUWa+CzkVzhp8bMHRbg81qhjjXuIKbHjSLSIBKWqockGtKinY+z4/RdBUF6pcc3JmnlxVcNgrI4SEzKUZSwcD2QCyxzKve+gAmg6ZuSRkpPFa6mfThu7LJNu3H5K42uCpNvPAsoedolKV/LHe/eJ+BbaG5MG0NaSGVPRUmNFMFFSSpXEcXwbVh7UETOZZtoVNRGOIbbkig3McEtR68cG0RZAoJevWYo7Dg/lZ1CQzblWeUvVHmr8fY4Nqd9JJiH/zEX24mJviH60fAyFr0A3c4bC1j3yZU60VgJxXn8JgJXLUIsiBnmKmMYz+7yBQFBvqb2eYnuW59joZBf56/wXvWIR4R8wTmV80i1mZy+S4+BUES+hzjk0uXpC///z/IlqHZ1monzlXp8aCfhGKMti73FI1KbL1q6IKO4fuBuZ59gagjn5xU79muMpHXg6S+e+gDM/U9BKLHbl9l6o8czQKl4RUkJJiqftQG2i3BMg/TQlUYFkJDYBOOvAugYuzYSDnZbDDd/aSd9x0Oe6F+bJcHfl9+gp6L5/TgA+BdFFovbfCrQ40s5vMPw8866pNX8zyFGeFWdxIpPVp9Rg1UPOVFbFZrvaFq/YAzHQgqMWpahMYfqHpmwXfHL1/kpYmGuHFwT55mQu0dylfNuq2Oq0hTMCPwqfxnuBIPLXfci4Y1ANy+1CUipQxld/izVh16WyG2Q0CQQ9NqtAnx1HCHwDj7sYxOSB0wopZSnOzxQOcExmxrVTF2BkOthVpGfuhaGECfCJpJKpjnihY+xOT2QJxN61+9K6QSqtv2Shr82I3jgJrqBg0wELFZPjvHpvzTtaJnLK6Vb97Yn933koO/saN7fsjwNKzp4l2lJVx2orjCGzC/4ZL4zCver6aQYtC5sdoychuFE6ufOiog+VWi5UDkbmvmtah/3aArEBIi39s5ILUnlFLgilcGuz9CQshEY7fw2ouoILAYPVT/gyAIq3TFAIwVsl+ktkRz/qGfnCDGrm5gsl/l9QdvCWGsjPz3dU7XuqKfdUrr/6XIgjp4rey6AJBmCmUJMjITHVdFb5m1p+dLMCL8t55zD42cmftmLEJC0Da04YiRCVUBLLa8D071/N5UBNBXDh0LFsmhV/5B5ExOB4j3WVG/S3lfK5o+V6ELHvy6RR9n4ac+VsK4VE4yphPvV+kG9FegTBH4ZRXL2HytUHCduJazB/KykjfetYxOXTLws267aGOd+I+JhKP//+VnXmS90OD/jvLcVu0asyqcuYN1mSb6XTlCkqv1vigZPIYwNF/zpWcT1GR/6aEIRjkh0yhg4LXJfaGobYJTY4JI58KiAKgmmgAKWdl5nYCeLqavRJGQNuYuZtZFGx+IkI4w4NS2xwbetNMunOjBu/hmKCI/w7tfiiyUd//4rbTeWt4izBY8YvGIN6vyKYmP/8X8wHKCeN+WRcKM70+tXKNGyevU9H2Dg5BsljnTf8YbsJ1TmMs74Ce2XlHisleguhyeg44rQOHZuw/6HTkhnnurK2d62q6yS7210SsAIaR+jXMQA+svkrLpsUY+F30Uw89uOdGAR6vo4FIME0EfVVeHTu6eKicfhSqOeXJhbftcd08sWEnNUL1C9fnprTgd83IMut8onVUF0hvqzZfHduPjbjwEXIcoYmy+P6tcJZHmeOv6VrvEdkHDJecjHuHeWANe79VG662qTjA/HCvumVv3qL+LrOcpqGps2ZGwQdFJ7PU4iuyRlBrwfO+xnPyr47s2cXVbWzAyznDiBGjCM3ksxjjqM62GE9C8f5U38kB3VjtabKp/nRdvMESPGDG90bWRLAt1Qk5DyLuazRR1YzdC1c+hZXvAWV8xA72S4A8B67vjVhbba3MMop293FeEXpe7zItMWrJG/LOH9ByOXmYnNJfjmfuX9KbrpgLOba4nZ+fl8Gbdv/ihv+6wFGKHCYrVwmhFC0J3V2bn2tIB1wCc1CST3d3X2OyxhguXcs4sm679UngzofuSeBewMFJboIQHbUh/m2JhW2hG9DIvG2t7yZIzKBTz9wBtnNC+2pCRYhSIuQ1j8xsz5VvqnyUIthvuoyyu7fNIrg/KQUVmGQaqkqZk/Vx5b33/gsEs8yX7SC1J+NV4icz6bvIE7C5G6McBaI8rVg56q5QBJWxn/87Q1sPK4+sQa8fLU5gXo4paaq4cOcQ4wR0VBHPGjKh+UlPCbA1nLXyEUX45qZ8J7/Ln4FPJE2TdzD0Z8MLSNQiykMMmSyOCiFfy84Rq60emYB2vD09KjYwsoIpeDcBDTElBbXxND72yhd9pC/1CMid/5HUMvAL27OtcIJDzNKpRPNqPOpyt2aPGz9QWIs9hQ9LiX5s8m9hjTUu/f7MyIatjjd+tSfQ3ufZxPpmJhTaBtZtKLUcfOCUqADuO+QoH8B9v6U+P0HV1GLQmtoNFTb3s74ivZgjES0qfK+8RdGgBbcCMSy8eBvh98+et1KIFqSe1KQPyXULBMTsIYnysIwiZBJYdI20vseV+wuJkcqGemehKjaAb9L57xZm3g2zX0bZ2xk/fU+bCo7TlnbW7JuF1YdURo/2Gw7VclDG1W7LOtas2LX4upifZ/23rzpsnY/ALfRgrcWP5hYmV9VxVOQA1fZvp9F2UNU+7d7xRyVm5wiLp3/0dlV7vdw1PMiZrbDAYzIVqEjRY2YU03sJhPnlwIPcZUG5ltL6S8XCxU1eYS5cjr34veBmXAvy7yN4ZjArIG0dfD/5UpBNlX1ZPoxJOwyqRi3wQWtOzd4oNKh0LkoTm8cwqgIfKhqqGOhwo71I+zXnMemTv2B2AUzABWyFztGgGULjDDzWYwJUVBTjKCn5K2QGMK1CQT7SzziOjo+BhAmqBjzuc3xYym2eedGeOIRJVyTwDw37iCMe4g5Vbnsb5ZBdxOAnMT7HU4DHpxWGuQ7GeiY30Cpbvzss55+5Km1YsbD5ea3NI9QNYIXol5apgSu9dZ8f8xS5dtHpido5BclDuLWY4lhik0tbJa07yJhH0BOyEut/GRbYTS6RfiTYWGMCkNpfSHi7HvdiTglEVHKZXaVhezH4kkXiIvKopYAlPusftpE4a5IZwvw1x/eLvoDIh/zpo9FiQInsTb2SAkKHV42XYBjpJDg4374XiVb3ws4qM0s9eSQ5HzsMU4OZJKuopFjBM+dAZEl8RUMx5uU2N486Kr141tVsGQfGjORYMCJAMsxELeNT4RmWjRcpdTGBwcx6XN9drWqPmJzcrGrH4+DRc7+n1w3kPZwu0BkNr6hQrqgo7JTB9A5kdJ/H7P4cWBMwsmuixAzJB3yrQpnGIq90lxAXLzDCdn1LPibsRt7rHNjgQBklRgPZ8vTbjXdgXrTWQsK5MdrXXQVPp0Rinq3frzZKJ0qD6Qhc40VzAraUXlob1gvkhK3vpmHgI6FRlQZNx6eRqkp0zy4AQlX813fAPtL3jMRaitGFFjo0zmErloC+h+YYdVQ6k4F/epxAoF0BmqEoKNTt6j4vQZNQ2BoqF9Vj53TOIoNmDiu9Xp15RkIgQIGcoLpfoIbenzpGUAtqFJp5W+LLnx38jHeECTJ/navKY1NWfN0sY1T8/pB8kIH3DU3DX+u6W3YwpypBMYOhbSxGjq84RZ84fWJow8pyHqn4S/9J15EcCMsXqrfwyd9mhiu3+rEo9pPpoJkdZqHjra4NvzFwuThNKy6hao/SlLw3ZADUcUp3w3SRVfW2rhl80zOgTYnKE0Hs2qp1J6H3xqPqIkvUDRMFDYyRbsFI3M9MEyovPk8rlw7/0a81cDVLmBsR2ze2pBuKb23fbeZC0uXoIvDppfTwIDxk1Oq2dGesGc+oJXWJLGkOha3CX+DUnzgAp9HGH9RsPZN63Hn4RMA5eSVhPHO+9RcRb/IOgtW31V1Q5IPGtoxPjC+MEJbVlIMYADd9aHYWUIQKopuPOHmoqSkubnAKnzgKHqgIOfW5RdAgotN6BN+O2ZYHkuemLnvQ8U9THVrS1RtLmKbcC7PeeDsYznvqzeg6VCNwmr0Yyx1wnLjyT84BZz3EJyCptD3yeueAyDWIs0L2qs/VQ3HUyqfrja0V1LdDzqAikeWuV4sc7RLIB69jEIBjCkyZedoUHqCrOvShVzyd73OdrJW0hPOuQv2qOoHDc9xVb6Yu6uq3Xqp2ZaH46A7lzevbxQEmfrzvAYSJuZ4WDk1Hz3QX1LVdiUK0EvlAGAYlG3Md30r7dcPN63yqBCIj25prpvZP0nI4+EgWoFG95V596CurXpKRBGRjQlHCvy5Ib/iW8nZJWwrET3mgd6mEhfP4KCuaLjopWs7h+MdXFdIv8dHQJgg1xi1eYqB0uDYjxwVmri0Sv5XKut/onqapC+FQiC2C1lvYJ9MVco6yDYsS3AANUfMtvtbYI2hfwZatiSsnoUeMZd34GVjkMMKA+XnjJpXgRW2SHTZplVowPmJsvXy6w3cfO1AK2dvtZEKTkC/TY9LFiKHCG0DnrMQdGm2lzlBHM9iEYynH2UcVMhUEjsc0oDBTgo2ZSQ1gzkAHeWeBXYFjYLuuf8yzTCy7/RFR81WDjXMbq2BOH5dURnxo6oivmxL3cKzKInlZkD31nvpHB9Kk7GfcfE1t+1V64b9LtgeJGlpRFxQCAqWJ5DoY77ski8gsOEOr2uywZaoO/NGa0X0y1pNQHBi3b2SUGNpcZxDT7rLbBf1FSnQ8guxGW3W+36BW0gBje4DOz6Ba6SVk0xiKgt+q2JOFyr4SYfnu+Ic1QZYIuwHBrgzr6UvOcSCzPTOo7D6IC4ISeS7zkl4h+2VoeHpnG/uWR3+ysNgPcOIXQbv0n4mr3BwQcdKJxgPSeyuP/z1Jjg4e9nUvoXegqQVIE30EHx5GHv+FAVUNTowYDJgyFhf5IvlYmEqRif6+WN1MkEJmDcQITx9FX23a4mxy1AQRsOHO/+eImX9l8EMJI3oPWzVXxSOeHU1dUWYr2uAA7AMb+vAEZSbU3qob9ibCyXeypEMpZ6863o6QPqlqGHZkuWABSTVNd4cOh9hv3qEpSx2Zy/DJMP6cItEmiBJ5PFqQnDEIt3NrA3COlOSgz43D7gpNFNJ5MBh4oFzhDPiglC2ypsNU4ISywY2erkyb1NC3Qh/IfWj0eDgZI4/ln8WPfBsT3meTjq1Uqt1E7Zl/qftqkx6aM9KueMCekSnMrcHj1CqTWWzEzPsZGcDe3Ue4Ws+XFYVxNbOFF8ezkvQGR6ZOtOLU2lQEnMBStx47vE6Pb7AYMBRj2OOfZXfisjJnpTfSNjo6sZ6qSvNxZNmDeS7Gk3yYyCk1HtKN2UnhMIjOXUzAqDv90lx9O/q/AT1ZMnit5XQe9wmQxnE/WSH0CqZ9/2Hy+Sfmpeg8RwsHI5Z8kC8H293m/LHVVM/BA7HaTJYg5Enk7M/xWpq0192ACfBai2LA/qrCjCr6Dh1BIMzMXINBmX96MJ5Hn2nxln/RXPFhwHxUmSV0EV2V0jm86/dxxuYSU1W7sVkEbN9EzkG0QFwPhyHKyb3t+Fj5WoUUTErcazE/N6EW6Lvp0d//SDPj7EV9UdJN+Amnf3Wwk3A0SlJ9Z00yvXZ7n3z70G47Hfsow8Wq1JXcfwnA+Yxa5mFsgV464KKP4T31wqIgzFPd3eCe3j5ory5fBF2hgCFyVFrLzI9eetNXvM7oQqyFgDo4CTp/hDV9NMX9JDHQ/nyHTLvZLNLF6ftn2OxjGm8+PqOwhxnPHWipkE/8wbtyri80Sr7pMNkQGMfo4ZYK9OcCC4ESVFFbLMIvlxSoRqWie0wxqnLfcLSXMSpMMQEJYDVObYsXIQNv4TGNwjq1kvT1UOkicTrG3IaBZ3XdScS3u8sgeZPVpOLkbiF940FjbCeNRINNvDbd01EPBrTCPpm12m43ze1bBB59Ia6Ovhnur/Nvx3IxwSWol+3H2qfCJR8df6aQf4v6WiONxkK+IqT4pKQrZK/LplgDI/PJZbOep8dtbV7oCr6CgfpWa8NczOkPx81iSHbsNhVSJBOtrLIMrL31LK9TqHqAbAHe0RLmmV806kRLDLNEhUEJfm9u0sxpkL93Zgd6rw+tqBfTMi59xqXHLXSHwSbSBl0EK0+loECOPtrl+/nsaFe197di4yUgoe4jKoAJDXc6DGDjrQOoFDWZJ9HXwt8xDrQP+7aRwWKWI1GF8s8O4KzxWBBcwnl3vnl1Oez3oh6Ea1vjR7/z7DDTrFtqU2W/KAEzAuXDNZ7MY73MF216dzdSbWmUp4lcm7keJfWaMHgut9x5C9mj66Z0lJ+yhsjVvyiWrfk1lzPOTdhG15Y7gQlXtacvI7qv/XNSscDwqkgwHT/gUsD5yB7LdRRvJxQGYINn9hTpodKFVSTPrtGvyQw+HlRFXIkodErAGu9Iy1YpfSPc3jkFh5CX3lPxv7aqjE/JAfTIpEjGb/H7MO0e2vsViSW1qa/Lmi4/n4DEI3g7lYrcanspDfEpKkdV1OjSLOy0BCUqVoECaB55vs06rXl4jqmLsPsFM/7vYJ0vrBhDCm/00A/H81l1uekJ/6Lml3Hb9+NKiLqATJmDpyzfYZFHumEjC662L0Bwkxi7E9U4cQA0XMVDuMYAIeLMPgQaMVOd8fmt5SflFIfuBoszeAw7ow5gXPE2Y/yBc/7jExARUf/BxIHQBF5Sn3i61w4z5xJdCyO1F1X3+3ax+JSvMeZ7S6QSKp1Fp/sjYz6Z+VgCZzibGeEoujryfMulH7Rai5kAft9ebcW50DyJr2uo2z97mTWIu45YsSnNSMrrNUuG1XsYBtD9TDYzQffKB87vWbkM4EbPAFgoBV4GQS+vtFDUqOFAoi1nTtmIOvg38N4hT2Sn8r8clmBCXspBlMBYTnrqFJGBT3wZOzAyJDre9dHH7+x7qaaKDOB4UQALD5ecS0DE4obubQEiuJZ0EpBVpLuYcce8Aa4PYd/V4DLDAJBYKQPCWTcrEaZ5HYbJi11Gd6hjGom1ii18VHYnG28NKpkz2UKVPxlhYSp8uZr367iOmoy7zsxehW9wzcy2zG0a80PBMCRQMb32hnaHeOR8fnNDzZhaNYhkOdDsBUZ3loDMa1YP0uS0cjUP3b/6DBlqmZOeNABDsLl5BI5QJups8uxAuWJdkUB/pO6Zax6tsg7fN5mjjDgMGngO+DPcKqiHIDbFIGudxtPTIyDi9SFMKBDcfdGQRv41q1AqmxgkVfJMnP8w/Bc7N9/TR6C7mGObFqFkIEom8sKi2xYqJLTCHK7cxzaZvqODo22c3wisBCP4HeAgcRbNPAsBkNRhSmD48dHupdBRw4mIvtS5oeF6zeT1KMCyhMnmhpkFAGWnGscoNkwvQ8ZM5lE/vgTHFYL99OuNxdFBxTEDd5v2qLR8y9WkXsWgG6kZNndFG+pO/UAkOCipqIhL3hq7cRSdrCq7YhUsTocEcnaFa6nVkhnSeRYUA1YO0z5itF9Sly3VlxYDw239TJJH6f3EUfYO5lb7bcFcz8Bp7Oo8QmnsUHOz/fagVUBtKEw1iT88j+aKkv8cscKNkMxjYr8344D1kFoZ7/td1W6LCNYN594301tUGRmFjAzeRg5vyoM1F6+bJZ/Q54jN/k8SFd3DxPTYaAUsivsBfgTn7Mx8H2SpPt4GOdYRnEJOH6jHM2p6SgB0gzIRq6fHxGMmSmqaPCmlfwxiuloaVIitLGN8wie2CDWhkzLoCJcODh7KIOAqbHEvXdUxaS4TTTs07Clzj/6GmVs9kiZDerMxEnhUB6QQPlcfqkG9882RqHoLiHGBoHfQuXIsAG8GTAtao2KVwRnvvam8jo1e312GQAKWEa4sUVEAMG4G6ckcONDwRcg1e2D3+ohXgY4UAWF8wHKQMrSnzCgfFpsxh+aHXMGtPQroQasRY4U6UdG0rz1Vjbka0MekOGRZQEvqQFlxseFor8zWFgHek3v29+WqN6gaK5gZOTOMZzpQIC1201LkMCXild3vWXSc5UX9xcFYfbRPzGFa1FDcPfPB/jUEq/FeGt419CI3YmBlVoHsa4KdcwQP5ZSwHHhFJ7/Ph/Rap/4vmG91eDwPP0lDfCDRCLszTqfzM71xpmiKi2HwS4WlqvGNwtvwF5Dqpn6KTq8ax00UMPkxDcZrEEEsIvHiUXXEphdb4GB4FymlPwBz4Gperqq5pW7TQ6/yNRhW8VT5NhuP0udlxo4gILq5ZxAZk8ZGh3g4CqxJlPKY7AQxupfUcVpWT5VItp1+30UqoyP4wWsRo3olRRgkWZZ2ZN6VC3OZFeXB8NbnUrSdikNptD1QiGuKkr8EmSR/AK9Rw+FF3s5uwuPbvHGiPeFOViltMK7AUaOsq9+x9cndk3iJEE5LKZRlWJbKOZweROzmPNVPkjE3K/TyA57Rs68TkZ3MR8akKpm7cFjnjPd/DdkWjgYoKHSr5Wu5ssoBYU4acRs5g2DHxUmdq8VXOXRbunD8QN0LhgkssgahcdoYsNvuXGUK/KXD/7oFb+VGdhqIn02veuM5bLudJOc2Ky0GMaG4W/xWBxIJcL7yliJOXOpx0AkBqUgzlDczmLT4iILXDxxtRR1oZa2JWFgiAb43obrJnG/TZC2KSK2wqOzRZTXavZZFMb1f3bXvVaNaK828w9TO610gk8JNf3gMfETzXXsbcvRGCG9JWQZ6+cDPqc4466Yo2RcKH+PILeKOqtnlbInR3MmBeGG3FH10yzkybuqEC2HSQwpA0An7d9+73BkDUTm30bZmoP/RGbgFN+GrCOfADgqr0WbI1a1okpFms8iHYw9hm0zUvlEMivBRxModrbJJ+9/p3jUdQQ9BCtQdxnOGrT5dzRUmw0593/mbRSdBg0nRvRZM5/E16m7ZHmDEtWhwvfdZCZ8J8M12W0yRMszXamWfQTwIZ4ayYktrnscQuWr8idp3PjT2eF/jmtdhIfcpMnb+IfZY2FebW6UY/AK3jP4u3Tu4zE4qlnQgLFbM19EBIsNf7KhjdbqQ/D6yiDb+NlEi2SKD+ivXVUK8ib0oBo366gXkR8ZxGjpJIDcEgZPa9TcYe0TIbiPl/rPUQDu3XBJ9X/GNq3FAUsKsll57DzaGMrjcT+gctp+9MLYXCq+sqP81eVQ0r9lt+gcQfZbACRbEjvlMskztZG8gbC8Qn9tt26Q7y7nDrbZq/LEz7kR6Jc6pg3N9rVX8Y5MJrGlML9p9lU4jbTkKqCveeZUJjHB03m2KRKR2TytoFkTXOLg7keU1s1lrPMQJpoOKLuAAC+y1HlJucU6ysB5hsXhvSPPLq5J7JtnqHKZ4vYjC4Vy8153QY+6780xDuGARsGbOs1WqzH0QS765rnSKEbbKlkO8oI/VDwUd0is13tKpqILu1mDJFNy/iJAWcvDgjxvusIT+PGz3ST/J9r9Mtfd0jpaGeiLYIqXc7DiHSS8TcjFVksi66PEkxW1z6ujbLLUGNNYnzOWpH8BZGK4bCK7iR+MbIv8ncDAz1u4StN3vTTzewr9IQjk9wxFxn+6N1ddKs0vffJiS08N3a4G1SVrlZ97Q/M+8G9fe5AP6d9/Qq4WRnORVhofPIKEdCr3llspUfE0oKIIYoByBRPh+bX1HLS3JWGJRhIvE1aW4NTd8ePi4Z+kXb+Z8snYfSNcqijhAgVsx4RCM54cXUiYkjeBmmC4ajOHrChoELscJJC7+9jjMjw5BagZKlgRMiSNYz7h7vvZIoQqbtQmspc0cUk1G/73iXtSpROl5wtLgQi0mW2Ex8i3WULhcggx6E1LMVHUsdc9GHI1PH3U2Ko0PyGdn9KdVOLm7FPBui0i9a0HpA60MsewVE4z8CAt5d401Gv6zXlIT5Ybit1VIA0FCs7wtvYreru1fUyW3oLAZ/+aTnZrOcYRNVA8spoRtlRoWflsRClFcgzkqiHOrf0/SVw+EpVaFlJ0g4Kxq1MMOmiQdpMNpte8lMMQqm6cIFXlnGbfJllysKDi+0JJMotkqgIxOSQgU9dn/lWkeVf8nUm3iwX2Nl3WDw9i6AUK3vBAbZZrcJpDQ/N64AVwjT07Jef30GSSmtNu2WlW7YoyW2FlWfZFQUwk867EdLYKk9VG6JgEnBiBxkY7LMo4YLQJJlAo9l/oTvJkSARDF/XtyAzM8O2t3eT/iXa6wDN3WewNmQHdPfsxChU/KtLG2Mn8i4ZqKdSlIaBZadxJmRzVS/o4yA65RTSViq60oa395Lqw0pzY4SipwE0SXXsKV+GZraGSkr/RW08wPRvqvSUkYBMA9lPx4m24az+IHmCbXA+0faxTRE9wuGeO06DIXa6QlKJ3puIyiuAVfPr736vzo2pBirS+Vxel3TMm3JKhz9o2ZoRvaFVpIkykb0Hcm4oHFBMcNSNj7/4GJt43ogonY2Vg4nsDQIWxAcorpXACzgBqQPjYsE/VUpXpwNManEru4NwMCFPkXvMoqvoeLN3qyu/N1eWEHttMD65v19l/0kH2mR35iv/FI+yjoHJ9gPMz67af3Mq/BoWXqu3rphiWMXVkmnPSEkpGpUI2h1MThideGFEOK6YZHPwYzMBvpNC7+ZHxPb7epfefGyIB4JzO9DTNEYnDLVVHdQyvOEVefrk6Uv5kTQYVYWWdqrdcIl7yljwwIWdfQ/y+2QB3eR/qxYObuYyB4gTbo2in4PzarU1sO9nETkmj9/AoxDA+JM3GMqQtJR4jtduHtnoCLxd1gQUscHRB/MoRYIEsP2pDZ9KvHgtlk1iTbWWbHhohwFEYX7y51fUV2nuUmnoUcqnWIQAAgl9LTVX+Bc0QGNEhChxHR4YjfE51PUdGfsSFE6ck7BL3/hTf9jLq4G1IafINxOLKeAtO7quulYvH5YOBc+zX7CrMgWnW47/jfRsWnJjYYoE7xMfWV2HN2iyIqLI";const vc=new Map([[8217,"apostrophe"],[8260,"fraction slash"],[12539,"middle dot"]]),wc=4;function bc(e){let t=0;function n(){return e[t++]<<8|e[t++]}let r=n(),i=1,o=[0,1];for(let w=1;w<r;w++)o.push(i+=n());let s=n(),a=t;t+=s;let c=0,l=0;function u(){return 0==c&&(l=l<<8|e[t++],c=8),l>>--c&1}const h=2**31,d=h>>>1,f=h-1;let p=0;for(let w=0;w<31;w++)p=p<<1|u();let g=[],m=0,y=h;for(;;){let e=Math.floor(((p-m+1)*i-1)/y),t=0,n=r;for(;n-t>1;){let r=t+n>>>1;e<o[r]?n=r:t=r}if(0==t)break;g.push(t);let s=m+Math.floor(y*o[t]/i),a=m+Math.floor(y*o[t+1]/i)-1;for(;0==((s^a)&d);)p=p<<1&f|u(),s=s<<1&f,a=a<<1&f|1;for(;s&~a&536870912;)p=p&d|p<<1&f>>>1|u(),s=s<<1^d,a=(a^d)<<1|d|1;m=s,y=1+a-s}let v=r-4;return g.map(t=>{switch(t-v){case 3:return v+65792+(e[a++]<<16|e[a++]<<8|e[a++]);case 2:return v+256+(e[a++]<<8|e[a++]);case 1:return v+e[a++];default:return t-1}})}function Oc(e){let t=0;return()=>e[t++]}function Ec(e){return Oc(bc(_c(e)))}function _c(e){let t=[];[..."ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"].forEach((e,n)=>t[e.charCodeAt(0)]=n);let n=e.length,r=new Uint8Array(6*n>>3);for(let i=0,o=0,s=0,a=0;i<n;i++)a=a<<6|t[e.charCodeAt(i)],(s+=6)>=8&&(r[o++]=a>>(s-=8));return r}function Cc(e){return 1&e?~e>>1:e>>1}function Nc(e,t){let n=Array(e);for(let r=0,i=0;r<e;r++)n[r]=i+=Cc(t());return n}function Ac(e,t=0){let n=[];for(;;){let r=e(),i=e();if(!i)break;t+=r;for(let e=0;e<i;e++)n.push(t+e);t+=i+1}return n}function Rc(e){return Tc(()=>{let t=Ac(e);if(t.length)return t})}function Sc(e){let t=[];for(;;){let n=e();if(0==n)break;t.push(Dc(n,e))}for(;;){let n=e()-1;if(n<0)break;t.push(kc(n,e))}return t.flat()}function Tc(e){let t=[];for(;;){let n=e(t.length);if(!n)break;t.push(n)}return t}function Pc(e,t,n){let r=Array(e).fill().map(()=>[]);for(let i=0;i<t;i++)Nc(e,n).forEach((e,t)=>r[t].push(e));return r}function Dc(e,t){let n=1+t(),r=t(),i=Tc(t);return Pc(i.length,1+e,t).flatMap((e,t)=>{let[o,...s]=e;return Array(i[t]).fill().map((e,t)=>{let i=t*r;return[o+t*n,s.map(e=>e+i)]})})}function kc(e,t){return Pc(1+t(),1+e,t).map(e=>[e[0],e.slice(1)])}function Ic(e){let t=[],n=Ac(e);return function e({S:n,B:r},i,o){if(!(4&n&&o===i[i.length-1])){2&n&&(o=i[i.length-1]),1&n&&t.push(i);for(let t of r)for(let n of t.Q)e(t,[...i,n],o)}}(function t(r){return{S:e(),B:Tc(()=>{let r=Ac(e).map(e=>n[e]);if(r.length)return t(r)}),Q:r}}([]),[]),t}function xc(e){return e.toString(16).toUpperCase().padStart(2,"0")}function Mc(e){return`{${xc(e)}}`}function Kc(e){let t=[];for(let n=0,r=e.length;n<r;){let r=e.codePointAt(n);n+=r<65536?1:2,t.push(r)}return t}function Lc(e){let t=e.length;if(t<4096)return String.fromCodePoint(...e);let n=[];for(let r=0;r<t;)n.push(String.fromCodePoint(...e.slice(r,r+=4096)));return n.join("")}function Uc(e,t){let n=e.length,r=n-t.length;for(let i=0;0==r&&i<n;i++)r=e[i]-t[i];return r}var Bc="AEUDTAHBCFQATQDRADAAcgAgADQAFAAsABQAHwAOACQADQARAAoAFwAHABIACAAPAAUACwAFAAwABAAQAAMABwAEAAoABQAIAAIACgABAAQAFAALAAIACwABAAIAAQAHAAMAAwAEAAsADAAMAAwACgANAA0AAwAKAAkABAAdAAYAZwDSAdsDJgC0CkMB8xhZAqfoC190UGcThgBurwf7PT09Pb09AjgJum8OjDllxHYUKXAPxzq6tABAxgK8ysUvWAgMPT09PT09PSs6LT2HcgWXWwFLoSMEEEl5RFVMKvO0XQ8ExDdJMnIgsj26PTQyy8FfEQ8AY8IPAGcEbwRwBHEEcgRzBHQEdQR2BHcEeAR6BHsEfAR+BIAEgfndBQoBYgULAWIFDAFiBNcE2ATZBRAFEQUvBdALFAsVDPcNBw13DYcOMA4xDjMB4BllHI0B2grbAMDpHLkQ7QHVAPRNQQFnGRUEg0yEB2uaJF8AJpIBpob5AERSMAKNoAXqaQLUBMCzEiACnwRZEkkVsS7tANAsBG0RuAQLEPABv9HICTUBXigPZwRBApMDOwAamhtaABqEAY8KvKx3LQ4ArAB8UhwEBAVSagD8AEFZADkBIadVj2UMUgx5Il4ANQC9AxIB1BlbEPMAs30CGxlXAhwZKQIECBc6EbsCoxngzv7UzRQA8M0BawL6ZwkN7wABAD33OQRcsgLJCjMCjqUChtw/km+NAsXPAoP2BT84PwURAK0RAvptb6cApQS/OMMey5HJS84UdxpxTPkCogVFITaTOwERAK5pAvkNBOVyA7q3BKlOJSALAgUIBRcEdASpBXqzABXFSWZOawLCOqw//AolCZdvv3dSBkEQGyelEPcMMwG1ATsN7UvYBPEGOwTJH30ZGQ/NlZwIpS3dDO0m4y6hgFoj9SqDBe1L9DzdC01RaA9ZC2UJ4zpjgU4DIQENIosK3Q05CG0Q8wrJaw3lEUUHOQPVSZoApQcBCxEdNRW1JhBirAsJOXcG+xr2C48mrxMpevwF0xohBk0BKRr/AM8u54WwWjFcHE9fBgMLJSPHFKhQIA0lQLd4SBobBxUlqQKRQ3BKh1E2HpMh9jw9DWYuE1F8B/U8BRlPC4E8nkarRQ4R0j6NPUgiSUwsBDV/LC8niwnPD4UMuXxyAVkJIQmxDHETMREXN8UIOQcZLZckJxUIIUaVYJoE958D8xPRAwsFPwlBBxMDtRwtEy4VKQUNgSTXAvM21S6zAo9WgAEXBcsPJR/fEFBH4A7pCJsCZQODJesALRUhABcimwhDYwBfj9hTBS7LCMdqbCN0A2cU52ERcweRDlcHpxwzFb8c4XDIXguGCCijrwlbAXUJmQFfBOMICTVbjKAgQWdTi1gYmyBhQT9d/AIxDGUVn0S9h3gCiw9rEhsBNQFzBzkNAQJ3Ee0RaxCVCOuGBDW1M/g6JQRPIYMgEQonA09szgsnJvkM+GkBoxJiAww0PXfuZ6tgtiQX/QcZMsVBYCHxC5JPzQycGsEYQlQuGeQHvwPzGvMn6kFXBf8DowMTOk0z7gS9C2kIiwk/AEkOoxcH1xhqCnGM0AExiwG3mQNXkYMCb48GNwcLAGcLhwV55QAdAqcIowAFAM8DVwA5Aq0HnQAZAIVBAT0DJy8BIeUCjwOTCDHLAZUvAfMpBBvDDBUA9zduSgLDsQKAamaiBd1YAo4CSTUBTSUEBU5HUQOvceEA2wBLBhPfRwEVq0rLGuNDAd9vKwDHAPsABTUHBUEBzQHzbQC3AV8LMQmis7UBTekpAIMAFWsB1wKJAN0ANQB/8QFTAE0FWfkF0wJPSQERMRgrV2EBuwMfATMBDQB5BsuNpckHHwRtB9MCEBsV4QLvLge1AQMi3xPNQsUCvd5VoWACZIECYkJbTa9bNyACofcCaJgCZgkCn4Q4GwsCZjsCZiYEbgR/A38TA36SOQY5dxc5gjojIwJsHQIyNjgKAm3HAm2u74ozZ0UrAWcA3gDhAEoFB5gMjQD+C8IADbUCdy8CdqI/AnlLQwJ4uh1c20WuRtcCfD8CesgCfQkCfPAFWQUgSABIfWMkAoFtAoAAAoAFAn+uSVhKWxUXSswC0QEC0MxLJwOITwOH5kTFkTIC8qFdAwMDrkvOTC0lA89NTE2vAos/AorYwRsHHUNnBbcCjjcCjlxAl4ECjtkCjlx4UbRTNQpS1FSFApP7ApMMAOkAHFUeVa9V0AYsGymVhjLheGZFOzkCl58C77JYIagAWSUClo8ClnycAKlZrFoJgU0AOwKWtQKWTlxEXNECmcsCmWRcyl0HGQKcmznCOp0CnBYCn5sCnriKAB0PMSoPAp3xAp6SALU9YTRh7wKe0wKgbgGpAp6fHwKeTqVjyGQnJSsCJ68CJn4CoPsCoEwCot0CocQCpi8Cpc4Cp/8AfQKn8mh8aLEAA0lqHGrRAqzjAqyuAq1nAq0CAlcdAlXcArHh1wMfTmyXArK9DQKy6Bds4G1jbUhfAyXNArZcOz9ukAMpRQK4XgK5RxUCuSp3cDZw4QK9GQK72nCWAzIRAr6IcgIDM3ECvhpzInNPAsPLAsMEc4J0SzVFdOADPKcDPJoDPb8CxXwCxkcCxhCJAshpUQLIRALJTwLJLgJknQLd0nh5YXiueSVL0AMYo2cCAmH0GfOVJHsLXpJeuxECz2sCz2wvS1PS8xOfAMatAs9zASnqA04SfksFAtwnAtuKAtJPA1JcA1NfAQEDVYyAiT8AyxbtYEWCHILTgs6DjQLaxwLZ3oQQhEmnPAOGpQAvA2QOhnFZ+QBVAt9lAt64c3cC4i/tFAHzMCcB9JsB8tKHAuvzAulweQLq+QLq5AD5RwG5Au6JAuuclqqXAwLuPwOF4Jh5cOBxoQLzAwBpA44WmZMC9xMDkW4DkocC95gC+dkC+GaaHJqruzebHgOdgwL++gEbADmfHJ+zAwWNA6ZqA6bZANHFAwZqoYiiBQkDDEkCwAA/AwDhQRdTARHzA2sHl2cFAJMtK7evvdsBiZkUfxEEOQH7KQUhDp0JnwCS/SlXxQL3AZ0AtwW5AG8LbUEuFCaNLgFDAYD8AbUmAHUDDgRtACwCFgyhAAAKAj0CagPdA34EkQEgRQUhfAoABQBEABMANhICdwEABdUDa+8KxQIA9wqfJ7+xt+UBkSFBQgHpFH8RNMCJAAQAGwBaAkUChIsABjpTOpSNbQC4Oo860ACNOME63AClAOgAywE6gTo7Ofw5+Tt2iTpbO56JOm85GAFWATMBbAUvNV01njWtNWY1dTW2NcU1gjWRNdI14TWeNa017jX9NbI1wTYCNhE1xjXVNhY2JzXeNe02LjY9Ni41LSE2OjY9Njw2yTcIBJA8VzY4Nt03IDcPNsogN4k3MAoEsDxnNiQ3GTdsOo03IULUQwdC4EMLHA8PCZsobShRVQYA6X8A6bABFCnXAukBowC9BbcAbwNzBL8MDAMMAQgDAAkKCwsLCQoGBAVVBI/DvwDz9b29kaUCb0QtsRTNLt4eGBcSHAMZFhYZEhYEARAEBUEcQRxBHEEcQRxBHEEaQRxBHEFCSTxBPElISUhBNkM2QTYbNklISVmBVIgBFLWZAu0BhQCjBcEAbykBvwGJAaQcEZ0ePCklMAAhMvAIMAL54gC7Bm8EescjzQMpARQpKgDUABavAj626xQAJP0A3etzuf4NNRA7efy2Z9NQrCnC0OSyANz5BBIbJ5IFDR6miIavYS6tprjjmuKebxm5C74Q225X1pkaYYPb6f1DK4k3xMEBb9S2WMjEibTNWhsRJIA+vwNVEiXTE5iXs/wezV66oFLfp9NZGYW+Gk19J2+bCT6Ye2w6LDYdgzKMUabk595eLBCXANz9HUpWbATq9vqXVx9XDg+Pc9Xp4+bsS005SVM/BJBM4687WUuf+Uj9dEi8aDNaPxtpbDxcG1THTImUMZq4UCaaNYpsVqraNyKLJXDYsFZ/5jl7bLRtO88t7P3xZaAxhb5OdPMXqsSkp1WCieG8jXm1U99+blvLlXzPCS+M93VnJCiK+09LfaSaBAVBomyDgJua8dfUzR7ga34IvR2Nvj+A9heJ6lsl1KG4NkI1032Cnff1m1wof2B9oHJK4bi6JkEdSqeNeiuo6QoZZincoc73/TH9SXF8sCE7XyuYyW8WSgbGFCjPV0ihLKhdPs08Tx82fYAkLLc4I2wdl4apY7GU5lHRFzRWJep7Ww3wbeA3qmd59/86P4xuNaqDpygXt6M85glSBHOCGgJDnt+pN9bK7HApMguX6+06RZNjzVmcZJ+wcUrJ9//bpRNxNuKpNl9uFds+S9tdx7LaM5ZkIrPj6nIU9mnbFtVbs9s/uLgl8MVczAwet+iOEzzBlYW7RCMgE6gyNLeq6+1tIx4dpgZnd0DksJS5f+JNDpwwcPNXaaVspq1fbQajOrJgK0ofKtJ1Ne90L6VO4MOl5S886p7u6xo7OLjG8TGL+HU1JXGJgppg4nNbNJ5nlzSpuPYy21JUEcUA94PoFiZfjZue+QnyQ80ekOuZVkxx4g+cvhJfHgNl4hy1/a6+RKcKlar/J29y//EztlbVPHVUeQ1zX86eQVAjR/M3dA9w4W8LfaXp4EgM85wOWasli837PzVMOnsLzR+k3o75/lRPAJSE1xAKQzEi5v10ke+VBvRt1cwQRMd+U5mLCTGVd6XiZtgBG5cDi0w22GKcVNvHiu5LQbZEDVtz0onn7k5+heuKXVsZtSzilkLRAUmjMXEMB3J9YC50XBxPiz53SC+EhnPl9WsKCv92SM/OFFIMJZYfl0WW8tIO3UxYcwdMAj7FSmgrsZ2aAZO03BOhP1bNNZItyXYQFTpC3SG1VuPDqH9GkiCDmE+JwxyIVSO5siDErAOpEXFgjy6PQtOVDj+s6e1r8heWVvmZnTciuf4EiNZzCAd7SOMhXERIOlsHIMG399i9aLTy3m2hRLZjJVDNLS53iGIK11dPqQt0zBDyg6qc7YqkDm2M5Ve6dCWCaCbTXX2rToaIgz6+zh4lYUi/+6nqcFMAkQJKHYLK0wYk5N9szV6xihDbDDFr45lN1K4aCXBq/FitPSud9gLt5ZVn+ZqGX7cwm2z5EGMgfFpIFyhGGuDPmso6TItTMwny+7uPnLCf4W6goFQFV0oQSsc9VfMmVLcLr6ZetDZbaSFTLqnSO/bIPjA3/zAUoqgGFAEQS4IhuMzEp2I3jJzbzkk/IEmyax+rhZTwd6f+CGtwPixu8IvzACquPWPREu9ZvGkUzpRwvRRuaNN6cr0W1wWits9ICdYJ7ltbgMiSL3sTPeufgNcVqMVWFkCPDH4jG2jA0XcVgQj62Cb29v9f/z/+2KbYvIv/zzjpQAPkliaVDzNrW57TZ/ZOyZD0nlfMmAIBIAGAI0D3k/mdN4xr9v85ZbZbbqfH2jGd5hUqNZWwl5SPfoGmfElmazUIeNL1j/mkF7VNAzTq4jNt8JoQ11NQOcmhprXoxSxfRGJ9LDEOAQ+dmxAQH90iti9e2u/MoeuaGcDTHoC+xsmEeWmxEKefQuIzHbpw5Tc5cEocboAD09oipWQhtTO1wivf/O+DRe2rpl/E9wlrzBorjJsOeG1B/XPW4EaJEFdNlECEZga5ZoGRHXgYouGRuVkm8tDESiEyFNo+3s5M5puSdTyUL2llnINVHEt91XUNW4ewdMgJ4boJfEyt/iY5WXqbA+A2Fkt5Z0lutiWhe9nZIyIUjyXDC3UsaG1t+eNx6z4W/OYoTB7A6x+dNSTOi9AInctbESqm5gvOLww7OWXPrmHwVZasrl4eD113pm+JtT7JVOvnCXqdzzdTRHgJ0PiGTFYW5Gvt9R9LD6Lzfs0v/TZZHSmyVNq7viIHE6DBK7Qp07Iz55EM8SYtQvZf/obBniTWi5C2/ovHfw4VndkE5XYdjOhCMRjDeOEfXeN/CwfGduiUIfsoFeUxXeQXba7c7972XNv8w+dTjjUM0QeNAReW+J014dKAD/McQYXT7c0GQPIkn3Ll6R7gGjuiQoZD0TEeEqQpKoZ15g/0OPQI17QiSv9AUROa/V/TQN3dvLArec3RrsYlvBm1b8LWzltdugsC50lNKYLEp2a+ZZYqPejULRlOJh5zj/LVMyTDvwKhMxxwuDkxJ1QpoNI0OTWLom4Z71SNzI9TV1iXJrIu9Wcnd+MCaAw8o1jSXd94YU/1gnkrC9BUEOtQvEIQ7g0i6h+KL2JKk8Ydl7HruvgWMSAmNe+LshGhV4qnWHhO9/RIPQzY1tHRj2VqOyNsDpK0cww+56AdDC4gsWwY0XxoucIWIqs/GcwnWqlaT0KPr8mbK5U94/301i1WLt4YINTVvCFBrFZbIbY8eycOdeJ2teD5IfPLCRg7jjcFTwlMFNl9zdh/o3E/hHPwj7BWg0MU09pPrBLbrCgm54A6H+I6v27+jL5gkjWg/iYdks9jbfVP5y/n0dlgWEMlKasl7JvFZd56LfybW1eeaVO0gxTfXZwD8G4SI116yx7UKVRgui6Ya1YpixqXeNLc8IxtAwCU5IhwQgn+NqHnRaDv61CxKhOq4pOX7M6pkA+Pmpd4j1vn6ACUALoLLc4vpXci8VidLxzm7qFBe7s+quuJs6ETYmnpgS3LwSZxPIltgBDXz8M1k/W2ySNv2f9/NPhxLGK2D21dkHeSGmenRT3Yqcdl0m/h3OYr8V+lXNYGf8aCCpd4bWjE4QIPj7vUKN4Nrfs7ML6Y2OyS830JCnofg/k7lpFpt4SqZc5HGg1HCOrHvOdC8bP6FGDbE/VV0mX4IakzbdS/op+Kt3G24/8QbBV7y86sGSQ/vZzU8FXs7u6jIvwchsEP2BpIhW3G8uWNwa3HmjfH/ZjhhCWvluAcF+nMf14ClKg5hGgtPLJ98ueNAkc5Hs2WZlk2QHvfreCK1CCGO6nMZVSb99VM/ajr8WHTte9JSmkXq/i/U943HEbdzW6Re/S88dKgg8pGOLlAeNiqrcLkUR3/aClFpMXcOUP3rmETcWSfMXZE3TUOi8i+fqRnTYLflVx/Vb/6GJ7eIRZUA6k3RYR3iFSK9c4iDdNwJuZL2FKz/IK5VimcNWEqdXjSoxSgmF0UPlDoUlNrPcM7ftmA8Y9gKiqKEHuWN+AZRIwtVSxye2Kf8rM3lhJ5XcBXU9n4v0Oy1RU2M+4qM8AQPVwse8ErNSob5oFPWxuqZnVzo1qB/IBxkM3EVUKFUUlO3e51259GgNcJbCmlvrdjtoTW7rChm1wyCKzpCTwozUUEOIcWLneRLgMXh+SjGSFkAllzbGS5HK7LlfCMRNRDSvbQPjcXaenNYxCvu2Qyznz6StuxVj66SgI0T8B6/sfHAJYZaZ78thjOSIFumNWLQbeZixDCCC+v0YBtkxiBB3jefHqZ/dFHU+crbj6OvS1x/JDD7vlm7zOVPwpUC01nhxZuY/63E7g";const jc=44032,Hc=4352,Wc=4449,Xc=4519,Fc=28,Jc=21*Fc,Gc=jc+19*Jc,qc=Hc+19,Vc=Wc+21,zc=Xc+Fc;function Qc(e){return e>>24&255}function $c(e){return 16777215&e}let Yc,Zc,el,tl;function nl(){let e=Ec(Bc);Yc=new Map(Rc(e).flatMap((e,t)=>e.map(e=>[e,t+1<<24]))),Zc=new Set(Ac(e)),el=new Map,tl=new Map;for(let[t,n]of Sc(e)){if(!Zc.has(t)&&2==n.length){let[e,r]=n,i=tl.get(e);i||(i=new Map,tl.set(e,i)),i.set(r,t)}el.set(t,n.reverse())}}function rl(e){return e>=jc&&e<Gc}function il(e,t){if(e>=Hc&&e<qc&&t>=Wc&&t<Vc)return jc+(e-Hc)*Jc+(t-Wc)*Fc;if(rl(e)&&t>Xc&&t<zc&&(e-jc)%Fc==0)return e+(t-Xc);{let n=tl.get(e);return n&&(n=n.get(t))?n:-1}}function ol(e){Yc||nl();let t=[],n=[],r=!1;function i(e){let n=Yc.get(e);n&&(r=!0,e|=n),t.push(e)}for(let o of e)for(;;){if(o<128)t.push(o);else if(rl(o)){let e=o-jc,t=e%Jc/Fc|0,n=e%Fc;i(Hc+(e/Jc|0)),i(Wc+t),n>0&&i(Xc+n)}else{let e=el.get(o);e?n.push(...e):i(o)}if(!n.length)break;o=n.pop()}if(r&&t.length>1){let e=Qc(t[0]);for(let n=1;n<t.length;n++){let r=Qc(t[n]);if(0==r||e<=r){e=r;continue}let i=n-1;for(;;){let n=t[i+1];if(t[i+1]=t[i],t[i]=n,!i||(e=Qc(t[--i]))<=r)break}e=Qc(t[n])}}return t}function sl(e){let t=[],n=[],r=-1,i=0;for(let o of e){let e=Qc(o),s=$c(o);if(-1==r)0==e?r=s:t.push(s);else if(i>0&&i>=e)0==e?(t.push(r,...n),n.length=0,r=s):n.push(s),i=e;else{let o=il(r,s);o>=0?r=o:0==i&&0==e?(t.push(r),r=s):(n.push(s),i=e)}}return r>=0&&t.push(r,...n),t}function al(e){return ol(e).map($c)}function cl(e){return sl(ol(e))}const ll=45,ul=".",hl=65039,dl=1,fl=e=>Array.from(e);function pl(e,t){return e.P.has(t)||e.Q.has(t)}class gl extends Array{get is_emoji(){return!0}}let ml,yl,vl,wl,bl,Ol,El,_l,Cl,Nl,Al;function Rl(){if(ml)return;let e=Ec(yc);const t=()=>Ac(e),n=()=>new Set(t()),r=(e,t)=>t.forEach(t=>e.add(t));ml=new Map(Sc(e)),yl=n(),vl=t(),wl=new Set(t().map(e=>vl[e])),vl=new Set(vl),bl=n(),n();let i=Rc(e),o=e();const s=()=>{let e=new Set;return t().forEach(t=>r(e,i[t])),r(e,t()),e};Ol=Tc(t=>{let n=Tc(e).map(e=>e+96);if(n.length){let r=t>=o;return n[0]-=32,n=Lc(n),r&&(n=`Restricted[${n}]`),{N:n,P:s(),Q:s(),M:!e(),R:r}}}),El=n(),_l=new Map;let a=t().concat(fl(El)).sort((e,t)=>e-t);a.forEach((t,n)=>{let r=e(),i=a[n]=r?a[n-r]:{V:[],M:new Map};i.V.push(t),El.has(t)||_l.set(t,i)});for(let{V:u,M:h}of new Set(_l.values())){let e=[];for(let n of u){let t=Ol.filter(e=>pl(e,n)),i=e.find(({G:e})=>t.some(t=>e.has(t)));i||(i={G:new Set,V:[]},e.push(i)),i.V.push(n),r(i.G,t)}let t=e.flatMap(e=>fl(e.G));for(let{G:n,V:r}of e){let e=new Set(t.filter(e=>!n.has(e)));for(let t of r)h.set(t,e)}}Cl=new Set;let c=new Set;const l=e=>Cl.has(e)?c.add(e):Cl.add(e);for(let u of Ol){for(let e of u.P)l(e);for(let e of u.Q)l(e)}for(let u of Cl)!_l.has(u)&&!c.has(u)&&_l.set(u,dl);r(Cl,al(Cl)),Nl=Ic(e).map(e=>gl.from(e)).sort(Uc),Al=new Map;for(let u of Nl){let e=[Al];for(let t of u){let n=e.map(e=>{let n=e.get(t);return n||(n=new Map,e.set(t,n)),n});t===hl?e.push(...n):e=n}for(let t of e)t.V=u}}function Sl(e){return(Ml(e)?"":`${Tl(Il([e]))} `)+Mc(e)}function Tl(e){return`"${e}"\u200e`}function Pl(e){if(e.length>=4&&e[2]==ll&&e[3]==ll)throw new Error(`invalid label extension: "${Lc(e.slice(0,4))}"`)}function Dl(e){for(let t=e.lastIndexOf(95);t>0;)if(95!==e[--t])throw new Error("underscore allowed only at start")}function kl(e){let t=e[0],n=vc.get(t);if(n)throw Xl(`leading ${n}`);let r=e.length,i=-1;for(let o=1;o<r;o++){t=e[o];let r=vc.get(t);if(r){if(i==o)throw Xl(`${n} + ${r}`);i=o+1,n=r}}if(i==r)throw Xl(`trailing ${n}`)}function Il(e,t=1/0,n=Mc){let r=[];xl(e[0])&&r.push("\u25cc"),e.length>t&&(t>>=1,e=[...e.slice(0,t),8230,...e.slice(-t)]);let i=0,o=e.length;for(let s=0;s<o;s++){let t=e[s];Ml(t)&&(r.push(Lc(e.slice(i,s))),r.push(n(t)),i=s+1)}return r.push(Lc(e.slice(i,o))),r.join("")}function xl(e){return Rl(),vl.has(e)}function Ml(e){return Rl(),bl.has(e)}function Kl(e){return jl(Ll(e,cl,Gl))}function Ll(e,t,n){if(!e)return[];Rl();let r=0;return e.split(ul).map(e=>{let i=Kc(e),o={input:i,offset:r};r+=i.length+1;try{let e,r=o.tokens=Jl(i,t,n),a=r.length;if(!a)throw new Error("empty label");let c=o.output=r.flat();if(Dl(c),!(o.emoji=a>1||r[0].is_emoji)&&c.every(e=>e<128))Pl(c),e="ASCII";else{let t=r.flatMap(e=>e.is_emoji?[]:e);if(t.length){if(vl.has(c[0]))throw Xl("leading combining mark");for(let e=1;e<a;e++){let t=r[e];if(!t.is_emoji&&vl.has(t[0]))throw Xl(`emoji + combining mark: "${Lc(r[e-1])} + ${Il([t[0]])}"`)}kl(c);let n=fl(new Set(t)),[i]=Bl(n);Fl(i,t),Ul(i,n),e=i.N}else e="Emoji"}o.type=e}catch(s){o.error=s}return o})}function Ul(e,t){let n,r=[];for(let i of t){let e=_l.get(i);if(e===dl)return;if(e){let t=e.M.get(i);if(!(n=n?n.filter(e=>t.has(e)):fl(t)).length)return}else r.push(i)}if(n)for(let i of n)if(r.every(e=>pl(i,e)))throw new Error(`whole-script confusable: ${e.N}/${i.N}`)}function Bl(e){let t=Ol;for(let n of e){let e=t.filter(e=>pl(e,n));if(!e.length)throw Ol.some(e=>pl(e,n))?Wl(t[0],n):Hl(n);if(t=e,1==e.length)break}return t}function jl(e){return e.map(({input:t,error:n,output:r})=>{if(n){let r=n.message;throw new Error(1==e.length?r:`Invalid label ${Tl(Il(t,63))}: ${r}`)}return Lc(r)}).join(ul)}function Hl(e){return new Error(`disallowed character: ${Sl(e)}`)}function Wl(e,t){let n=Sl(t),r=Ol.find(e=>e.P.has(t));return r&&(n=`${r.N} ${n}`),new Error(`illegal mixture: ${e.N} + ${n}`)}function Xl(e){return new Error(`illegal placement: ${e}`)}function Fl(e,t){for(let n of t)if(!pl(e,n))throw Wl(e,n);if(e.M){let e=al(t);for(let t=1,n=e.length;t<n;t++)if(wl.has(e[t])){let r,i=t+1;for(;i<n&&wl.has(r=e[i]);i++)for(let n=t;n<i;n++)if(e[n]==r)throw new Error(`duplicate non-spacing marks: ${Sl(r)}`);if(i-t>wc)throw new Error(`excessive non-spacing marks: ${Tl(Il(e.slice(t-1,i)))} (${i-t}/${wc})`);t=i}}}function Jl(e,t,n){let r=[],i=[];for(e=e.slice().reverse();e.length;){let o=ql(e);if(o)i.length&&(r.push(t(i)),i=[]),r.push(n(o));else{let t=e.pop();if(Cl.has(t))i.push(t);else{let e=ml.get(t);if(e)i.push(...e);else if(!yl.has(t))throw Hl(t)}}}return i.length&&r.push(t(i)),r}function Gl(e){return e.filter(e=>e!=hl)}function ql(e){let t,n=Al,r=e.length;for(;r&&(n=n.get(e[--r]));){let{V:i}=n;i&&(t=i,e.length=r)}return t}const Vl=new Uint8Array(32);function zl(e){return In(0!==e.length,"invalid ENS name; empty component","comp",e),e}function Ql(e){const t=vr($l(e)),n=[];if(0===e.length)return n;let r=0;for(let i=0;i<t.length;i++)46===t[i]&&(n.push(zl(t.slice(r,i))),r=i+1);return In(r<t.length,"invalid ENS name; empty component","name",e),n.push(zl(t.slice(r))),n}function $l(e){try{if(0===e.length)throw new Error("empty label");return Kl(e)}catch(t){In(!1,`invalid ENS name (${t.message})`,"name",e)}}function Yl(e){In("string"==typeof e,"invalid ENS name; not a string","name",e),In(e.length,"invalid ENS name (empty label)","name",e);let t=Vl;const n=Ql(e);for(;n.length;)t=So(Xn([t,So(n.pop())]));return Wn(t)}function Zl(e,t){const n=t;return In(n<=255,"DNS encoded label cannot exceed 255","length",n),Wn(Xn(Ql(e).map(t=>{In(t.length<=n,`label ${JSON.stringify(e)} exceeds ${n} bytes`,"name",e);const r=new Uint8Array(t.length+1);return r.set(t,1),r[0]=r.length-1,r})))+"00"}Vl.fill(0);const eu=new Uint8Array(32);eu.fill(0);const tu=BigInt(-1),nu=BigInt(0),ru=BigInt(1),iu=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function ou(e){const t=Ln(e),n=t.length%32;return n?Xn([t,eu.slice(n)]):Wn(t)}const su=sr(ru,32),au=sr(nu,32),cu={name:"string",version:"string",chainId:"uint256",verifyingContract:"address",salt:"bytes32"},lu=["name","version","chainId","verifyingContract","salt"];function uu(e){return function(t){return In("string"==typeof t,`invalid domain value for ${JSON.stringify(e)}`,`domain.${e}`,t),t}}const hu={name:uu("name"),version:uu("version"),chainId:function(e){const t=tr(e,"domain.chainId");return In(t>=0,"invalid chain ID","domain.chainId",e),Number.isSafeInteger(t)?Number(t):cr(t)},verifyingContract:function(e){try{return ua(e).toLowerCase()}catch{}In(!1,'invalid domain value "verifyingContract"',"domain.verifyingContract",e)},salt:function(e){const t=Ln(e,"domain.salt");return In(32===t.length,'invalid domain value "salt"',"domain.salt",e),Wn(t)}};function du(e){{const t=e.match(/^(u?)int(\d+)$/);if(t){const n=""===t[1],r=parseInt(t[2]);In(r%8==0&&0!==r&&r<=256&&t[2]===String(r),"invalid numeric width","type",e);const i=er(iu,n?r-1:r),o=n?(i+ru)*tu:nu;return function(t){const r=tr(t,"value");return In(r>=o&&r<=i,`value out-of-bounds for ${e}`,"value",r),sr(n?Zn(r,256):r,32)}}}{const t=e.match(/^bytes(\d+)$/);if(t){const n=parseInt(t[1]);return In(0!==n&&n<=32&&t[1]===String(n),"invalid bytes width","type",e),function(t){return In(Ln(t).length===n,`invalid length for ${e}`,"value",t),ou(t)}}}switch(e){case"address":return function(e){return qn(ua(e),32)};case"bool":return function(e){return e?su:au};case"bytes":return function(e){return So(e)};case"string":return function(e){return mc(e)}}return null}function fu(e,t){return`${e}(${t.map(({name:e,type:t})=>t+" "+e).join(",")})`}function pu(e){const t=e.match(/^([^\x5b]*)((\x5b\d*\x5d)*)(\x5b(\d*)\x5d)$/);return t?{base:t[1],index:t[2]+t[4],array:{base:t[1],prefix:t[1]+t[2],count:t[5]?parseInt(t[5]):-1}}:{base:e}}Oe=new WeakMap,Ee=new WeakMap,_e=new WeakMap,Ce=new WeakSet,Ne=function(e){{const t=du(e);if(t)return t}const t=pu(e).array;if(t){const e=t.prefix,n=this.getEncoder(e);return r=>{In(-1===t.count||t.count===r.length,`array length mismatch; expected length ${t.count}`,"value",r);let i=r.map(n);return wn(this,Ee).has(e)&&(i=i.map(So)),So(Xn(i))}}const n=this.types[e];if(n){const t=mc(wn(this,Ee).get(e));return e=>{const r=n.map(({name:t,type:n})=>{const r=this.getEncoder(n)(e[t]);return wn(this,Ee).has(n)?So(r):r});return r.unshift(t),Xn(r)}}In(!1,`unknown type: ${e}`,"type",e)};let gu=class e{constructor(e){bn(this,Ce),yn(this,"primaryType"),bn(this,Oe),bn(this,Ee),bn(this,_e),On(this,Ee,new Map),On(this,_e,new Map);const t=new Map,n=new Map,r=new Map,i={};Object.keys(e).forEach(o=>{i[o]=e[o].map(({name:t,type:n})=>{let{base:r,index:i}=pu(n);return"int"===r&&!e.int&&(r="int256"),"uint"===r&&!e.uint&&(r="uint256"),{name:t,type:r+(i||"")}}),t.set(o,new Set),n.set(o,[]),r.set(o,new Set)}),On(this,Oe,JSON.stringify(i));for(const s in i){const r=new Set;for(const o of i[s]){In(!r.has(o.name),`duplicate variable name ${JSON.stringify(o.name)} in ${JSON.stringify(s)}`,"types",e),r.add(o.name);const i=pu(o.type).base;In(i!==s,`circular type reference to ${JSON.stringify(i)}`,"types",e),!du(i)&&(In(n.has(i),`unknown type ${JSON.stringify(i)}`,"types",e),n.get(i).push(s),t.get(s).add(i))}}const o=Array.from(n.keys()).filter(e=>0===n.get(e).length);In(0!==o.length,"missing primary type","types",e),In(1===o.length,`ambiguous primary types or unused types: ${o.map(e=>JSON.stringify(e)).join(", ")}`,"types",e),Rn(this,{primaryType:o[0]}),function i(o,s){In(!s.has(o),`circular type reference to ${JSON.stringify(o)}`,"types",e),s.add(o);for(const e of t.get(o))if(n.has(e)){i(e,s);for(const t of s)r.get(t).add(e)}s.delete(o)}(this.primaryType,new Set);for(const[s,a]of r){const e=Array.from(a);e.sort(),wn(this,Ee).set(s,fu(s,i[s])+e.map(e=>fu(e,i[e])).join(""))}}get types(){return JSON.parse(wn(this,Oe))}getEncoder(e){let t=wn(this,_e).get(e);return t||(t=En(this,Ce,Ne).call(this,e),wn(this,_e).set(e,t)),t}encodeType(e){const t=wn(this,Ee).get(e);return In(t,`unknown type: ${JSON.stringify(e)}`,"name",e),t}encodeData(e,t){return this.getEncoder(e)(t)}hashStruct(e,t){return So(this.encodeData(e,t))}encode(e){return this.encodeData(this.primaryType,e)}hash(e){return this.hashStruct(this.primaryType,e)}_visit(e,t,n){if(du(e))return n(e,t);const r=pu(e).array;if(r)return In(-1===r.count||r.count===t.length,`array length mismatch; expected length ${r.count}`,"value",t),t.map(e=>this._visit(r.prefix,e,n));const i=this.types[e];if(i)return i.reduce((e,{name:r,type:i})=>(e[r]=this._visit(i,t[r],n),e),{});In(!1,`unknown type: ${e}`,"type",e)}visit(e,t){return this._visit(this.primaryType,e,t)}static from(t){return new e(t)}static getPrimaryType(t){return e.from(t).primaryType}static hashStruct(t,n,r){return e.from(n).hashStruct(t,r)}static hashDomain(t){const n=[];for(const e in t){if(null==t[e])continue;const r=cu[e];In(r,`invalid typed-data domain key: ${JSON.stringify(e)}`,"domain",t),n.push({name:e,type:r})}return n.sort((e,t)=>lu.indexOf(e.name)-lu.indexOf(t.name)),e.hashStruct("EIP712Domain",{EIP712Domain:n},t)}static encode(t,n,r){return Xn(["0x1901",e.hashDomain(t),e.from(n).hash(r)])}static hash(t,n,r){return So(e.encode(t,n,r))}static async resolveNames(t,n,r,i){t=Object.assign({},t);for(const e in t)null==t[e]&&delete t[e];const o={};t.verifyingContract&&!Bn(t.verifyingContract,20)&&(o[t.verifyingContract]="0x");const s=e.from(n);s.visit(r,(e,t)=>("address"===e&&!Bn(t,20)&&(o[t]="0x"),t));for(const e in o)o[e]=await i(e);return t.verifyingContract&&o[t.verifyingContract]&&(t.verifyingContract=o[t.verifyingContract]),{domain:t,value:r=s.visit(r,(e,t)=>"address"===e&&o[t]?o[t]:t)}}static getPayload(t,n,r){e.hashDomain(t);const i={},o=[];lu.forEach(e=>{const n=t[e];null!=n&&(i[e]=hu[e](n),o.push({name:e,type:cu[e]}))});const s=e.from(n);n=s.types;const a=Object.assign({},n);return In(null==a.EIP712Domain,"types must not contain EIP712Domain type","types.EIP712Domain",n),a.EIP712Domain=o,s.encode(r),{types:a,domain:i,primaryType:s.primaryType,message:s.visit(r,(e,t)=>{if(e.match(/^bytes(\d*)/))return Wn(Ln(t));if(e.match(/^u?int/))return tr(t).toString();switch(e){case"address":return t.toLowerCase();case"bool":return!!t;case"string":return In("string"==typeof t,"invalid string","value",t),t}In(!1,"unsupported type","type",e)})}}};function mu(e){const t=new Set;return e.forEach(e=>t.add(e)),Object.freeze(t)}const yu=mu("external public payable override".split(" ")),vu="constant external internal payable private public pure view override",wu=mu(vu.split(" ")),bu="constructor error event fallback function receive struct",Ou=mu(bu.split(" ")),Eu="calldata memory storage payable indexed",_u=mu(Eu.split(" ")),Cu=mu([bu,Eu,"tuple returns",vu].join(" ").split(" ")),Nu={"(":"OPEN_PAREN",")":"CLOSE_PAREN","[":"OPEN_BRACKET","]":"CLOSE_BRACKET",",":"COMMA","@":"AT"},Au=new RegExp("^(\\s*)"),Ru=new RegExp("^([0-9]+)"),Su=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)"),Tu=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)$"),Pu=new RegExp("^(address|bool|bytes([0-9]*)|string|u?int([0-9]*))$"),Du=class e{constructor(e){bn(this,Se),bn(this,Ae),bn(this,Re),On(this,Ae,0),On(this,Re,e.slice())}get offset(){return wn(this,Ae)}get length(){return wn(this,Re).length-wn(this,Ae)}clone(){return new e(wn(this,Re))}reset(){On(this,Ae,0)}popKeyword(e){const t=this.peek();if("KEYWORD"!==t.type||!e.has(t.text))throw new Error(`expected keyword ${t.text}`);return this.pop().text}popType(e){if(this.peek().type!==e){const t=this.peek();throw new Error(`expected ${e}; got ${t.type} ${JSON.stringify(t.text)}`)}return this.pop().text}popParen(){const e=this.peek();if("OPEN_PAREN"!==e.type)throw new Error("bad start");const t=En(this,Se,Te).call(this,wn(this,Ae)+1,e.match+1);return On(this,Ae,e.match+1),t}popParams(){const e=this.peek();if("OPEN_PAREN"!==e.type)throw new Error("bad start");const t=[];for(;wn(this,Ae)<e.match-1;){const e=this.peek().linkNext;t.push(En(this,Se,Te).call(this,wn(this,Ae)+1,e)),On(this,Ae,e)}return On(this,Ae,e.match+1),t}peek(){if(wn(this,Ae)>=wn(this,Re).length)throw new Error("out-of-bounds");return wn(this,Re)[wn(this,Ae)]}peekKeyword(e){const t=this.peekType("KEYWORD");return null!=t&&e.has(t)?t:null}peekType(e){if(0===this.length)return null;const t=this.peek();return t.type===e?t.text:null}pop(){const e=this.peek();return _n(this,Ae)._++,e}toString(){const e=[];for(let t=wn(this,Ae);t<wn(this,Re).length;t++){const n=wn(this,Re)[t];e.push(`${n.type}:${n.text}`)}return`<TokenString ${e.join(" ")}>`}};Ae=new WeakMap,Re=new WeakMap,Se=new WeakSet,Te=function(e=0,t=0){return new Du(wn(this,Re).slice(e,t).map(t=>Object.freeze(Object.assign({},t,{match:t.match-e,linkBack:t.linkBack-e,linkNext:t.linkNext-e}))))};let ku=Du;function Iu(e){const t=[],n=t=>{const n=o<e.length?JSON.stringify(e[o]):"$EOI";throw new Error(`invalid token ${n} at ${o}: ${t}`)};let r=[],i=[],o=0;for(;o<e.length;){let s=e.substring(o),a=s.match(Au);a&&(o+=a[1].length,s=e.substring(o));const c={depth:r.length,linkBack:-1,linkNext:-1,match:-1,type:"",text:"",offset:o,value:-1};t.push(c);let l=Nu[s[0]]||"";if(l){if(c.type=l,c.text=s[0],o++,"OPEN_PAREN"===l)r.push(t.length-1),i.push(t.length-1);else if("CLOSE_PAREN"==l)0===r.length&&n("no matching open bracket"),c.match=r.pop(),t[c.match].match=t.length-1,c.depth--,c.linkBack=i.pop(),t[c.linkBack].linkNext=t.length-1;else if("COMMA"===l)c.linkBack=i.pop(),t[c.linkBack].linkNext=t.length-1,i.push(t.length-1);else if("OPEN_BRACKET"===l)c.type="BRACKET";else if("CLOSE_BRACKET"===l){let e=t.pop().text;if(t.length>0&&"NUMBER"===t[t.length-1].type){const n=t.pop().text;e=n+e,t[t.length-1].value=or(n)}if(0===t.length||"BRACKET"!==t[t.length-1].type)throw new Error("missing opening bracket");t[t.length-1].text+=e}}else if(a=s.match(Su)){if(c.text=a[1],o+=c.text.length,Cu.has(c.text)){c.type="KEYWORD";continue}if(c.text.match(Pu)){c.type="TYPE";continue}c.type="ID"}else{if(!(a=s.match(Ru)))throw new Error(`unexpected token ${JSON.stringify(s[0])} at position ${o}`);c.text=a[1],c.type="NUMBER",o+=c.text.length}}return new ku(t.map(e=>Object.freeze(e)))}function xu(e,t){let n=[];for(const r in t.keys())e.has(r)&&n.push(r);if(n.length>1)throw new Error(`conflicting types: ${n.join(", ")}`)}function Mu(e,t){if(t.peekKeyword(Ou)){const n=t.pop().text;if(n!==e)throw new Error(`expected ${e}, got ${n}`)}return t.popType("ID")}function Ku(e,t){const n=new Set;for(;;){const r=e.peekType("KEYWORD");if(null==r||t&&!t.has(r))break;if(e.pop(),n.has(r))throw new Error(`duplicate keywords: ${JSON.stringify(r)}`);n.add(r)}return Object.freeze(n)}function Lu(e){let t=Ku(e,wu);return xu(t,mu("constant payable nonpayable".split(" "))),xu(t,mu("pure view payable nonpayable".split(" "))),t.has("view")?"view":t.has("pure")?"pure":t.has("payable")?"payable":t.has("nonpayable")?"nonpayable":t.has("constant")?"view":"nonpayable"}function Uu(e,t){return e.popParams().map(e=>Yu.from(e,t))}function Bu(e){if(e.peekType("AT")){if(e.pop(),e.peekType("NUMBER"))return tr(e.pop().text);throw new Error("invalid gas")}return null}function ju(e){if(e.length)throw new Error(`unexpected tokens at offset ${e.offset}: ${e.toString()}`)}const Hu=new RegExp(/^(.*)\[([0-9]*)\]$/);function Wu(e){const t=e.match(Pu);if(In(t,"invalid type","type",e),"uint"===e)return"uint256";if("int"===e)return"int256";if(t[2]){const n=parseInt(t[2]);In(0!==n&&n<=32,"invalid bytes length","type",e)}else if(t[3]){const n=parseInt(t[3]);In(0!==n&&n<=256&&n%8==0,"invalid numeric width","type",e)}return e}const Xu={},Fu=Symbol.for("_ethers_internal"),Ju="_ParamTypeInternal",Gu="_ErrorInternal",qu="_EventInternal",Vu="_ConstructorInternal",zu="_FallbackInternal",Qu="_FunctionInternal",$u="_StructInternal";Pe=new WeakSet,De=function(e,t,n,r){if(this.isArray()){if(!Array.isArray(t))throw new Error("invalid array value");if(-1!==this.arrayLength&&t.length!==this.arrayLength)throw new Error("array is wrong length");const i=this.arrayChildren,o=t.slice();return o.forEach((t,r)=>{var s;En(s=i,Pe,De).call(s,e,t,n,e=>{o[r]=e})}),void r(o)}if(this.isTuple()){const i=this.components;let o;if(Array.isArray(t))o=t.slice();else{if(null==t||"object"!=typeof t)throw new Error("invalid tuple value");o=i.map(e=>{if(!e.name)throw new Error("cannot use object value with unnamed components");if(!(e.name in t))throw new Error(`missing value for component ${e.name}`);return t[e.name]})}if(o.length!==this.components.length)throw new Error("array is wrong length");return o.forEach((t,r)=>{var s;En(s=i[r],Pe,De).call(s,e,t,n,e=>{o[r]=e})}),void r(o)}const i=n(this.type,t);i.then?e.push(async function(){r(await i)}()):r(i)};let Yu=class e{constructor(e,t,n,r,i,o,s,a){if(bn(this,Pe),yn(this,"name"),yn(this,"type"),yn(this,"baseType"),yn(this,"indexed"),yn(this,"components"),yn(this,"arrayLength"),yn(this,"arrayChildren"),Mn(e,Xu,"ParamType"),Object.defineProperty(this,Fu,{value:Ju}),o&&(o=Object.freeze(o.slice())),"array"===r){if(null==s||null==a)throw new Error("")}else if(null!=s||null!=a)throw new Error("");if("tuple"===r){if(null==o)throw new Error("")}else if(null!=o)throw new Error("");Rn(this,{name:t,type:n,baseType:r,indexed:i,components:o,arrayLength:s,arrayChildren:a})}format(e){if(null==e&&(e="sighash"),"json"===e){const t=this.name||"";if(this.isArray()){const e=JSON.parse(this.arrayChildren.format("json"));return e.name=t,e.type+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`,JSON.stringify(e)}const n={type:"tuple"===this.baseType?"tuple":this.type,name:t};return"boolean"==typeof this.indexed&&(n.indexed=this.indexed),this.isTuple()&&(n.components=this.components.map(t=>JSON.parse(t.format(e)))),JSON.stringify(n)}let t="";return this.isArray()?(t+=this.arrayChildren.format(e),t+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`):this.isTuple()?t+="("+this.components.map(t=>t.format(e)).join("full"===e?", ":",")+")":t+=this.type,"sighash"!==e&&(!0===this.indexed&&(t+=" indexed"),"full"===e&&this.name&&(t+=" "+this.name)),t}isArray(){return"array"===this.baseType}isTuple(){return"tuple"===this.baseType}isIndexable(){return null!=this.indexed}walk(e,t){if(this.isArray()){if(!Array.isArray(e))throw new Error("invalid array value");if(-1!==this.arrayLength&&e.length!==this.arrayLength)throw new Error("array is wrong length");const n=this;return e.map(e=>n.arrayChildren.walk(e,t))}if(this.isTuple()){if(!Array.isArray(e))throw new Error("invalid tuple value");if(e.length!==this.components.length)throw new Error("array is wrong length");const n=this;return e.map((e,r)=>n.components[r].walk(e,t))}return t(this.type,e)}async walkAsync(e,t){const n=[],r=[e];return En(this,Pe,De).call(this,n,e,t,e=>{r[0]=e}),n.length&&await Promise.all(n),r[0]}static from(t,n){if(e.isParamType(t))return t;if("string"==typeof t)try{return e.from(Iu(t),n)}catch{In(!1,"invalid param type","obj",t)}else if(t instanceof ku){let r="",i="",o=null;Ku(t,mu(["tuple"])).has("tuple")||t.peekType("OPEN_PAREN")?(i="tuple",r=`tuple(${(o=t.popParams().map(t=>e.from(t))).map(e=>e.format()).join(",")})`):i=r=Wu(t.popType("TYPE"));let s=null,a=null;for(;t.length&&t.peekType("BRACKET");){const n=t.pop();s=new e(Xu,"",r,i,null,o,a,s),a=n.value,r+=n.text,i="array",o=null}let c=null;if(Ku(t,_u).has("indexed")){if(!n)throw new Error("");c=!0}const l=t.peekType("ID")?t.pop().text:"";if(t.length)throw new Error("leftover tokens");return new e(Xu,l,r,i,c,o,a,s)}const r=t.name;In(!r||"string"==typeof r&&r.match(Tu),"invalid name","obj.name",r);let i=t.indexed;null!=i&&(In(n,"parameter cannot be indexed","obj.indexed",t.indexed),i=!!i);let o=t.type,s=o.match(Hu);if(s){const n=parseInt(s[2]||"-1"),a=e.from({type:s[1],components:t.components});return new e(Xu,r||"",o,"array",i,null,n,a)}if("tuple"===o||o.startsWith("tuple(")||o.startsWith("(")){const n=null!=t.components?t.components.map(t=>e.from(t)):null;return new e(Xu,r||"",o,"tuple",i,n,null,null)}return o=Wu(t.type),new e(Xu,r||"",o,o,i,null,null,null)}static isParamType(e){return e&&e[Fu]===Ju}};class Zu{constructor(e,t,n){yn(this,"type"),yn(this,"inputs"),Mn(e,Xu,"Fragment"),Rn(this,{type:t,inputs:n=Object.freeze(n.slice())})}static from(e){if("string"==typeof e){try{Zu.from(JSON.parse(e))}catch{}return Zu.from(Iu(e))}if(e instanceof ku)switch(e.peekKeyword(Ou)){case"constructor":return ih.from(e);case"error":return nh.from(e);case"event":return rh.from(e);case"fallback":case"receive":return oh.from(e);case"function":return sh.from(e);case"struct":return ah.from(e)}else if("object"==typeof e){switch(e.type){case"constructor":return ih.from(e);case"error":return nh.from(e);case"event":return rh.from(e);case"fallback":case"receive":return oh.from(e);case"function":return sh.from(e);case"struct":return ah.from(e)}kn(!1,`unsupported type: ${e.type}`,"UNSUPPORTED_OPERATION",{operation:"Fragment.from"})}In(!1,"unsupported frgament object","obj",e)}static isConstructor(e){return ih.isFragment(e)}static isError(e){return nh.isFragment(e)}static isEvent(e){return rh.isFragment(e)}static isFunction(e){return sh.isFragment(e)}static isStruct(e){return ah.isFragment(e)}}class eh extends Zu{constructor(e,t,n,r){super(e,t,r),yn(this,"name"),In("string"==typeof n&&n.match(Tu),"invalid identifier","name",n),r=Object.freeze(r.slice()),Rn(this,{name:n})}}function th(e,t){return"("+t.map(t=>t.format(e)).join("full"===e?", ":",")+")"}class nh extends eh{constructor(e,t,n){super(e,"error",t,n),Object.defineProperty(this,Fu,{value:Gu})}get selector(){return mc(this.format("sighash")).substring(0,10)}format(e){if(null==e&&(e="sighash"),"json"===e)return JSON.stringify({type:"error",name:this.name,inputs:this.inputs.map(t=>JSON.parse(t.format(e)))});const t=[];return"sighash"!==e&&t.push("error"),t.push(this.name+th(e,this.inputs)),t.join(" ")}static from(e){if(nh.isFragment(e))return e;if("string"==typeof e)return nh.from(Iu(e));if(e instanceof ku){const t=Mu("error",e),n=Uu(e);return ju(e),new nh(Xu,t,n)}return new nh(Xu,e.name,e.inputs?e.inputs.map(Yu.from):[])}static isFragment(e){return e&&e[Fu]===Gu}}class rh extends eh{constructor(e,t,n,r){super(e,"event",t,n),yn(this,"anonymous"),Object.defineProperty(this,Fu,{value:qu}),Rn(this,{anonymous:r})}get topicHash(){return mc(this.format("sighash"))}format(e){if(null==e&&(e="sighash"),"json"===e)return JSON.stringify({type:"event",anonymous:this.anonymous,name:this.name,inputs:this.inputs.map(t=>JSON.parse(t.format(e)))});const t=[];return"sighash"!==e&&t.push("event"),t.push(this.name+th(e,this.inputs)),"sighash"!==e&&this.anonymous&&t.push("anonymous"),t.join(" ")}static getTopicHash(e,t){return t=(t||[]).map(e=>Yu.from(e)),new rh(Xu,e,t,!1).topicHash}static from(e){if(rh.isFragment(e))return e;if("string"==typeof e)try{return rh.from(Iu(e))}catch{In(!1,"invalid event fragment","obj",e)}else if(e instanceof ku){const t=Mu("event",e),n=Uu(e,!0),r=!!Ku(e,mu(["anonymous"])).has("anonymous");return ju(e),new rh(Xu,t,n,r)}return new rh(Xu,e.name,e.inputs?e.inputs.map(e=>Yu.from(e,!0)):[],!!e.anonymous)}static isFragment(e){return e&&e[Fu]===qu}}class ih extends Zu{constructor(e,t,n,r,i){super(e,t,n),yn(this,"payable"),yn(this,"gas"),Object.defineProperty(this,Fu,{value:Vu}),Rn(this,{payable:r,gas:i})}format(e){if(kn(null!=e&&"sighash"!==e,"cannot format a constructor for sighash","UNSUPPORTED_OPERATION",{operation:"format(sighash)"}),"json"===e)return JSON.stringify({type:"constructor",stateMutability:this.payable?"payable":"undefined",payable:this.payable,gas:null!=this.gas?this.gas:void 0,inputs:this.inputs.map(t=>JSON.parse(t.format(e)))});const t=[`constructor${th(e,this.inputs)}`];return this.payable&&t.push("payable"),null!=this.gas&&t.push(`@${this.gas.toString()}`),t.join(" ")}static from(e){if(ih.isFragment(e))return e;if("string"==typeof e)try{return ih.from(Iu(e))}catch{In(!1,"invalid constuctor fragment","obj",e)}else if(e instanceof ku){Ku(e,mu(["constructor"]));const t=Uu(e),n=!!Ku(e,yu).has("payable"),r=Bu(e);return ju(e),new ih(Xu,"constructor",t,n,r)}return new ih(Xu,"constructor",e.inputs?e.inputs.map(Yu.from):[],!!e.payable,null!=e.gas?e.gas:null)}static isFragment(e){return e&&e[Fu]===Vu}}class oh extends Zu{constructor(e,t,n){super(e,"fallback",t),yn(this,"payable"),Object.defineProperty(this,Fu,{value:zu}),Rn(this,{payable:n})}format(e){const t=0===this.inputs.length?"receive":"fallback";if("json"===e){const e=this.payable?"payable":"nonpayable";return JSON.stringify({type:t,stateMutability:e})}return`${t}()${this.payable?" payable":""}`}static from(e){if(oh.isFragment(e))return e;if("string"==typeof e)try{return oh.from(Iu(e))}catch{In(!1,"invalid fallback fragment","obj",e)}else if(e instanceof ku){const t=e.toString();if(In(e.peekKeyword(mu(["fallback","receive"])),"type must be fallback or receive","obj",t),"receive"===e.popKeyword(mu(["fallback","receive"]))){const t=Uu(e);return In(0===t.length,"receive cannot have arguments","obj.inputs",t),Ku(e,mu(["payable"])),ju(e),new oh(Xu,[],!0)}let n=Uu(e);n.length?In(1===n.length&&"bytes"===n[0].type,"invalid fallback inputs","obj.inputs",n.map(e=>e.format("minimal")).join(", ")):n=[Yu.from("bytes")];const r=Lu(e);if(In("nonpayable"===r||"payable"===r,"fallback cannot be constants","obj.stateMutability",r),Ku(e,mu(["returns"])).has("returns")){const t=Uu(e);In(1===t.length&&"bytes"===t[0].type,"invalid fallback outputs","obj.outputs",t.map(e=>e.format("minimal")).join(", "))}return ju(e),new oh(Xu,n,"payable"===r)}if("receive"===e.type)return new oh(Xu,[],!0);if("fallback"===e.type){const t=[Yu.from("bytes")],n="payable"===e.stateMutability;return new oh(Xu,t,n)}In(!1,"invalid fallback description","obj",e)}static isFragment(e){return e&&e[Fu]===zu}}class sh extends eh{constructor(e,t,n,r,i,o){super(e,"function",t,r),yn(this,"constant"),yn(this,"outputs"),yn(this,"stateMutability"),yn(this,"payable"),yn(this,"gas"),Object.defineProperty(this,Fu,{value:Qu}),Rn(this,{constant:"view"===n||"pure"===n,gas:o,outputs:i=Object.freeze(i.slice()),payable:"payable"===n,stateMutability:n})}get selector(){return mc(this.format("sighash")).substring(0,10)}format(e){if(null==e&&(e="sighash"),"json"===e)return JSON.stringify({type:"function",name:this.name,constant:this.constant,stateMutability:"nonpayable"!==this.stateMutability?this.stateMutability:void 0,payable:this.payable,gas:null!=this.gas?this.gas:void 0,inputs:this.inputs.map(t=>JSON.parse(t.format(e))),outputs:this.outputs.map(t=>JSON.parse(t.format(e)))});const t=[];return"sighash"!==e&&t.push("function"),t.push(this.name+th(e,this.inputs)),"sighash"!==e&&("nonpayable"!==this.stateMutability&&t.push(this.stateMutability),this.outputs&&this.outputs.length&&(t.push("returns"),t.push(th(e,this.outputs))),null!=this.gas&&t.push(`@${this.gas.toString()}`)),t.join(" ")}static getSelector(e,t){return t=(t||[]).map(e=>Yu.from(e)),new sh(Xu,e,"view",t,[],null).selector}static from(e){if(sh.isFragment(e))return e;if("string"==typeof e)try{return sh.from(Iu(e))}catch{In(!1,"invalid function fragment","obj",e)}else if(e instanceof ku){const t=Mu("function",e),n=Uu(e),r=Lu(e);let i=[];Ku(e,mu(["returns"])).has("returns")&&(i=Uu(e));const o=Bu(e);return ju(e),new sh(Xu,t,r,n,i,o)}let t=e.stateMutability;return null==t&&(t="payable","boolean"==typeof e.constant?(t="view",e.constant||(t="payable","boolean"==typeof e.payable&&!e.payable&&(t="nonpayable"))):"boolean"==typeof e.payable&&!e.payable&&(t="nonpayable")),new sh(Xu,e.name,t,e.inputs?e.inputs.map(Yu.from):[],e.outputs?e.outputs.map(Yu.from):[],null!=e.gas?e.gas:null)}static isFragment(e){return e&&e[Fu]===Qu}}class ah extends eh{constructor(e,t,n){super(e,"struct",t,n),Object.defineProperty(this,Fu,{value:$u})}format(){throw new Error("@TODO")}static from(e){if("string"==typeof e)try{return ah.from(Iu(e))}catch{In(!1,"invalid struct fragment","obj",e)}else if(e instanceof ku){const t=Mu("struct",e),n=Uu(e);return ju(e),new ah(Xu,t,n)}return new ah(Xu,e.name,e.inputs?e.inputs.map(Yu.from):[])}static isFragment(e){return e&&e[Fu]===$u}}const ch=new Map;ch.set(0,"GENERIC_PANIC"),ch.set(1,"ASSERT_FALSE"),ch.set(17,"OVERFLOW"),ch.set(18,"DIVIDE_BY_ZERO"),ch.set(33,"ENUM_RANGE_ERROR"),ch.set(34,"BAD_STORAGE_DATA"),ch.set(49,"STACK_UNDERFLOW"),ch.set(50,"ARRAY_RANGE_ERROR"),ch.set(65,"OUT_OF_MEMORY"),ch.set(81,"UNINITIALIZED_FUNCTION_CALL");const lh=new RegExp(/^bytes([0-9]*)$/),uh=new RegExp(/^(u?int)([0-9]*)$/);let hh=null,dh=1024;function fh(e,t,n,r){let i="missing revert data",o=null,s=null;if(n){i="execution reverted";const e=Ln(n);if(n=Wn(n),0===e.length)i+=" (no data present; likely require(false) occurred",o="require(false)";else if(e.length%32!=4)i+=" (could not decode reason; invalid data length)";else if("0x08c379a0"===Wn(e.slice(0,4)))try{s={signature:"Error(string)",name:"Error",args:[o=r.decode(["string"],e.slice(4))[0]]},i+=`: ${JSON.stringify(o)}`}catch{i+=" (could not decode reason; invalid string data)"}else if("0x4e487b71"===Wn(e.slice(0,4)))try{const t=Number(r.decode(["uint256"],e.slice(4))[0]);s={signature:"Panic(uint256)",name:"Panic",args:[t]},i+=`: ${o=`Panic due to ${ch.get(t)||"UNKNOWN"}(${t})`}`}catch{i+=" (could not decode panic code)"}else i+=" (unknown custom error)"}const a={to:t.to?ua(t.to):null,data:t.data||"0x"};return t.from&&(a.from=ua(t.from)),Dn(i,"CALL_EXCEPTION",{action:e,data:n,reason:o,transaction:a,invocation:null,revert:s})}ke=new WeakSet,Ie=function(e){if(e.isArray())return new Ca(En(this,ke,Ie).call(this,e.arrayChildren),e.arrayLength,e.name);if(e.isTuple())return new Ka(e.components.map(e=>En(this,ke,Ie).call(this,e)),e.name);switch(e.baseType){case"address":return new ba(e.name);case"bool":return new Na(e.name);case"string":return new Ma(e.name);case"bytes":return new Ra(e.name);case"":return new Pa(e.name)}let t=e.type.match(uh);if(t){let n=parseInt(t[2]||"256");return In(0!==n&&n<=256&&n%8==0,"invalid "+t[1]+" bit length","param",e),new xa(n/8,"int"===t[1],e.name)}if(t=e.type.match(lh)){let n=parseInt(t[1]);return In(0!==n&&n<=32,"invalid bytes length","param",e),new Sa(n,e.name)}In(!1,"invalid type","type",e.type)};let ph=class e{constructor(){bn(this,ke)}getDefaultValue(e){const t=e.map(e=>En(this,ke,Ie).call(this,Yu.from(e)));return new Ka(t,"_").defaultValue()}encode(e,t){xn(t.length,e.length,"types/values length mismatch");const n=e.map(e=>En(this,ke,Ie).call(this,Yu.from(e))),r=new Ka(n,"_"),i=new yi;return r.encode(i,t),i.data}decode(e,t,n){const r=e.map(e=>En(this,ke,Ie).call(this,Yu.from(e)));return new Ka(r,"_").decode(new class e{constructor(e,t,n){bn(this,q),yn(this,"allowLoose"),bn(this,W),bn(this,X),bn(this,F),bn(this,J),bn(this,G),Rn(this,{allowLoose:!!t}),On(this,W,Un(e)),On(this,F,0),On(this,J,null),On(this,G,null!=n?n:1024),On(this,X,0)}get data(){return Wn(wn(this,W))}get dataLength(){return wn(this,W).length}get consumed(){return wn(this,X)}get bytes(){return new Uint8Array(wn(this,W))}subReader(t){const n=new e(wn(this,W).slice(wn(this,X)+t),this.allowLoose,wn(this,G));return On(n,J,this),n}readBytes(e,t){let n=En(this,q,z).call(this,0,e,!!t);return En(this,q,V).call(this,e),On(this,X,wn(this,X)+n.length),n.slice(0,e)}readValue(){return ir(this.readBytes(oi))}readIndex(){return or(ir(this.readBytes(oi)))}}(t,n,dh))}static _setDefaultMaxInflation(e){In("number"==typeof e&&Number.isInteger(e),"invalid defaultMaxInflation factor","value",e),dh=e}static defaultAbiCoder(){return null==hh&&(hh=new e),hh}static getBuiltinCallException(t,n,r){return fh(t,n,r,e.defaultAbiCoder())}};class gh{constructor(e,t,n){yn(this,"fragment"),yn(this,"name"),yn(this,"signature"),yn(this,"topic"),yn(this,"args");const r=e.name,i=e.format();Rn(this,{fragment:e,name:r,signature:i,topic:t,args:n})}}class mh{constructor(e,t,n,r){yn(this,"fragment"),yn(this,"name"),yn(this,"args"),yn(this,"signature"),yn(this,"selector"),yn(this,"value");const i=e.name,o=e.format();Rn(this,{fragment:e,name:i,args:n,signature:o,selector:t,value:r})}}class yh{constructor(e,t,n){yn(this,"fragment"),yn(this,"name"),yn(this,"args"),yn(this,"signature"),yn(this,"selector");const r=e.name,i=e.format();Rn(this,{fragment:e,name:r,args:n,signature:i,selector:t})}}class vh{constructor(e){yn(this,"hash"),yn(this,"_isIndexed"),Rn(this,{hash:e,_isIndexed:!0})}static isIndexed(e){return!(!e||!e._isIndexed)}}const wh={0:"generic panic",1:"assert(false)",17:"arithmetic overflow",18:"division or modulo by zero",33:"enum overflow",34:"invalid encoded storage byte array accessed",49:"out-of-bounds array access; popping on an empty array",50:"out-of-bounds access of an array or bytesN",65:"out of memory",81:"uninitialized function"},bh={"0x08c379a0":{signature:"Error(string)",name:"Error",inputs:["string"],reason:e=>`reverted with reason string ${JSON.stringify(e)}`},"0x4e487b71":{signature:"Panic(uint256)",name:"Panic",inputs:["uint256"],reason:e=>{let t="unknown panic code";return e>=0&&e<=255&&wh[e.toString()]&&(t=wh[e.toString()]),`reverted with panic code 0x${e.toString(16)} (${t})`}}};xe=new WeakMap,Me=new WeakMap,Ke=new WeakMap,Le=new WeakMap,Ue=new WeakSet,Be=function(e,t,n){if(Bn(e)){const t=e.toLowerCase();for(const e of wn(this,Ke).values())if(t===e.selector)return e;return null}if(-1===e.indexOf("(")){const r=[];for(const[t,n]of wn(this,Ke))t.split("(")[0]===e&&r.push(n);if(t){const e=t.length>0?t[t.length-1]:null;let n=t.length,i=!0;wa.isTyped(e)&&"overrides"===e.type&&(i=!1,n--);for(let t=r.length-1;t>=0;t--){const e=r[t].inputs.length;e!==n&&(!i||e!==n-1)&&r.splice(t,1)}for(let o=r.length-1;o>=0;o--){const e=r[o].inputs;for(let n=0;n<t.length;n++)if(wa.isTyped(t[n])){if(n>=e.length){if("overrides"===t[n].type)continue;r.splice(o,1);break}if(t[n].type!==e[n].baseType){r.splice(o,1);break}}}}if(1===r.length&&t&&t.length!==r[0].inputs.length){const e=t[t.length-1];(null==e||Array.isArray(e)||"object"!=typeof e)&&r.splice(0,1)}return 0===r.length?null:(r.length>1&&n&&In(!1,`ambiguous function description (i.e. matches ${r.map(e=>JSON.stringify(e.format())).join(", ")})`,"key",e),r[0])}return wn(this,Ke).get(sh.from(e).format())||null},je=function(e,t,n){if(Bn(e)){const t=e.toLowerCase();for(const e of wn(this,Me).values())if(t===e.topicHash)return e;return null}if(-1===e.indexOf("(")){const r=[];for(const[t,n]of wn(this,Me))t.split("(")[0]===e&&r.push(n);if(t){for(let e=r.length-1;e>=0;e--)r[e].inputs.length<t.length&&r.splice(e,1);for(let e=r.length-1;e>=0;e--){const n=r[e].inputs;for(let i=0;i<t.length;i++)if(wa.isTyped(t[i])&&t[i].type!==n[i].baseType){r.splice(e,1);break}}}return 0===r.length?null:(r.length>1&&n&&In(!1,`ambiguous event description (i.e. matches ${r.map(e=>JSON.stringify(e.format())).join(", ")})`,"key",e),r[0])}return wn(this,Me).get(rh.from(e).format())||null};const Oh=BigInt(0);function Eh(e){return null==e?null:e}function _h(e){return null==e?null:e.toString()}class Ch{constructor(e,t,n){yn(this,"gasPrice"),yn(this,"maxFeePerGas"),yn(this,"maxPriorityFeePerGas"),Rn(this,{gasPrice:Eh(e),maxFeePerGas:Eh(t),maxPriorityFeePerGas:Eh(n)})}toJSON(){const{gasPrice:e,maxFeePerGas:t,maxPriorityFeePerGas:n}=this;return{_type:"FeeData",gasPrice:_h(e),maxFeePerGas:_h(t),maxPriorityFeePerGas:_h(n)}}}function Nh(e){const t={};e.to&&(t.to=e.to),e.from&&(t.from=e.from),e.data&&(t.data=Wn(e.data));const n="chainId,gasLimit,gasPrice,maxFeePerBlobGas,maxFeePerGas,maxPriorityFeePerGas,value".split(/,/);for(const i of n)!(i in e)||null==e[i]||(t[i]=tr(e[i],`request.${i}`));const r="type,nonce".split(/,/);for(const i of r)!(i in e)||null==e[i]||(t[i]=or(e[i],`request.${i}`));return e.accessList&&(t.accessList=Ua(e.accessList)),e.authorizationList&&(t.authorizationList=e.authorizationList.slice()),"blockTag"in e&&(t.blockTag=e.blockTag),"enableCcipRead"in e&&(t.enableCcipRead=!!e.enableCcipRead),"customData"in e&&(t.customData=e.customData),"blobVersionedHashes"in e&&e.blobVersionedHashes&&(t.blobVersionedHashes=e.blobVersionedHashes.slice()),"kzg"in e&&(t.kzg=e.kzg),"blobs"in e&&e.blobs&&(t.blobs=e.blobs.map(e=>jn(e)?Wn(e):Object.assign({},e))),t}class Ah{constructor(e,t){yn(this,"provider"),yn(this,"number"),yn(this,"hash"),yn(this,"timestamp"),yn(this,"parentHash"),yn(this,"parentBeaconBlockRoot"),yn(this,"nonce"),yn(this,"difficulty"),yn(this,"gasLimit"),yn(this,"gasUsed"),yn(this,"stateRoot"),yn(this,"receiptsRoot"),yn(this,"blobGasUsed"),yn(this,"excessBlobGas"),yn(this,"miner"),yn(this,"prevRandao"),yn(this,"extraData"),yn(this,"baseFeePerGas"),bn(this,He),On(this,He,e.transactions.map(e=>"string"!=typeof e?new Th(e,t):e)),Rn(this,{provider:t,hash:Eh(e.hash),number:e.number,timestamp:e.timestamp,parentHash:e.parentHash,parentBeaconBlockRoot:e.parentBeaconBlockRoot,nonce:e.nonce,difficulty:e.difficulty,gasLimit:e.gasLimit,gasUsed:e.gasUsed,blobGasUsed:e.blobGasUsed,excessBlobGas:e.excessBlobGas,miner:e.miner,prevRandao:Eh(e.prevRandao),extraData:e.extraData,baseFeePerGas:Eh(e.baseFeePerGas),stateRoot:e.stateRoot,receiptsRoot:e.receiptsRoot})}get transactions(){return wn(this,He).map(e=>"string"==typeof e?e:e.hash)}get prefetchedTransactions(){const e=wn(this,He).slice();return 0===e.length?[]:(kn("object"==typeof e[0],"transactions were not prefetched with block request","UNSUPPORTED_OPERATION",{operation:"transactionResponses()"}),e)}toJSON(){const{baseFeePerGas:e,difficulty:t,extraData:n,gasLimit:r,gasUsed:i,hash:o,miner:s,prevRandao:a,nonce:c,number:l,parentHash:u,parentBeaconBlockRoot:h,stateRoot:d,receiptsRoot:f,timestamp:p,transactions:g}=this;return{_type:"Block",baseFeePerGas:_h(e),difficulty:_h(t),extraData:n,gasLimit:_h(r),gasUsed:_h(i),blobGasUsed:_h(this.blobGasUsed),excessBlobGas:_h(this.excessBlobGas),hash:o,miner:s,prevRandao:a,nonce:c,number:l,parentHash:u,timestamp:p,parentBeaconBlockRoot:h,stateRoot:d,receiptsRoot:f,transactions:g}}[Symbol.iterator](){let e=0;const t=this.transactions;return{next:()=>e<this.length?{value:t[e++],done:!1}:{value:void 0,done:!0}}}get length(){return wn(this,He).length}get date(){return null==this.timestamp?null:new Date(1e3*this.timestamp)}async getTransaction(e){let t;if("number"==typeof e)t=wn(this,He)[e];else{const n=e.toLowerCase();for(const e of wn(this,He)){if("string"==typeof e){if(e!==n)continue;t=e;break}if(e.hash===n){t=e;break}}}if(null==t)throw new Error("no such tx");return"string"==typeof t?await this.provider.getTransaction(t):t}getPrefetchedTransaction(e){const t=this.prefetchedTransactions;if("number"==typeof e)return t[e];e=e.toLowerCase();for(const n of t)if(n.hash===e)return n;In(!1,"no matching transaction","indexOrHash",e)}isMined(){return!!this.hash}isLondon(){return!!this.baseFeePerGas}orphanedEvent(){if(!this.isMined())throw new Error("");return{orphan:"drop-block",hash:this.hash,number:this.number}}}He=new WeakMap;class Rh{constructor(e,t){yn(this,"provider"),yn(this,"transactionHash"),yn(this,"blockHash"),yn(this,"blockNumber"),yn(this,"removed"),yn(this,"address"),yn(this,"data"),yn(this,"topics"),yn(this,"index"),yn(this,"transactionIndex"),this.provider=t;const n=Object.freeze(e.topics.slice());Rn(this,{transactionHash:e.transactionHash,blockHash:e.blockHash,blockNumber:e.blockNumber,removed:e.removed,address:e.address,data:e.data,topics:n,index:e.index,transactionIndex:e.transactionIndex})}toJSON(){const{address:e,blockHash:t,blockNumber:n,data:r,index:i,removed:o,topics:s,transactionHash:a,transactionIndex:c}=this;return{_type:"log",address:e,blockHash:t,blockNumber:n,data:r,index:i,removed:o,topics:s,transactionHash:a,transactionIndex:c}}async getBlock(){const e=await this.provider.getBlock(this.blockHash);return kn(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransaction(){const e=await this.provider.getTransaction(this.transactionHash);return kn(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransactionReceipt(){const e=await this.provider.getTransactionReceipt(this.transactionHash);return kn(!!e,"failed to find transaction receipt","UNKNOWN_ERROR",{}),e}removedEvent(){return{orphan:"drop-log",log:{transactionHash:(e=this).transactionHash,blockHash:e.blockHash,blockNumber:e.blockNumber,address:e.address,data:e.data,topics:Object.freeze(e.topics.slice()),index:e.index}};var e}}class Sh{constructor(e,t){yn(this,"provider"),yn(this,"to"),yn(this,"from"),yn(this,"contractAddress"),yn(this,"hash"),yn(this,"index"),yn(this,"blockHash"),yn(this,"blockNumber"),yn(this,"logsBloom"),yn(this,"gasUsed"),yn(this,"blobGasUsed"),yn(this,"cumulativeGasUsed"),yn(this,"gasPrice"),yn(this,"blobGasPrice"),yn(this,"type"),yn(this,"status"),yn(this,"root"),bn(this,We),On(this,We,Object.freeze(e.logs.map(e=>new Rh(e,t))));let n=Oh;null!=e.effectiveGasPrice?n=e.effectiveGasPrice:null!=e.gasPrice&&(n=e.gasPrice),Rn(this,{provider:t,to:e.to,from:e.from,contractAddress:e.contractAddress,hash:e.hash,index:e.index,blockHash:e.blockHash,blockNumber:e.blockNumber,logsBloom:e.logsBloom,gasUsed:e.gasUsed,cumulativeGasUsed:e.cumulativeGasUsed,blobGasUsed:e.blobGasUsed,gasPrice:n,blobGasPrice:e.blobGasPrice,type:e.type,status:e.status,root:e.root})}get logs(){return wn(this,We)}toJSON(){const{to:e,from:t,contractAddress:n,hash:r,index:i,blockHash:o,blockNumber:s,logsBloom:a,logs:c,status:l,root:u}=this;return{_type:"TransactionReceipt",blockHash:o,blockNumber:s,contractAddress:n,cumulativeGasUsed:_h(this.cumulativeGasUsed),from:t,gasPrice:_h(this.gasPrice),blobGasUsed:_h(this.blobGasUsed),blobGasPrice:_h(this.blobGasPrice),gasUsed:_h(this.gasUsed),hash:r,index:i,logs:c,logsBloom:a,root:u,status:l,to:e}}get length(){return this.logs.length}[Symbol.iterator](){let e=0;return{next:()=>e<this.length?{value:this.logs[e++],done:!1}:{value:void 0,done:!0}}}get fee(){return this.gasUsed*this.gasPrice}async getBlock(){const e=await this.provider.getBlock(this.blockHash);if(null==e)throw new Error("TODO");return e}async getTransaction(){const e=await this.provider.getTransaction(this.hash);if(null==e)throw new Error("TODO");return e}async getResult(){return await this.provider.getTransactionResult(this.hash)}async confirmations(){return await this.provider.getBlockNumber()-this.blockNumber+1}removedEvent(){return Dh(this)}reorderedEvent(e){return kn(!e||e.isMined(),"unmined 'other' transction cannot be orphaned","UNSUPPORTED_OPERATION",{operation:"reorderedEvent(other)"}),Ph(this,e)}}We=new WeakMap,Xe=new WeakMap;let Th=class e{constructor(e,t){yn(this,"provider"),yn(this,"blockNumber"),yn(this,"blockHash"),yn(this,"index"),yn(this,"hash"),yn(this,"type"),yn(this,"to"),yn(this,"from"),yn(this,"nonce"),yn(this,"gasLimit"),yn(this,"gasPrice"),yn(this,"maxPriorityFeePerGas"),yn(this,"maxFeePerGas"),yn(this,"maxFeePerBlobGas"),yn(this,"data"),yn(this,"value"),yn(this,"chainId"),yn(this,"signature"),yn(this,"accessList"),yn(this,"blobVersionedHashes"),yn(this,"authorizationList"),bn(this,Xe),this.provider=t,this.blockNumber=null!=e.blockNumber?e.blockNumber:null,this.blockHash=null!=e.blockHash?e.blockHash:null,this.hash=e.hash,this.index=e.index,this.type=e.type,this.from=e.from,this.to=e.to||null,this.gasLimit=e.gasLimit,this.nonce=e.nonce,this.data=e.data,this.value=e.value,this.gasPrice=e.gasPrice,this.maxPriorityFeePerGas=null!=e.maxPriorityFeePerGas?e.maxPriorityFeePerGas:null,this.maxFeePerGas=null!=e.maxFeePerGas?e.maxFeePerGas:null,this.maxFeePerBlobGas=null!=e.maxFeePerBlobGas?e.maxFeePerBlobGas:null,this.chainId=e.chainId,this.signature=e.signature,this.accessList=null!=e.accessList?e.accessList:null,this.blobVersionedHashes=null!=e.blobVersionedHashes?e.blobVersionedHashes:null,this.authorizationList=null!=e.authorizationList?e.authorizationList:null,On(this,Xe,-1)}toJSON(){const{blockNumber:e,blockHash:t,index:n,hash:r,type:i,to:o,from:s,nonce:a,data:c,signature:l,accessList:u,blobVersionedHashes:h}=this;return{_type:"TransactionResponse",accessList:u,blockNumber:e,blockHash:t,blobVersionedHashes:h,chainId:_h(this.chainId),data:c,from:s,gasLimit:_h(this.gasLimit),gasPrice:_h(this.gasPrice),hash:r,maxFeePerGas:_h(this.maxFeePerGas),maxPriorityFeePerGas:_h(this.maxPriorityFeePerGas),maxFeePerBlobGas:_h(this.maxFeePerBlobGas),nonce:a,signature:l,to:o,index:n,type:i,value:_h(this.value)}}async getBlock(){let e=this.blockNumber;if(null==e){const t=await this.getTransaction();t&&(e=t.blockNumber)}if(null==e)return null;const t=this.provider.getBlock(e);if(null==t)throw new Error("TODO");return t}async getTransaction(){return this.provider.getTransaction(this.hash)}async confirmations(){if(null==this.blockNumber){const{tx:e,blockNumber:t}=await An({tx:this.getTransaction(),blockNumber:this.provider.getBlockNumber()});return null==e||null==e.blockNumber?0:t-e.blockNumber+1}return await this.provider.getBlockNumber()-this.blockNumber+1}async wait(e,t){const n=null==e?1:e,r=null==t?0:t;let i=wn(this,Xe),o=-1,s=-1===i;const a=async()=>{if(s)return null;const{blockNumber:e,nonce:t}=await An({blockNumber:this.provider.getBlockNumber(),nonce:this.provider.getTransactionCount(this.from)});if(t<this.nonce)return void(i=e);if(s)return null;const r=await this.getTransaction();if(!r||null==r.blockNumber)for(-1===o&&(o=i-3)<wn(this,Xe)&&(o=wn(this,Xe));o<=e;){if(s)return null;const t=await this.provider.getBlock(o,!0);if(null==t)return;for(const e of t)if(e===this.hash)return;for(let r=0;r<t.length;r++){const o=await t.getTransaction(r);if(o.from===this.from&&o.nonce===this.nonce){if(s)return null;const t=await this.provider.getTransactionReceipt(o.hash);if(null==t||e-t.blockNumber+1<n)return;let r="replaced";o.data===this.data&&o.to===this.to&&o.value===this.value?r="repriced":"0x"===o.data&&o.from===o.to&&o.value===Oh&&(r="cancelled"),kn(!1,"transaction was replaced","TRANSACTION_REPLACED",{cancelled:"replaced"===r||"cancelled"===r,reason:r,replacement:o.replaceableTransaction(i),hash:o.hash,receipt:t})}}o++}},c=e=>{if(null==e||0!==e.status)return e;kn(!1,"transaction execution reverted","CALL_EXCEPTION",{action:"sendTransaction",data:null,reason:null,invocation:null,revert:null,transaction:{to:e.to,from:e.from,data:""},receipt:e})},l=await this.provider.getTransactionReceipt(this.hash);if(0===n)return c(l);if(l){if(1===n||await l.confirmations()>=n)return c(l)}else if(await a(),0===n)return null;return await new Promise((e,t)=>{const o=[],l=()=>{o.forEach(e=>e())};if(o.push(()=>{s=!0}),r>0){const e=setTimeout(()=>{l(),t(Dn("wait for transaction timeout","TIMEOUT"))},r);o.push(()=>{clearTimeout(e)})}const u=async r=>{if(await r.confirmations()>=n){l();try{e(c(r))}catch(i){t(i)}}};if(o.push(()=>{this.provider.off(this.hash,u)}),this.provider.on(this.hash,u),i>=0){const e=async()=>{try{await a()}catch(n){if(Tn(n,"TRANSACTION_REPLACED"))return l(),void t(n)}s||this.provider.once("block",e)};o.push(()=>{this.provider.off("block",e)}),this.provider.once("block",e)}})}isMined(){return null!=this.blockHash}isLegacy(){return 0===this.type}isBerlin(){return 1===this.type}isLondon(){return 2===this.type}isCancun(){return 3===this.type}removedEvent(){return kn(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),Dh(this)}reorderedEvent(e){return kn(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),kn(!e||e.isMined(),"unmined 'other' transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),Ph(this,e)}replaceableTransaction(t){In(Number.isInteger(t)&&t>=0,"invalid startBlock","startBlock",t);const n=new e(this,this.provider);return On(n,Xe,t),n}};function Ph(e,t){return{orphan:"reorder-transaction",tx:e,other:t}}function Dh(e){return{orphan:"drop-transaction",tx:e}}class kh extends Rh{constructor(e,t,n){super(e,e.provider),yn(this,"interface"),yn(this,"fragment"),yn(this,"args"),Rn(this,{args:t.decodeEventLog(n,e.data,e.topics),fragment:n,interface:t})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}class Ih extends Rh{constructor(e,t){super(e,e.provider),yn(this,"error"),Rn(this,{error:t})}}class xh extends Sh{constructor(e,t,n){super(n,t),bn(this,Fe),On(this,Fe,e)}get logs(){return super.logs.map(e=>{const t=e.topics.length?wn(this,Fe).getEvent(e.topics[0]):null;if(t)try{return new kh(e,wn(this,Fe),t)}catch(n){return new Ih(e,n)}return e})}}Fe=new WeakMap;class Mh extends Th{constructor(e,t,n){super(n,t),bn(this,Je),On(this,Je,e)}async wait(e,t){const n=await super.wait(e,t);return null==n?null:new xh(wn(this,Je),this.provider,n)}}Je=new WeakMap;class Kh extends pr{constructor(e,t,n,r){super(e,t,n),yn(this,"log"),Rn(this,{log:r})}async getBlock(){return await this.log.getBlock()}async getTransaction(){return await this.log.getTransaction()}async getTransactionReceipt(){return await this.log.getTransactionReceipt()}}class Lh extends Kh{constructor(e,t,n,r,i){super(e,t,n,new kh(i,e.interface,r)),Rn(this,{args:e.interface.decodeEventLog(r,this.log.data,this.log.topics),fragment:r})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}const Uh=BigInt(0);function Bh(e){return e&&"function"==typeof e.call}function jh(e){return e&&"function"==typeof e.estimateGas}function Hh(e){return e&&"function"==typeof e.resolveName}function Wh(e){return e&&"function"==typeof e.sendTransaction}function Xh(e){if(null!=e){if(Hh(e))return e;if(e.provider)return e.provider}}class Fh{constructor(e,t,n){if(bn(this,Ge),yn(this,"fragment"),Rn(this,{fragment:t}),t.inputs.length<n.length)throw new Error("too many arguments");const r=Jh(e.runner,"resolveName"),i=Hh(r)?r:null;On(this,Ge,async function(){const r=await Promise.all(t.inputs.map((e,t)=>null==n[t]?null:e.walkAsync(n[t],(e,t)=>"address"===e?Array.isArray(t)?Promise.all(t.map(e=>pa(e,i))):pa(t,i):t)));return e.interface.encodeFilterTopics(t,r)}())}getTopicFilter(){return wn(this,Ge)}}function Jh(e,t){return null==e?null:"function"==typeof e[t]?e:e.provider&&"function"==typeof e.provider[t]?e.provider:null}function Gh(e){return null==e?null:e.provider||null}async function qh(e,t){const n=wa.dereference(e,"overrides");In("object"==typeof n,"invalid overrides parameter","overrides",e);const r=Nh(n);return In(null==r.to||(t||[]).indexOf("to")>=0,"cannot override to","overrides.to",r.to),In(null==r.data||(t||[]).indexOf("data")>=0,"cannot override data","overrides.data",r.data),r.from&&(r.from=r.from),r}async function Vh(e,t,n){const r=Jh(e,"resolveName"),i=Hh(r)?r:null;return await Promise.all(t.map((e,t)=>e.walkAsync(n[t],(e,t)=>(t=wa.dereference(t,e),"address"===e?pa(t,i):t))))}function zh(e){const t=async function(t){const n=await qh(t,["data"]);n.to=await e.getAddress(),n.from&&(n.from=await pa(n.from,Xh(e.runner)));const r=e.interface,i=tr(n.value||Uh,"overrides.value")===Uh,o="0x"===(n.data||"0x");return r.fallback&&!r.fallback.payable&&r.receive&&!o&&!i&&In(!1,"cannot send data to receive or send value to non-payable fallback","overrides",t),In(r.fallback||o,"cannot send data to receive-only contract","overrides.data",n.data),In(r.receive||r.fallback&&r.fallback.payable||i,"cannot send value to non-payable fallback","overrides.value",n.value),In(r.fallback||o,"cannot send data to receive-only contract","overrides.data",n.data),n},n=async function(n){const r=e.runner;kn(Wh(r),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const i=await r.sendTransaction(await t(n)),o=Gh(e.runner);return new Mh(e.interface,o,i)},r=async e=>await n(e);return Rn(r,{_contract:e,estimateGas:async function(n){const r=Jh(e.runner,"estimateGas");return kn(jh(r),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await r.estimateGas(await t(n))},populateTransaction:t,send:n,staticCall:async function(n){const r=Jh(e.runner,"call");kn(Bh(r),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const i=await t(n);try{return await r.call(i)}catch(o){throw Pn(o)&&o.data?e.interface.makeError(o.data,i):o}}}),r}function Qh(e,t){const n=function(...n){const r=e.interface.getFunction(t,n);return kn(r,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:t,args:n}}),r},r=async function(...t){const r=n(...t);let i={};if(r.inputs.length+1===t.length&&(i=await qh(t.pop())).from&&(i.from=await pa(i.from,Xh(e.runner))),r.inputs.length!==t.length)throw new Error("internal error: fragment inputs doesn't match arguments; should not happen");const o=await Vh(e.runner,r.inputs,t);return Object.assign({},i,await An({to:e.getAddress(),data:e.interface.encodeFunctionData(r,o)}))},i=async function(...e){const t=await s(...e);return 1===t.length?t[0]:t},o=async function(...t){const n=e.runner;kn(Wh(n),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const i=await n.sendTransaction(await r(...t)),o=Gh(e.runner);return new Mh(e.interface,o,i)},s=async function(...t){const i=Jh(e.runner,"call");kn(Bh(i),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const o=await r(...t);let s="0x";try{s=await i.call(o)}catch(c){throw Pn(c)&&c.data?e.interface.makeError(c.data,o):c}const a=n(...t);return e.interface.decodeFunctionResult(a,s)},a=async(...e)=>n(...e).constant?await i(...e):await o(...e);return Rn(a,{name:e.interface.getFunctionName(t),_contract:e,_key:t,getFragment:n,estimateGas:async function(...t){const n=Jh(e.runner,"estimateGas");return kn(jh(n),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await n.estimateGas(await r(...t))},populateTransaction:r,send:o,staticCall:i,staticCallResult:s}),Object.defineProperty(a,"fragment",{configurable:!1,enumerable:!0,get:()=>{const n=e.interface.getFunction(t);return kn(n,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:t}}),n}}),a}function $h(e,t){const n=function(...n){const r=e.interface.getEvent(t,n);return kn(r,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:t,args:n}}),r},r=function(...t){return new Fh(e,n(...t),t)};return Rn(r,{name:e.interface.getEventName(t),_contract:e,_key:t,getFragment:n}),Object.defineProperty(r,"fragment",{configurable:!1,enumerable:!0,get:()=>{const n=e.interface.getEvent(t);return kn(n,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:t}}),n}}),r}Ge=new WeakMap;const Yh=Symbol.for("_ethersInternal_contract"),Zh=new WeakMap;function ed(e,t){Zh.set(e[Yh],t)}function td(e){return Zh.get(e[Yh])}function nd(e){return e&&"object"==typeof e&&"getTopicFilter"in e&&"function"==typeof e.getTopicFilter&&e.fragment}async function rd(e,t){let n,r=null;if(Array.isArray(t)){const r=function(t){if(Bn(t,32))return t;const n=e.interface.getEvent(t);return In(n,"unknown fragment","name",t),n.topicHash};n=t.map(e=>null==e?null:Array.isArray(e)?e.map(r):r(e))}else"*"===t?n=[null]:"string"==typeof t?Bn(t,32)?n=[t]:(In(r=e.interface.getEvent(t),"unknown fragment","event",t),n=[r.topicHash]):nd(t)?n=await t.getTopicFilter():"fragment"in t?n=[(r=t.fragment).topicHash]:In(!1,"unknown event name","event",t);return{fragment:r,tag:(n=n.map(e=>{if(null==e)return null;if(Array.isArray(e)){const t=Array.from(new Set(e.map(e=>e.toLowerCase())).values());return 1===t.length?t[0]:(t.sort(),t)}return e.toLowerCase()})).map(e=>null==e?"null":Array.isArray(e)?e.join("|"):e).join("&"),topics:n}}async function id(e,t){const{subs:n}=td(e);return n.get((await rd(e,t)).tag)||null}async function od(e,t,n){const r=Gh(e.runner);kn(r,"contract runner does not support subscribing","UNSUPPORTED_OPERATION",{operation:t});const{fragment:i,tag:o,topics:s}=await rd(e,n),{addr:a,subs:c}=td(e);let l=c.get(o);if(!l){const t={address:a||e,topics:s},u=t=>{let r=i;if(null==r)try{r=e.interface.getEvent(t.topics[0])}catch{}if(r){const o=r,s=i?e.interface.decodeEventLog(i,t.data,t.topics):[];cd(e,n,s,r=>new Lh(e,r,n,o,t))}else cd(e,n,[],r=>new Kh(e,r,n,t))};let h=[];l={tag:o,listeners:[],start:()=>{h.length||h.push(r.on(t,u))},stop:async()=>{if(0==h.length)return;let e=h;h=[],await Promise.all(e),r.off(t,u)}},c.set(o,l)}return l}let sd=Promise.resolve();async function ad(e,t,n,r){await sd;const i=await id(e,t);if(!i)return!1;const o=i.listeners.length;return i.listeners=i.listeners.filter(({listener:t,once:i})=>{const o=Array.from(n);r&&o.push(r(i?null:t));try{t.call(e,...o)}catch{}return!i}),0===i.listeners.length&&(i.stop(),td(e).subs.delete(i.tag)),o>0}async function cd(e,t,n,r){try{await sd}catch{}const i=ad(e,t,n,r);return sd=i,await i}const ld=["then"];qe=Yh;let ud=class e{constructor(e,t,n,r){yn(this,"target"),yn(this,"interface"),yn(this,"runner"),yn(this,"filters"),yn(this,qe),yn(this,"fallback"),In("string"==typeof e||da(e),"invalid value for Contract target","target",e),null==n&&(n=null);const i=class e{constructor(e){bn(this,Ue),yn(this,"fragments"),yn(this,"deploy"),yn(this,"fallback"),yn(this,"receive"),bn(this,xe),bn(this,Me),bn(this,Ke),bn(this,Le);let t=[];t="string"==typeof e?JSON.parse(e):e,On(this,Ke,new Map),On(this,xe,new Map),On(this,Me,new Map);const n=[];for(const o of t)try{n.push(Zu.from(o))}catch(s){console.log(`[Warning] Invalid Fragment ${JSON.stringify(o)}:`,s.message)}Rn(this,{fragments:Object.freeze(n)});let r=null,i=!1;On(this,Le,this.getAbiCoder()),this.fragments.forEach((e,t)=>{let n;switch(e.type){case"constructor":return this.deploy?void console.log("duplicate definition - constructor"):void Rn(this,{deploy:e});case"fallback":return void(0===e.inputs.length?i=!0:(In(!r||e.payable!==r.payable,"conflicting fallback fragments",`fragments[${t}]`,e),r=e,i=r.payable));case"function":n=wn(this,Ke);break;case"event":n=wn(this,Me);break;case"error":n=wn(this,xe);break;default:return}const o=e.format();n.has(o)||n.set(o,e)}),this.deploy||Rn(this,{deploy:ih.from("constructor()")}),Rn(this,{fallback:r,receive:i})}format(e){const t=e?"minimal":"full";return this.fragments.map(e=>e.format(t))}formatJson(){const e=this.fragments.map(e=>e.format("json"));return JSON.stringify(e.map(e=>JSON.parse(e)))}getAbiCoder(){return ph.defaultAbiCoder()}getFunctionName(e){const t=En(this,Ue,Be).call(this,e,null,!1);return In(t,"no matching function","key",e),t.name}hasFunction(e){return!!En(this,Ue,Be).call(this,e,null,!1)}getFunction(e,t){return En(this,Ue,Be).call(this,e,t||null,!0)}forEachFunction(e){const t=Array.from(wn(this,Ke).keys());t.sort((e,t)=>e.localeCompare(t));for(let n=0;n<t.length;n++){const r=t[n];e(wn(this,Ke).get(r),n)}}getEventName(e){const t=En(this,Ue,je).call(this,e,null,!1);return In(t,"no matching event","key",e),t.name}hasEvent(e){return!!En(this,Ue,je).call(this,e,null,!1)}getEvent(e,t){return En(this,Ue,je).call(this,e,t||null,!0)}forEachEvent(e){const t=Array.from(wn(this,Me).keys());t.sort((e,t)=>e.localeCompare(t));for(let n=0;n<t.length;n++){const r=t[n];e(wn(this,Me).get(r),n)}}getError(e,t){if(Bn(e)){const t=e.toLowerCase();if(bh[t])return nh.from(bh[t].signature);for(const e of wn(this,xe).values())if(t===e.selector)return e;return null}if(-1===e.indexOf("(")){const t=[];for(const[n,r]of wn(this,xe))n.split("(")[0]===e&&t.push(r);return 0===t.length?"Error"===e?nh.from("error Error(string)"):"Panic"===e?nh.from("error Panic(uint256)"):null:(t.length>1&&In(!1,`ambiguous error description (i.e. ${t.map(e=>JSON.stringify(e.format())).join(", ")})`,"name",e),t[0])}return"Error(string)"===(e=nh.from(e).format())?nh.from("error Error(string)"):"Panic(uint256)"===e?nh.from("error Panic(uint256)"):wn(this,xe).get(e)||null}forEachError(e){const t=Array.from(wn(this,xe).keys());t.sort((e,t)=>e.localeCompare(t));for(let n=0;n<t.length;n++){const r=t[n];e(wn(this,xe).get(r),n)}}_decodeParams(e,t){return wn(this,Le).decode(e,t)}_encodeParams(e,t){return wn(this,Le).encode(e,t)}encodeDeploy(e){return this._encodeParams(this.deploy.inputs,e||[])}decodeErrorResult(e,t){if("string"==typeof e){const t=this.getError(e);In(t,"unknown error","fragment",e),e=t}return In(Jn(t,0,4)===e.selector,`data signature does not match error ${e.name}.`,"data",t),this._decodeParams(e.inputs,Jn(t,4))}encodeErrorResult(e,t){if("string"==typeof e){const t=this.getError(e);In(t,"unknown error","fragment",e),e=t}return Xn([e.selector,this._encodeParams(e.inputs,t||[])])}decodeFunctionData(e,t){if("string"==typeof e){const t=this.getFunction(e);In(t,"unknown function","fragment",e),e=t}return In(Jn(t,0,4)===e.selector,`data signature does not match function ${e.name}.`,"data",t),this._decodeParams(e.inputs,Jn(t,4))}encodeFunctionData(e,t){if("string"==typeof e){const t=this.getFunction(e);In(t,"unknown function","fragment",e),e=t}return Xn([e.selector,this._encodeParams(e.inputs,t||[])])}decodeFunctionResult(e,t){if("string"==typeof e){const t=this.getFunction(e);In(t,"unknown function","fragment",e),e=t}let n="invalid length for result data";const r=Un(t);if(r.length%32==0)try{return wn(this,Le).decode(e.outputs,r)}catch{n="could not decode result data"}kn(!1,n,"BAD_DATA",{value:Wn(r),info:{method:e.name,signature:e.format()}})}makeError(e,t){const n=Ln(e,"data"),r=ph.getBuiltinCallException("call",t,n);if(r.message.startsWith("execution reverted (unknown custom error)")){const e=Wn(n.slice(0,4)),t=this.getError(e);if(t)try{const e=wn(this,Le).decode(t.inputs,n.slice(4));r.revert={name:t.name,signature:t.format(),args:e},r.reason=r.revert.signature,r.message=`execution reverted: ${r.reason}`}catch{r.message="execution reverted (coult not decode custom error)"}}const i=this.parseTransaction(t);return i&&(r.invocation={method:i.name,signature:i.signature,args:i.args}),r}encodeFunctionResult(e,t){if("string"==typeof e){const t=this.getFunction(e);In(t,"unknown function","fragment",e),e=t}return Wn(wn(this,Le).encode(e.outputs,t||[]))}encodeFilterTopics(e,t){if("string"==typeof e){const t=this.getEvent(e);In(t,"unknown event","eventFragment",e),e=t}kn(t.length<=e.inputs.length,`too many arguments for ${e.format()}`,"UNEXPECTED_ARGUMENT",{count:t.length,expectedCount:e.inputs.length});const n=[];e.anonymous||n.push(e.topicHash);const r=(e,t)=>"string"===e.type?mc(t):"bytes"===e.type?So(Wn(t)):("bool"===e.type&&"boolean"==typeof t?t=t?"0x01":"0x00":e.type.match(/^u?int/)?t=sr(t):e.type.match(/^bytes/)?t=Vn(t,32):"address"===e.type&&wn(this,Le).encode(["address"],[t]),qn(Wn(t),32));for(t.forEach((t,i)=>{const o=e.inputs[i];o.indexed?null==t?n.push(null):"array"===o.baseType||"tuple"===o.baseType?In(!1,"filtering with tuples or arrays not supported","contract."+o.name,t):Array.isArray(t)?n.push(t.map(e=>r(o,e))):n.push(r(o,t)):In(null==t,"cannot filter non-indexed parameters; must be null","contract."+o.name,t)});n.length&&null===n[n.length-1];)n.pop();return n}encodeEventLog(e,t){if("string"==typeof e){const t=this.getEvent(e);In(t,"unknown event","eventFragment",e),e=t}const n=[],r=[],i=[];return e.anonymous||n.push(e.topicHash),In(t.length===e.inputs.length,"event arguments/values mismatch","values",t),e.inputs.forEach((e,o)=>{const s=t[o];if(e.indexed)if("string"===e.type)n.push(mc(s));else if("bytes"===e.type)n.push(So(s));else{if("tuple"===e.baseType||"array"===e.baseType)throw new Error("not implemented");n.push(wn(this,Le).encode([e.type],[s]))}else r.push(e),i.push(s)}),{data:wn(this,Le).encode(r,i),topics:n}}decodeEventLog(e,t,n){if("string"==typeof e){const t=this.getEvent(e);In(t,"unknown event","eventFragment",e),e=t}if(null!=n&&!e.anonymous){const t=e.topicHash;In(Bn(n[0],32)&&n[0].toLowerCase()===t,"fragment/topic mismatch","topics[0]",n[0]),n=n.slice(1)}const r=[],i=[],o=[];e.inputs.forEach(e=>{e.indexed?"string"===e.type||"bytes"===e.type||"tuple"===e.baseType||"array"===e.baseType?(r.push(Yu.from({type:"bytes32",name:e.name})),o.push(!0)):(r.push(e),o.push(!1)):(i.push(e),o.push(!1))});const s=null!=n?wn(this,Le).decode(r,Xn(n)):null,a=wn(this,Le).decode(i,t,!0),c=[],l=[];let u=0,h=0;return e.inputs.forEach((e,t)=>{let n=null;if(e.indexed)if(null==s)n=new vh(null);else if(o[t])n=new vh(s[h++]);else try{n=s[h++]}catch(r){n=r}else try{n=a[u++]}catch(r){n=r}c.push(n),l.push(e.name||null)}),pi.fromItems(c,l)}parseTransaction(e){const t=Ln(e.data,"tx.data"),n=tr(null!=e.value?e.value:0,"tx.value"),r=this.getFunction(Wn(t.slice(0,4)));if(!r)return null;const i=wn(this,Le).decode(r.inputs,t.slice(4));return new mh(r,r.selector,i,n)}parseCallResult(e){throw new Error("@TODO")}parseLog(e){const t=this.getEvent(e.topics[0]);return!t||t.anonymous?null:new gh(t,t.topicHash,this.decodeEventLog(t,e.data,e.topics))}parseError(e){const t=Wn(e),n=this.getError(Jn(t,0,4));if(!n)return null;const r=wn(this,Le).decode(n.inputs,Jn(t,4));return new yh(n,n.selector,r)}static from(t){return t instanceof e?t:"string"==typeof t?new e(JSON.parse(t)):"function"==typeof t.formatJson?new e(t.formatJson()):"function"==typeof t.format?new e(t.format("json")):new e(t)}}.from(t);Rn(this,{target:e,runner:n,interface:i}),Object.defineProperty(this,Yh,{value:{}});let o,s=null,a=null;if(r){const e=Gh(n);a=new Mh(this.interface,e,r)}let c=new Map;if("string"==typeof e)if(Bn(e))s=e,o=Promise.resolve(e);else{const t=Jh(n,"resolveName");if(!Hh(t))throw Dn("contract runner does not support name resolution","UNSUPPORTED_OPERATION",{operation:"resolveName"});o=t.resolveName(e).then(t=>{if(null==t)throw Dn("an ENS name used for a contract target must be correctly configured","UNCONFIGURED_NAME",{value:e});return td(this).addr=t,t})}else o=e.getAddress().then(e=>{if(null==e)throw new Error("TODO");return td(this).addr=e,e});return ed(this,{addrPromise:o,addr:s,deployTx:a,subs:c}),Rn(this,{filters:new Proxy({},{get:(e,t,n)=>{if("symbol"==typeof t||ld.indexOf(t)>=0)return Reflect.get(e,t,n);try{return this.getEvent(t)}catch(r){if(!Tn(r,"INVALID_ARGUMENT")||"key"!==r.argument)throw r}},has:(e,t)=>ld.indexOf(t)>=0?Reflect.has(e,t):Reflect.has(e,t)||this.interface.hasEvent(String(t))})}),Rn(this,{fallback:i.receive||i.fallback?zh(this):null}),new Proxy(this,{get:(e,t,n)=>{if("symbol"==typeof t||t in e||ld.indexOf(t)>=0)return Reflect.get(e,t,n);try{return e.getFunction(t)}catch(r){if(!Tn(r,"INVALID_ARGUMENT")||"key"!==r.argument)throw r}},has:(e,t)=>"symbol"==typeof t||t in e||ld.indexOf(t)>=0?Reflect.has(e,t):e.interface.hasFunction(t)})}connect(t){return new e(this.target,this.interface,t)}attach(t){return new e(t,this.interface,this.runner)}async getAddress(){return await td(this).addrPromise}async getDeployedCode(){const e=Gh(this.runner);kn(e,"runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"getDeployedCode"});const t=await e.getCode(await this.getAddress());return"0x"===t?null:t}async waitForDeployment(){const e=this.deploymentTransaction();if(e)return await e.wait(),this;if(null!=await this.getDeployedCode())return this;const t=Gh(this.runner);return kn(null!=t,"contract runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"waitForDeployment"}),new Promise((e,n)=>{const r=async()=>{try{if(null!=await this.getDeployedCode())return e(this);t.once("block",r)}catch(i){n(i)}};r()})}deploymentTransaction(){return td(this).deployTx}getFunction(e){return"string"!=typeof e&&(e=e.format()),Qh(this,e)}getEvent(e){return"string"!=typeof e&&(e=e.format()),$h(this,e)}async queryTransaction(e){throw new Error("@TODO")}async queryFilter(e,t,n){null==t&&(t=0),null==n&&(n="latest");const{addr:r,addrPromise:i}=td(this),o=r||await i,{fragment:s,topics:a}=await rd(this,e),c={address:o,topics:a,fromBlock:t,toBlock:n},l=Gh(this.runner);return kn(l,"contract runner does not have a provider","UNSUPPORTED_OPERATION",{operation:"queryFilter"}),(await l.getLogs(c)).map(e=>{let t=s;if(null==t)try{t=this.interface.getEvent(e.topics[0])}catch{}if(t)try{return new kh(e,this.interface,t)}catch(n){return new Ih(e,n)}return new Rh(e,l)})}async on(e,t){const n=await od(this,"on",e);return n.listeners.push({listener:t,once:!1}),n.start(),this}async once(e,t){const n=await od(this,"once",e);return n.listeners.push({listener:t,once:!0}),n.start(),this}async emit(e,...t){return await cd(this,e,t,null)}async listenerCount(e){if(e){const t=await id(this,e);return t?t.listeners.length:0}const{subs:t}=td(this);let n=0;for(const{listeners:r}of t.values())n+=r.length;return n}async listeners(e){if(e){const t=await id(this,e);return t?t.listeners.map(({listener:e})=>e):[]}const{subs:t}=td(this);let n=[];for(const{listeners:r}of t.values())n=n.concat(r.map(({listener:e})=>e));return n}async off(e,t){const n=await id(this,e);if(!n)return this;if(t){const e=n.listeners.map(({listener:e})=>e).indexOf(t);e>=0&&n.listeners.splice(e,1)}return(null==t||0===n.listeners.length)&&(n.stop(),td(this).subs.delete(n.tag)),this}async removeAllListeners(e){if(e){const t=await id(this,e);if(!t)return this;t.stop(),td(this).subs.delete(t.tag)}else{const{subs:e}=td(this);for(const{tag:t,stop:n}of e.values())n(),e.delete(t)}return this}async addListener(e,t){return await this.on(e,t)}async removeListener(e,t){return await this.off(e,t)}static buildClass(t){return class extends e{constructor(e,n=null){super(e,t,n)}}}static from(e,t,n){return null==n&&(n=null),new this(e,t,n)}};function hd(){return ud}class dd extends(hd()){}function fd(e){return e.match(/^ipfs:\/\/ipfs\//i)?e=e.substring(12):e.match(/^ipfs:\/\//i)?e=e.substring(7):In(!1,"unsupported IPFS format","link",e),`https://gateway.ipfs.io/ipfs/${e}`}class pd{constructor(e){yn(this,"name"),Rn(this,{name:e})}connect(e){return this}supportsCoinType(e){return!1}async encodeAddress(e,t){throw new Error("unsupported coin")}async decodeAddress(e,t){throw new Error("unsupported coin")}}const gd=new RegExp("^(ipfs)://(.*)$","i"),md=[new RegExp("^(https)://(.*)$","i"),new RegExp("^(data):(.*)$","i"),gd,new RegExp("^eip155:[0-9]+/(erc[0-9]+):(.*)$","i")],yd=class e{constructor(e,t,n){bn(this,Qe),yn(this,"provider"),yn(this,"address"),yn(this,"name"),bn(this,Ve),bn(this,ze),Rn(this,{provider:e,address:t,name:n}),On(this,Ve,null),On(this,ze,new dd(t,["function supportsInterface(bytes4) view returns (bool)","function resolve(bytes, bytes) view returns (bytes)","function addr(bytes32) view returns (address)","function addr(bytes32, uint) view returns (bytes)","function text(bytes32, string) view returns (string)","function contenthash(bytes32) view returns (bytes)"],e))}async supportsWildcard(){return null==wn(this,Ve)&&On(this,Ve,(async()=>{try{return await wn(this,ze).supportsInterface("0x9061b923")}catch(e){if(Tn(e,"CALL_EXCEPTION"))return!1;throw On(this,Ve,null),e}})()),await wn(this,Ve)}async getAddress(e){if(null==e&&(e=60),60===e)try{const e=await En(this,Qe,$e).call(this,"addr(bytes32)");return null==e||e===Fs?null:e}catch(i){if(Tn(i,"CALL_EXCEPTION"))return null;throw i}if(e>=0&&e<2147483648){let t=e+2147483648;const n=await En(this,Qe,$e).call(this,"addr(bytes32,uint)",[t]);if(Bn(n,20))return ua(n)}let t=null;for(const o of this.provider.plugins)if(o instanceof pd&&o.supportsCoinType(e)){t=o;break}if(null==t)return null;const n=await En(this,Qe,$e).call(this,"addr(bytes32,uint)",[e]);if(null==n||"0x"===n)return null;const r=await t.decodeAddress(e,n);if(null!=r)return r;kn(!1,"invalid coin data","UNSUPPORTED_OPERATION",{operation:`getAddress(${e})`,info:{coinType:e,data:n}})}async getText(e){const t=await En(this,Qe,$e).call(this,"text(bytes32,string)",[e]);return null==t||"0x"===t?null:t}async getContentHash(){const e=await En(this,Qe,$e).call(this,"contenthash(bytes32)");if(null==e||"0x"===e)return null;const t=e.match(/^0x(e3010170|e5010172)(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/);if(t){const e="e3010170"===t[1]?"ipfs":"ipns",n=parseInt(t[4],16);if(t[5].length===2*n)return`${e}://${hr("0x"+t[2])}`}const n=e.match(/^0xe40101fa011b20([0-9a-f]*)$/);if(n&&64===n[1].length)return`bzz://${n[1]}`;kn(!1,"invalid or unsupported content hash data","UNSUPPORTED_OPERATION",{operation:"getContentHash()",info:{data:e}})}async getAvatar(){return(await this._getAvatar()).url}async _getAvatar(){const e=[{type:"name",value:this.name}];try{const t=await this.getText("avatar");if(null==t)return e.push({type:"!avatar",value:""}),{url:null,linkage:e};e.push({type:"avatar",value:t});for(let n=0;n<md.length;n++){const r=t.match(md[n]);if(null==r)continue;const i=r[1].toLowerCase();switch(i){case"https":case"data":return e.push({type:"url",value:t}),{linkage:e,url:t};case"ipfs":{const n=fd(t);return e.push({type:"ipfs",value:t}),e.push({type:"url",value:n}),{linkage:e,url:n}}case"erc721":case"erc1155":{const n="erc721"===i?"tokenURI(uint256)":"uri(uint256)";e.push({type:i,value:t});const o=await this.getAddress();if(null==o)return e.push({type:"!owner",value:""}),{url:null,linkage:e};const s=(r[2]||"").split("/");if(2!==s.length)return e.push({type:`!${i}caip`,value:r[2]||""}),{url:null,linkage:e};const a=s[1],c=new dd(s[0],["function tokenURI(uint) view returns (string)","function ownerOf(uint) view returns (address)","function uri(uint) view returns (string)","function balanceOf(address, uint256) view returns (uint)"],this.provider);if("erc721"===i){const t=await c.ownerOf(a);if(o!==t)return e.push({type:"!owner",value:t}),{url:null,linkage:e};e.push({type:"owner",value:t})}else if("erc1155"===i){const t=await c.balanceOf(o,a);if(!t)return e.push({type:"!balance",value:"0"}),{url:null,linkage:e};e.push({type:"balance",value:t.toString()})}let l=await c[n](a);if(null==l||"0x"===l)return e.push({type:"!metadata-url",value:""}),{url:null,linkage:e};e.push({type:"metadata-url-base",value:l}),"erc1155"===i&&(l=l.replace("{id}",sr(a,32).substring(2)),e.push({type:"metadata-url-expanded",value:l})),l.match(/^ipfs:/i)&&(l=fd(l)),e.push({type:"metadata-url",value:l});let u={};const h=await new kr(l).send();h.assertOk();try{u=h.bodyJson}catch{try{e.push({type:"!metadata",value:h.bodyText})}catch{const t=h.body;return t&&e.push({type:"!metadata",value:Wn(t)}),{url:null,linkage:e}}return{url:null,linkage:e}}if(!u)return e.push({type:"!metadata",value:""}),{url:null,linkage:e};e.push({type:"metadata",value:JSON.stringify(u)});let d=u.image;if("string"!=typeof d)return e.push({type:"!imageUrl",value:""}),{url:null,linkage:e};if(!d.match(/^(https:\/\/|data:)/i)){if(null==d.match(gd))return e.push({type:"!imageUrl-ipfs",value:d}),{url:null,linkage:e};e.push({type:"imageUrl-ipfs",value:d}),d=fd(d)}return e.push({type:"url",value:d}),{linkage:e,url:d}}}}}catch{}return{linkage:e,url:null}}static async getEnsAddress(e){const t=await e.getNetwork(),n=t.getPlugin("org.ethers.plugins.network.Ens");return kn(n,"network does not support ENS","UNSUPPORTED_OPERATION",{operation:"getEnsAddress",info:{network:t}}),n.address}static async fromName(t,n){var r;let i=n;for(;;){if(""===i||"."===i||"eth"!==n&&"eth"===i)return null;const o=await En(r=e,Ye,Ze).call(r,t,i);if(null!=o){const r=new e(t,o,n);return i===n||await r.supportsWildcard()?r:null}i=i.split(".").slice(1).join(".")}}};Ve=new WeakMap,ze=new WeakMap,Qe=new WeakSet,$e=async function(e,t){t=(t||[]).slice();const n=wn(this,ze).interface;t.unshift(Yl(this.name));let r=null;await this.supportsWildcard()&&(kn(r=n.getFunction(e),"missing fragment","UNKNOWN_ERROR",{info:{funcName:e}}),t=[Zl(this.name,255),n.encodeFunctionData(r,t)],e="resolve(bytes,bytes)"),t.push({enableCcipRead:!0});try{const o=await wn(this,ze)[e](...t);return r?n.decodeFunctionResult(r,o)[0]:o}catch(i){if(!Tn(i,"CALL_EXCEPTION"))throw i}return null},Ye=new WeakSet,Ze=async function(e,t){const n=await yd.getEnsAddress(e);try{const i=await new dd(n,["function resolver(bytes32) view returns (address)"],e).resolver(Yl(t),{enableCcipRead:!0});return i===Fs?null:i}catch(r){throw r}return null},bn(yd,Ye);let vd=yd;const wd=BigInt(0);function bd(e,t){return function(n){return null==n?t:e(n)}}function Od(e,t){return n=>{if(t&&null==n)return null;if(!Array.isArray(n))throw new Error("not an array");return n.map(t=>e(t))}}function Ed(e,t){return n=>{const r={};for(const o in e){let s=o;if(t&&o in t&&!(s in n))for(const e of t[o])if(e in n){s=e;break}try{const t=e[o](n[s]);void 0!==t&&(r[o]=t)}catch(i){kn(!1,`invalid value for value.${o} (${i instanceof Error?i.message:"not-an-error"})`,"BAD_DATA",{value:n})}}return r}}function _d(e){return In(Bn(e,!0),"invalid data","value",e),e}function Cd(e){return In(Bn(e,32),"invalid hash","value",e),e}const Nd=Ed({address:ua,blockHash:Cd,blockNumber:or,data:_d,index:or,removed:bd(function(e){switch(e){case!0:case"true":return!0;case!1:case"false":return!1}In(!1,`invalid boolean; ${JSON.stringify(e)}`,"value",e)},!1),topics:Od(Cd),transactionHash:Cd,transactionIndex:or},{index:["logIndex"]}),Ad=Ed({hash:bd(Cd),parentHash:Cd,parentBeaconBlockRoot:bd(Cd,null),number:or,timestamp:or,nonce:bd(_d),difficulty:tr,gasLimit:tr,gasUsed:tr,stateRoot:bd(Cd,null),receiptsRoot:bd(Cd,null),blobGasUsed:bd(tr,null),excessBlobGas:bd(tr,null),miner:bd(ua),prevRandao:bd(Cd,null),extraData:_d,baseFeePerGas:bd(tr)},{prevRandao:["mixHash"]});function Rd(e){const t=Ad(e);return t.transactions=e.transactions.map(e=>"string"==typeof e?e:Pd(e)),t}const Sd=Ed({transactionIndex:or,blockNumber:or,transactionHash:Cd,address:ua,topics:Od(Cd),data:_d,index:or,blockHash:Cd},{index:["logIndex"]}),Td=Ed({to:bd(ua,null),from:bd(ua,null),contractAddress:bd(ua,null),index:or,root:bd(Wn),gasUsed:tr,blobGasUsed:bd(tr,null),logsBloom:bd(_d),blockHash:Cd,hash:Cd,logs:Od(function(e){return Sd(e)}),blockNumber:or,cumulativeGasUsed:tr,effectiveGasPrice:bd(tr),blobGasPrice:bd(tr,null),status:bd(or),type:bd(or,0)},{effectiveGasPrice:["gasPrice"],hash:["transactionHash"],index:["transactionIndex"]});function Pd(e){e.to&&tr(e.to)===wd&&(e.to="0x0000000000000000000000000000000000000000");const t=Ed({hash:Cd,index:bd(or,void 0),type:e=>"0x"===e||null==e?0:or(e),accessList:bd(Ua,null),blobVersionedHashes:bd(Od(Cd,!0),null),authorizationList:bd(Od(e=>{let t;if(e.signature)t=e.signature;else{let n=e.yParity;"0x1b"===n?n=0:"0x1c"===n&&(n=1),t=Object.assign({},e,{yParity:n})}return{address:ua(e.address),chainId:tr(e.chainId),nonce:tr(e.nonce),signature:ea.from(t)}},!1),null),blockHash:bd(Cd,null),blockNumber:bd(or,null),transactionIndex:bd(or,null),from:ua,gasPrice:bd(tr),maxPriorityFeePerGas:bd(tr),maxFeePerGas:bd(tr),maxFeePerBlobGas:bd(tr,null),gasLimit:tr,to:bd(ua,null),value:tr,nonce:or,data:_d,creates:bd(ua,null),chainId:bd(tr,null)},{data:["input"],gasLimit:["gas"],index:["transactionIndex"]})(e);if(null==t.to&&null==t.creates&&(t.creates=ha(t)),(1===e.type||2===e.type)&&null==e.accessList&&(t.accessList=[]),e.signature?t.signature=ea.from(e.signature):t.signature=ea.from(e),null==t.chainId){const e=t.signature.legacyChainId;null!=e&&(t.chainId=e)}return t.blockHash&&tr(t.blockHash)===wd&&(t.blockHash=null),t}const Dd="0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e";class kd{constructor(e){yn(this,"name"),Rn(this,{name:e})}clone(){return new kd(this.name)}}class Id extends kd{constructor(e,t){null==e&&(e=0),super(`org.ethers.network.plugins.GasCost#${e||0}`),yn(this,"effectiveBlock"),yn(this,"txBase"),yn(this,"txCreate"),yn(this,"txDataZero"),yn(this,"txDataNonzero"),yn(this,"txAccessListStorageKey"),yn(this,"txAccessListAddress");const n={effectiveBlock:e};function r(e,r){let i=(t||{})[e];null==i&&(i=r),In("number"==typeof i,`invalud value for ${e}`,"costs",t),n[e]=i}r("txBase",21e3),r("txCreate",32e3),r("txDataZero",4),r("txDataNonzero",16),r("txAccessListStorageKey",1900),r("txAccessListAddress",2400),Rn(this,n)}clone(){return new Id(this.effectiveBlock,this)}}class xd extends kd{constructor(e,t){super("org.ethers.plugins.network.Ens"),yn(this,"address"),yn(this,"targetNetwork"),Rn(this,{address:e||Dd,targetNetwork:null==t?1:t})}clone(){return new xd(this.address,this.targetNetwork)}}class Md extends kd{constructor(e,t){super("org.ethers.plugins.network.FetchUrlFeeDataPlugin"),bn(this,et),bn(this,tt),On(this,et,e),On(this,tt,t)}get url(){return wn(this,et)}get processFunc(){return wn(this,tt)}clone(){return this}}et=new WeakMap,tt=new WeakMap;const Kd=new Map;nt=new WeakMap,rt=new WeakMap,it=new WeakMap;let Ld=class e{constructor(e,t){bn(this,nt),bn(this,rt),bn(this,it),On(this,nt,e),On(this,rt,tr(t)),On(this,it,new Map)}toJSON(){return{name:this.name,chainId:String(this.chainId)}}get name(){return wn(this,nt)}set name(e){On(this,nt,e)}get chainId(){return wn(this,rt)}set chainId(e){On(this,rt,tr(e,"chainId"))}matches(e){if(null==e)return!1;if("string"==typeof e){try{return this.chainId===tr(e)}catch{}return this.name===e}if("number"==typeof e||"bigint"==typeof e){try{return this.chainId===tr(e)}catch{}return!1}if("object"==typeof e){if(null!=e.chainId){try{return this.chainId===tr(e.chainId)}catch{}return!1}return null!=e.name&&this.name===e.name}return!1}get plugins(){return Array.from(wn(this,it).values())}attachPlugin(e){if(wn(this,it).get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return wn(this,it).set(e.name,e.clone()),this}getPlugin(e){return wn(this,it).get(e)||null}getPlugins(e){return this.plugins.filter(t=>t.name.split("#")[0]===e)}clone(){const t=new e(this.name,this.chainId);return this.plugins.forEach(e=>{t.attachPlugin(e.clone())}),t}computeIntrinsicGas(e){const t=this.getPlugin("org.ethers.plugins.network.GasCost")||new Id;let n=t.txBase;if(null==e.to&&(n+=t.txCreate),e.data)for(let r=2;r<e.data.length;r+=2)"00"===e.data.substring(r,r+2)?n+=t.txDataZero:n+=t.txDataNonzero;if(e.accessList){const r=Ua(e.accessList);for(const e in r)n+=t.txAccessListAddress+t.txAccessListStorageKey*r[e].storageKeys.length}return n}static from(t){if(Hd(),null==t)return e.from("mainnet");if("number"==typeof t&&(t=BigInt(t)),"string"==typeof t||"bigint"==typeof t){const n=Kd.get(t);if(n)return n();if("bigint"==typeof t)return new e("unknown",t);In(!1,"unknown network","network",t)}if("function"==typeof t.clone)return t.clone();if("object"==typeof t){In("string"==typeof t.name&&"number"==typeof t.chainId,"invalid network object name or chainId","network",t);const n=new e(t.name,t.chainId);return(t.ensAddress||null!=t.ensNetwork)&&n.attachPlugin(new xd(t.ensAddress,t.ensNetwork)),n}In(!1,"invalid network","network",t)}static register(e,t){"number"==typeof e&&(e=BigInt(e));const n=Kd.get(e);n&&In(!1,`conflicting network for ${JSON.stringify(n.name)}`,"nameOrChainId",e),Kd.set(e,t)}};function Ud(e,t){const n=String(e);if(!n.match(/^[0-9.]+$/))throw new Error(`invalid gwei value: ${e}`);const r=n.split(".");if(1===r.length&&r.push(""),2!==r.length)throw new Error(`invalid gwei value: ${e}`);for(;r[1].length<t;)r[1]+="0";if(r[1].length>9){let e=BigInt(r[1].substring(0,9));r[1].substring(9).match(/^0+$/)||e++,r[1]=e.toString()}return BigInt(r[0]+r[1])}function Bd(e){return new Md(e,async(e,t,n)=>{let r;n.setHeader("User-Agent","ethers");try{const[t,o]=await Promise.all([n.send(),e()]),s=(r=t).bodyJson.standard;return{gasPrice:o.gasPrice,maxFeePerGas:Ud(s.maxFee,9),maxPriorityFeePerGas:Ud(s.maxPriorityFee,9)}}catch(i){kn(!1,`error encountered with polygon gas station (${JSON.stringify(n.url)})`,"SERVER_ERROR",{request:n,response:r,error:i})}})}let jd=!1;function Hd(){function e(e,t,n){const r=function(){const r=new Ld(e,t);return null!=n.ensNetwork&&r.attachPlugin(new xd(null,n.ensNetwork)),r.attachPlugin(new Id),(n.plugins||[]).forEach(e=>{r.attachPlugin(e)}),r};Ld.register(e,r),Ld.register(t,r),n.altNames&&n.altNames.forEach(e=>{Ld.register(e,r)})}jd||(jd=!0,e("mainnet",1,{ensNetwork:1,altNames:["homestead"]}),e("ropsten",3,{ensNetwork:3}),e("rinkeby",4,{ensNetwork:4}),e("goerli",5,{ensNetwork:5}),e("kovan",42,{ensNetwork:42}),e("sepolia",11155111,{ensNetwork:11155111}),e("holesky",17e3,{ensNetwork:17e3}),e("classic",61,{}),e("classicKotti",6,{}),e("arbitrum",42161,{ensNetwork:1}),e("arbitrum-goerli",421613,{}),e("arbitrum-sepolia",421614,{}),e("base",8453,{ensNetwork:1}),e("base-goerli",84531,{}),e("base-sepolia",84532,{}),e("bnb",56,{ensNetwork:1}),e("bnbt",97,{}),e("linea",59144,{ensNetwork:1}),e("linea-goerli",59140,{}),e("linea-sepolia",59141,{}),e("matic",137,{ensNetwork:1,plugins:[Bd("https://gasstation.polygon.technology/v2")]}),e("matic-amoy",80002,{}),e("matic-mumbai",80001,{altNames:["maticMumbai","maticmum"],plugins:[Bd("https://gasstation-testnet.polygon.technology/v2")]}),e("optimism",10,{ensNetwork:1,plugins:[]}),e("optimism-goerli",420,{}),e("optimism-sepolia",11155420,{}),e("xdai",100,{ensNetwork:1}))}function Wd(e){return JSON.parse(JSON.stringify(e))}class Xd{constructor(e){bn(this,lt),bn(this,ot),bn(this,st),bn(this,at),bn(this,ct),On(this,ot,e),On(this,st,null),On(this,at,4e3),On(this,ct,-2)}get pollingInterval(){return wn(this,at)}set pollingInterval(e){On(this,at,e)}start(){wn(this,st)||(On(this,st,wn(this,ot)._setTimeout(En(this,lt,ut).bind(this),wn(this,at))),En(this,lt,ut).call(this))}stop(){wn(this,st)&&(wn(this,ot)._clearTimeout(wn(this,st)),On(this,st,null))}pause(e){this.stop(),e&&On(this,ct,-2)}resume(){this.start()}}ot=new WeakMap,st=new WeakMap,at=new WeakMap,ct=new WeakMap,lt=new WeakSet,ut=async function(){try{const e=await wn(this,ot).getBlockNumber();if(-2===wn(this,ct))return void On(this,ct,e);if(e!==wn(this,ct)){for(let t=wn(this,ct)+1;t<=e;t++){if(null==wn(this,st))return;await wn(this,ot).emit("block",t)}On(this,ct,e)}}catch{}null!=wn(this,st)&&On(this,st,wn(this,ot)._setTimeout(En(this,lt,ut).bind(this),wn(this,at)))};class Fd{constructor(e){bn(this,ht),bn(this,dt),bn(this,ft),On(this,ht,e),On(this,ft,!1),On(this,dt,e=>{this._poll(e,wn(this,ht))})}async _poll(e,t){throw new Error("sub-classes must override this")}start(){wn(this,ft)||(On(this,ft,!0),wn(this,dt).call(this,-2),wn(this,ht).on("block",wn(this,dt)))}stop(){wn(this,ft)&&(On(this,ft,!1),wn(this,ht).off("block",wn(this,dt)))}pause(e){this.stop()}resume(){this.start()}}ht=new WeakMap,dt=new WeakMap,ft=new WeakMap;class Jd extends Fd{constructor(e,t){super(e),bn(this,pt),bn(this,gt),On(this,pt,t),On(this,gt,-2)}pause(e){e&&On(this,gt,-2),super.pause(e)}async _poll(e,t){const n=await t.getBlock(wn(this,pt));null!=n&&(-2===wn(this,gt)?On(this,gt,n.number):n.number>wn(this,gt)&&(t.emit(wn(this,pt),n.number),On(this,gt,n.number)))}}pt=new WeakMap,gt=new WeakMap;class Gd extends Fd{constructor(e,t){super(e),bn(this,mt),On(this,mt,Wd(t))}async _poll(e,t){throw new Error("@TODO")}}mt=new WeakMap;class qd extends Fd{constructor(e,t){super(e),bn(this,yt),On(this,yt,t)}async _poll(e,t){const n=await t.getTransactionReceipt(wn(this,yt));n&&t.emit(wn(this,yt),n)}}yt=new WeakMap;class Vd{constructor(e,t){bn(this,_t),bn(this,vt),bn(this,wt),bn(this,bt),bn(this,Ot),bn(this,Et),On(this,vt,e),On(this,wt,Wd(t)),On(this,bt,En(this,_t,Ct).bind(this)),On(this,Ot,!1),On(this,Et,-2)}start(){wn(this,Ot)||(On(this,Ot,!0),-2===wn(this,Et)&&wn(this,vt).getBlockNumber().then(e=>{On(this,Et,e)}),wn(this,vt).on("block",wn(this,bt)))}stop(){wn(this,Ot)&&(On(this,Ot,!1),wn(this,vt).off("block",wn(this,bt)))}pause(e){this.stop(),e&&On(this,Et,-2)}resume(){this.start()}}vt=new WeakMap,wt=new WeakMap,bt=new WeakMap,Ot=new WeakMap,Et=new WeakMap,_t=new WeakSet,Ct=async function(e){if(-2===wn(this,Et))return;const t=Wd(wn(this,wt));t.fromBlock=wn(this,Et)+1,t.toBlock=e;const n=await wn(this,vt).getLogs(t);if(0!==n.length)for(const r of n)wn(this,vt).emit(wn(this,wt),r),On(this,Et,r.blockNumber);else wn(this,Et)<e-60&&On(this,Et,e-60)};const zd=BigInt(2);function Qd(e){return e&&"function"==typeof e.then}function $d(e,t){return e+":"+JSON.stringify(t,(e,t)=>{if(null==t)return"null";if("bigint"==typeof t)return`bigint:${t.toString()}`;if("string"==typeof t)return t.toLowerCase();if("object"==typeof t&&!Array.isArray(t)){const e=Object.keys(t);return e.sort(),e.reduce((e,n)=>(e[n]=t[n],e),{})}return t})}class Yd{constructor(e){yn(this,"name"),Rn(this,{name:e})}start(){}stop(){}pause(e){}resume(){}}function Zd(e){return JSON.parse(JSON.stringify(e))}function ef(e){return(e=Array.from(new Set(e).values())).sort(),e}async function tf(e,t){if(null==e)throw new Error("invalid event");if(Array.isArray(e)&&(e={topics:e}),"string"==typeof e)switch(e){case"block":case"debug":case"error":case"finalized":case"network":case"pending":case"safe":return{type:e,tag:e}}if(Bn(e,32)){const t=e.toLowerCase();return{type:"transaction",tag:$d("tx",{hash:t}),hash:t}}if(e.orphan){const t=e;return{type:"orphan",tag:$d("orphan",t),filter:Zd(t)}}if(e.address||e.topics){const n=e,r={topics:(n.topics||[]).map(e=>null==e?null:Array.isArray(e)?ef(e.map(e=>e.toLowerCase())):e.toLowerCase())};if(n.address){const e=[],i=[],o=n=>{Bn(n)?e.push(n):i.push((async()=>{e.push(await pa(n,t))})())};Array.isArray(n.address)?n.address.forEach(o):o(n.address),i.length&&await Promise.all(i),r.address=ef(e.map(e=>e.toLowerCase()))}return{filter:r,tag:$d("event",r),type:"event"}}In(!1,"unknown ProviderEvent","event",e)}function nf(){return(new Date).getTime()}const rf={cacheTimeout:250,pollingInterval:4e3};class of{constructor(e,t){if(bn(this,Lt),bn(this,Nt),bn(this,At),bn(this,Rt),bn(this,St),bn(this,Tt),bn(this,Pt),bn(this,Dt),bn(this,kt),bn(this,It),bn(this,xt),bn(this,Mt),bn(this,Kt),On(this,Kt,Object.assign({},rf,t||{})),"any"===e)On(this,Pt,!0),On(this,Tt,null);else if(e){const t=Ld.from(e);On(this,Pt,!1),On(this,Tt,Promise.resolve(t)),setTimeout(()=>{this.emit("network",t,null)},0)}else On(this,Pt,!1),On(this,Tt,null);On(this,kt,-1),On(this,Dt,new Map),On(this,Nt,new Map),On(this,At,new Map),On(this,Rt,null),On(this,St,!1),On(this,It,1),On(this,xt,new Map),On(this,Mt,!1)}get pollingInterval(){return wn(this,Kt).pollingInterval}get provider(){return this}get plugins(){return Array.from(wn(this,At).values())}attachPlugin(e){if(wn(this,At).get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return wn(this,At).set(e.name,e.connect(this)),this}getPlugin(e){return wn(this,At).get(e)||null}get disableCcipRead(){return wn(this,Mt)}set disableCcipRead(e){On(this,Mt,!!e)}async ccipReadFetch(e,t,n){if(this.disableCcipRead||0===n.length||null==e.to)return null;const r=e.to.toLowerCase(),i=t.toLowerCase(),o=[];for(let a=0;a<n.length;a++){const t=n[a],c=t.replace("{sender}",r).replace("{data}",i),l=new kr(c);-1===t.indexOf("{data}")&&(l.body={data:i,sender:r}),this.emit("debug",{action:"sendCcipReadFetchRequest",request:l,index:a,urls:n});let u,h="unknown error";try{u=await l.send()}catch(s){o.push(s.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:l,result:{error:s}});continue}try{const e=u.bodyJson;if(e.data)return this.emit("debug",{action:"receiveCcipReadFetchResult",request:l,result:e}),e.data;e.message&&(h=e.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:l,result:e})}catch{}kn(u.statusCode<400||u.statusCode>=500,`response not found during CCIP fetch: ${h}`,"OFFCHAIN_FAULT",{reason:"404_MISSING_RESOURCE",transaction:e,info:{url:t,errorMessage:h}}),o.push(h)}kn(!1,`error encountered during CCIP fetch: ${o.map(e=>JSON.stringify(e)).join(", ")}`,"OFFCHAIN_FAULT",{reason:"500_SERVER_ERROR",transaction:e,info:{urls:n,errorMessages:o}})}_wrapBlock(e,t){return new Ah(Rd(e),this)}_wrapLog(e,t){return new Rh(Nd(e),this)}_wrapTransactionReceipt(e,t){return new Sh(Td(e),this)}_wrapTransactionResponse(e,t){return new Th(Pd(e),this)}_detectNetwork(){kn(!1,"sub-classes must implement this","UNSUPPORTED_OPERATION",{operation:"_detectNetwork"})}async _perform(e){kn(!1,`unsupported method: ${e.method}`,"UNSUPPORTED_OPERATION",{operation:e.method,info:e})}async getBlockNumber(){const e=or(await En(this,Lt,Ut).call(this,{method:"getBlockNumber"}),"%response");return wn(this,kt)>=0&&On(this,kt,e),e}_getAddress(e){return pa(e,this)}_getBlockTag(e){if(null==e)return"latest";switch(e){case"earliest":return"0x0";case"finalized":case"latest":case"pending":case"safe":return e}return Bn(e)?Bn(e,32)?e:cr(e):("bigint"==typeof e&&(e=or(e,"blockTag")),"number"==typeof e?e>=0?cr(e):wn(this,kt)>=0?cr(wn(this,kt)+e):this.getBlockNumber().then(t=>cr(t+e)):void In(!1,"invalid blockTag","blockTag",e))}_getFilter(e){const t=(e.topics||[]).map(e=>null==e?null:Array.isArray(e)?ef(e.map(e=>e.toLowerCase())):e.toLowerCase()),n="blockHash"in e?e.blockHash:void 0,r=(e,r,i)=>{let o;switch(e.length){case 0:break;case 1:o=e[0];break;default:e.sort(),o=e}if(n&&(null!=r||null!=i))throw new Error("invalid filter");const s={};return o&&(s.address=o),t.length&&(s.topics=t),r&&(s.fromBlock=r),i&&(s.toBlock=i),n&&(s.blockHash=n),s};let i,o,s=[];if(e.address)if(Array.isArray(e.address))for(const a of e.address)s.push(this._getAddress(a));else s.push(this._getAddress(e.address));return"fromBlock"in e&&(i=this._getBlockTag(e.fromBlock)),"toBlock"in e&&(o=this._getBlockTag(e.toBlock)),s.filter(e=>"string"!=typeof e).length||null!=i&&"string"!=typeof i||null!=o&&"string"!=typeof o?Promise.all([Promise.all(s),i,o]).then(e=>r(e[0],e[1],e[2])):r(s,i,o)}_getTransactionRequest(e){const t=Nh(e),n=[];if(["to","from"].forEach(e=>{if(null==t[e])return;const r=pa(t[e],this);Qd(r)?n.push(async function(){t[e]=await r}()):t[e]=r}),null!=t.blockTag){const e=this._getBlockTag(t.blockTag);Qd(e)?n.push(async function(){t.blockTag=await e}()):t.blockTag=e}return n.length?async function(){return await Promise.all(n),t}():t}async getNetwork(){if(null==wn(this,Tt)){const e=(async()=>{try{const n=await this._detectNetwork();return this.emit("network",n,null),n}catch(t){throw wn(this,Tt)===e&&On(this,Tt,null),t}})();return On(this,Tt,e),(await e).clone()}const e=wn(this,Tt),[t,n]=await Promise.all([e,this._detectNetwork()]);return t.chainId!==n.chainId&&(wn(this,Pt)?(this.emit("network",n,t),wn(this,Tt)===e&&On(this,Tt,Promise.resolve(n))):kn(!1,`network changed: ${t.chainId} => ${n.chainId} `,"NETWORK_ERROR",{event:"changed"})),t.clone()}async getFeeData(){const e=await this.getNetwork(),t=async()=>{const{_block:t,gasPrice:n,priorityFee:r}=await An({_block:En(this,Lt,Wt).call(this,"latest",!1),gasPrice:(async()=>{try{return tr(await En(this,Lt,Ut).call(this,{method:"getGasPrice"}),"%response")}catch{}return null})(),priorityFee:(async()=>{try{return tr(await En(this,Lt,Ut).call(this,{method:"getPriorityFee"}),"%response")}catch{}return null})()});let i=null,o=null;const s=this._wrapBlock(t,e);return s&&s.baseFeePerGas&&(o=null!=r?r:BigInt("1000000000"),i=s.baseFeePerGas*zd+o),new Ch(n,i,o)},n=e.getPlugin("org.ethers.plugins.network.FetchUrlFeeDataPlugin");if(n){const e=new kr(n.url),r=await n.processFunc(t,this,e);return new Ch(r.gasPrice,r.maxFeePerGas,r.maxPriorityFeePerGas)}return await t()}async estimateGas(e){let t=this._getTransactionRequest(e);return Qd(t)&&(t=await t),tr(await En(this,Lt,Ut).call(this,{method:"estimateGas",transaction:t}),"%response")}async call(e){const{tx:t,blockTag:n}=await An({tx:this._getTransactionRequest(e),blockTag:this._getBlockTag(e.blockTag)});return await En(this,Lt,jt).call(this,En(this,Lt,Bt).call(this,t,n,e.enableCcipRead?0:-1))}async getBalance(e,t){return tr(await En(this,Lt,Ht).call(this,{method:"getBalance"},e,t),"%response")}async getTransactionCount(e,t){return or(await En(this,Lt,Ht).call(this,{method:"getTransactionCount"},e,t),"%response")}async getCode(e,t){return Wn(await En(this,Lt,Ht).call(this,{method:"getCode"},e,t))}async getStorage(e,t,n){const r=tr(t,"position");return Wn(await En(this,Lt,Ht).call(this,{method:"getStorage",position:r},e,n))}async broadcastTransaction(e){const{blockNumber:t,hash:n,network:r}=await An({blockNumber:this.getBlockNumber(),hash:this._perform({method:"broadcastTransaction",signedTransaction:e}),network:this.getNetwork()}),i=gc.from(e);if(i.hash!==n)throw new Error("@TODO: the returned hash did not match");return this._wrapTransactionResponse(i,r).replaceableTransaction(t)}async getBlock(e,t){const{network:n,params:r}=await An({network:this.getNetwork(),params:En(this,Lt,Wt).call(this,e,!!t)});return null==r?null:this._wrapBlock(r,n)}async getTransaction(e){const{network:t,params:n}=await An({network:this.getNetwork(),params:En(this,Lt,Ut).call(this,{method:"getTransaction",hash:e})});return null==n?null:this._wrapTransactionResponse(n,t)}async getTransactionReceipt(e){const{network:t,params:n}=await An({network:this.getNetwork(),params:En(this,Lt,Ut).call(this,{method:"getTransactionReceipt",hash:e})});if(null==n)return null;if(null==n.gasPrice&&null==n.effectiveGasPrice){const t=await En(this,Lt,Ut).call(this,{method:"getTransaction",hash:e});if(null==t)throw new Error("report this; could not find tx or effectiveGasPrice");n.effectiveGasPrice=t.gasPrice}return this._wrapTransactionReceipt(n,t)}async getTransactionResult(e){const{result:t}=await An({network:this.getNetwork(),result:En(this,Lt,Ut).call(this,{method:"getTransactionResult",hash:e})});return null==t?null:Wn(t)}async getLogs(e){let t=this._getFilter(e);Qd(t)&&(t=await t);const{network:n,params:r}=await An({network:this.getNetwork(),params:En(this,Lt,Ut).call(this,{method:"getLogs",filter:t})});return r.map(e=>this._wrapLog(e,n))}_getProvider(e){kn(!1,"provider cannot connect to target network","UNSUPPORTED_OPERATION",{operation:"_getProvider()"})}async getResolver(e){return await vd.fromName(this,e)}async getAvatar(e){const t=await this.getResolver(e);return t?await t.getAvatar():null}async resolveName(e){const t=await this.getResolver(e);return t?await t.getAddress():null}async lookupAddress(e){const t=Yl((e=ua(e)).substring(2).toLowerCase()+".addr.reverse");try{const r=await vd.getEnsAddress(this),i=await new dd(r,["function resolver(bytes32) view returns (address)"],this).resolver(t);if(null==i||i===Fs)return null;const o=await new dd(i,["function name(bytes32) view returns (string)"],this).name(t);return await this.resolveName(o)!==e?null:o}catch(n){if(Tn(n,"BAD_DATA")&&"0x"===n.value||Tn(n,"CALL_EXCEPTION"))return null;throw n}return null}async waitForTransaction(e,t,n){const r=null!=t?t:1;return 0===r?this.getTransactionReceipt(e):new Promise(async(t,i)=>{let o=null;const s=async n=>{try{const s=await this.getTransactionReceipt(e);if(null!=s&&n-s.blockNumber+1>=r)return t(s),void(o&&(clearTimeout(o),o=null))}catch(i){console.log("EEE",i)}this.once("block",s)};null!=n&&(o=setTimeout(()=>{null!=o&&(o=null,this.off("block",s),i(Dn("timeout","TIMEOUT",{reason:"timeout"})))},n)),s(await this.getBlockNumber())})}async waitForBlock(e){kn(!1,"not implemented yet","NOT_IMPLEMENTED",{operation:"waitForBlock"})}_clearTimeout(e){const t=wn(this,xt).get(e);t&&(t.timer&&clearTimeout(t.timer),wn(this,xt).delete(e))}_setTimeout(e,t){null==t&&(t=0);const n=_n(this,It)._++,r=()=>{wn(this,xt).delete(n),e()};if(this.paused)wn(this,xt).set(n,{timer:null,func:r,time:t});else{const e=setTimeout(r,t);wn(this,xt).set(n,{timer:e,func:r,time:nf()})}return n}_forEachSubscriber(e){for(const t of wn(this,Nt).values())e(t.subscriber)}_getSubscriber(e){switch(e.type){case"debug":case"error":case"network":return new Yd(e.type);case"block":{const e=new Xd(this);return e.pollingInterval=this.pollingInterval,e}case"safe":case"finalized":return new Jd(this,e.type);case"event":return new Vd(this,e.filter);case"transaction":return new qd(this,e.hash);case"orphan":return new Gd(this,e.filter)}throw new Error(`unsupported event: ${e.type}`)}_recoverSubscriber(e,t){for(const n of wn(this,Nt).values())if(n.subscriber===e){n.started&&n.subscriber.stop(),n.subscriber=t,n.started&&t.start(),null!=wn(this,Rt)&&t.pause(wn(this,Rt));break}}async on(e,t){const n=await En(this,Lt,Ft).call(this,e);return n.listeners.push({listener:t,once:!1}),n.started||(n.subscriber.start(),n.started=!0,null!=wn(this,Rt)&&n.subscriber.pause(wn(this,Rt))),this}async once(e,t){const n=await En(this,Lt,Ft).call(this,e);return n.listeners.push({listener:t,once:!0}),n.started||(n.subscriber.start(),n.started=!0,null!=wn(this,Rt)&&n.subscriber.pause(wn(this,Rt))),this}async emit(e,...t){const n=await En(this,Lt,Xt).call(this,e,t);if(!n||0===n.listeners.length)return!1;const r=n.listeners.length;return n.listeners=n.listeners.filter(({listener:n,once:r})=>{const i=new pr(this,r?null:n,e);try{n.call(this,...t,i)}catch{}return!r}),0===n.listeners.length&&(n.started&&n.subscriber.stop(),wn(this,Nt).delete(n.tag)),r>0}async listenerCount(e){if(e){const t=await En(this,Lt,Xt).call(this,e);return t?t.listeners.length:0}let t=0;for(const{listeners:n}of wn(this,Nt).values())t+=n.length;return t}async listeners(e){if(e){const t=await En(this,Lt,Xt).call(this,e);return t?t.listeners.map(({listener:e})=>e):[]}let t=[];for(const{listeners:n}of wn(this,Nt).values())t=t.concat(n.map(({listener:e})=>e));return t}async off(e,t){const n=await En(this,Lt,Xt).call(this,e);if(!n)return this;if(t){const e=n.listeners.map(({listener:e})=>e).indexOf(t);e>=0&&n.listeners.splice(e,1)}return(!t||0===n.listeners.length)&&(n.started&&n.subscriber.stop(),wn(this,Nt).delete(n.tag)),this}async removeAllListeners(e){if(e){const{tag:t,started:n,subscriber:r}=await En(this,Lt,Ft).call(this,e);n&&r.stop(),wn(this,Nt).delete(t)}else for(const[t,{started:n,subscriber:r}]of wn(this,Nt))n&&r.stop(),wn(this,Nt).delete(t);return this}async addListener(e,t){return await this.on(e,t)}async removeListener(e,t){return this.off(e,t)}get destroyed(){return wn(this,St)}destroy(){this.removeAllListeners();for(const e of wn(this,xt).keys())this._clearTimeout(e);On(this,St,!0)}get paused(){return null!=wn(this,Rt)}set paused(e){!!e!==this.paused&&(this.paused?this.resume():this.pause(!1))}pause(e){if(On(this,kt,-1),null!=wn(this,Rt)){if(wn(this,Rt)==!!e)return;kn(!1,"cannot change pause type; resume first","UNSUPPORTED_OPERATION",{operation:"pause"})}this._forEachSubscriber(t=>t.pause(e)),On(this,Rt,!!e);for(const t of wn(this,xt).values())t.timer&&clearTimeout(t.timer),t.time=nf()-t.time}resume(){if(null!=wn(this,Rt)){this._forEachSubscriber(e=>e.resume()),On(this,Rt,null);for(const e of wn(this,xt).values()){let t=e.time;t<0&&(t=0),e.time=nf(),setTimeout(e.func,t)}}}}function sf(e,t){try{const n=af(e,t);if(n)return br(n)}catch{}return null}function af(e,t){if("0x"===e)return null;try{const n=or(Jn(e,t,t+32)),r=or(Jn(e,n,n+32));return Jn(e,n+32,n+32+r)}catch{}return null}function cf(e){const t=ar(e);if(t.length>32)throw new Error("internal; should not happen");const n=new Uint8Array(32);return n.set(t,32-t.length),n}function lf(e){if(e.length%32==0)return e;const t=new Uint8Array(32*Math.ceil(e.length/32));return t.set(e),t}Nt=new WeakMap,At=new WeakMap,Rt=new WeakMap,St=new WeakMap,Tt=new WeakMap,Pt=new WeakMap,Dt=new WeakMap,kt=new WeakMap,It=new WeakMap,xt=new WeakMap,Mt=new WeakMap,Kt=new WeakMap,Lt=new WeakSet,Ut=async function(e){const t=wn(this,Kt).cacheTimeout;if(t<0)return await this._perform(e);const n=$d(e.method,e);let r=wn(this,Dt).get(n);return r||(r=this._perform(e),wn(this,Dt).set(n,r),setTimeout(()=>{wn(this,Dt).get(n)===r&&wn(this,Dt).delete(n)},t)),await r},Bt=async function(e,t,n){kn(n<10,"CCIP read exceeded maximum redirections","OFFCHAIN_FAULT",{reason:"TOO_MANY_REDIRECTS",transaction:Object.assign({},e,{blockTag:t,enableCcipRead:!0})});const r=Nh(e);try{return Wn(await this._perform({method:"call",transaction:r,blockTag:t}))}catch(i){if(!this.disableCcipRead&&Pn(i)&&i.data&&n>=0&&"latest"===t&&null!=r.to&&"0x556f1830"===Jn(i.data,0,4)){const e=i.data,s=await pa(r.to,this);let a;try{a=ff(Jn(i.data,4))}catch(o){kn(!1,o.message,"OFFCHAIN_FAULT",{reason:"BAD_DATA",transaction:r,info:{data:e}})}kn(a.sender.toLowerCase()===s.toLowerCase(),"CCIP Read sender mismatch","CALL_EXCEPTION",{action:"call",data:e,reason:"OffchainLookup",transaction:r,invocation:null,revert:{signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",name:"OffchainLookup",args:a.errorArgs}});const c=await this.ccipReadFetch(r,a.calldata,a.urls);kn(null!=c,"CCIP Read failed to fetch data","OFFCHAIN_FAULT",{reason:"FETCH_FAILED",transaction:r,info:{data:i.data,errorArgs:a.errorArgs}});const l={to:s,data:Xn([a.selector,hf([c,a.extraData])])};this.emit("debug",{action:"sendCcipReadCall",transaction:l});try{const e=await En(this,Lt,Bt).call(this,l,t,n+1);return this.emit("debug",{action:"receiveCcipReadCallResult",transaction:Object.assign({},l),result:e}),e}catch(o){throw this.emit("debug",{action:"receiveCcipReadCallError",transaction:Object.assign({},l),error:o}),o}}throw i}},jt=async function(e){const{value:t}=await An({network:this.getNetwork(),value:e});return t},Ht=async function(e,t,n){let r=this._getAddress(t),i=this._getBlockTag(n);return("string"!=typeof r||"string"!=typeof i)&&([r,i]=await Promise.all([r,i])),await En(this,Lt,jt).call(this,En(this,Lt,Ut).call(this,Object.assign(e,{address:r,blockTag:i})))},Wt=async function(e,t){if(Bn(e,32))return await En(this,Lt,Ut).call(this,{method:"getBlock",blockHash:e,includeTransactions:t});let n=this._getBlockTag(e);return"string"!=typeof n&&(n=await n),await En(this,Lt,Ut).call(this,{method:"getBlock",blockTag:n,includeTransactions:t})},Xt=async function(e,t){let n=await tf(e,this);return"event"===n.type&&t&&t.length>0&&!0===t[0].removed&&(n=await tf({orphan:"drop-log",log:t[0]},this)),wn(this,Nt).get(n.tag)||null},Ft=async function(e){const t=await tf(e,this),n=t.tag;let r=wn(this,Nt).get(n);return r||(r={subscriber:this._getSubscriber(t),tag:n,addressableMap:new WeakMap,nameMap:new Map,started:!1,listeners:[]},wn(this,Nt).set(n,r)),r};const uf=new Uint8Array([]);function hf(e){const t=[];let n=0;for(let r=0;r<e.length;r++)t.push(uf),n+=32;for(let r=0;r<e.length;r++){const i=Ln(e[r]);t[r]=cf(n),t.push(cf(i.length)),t.push(lf(i)),n+=32+32*Math.ceil(i.length/32)}return Xn(t)}const df="0x0000000000000000000000000000000000000000000000000000000000000000";function ff(e){const t={sender:"",urls:[],calldata:"",selector:"",extraData:"",errorArgs:[]};kn(Fn(e)>=160,"insufficient OffchainLookup data","OFFCHAIN_FAULT",{reason:"insufficient OffchainLookup data"});const n=Jn(e,0,32);kn(Jn(n,0,12)===Jn(df,0,12),"corrupt OffchainLookup sender","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup sender"}),t.sender=Jn(n,12);try{const n=[],r=or(Jn(e,32,64)),i=or(Jn(e,r,r+32)),o=Jn(e,r+32);for(let e=0;e<i;e++){const t=sf(o,32*e);if(null==t)throw new Error("abort");n.push(t)}t.urls=n}catch{kn(!1,"corrupt OffchainLookup urls","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup urls"})}try{const n=af(e,64);if(null==n)throw new Error("abort");t.calldata=n}catch{kn(!1,"corrupt OffchainLookup calldata","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup calldata"})}kn(Jn(e,100,128)===Jn(df,0,28),"corrupt OffchainLookup callbaackSelector","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup callbaackSelector"}),t.selector=Jn(e,96,100);try{const n=af(e,128);if(null==n)throw new Error("abort");t.extraData=n}catch{kn(!1,"corrupt OffchainLookup extraData","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup extraData"})}return t.errorArgs="sender,urls,calldata,selector,extraData".split(/,/).map(e=>t[e]),t}function pf(e,t){if(e.provider)return e.provider;kn(!1,"missing provider","UNSUPPORTED_OPERATION",{operation:t})}async function gf(e,t){let n=Nh(t);if(null!=n.to&&(n.to=pa(n.to,e)),null!=n.from){const t=n.from;n.from=Promise.all([e.getAddress(),pa(t,e)]).then(([e,t])=>(In(e.toLowerCase()===t.toLowerCase(),"transaction from mismatch","tx.from",t),e))}else n.from=e.getAddress();return await An(n)}class mf{constructor(e){yn(this,"provider"),Rn(this,{provider:e||null})}async getNonce(e){return pf(this,"getTransactionCount").getTransactionCount(await this.getAddress(),e)}async populateCall(e){return await gf(this,e)}async populateTransaction(e){const t=pf(this,"populateTransaction"),n=await gf(this,e);null==n.nonce&&(n.nonce=await this.getNonce("pending")),null==n.gasLimit&&(n.gasLimit=await this.estimateGas(n));const r=await this.provider.getNetwork();null!=n.chainId?In(tr(n.chainId)===r.chainId,"transaction chainId mismatch","tx.chainId",e.chainId):n.chainId=r.chainId;const i=null!=n.maxFeePerGas||null!=n.maxPriorityFeePerGas;if(null==n.gasPrice||2!==n.type&&!i?(0===n.type||1===n.type)&&i&&In(!1,"pre-eip-1559 transaction do not support maxFeePerGas/maxPriorityFeePerGas","tx",e):In(!1,"eip-1559 transaction do not support gasPrice","tx",e),2!==n.type&&null!=n.type||null==n.maxFeePerGas||null==n.maxPriorityFeePerGas)if(0===n.type||1===n.type){const e=await t.getFeeData();kn(null!=e.gasPrice,"network does not support gasPrice","UNSUPPORTED_OPERATION",{operation:"getGasPrice"}),null==n.gasPrice&&(n.gasPrice=e.gasPrice)}else{const e=await t.getFeeData();if(null==n.type)if(null!=e.maxFeePerGas&&null!=e.maxPriorityFeePerGas)if(n.authorizationList&&n.authorizationList.length?n.type=4:n.type=2,null!=n.gasPrice){const e=n.gasPrice;delete n.gasPrice,n.maxFeePerGas=e,n.maxPriorityFeePerGas=e}else null==n.maxFeePerGas&&(n.maxFeePerGas=e.maxFeePerGas),null==n.maxPriorityFeePerGas&&(n.maxPriorityFeePerGas=e.maxPriorityFeePerGas);else null!=e.gasPrice?(kn(!i,"network does not support EIP-1559","UNSUPPORTED_OPERATION",{operation:"populateTransaction"}),null==n.gasPrice&&(n.gasPrice=e.gasPrice),n.type=0):kn(!1,"failed to get consistent fee data","UNSUPPORTED_OPERATION",{operation:"signer.getFeeData"});else(2===n.type||3===n.type||4===n.type)&&(null==n.maxFeePerGas&&(n.maxFeePerGas=e.maxFeePerGas),null==n.maxPriorityFeePerGas&&(n.maxPriorityFeePerGas=e.maxPriorityFeePerGas))}else n.type=2;return await An(n)}async populateAuthorization(e){const t=Object.assign({},e);return null==t.chainId&&(t.chainId=(await pf(this,"getNetwork").getNetwork()).chainId),null==t.nonce&&(t.nonce=await this.getNonce()),t}async estimateGas(e){return pf(this,"estimateGas").estimateGas(await this.populateCall(e))}async call(e){return pf(this,"call").call(await this.populateCall(e))}async resolveName(e){return await pf(this,"resolveName").resolveName(e)}async sendTransaction(e){const t=pf(this,"sendTransaction"),n=await this.populateTransaction(e);delete n.from;const r=gc.from(n);return await t.broadcastTransaction(await this.signTransaction(r))}authorize(e){kn(!1,"authorization not implemented for this signer","UNSUPPORTED_OPERATION",{operation:"authorize"})}}class yf{constructor(e){bn(this,$t),bn(this,Jt),bn(this,Gt),bn(this,qt),bn(this,Vt),bn(this,zt),bn(this,Qt),On(this,Jt,e),On(this,Gt,null),On(this,qt,En(this,$t,Yt).bind(this)),On(this,Vt,!1),On(this,zt,null),On(this,Qt,!1)}_subscribe(e){throw new Error("subclasses must override this")}_emitResults(e,t){throw new Error("subclasses must override this")}_recover(e){throw new Error("subclasses must override this")}start(){wn(this,Vt)||(On(this,Vt,!0),En(this,$t,Yt).call(this,-2))}stop(){wn(this,Vt)&&(On(this,Vt,!1),On(this,Qt,!0),En(this,$t,Zt).call(this),wn(this,Jt).off("block",wn(this,qt)))}pause(e){e&&En(this,$t,Zt).call(this),wn(this,Jt).off("block",wn(this,qt))}resume(){this.start()}}Jt=new WeakMap,Gt=new WeakMap,qt=new WeakMap,Vt=new WeakMap,zt=new WeakMap,Qt=new WeakMap,$t=new WeakSet,Yt=async function(){try{null==wn(this,Gt)&&On(this,Gt,this._subscribe(wn(this,Jt)));let n=null;try{n=await wn(this,Gt)}catch(e){if(!Tn(e,"UNSUPPORTED_OPERATION")||"eth_newFilter"!==e.operation)throw e}if(null==n)return On(this,Gt,null),void wn(this,Jt)._recoverSubscriber(this,this._recover(wn(this,Jt)));const r=await wn(this,Jt).getNetwork();if(wn(this,zt)||On(this,zt,r),wn(this,zt).chainId!==r.chainId)throw new Error("chaid changed");if(wn(this,Qt))return;const i=await wn(this,Jt).send("eth_getFilterChanges",[n]);await this._emitResults(wn(this,Jt),i)}catch(t){console.log("@TODO",t)}wn(this,Jt).once("block",wn(this,qt))},Zt=function(){const e=wn(this,Gt);e&&(On(this,Gt,null),e.then(e=>{wn(this,Jt).destroyed||wn(this,Jt).send("eth_uninstallFilter",[e])}))};class vf extends yf{constructor(e,t){var n;super(e),bn(this,en),On(this,en,(n=t,JSON.parse(JSON.stringify(n))))}_recover(e){return new Vd(e,wn(this,en))}async _subscribe(e){return await e.send("eth_newFilter",[wn(this,en)])}async _emitResults(e,t){for(const n of t)e.emit(wn(this,en),e._wrapLog(n,e._network))}}en=new WeakMap;class wf extends yf{async _subscribe(e){return await e.send("eth_newPendingTransactionFilter",[])}async _emitResults(e,t){for(const n of t)e.emit("pending",n)}}const bf="bigint,boolean,function,number,string,symbol".split(/,/g);function Of(e){if(null==e||bf.indexOf(typeof e)>=0||"function"==typeof e.getAddress)return e;if(Array.isArray(e))return e.map(Of);if("object"==typeof e)return Object.keys(e).reduce((t,n)=>(t[n]=e[n],t),{});throw new Error(`should not happen: ${e} (${typeof e})`)}function Ef(e){return new Promise(t=>{setTimeout(t,e)})}function _f(e){return e&&e.toLowerCase()}function Cf(e){return e&&"number"==typeof e.pollingInterval}const Nf={polling:!1,staticNetwork:null,batchStallTime:10,batchMaxSize:1<<20,batchMaxCount:100,cacheTimeout:250,pollingInterval:4e3};class Af extends mf{constructor(e,t){super(e),yn(this,"address"),Rn(this,{address:t=ua(t)})}connect(e){kn(!1,"cannot reconnect JsonRpcSigner","UNSUPPORTED_OPERATION",{operation:"signer.connect"})}async getAddress(){return this.address}async populateTransaction(e){return await this.populateCall(e)}async sendUncheckedTransaction(e){const t=Of(e),n=[];if(t.from){const r=t.from;n.push((async()=>{const n=await pa(r,this.provider);In(null!=n&&n.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",e),t.from=n})())}else t.from=this.address;if(null==t.gasLimit&&n.push((async()=>{t.gasLimit=await this.provider.estimateGas({...t,from:this.address})})()),null!=t.to){const e=t.to;n.push((async()=>{t.to=await pa(e,this.provider)})())}n.length&&await Promise.all(n);const r=this.provider.getRpcTransaction(t);return this.provider.send("eth_sendTransaction",[r])}async sendTransaction(e){const t=await this.provider.getBlockNumber(),n=await this.sendUncheckedTransaction(e);return await new Promise((e,r)=>{const i=[1e3,100];let o=0;const s=async()=>{try{const i=await this.provider.getTransaction(n);if(null!=i)return void e(i.replaceableTransaction(t))}catch(a){if(Tn(a,"CANCELLED")||Tn(a,"BAD_DATA")||Tn(a,"NETWORK_ERROR")||Tn(a,"UNSUPPORTED_OPERATION"))return null==a.info&&(a.info={}),a.info.sendTransactionHash=n,void r(a);if(Tn(a,"INVALID_ARGUMENT")&&(o++,null==a.info&&(a.info={}),a.info.sendTransactionHash=n,o>10))return void r(a);this.provider.emit("error",Dn("failed to fetch transation after sending (will try again)","UNKNOWN_ERROR",{error:a}))}this.provider._setTimeout(()=>{s()},i.pop()||4e3)};s()})}async signTransaction(e){const t=Of(e);if(t.from){const n=await pa(t.from,this.provider);In(null!=n&&n.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",e),t.from=n}else t.from=this.address;const n=this.provider.getRpcTransaction(t);return await this.provider.send("eth_signTransaction",[n])}async signMessage(e){const t="string"==typeof e?vr(e):e;return await this.provider.send("personal_sign",[Wn(t),this.address.toLowerCase()])}async signTypedData(e,t,n){const r=Of(n),i=await gu.resolveNames(e,t,r,async e=>{const t=await pa(e);return In(null!=t,"TypedData does not support null address","value",e),t});return await this.provider.send("eth_signTypedData_v4",[this.address.toLowerCase(),JSON.stringify(gu.getPayload(i.domain,t,i.value))])}async unlock(e){return this.provider.send("personal_unlockAccount",[this.address.toLowerCase(),e,null])}async _legacySignMessage(e){const t="string"==typeof e?vr(e):e;return await this.provider.send("eth_sign",[this.address.toLowerCase(),Wn(t)])}}class Rf extends of{constructor(e,t){super(e,t),bn(this,ln),bn(this,tn),bn(this,nn),bn(this,rn),bn(this,on),bn(this,sn),bn(this,an),bn(this,cn),On(this,nn,1),On(this,tn,Object.assign({},Nf,t||{})),On(this,rn,[]),On(this,on,null),On(this,an,null),On(this,cn,null);{let e=null;const t=new Promise(t=>{e=t});On(this,sn,{promise:t,resolve:e})}const n=this._getOption("staticNetwork");"boolean"==typeof n?(In(!n||"any"!==e,"staticNetwork cannot be used on special network 'any'","options",t),n&&null!=e&&On(this,an,Ld.from(e))):n&&(In(null==e||n.matches(e),"staticNetwork MUST match network object","options",t),On(this,an,n))}_getOption(e){return wn(this,tn)[e]}get _network(){return kn(wn(this,an),"network is not available yet","NETWORK_ERROR"),wn(this,an)}async _perform(e){if("call"===e.method||"estimateGas"===e.method){let t=e.transaction;if(t&&null!=t.type&&tr(t.type)&&null==t.maxFeePerGas&&null==t.maxPriorityFeePerGas){const n=await this.getFeeData();null==n.maxFeePerGas&&null==n.maxPriorityFeePerGas&&(e=Object.assign({},e,{transaction:Object.assign({},t,{type:void 0})}))}}const t=this.getRpcRequest(e);return null!=t?await this.send(t.method,t.args):super._perform(e)}async _detectNetwork(){const e=this._getOption("staticNetwork");if(e){if(!0!==e)return e;if(wn(this,an))return wn(this,an)}return wn(this,cn)?await wn(this,cn):this.ready?(On(this,cn,(async()=>{try{const t=Ld.from(tr(await this.send("eth_chainId",[])));return On(this,cn,null),t}catch(e){throw On(this,cn,null),e}})()),await wn(this,cn)):(On(this,cn,(async()=>{const e={id:_n(this,nn)._++,method:"eth_chainId",params:[],jsonrpc:"2.0"};let t;this.emit("debug",{action:"sendRpcPayload",payload:e});try{t=(await this._send(e))[0],On(this,cn,null)}catch(n){throw On(this,cn,null),this.emit("debug",{action:"receiveRpcError",error:n}),n}if(this.emit("debug",{action:"receiveRpcResult",result:t}),"result"in t)return Ld.from(tr(t.result));throw this.getRpcError(e,t)})()),await wn(this,cn))}_start(){null==wn(this,sn)||null==wn(this,sn).resolve||(wn(this,sn).resolve(),On(this,sn,null),(async()=>{for(;null==wn(this,an)&&!this.destroyed;)try{On(this,an,await this._detectNetwork())}catch(e){if(this.destroyed)break;console.log("JsonRpcProvider failed to detect network and cannot start up; retry in 1s (perhaps the URL is wrong or the node is not started)"),this.emit("error",Dn("failed to bootstrap network detection","NETWORK_ERROR",{event:"initial-network-discovery",info:{error:e}})),await Ef(1e3)}En(this,ln,un).call(this)})())}async _waitUntilReady(){if(null!=wn(this,sn))return await wn(this,sn).promise}_getSubscriber(e){return"pending"===e.type?new wf(this):"event"===e.type?this._getOption("polling")?new Vd(this,e.filter):new vf(this,e.filter):"orphan"===e.type&&"drop-log"===e.filter.orphan?new Yd("orphan"):super._getSubscriber(e)}get ready(){return null==wn(this,sn)}getRpcTransaction(e){const t={};return["chainId","gasLimit","gasPrice","type","maxFeePerGas","maxPriorityFeePerGas","nonce","value"].forEach(n=>{if(null==e[n])return;let r=n;"gasLimit"===n&&(r="gas"),t[r]=cr(tr(e[n],`tx.${n}`))}),["from","to","data"].forEach(n=>{null!=e[n]&&(t[n]=Wn(e[n]))}),e.accessList&&(t.accessList=Ua(e.accessList)),e.blobVersionedHashes&&(t.blobVersionedHashes=e.blobVersionedHashes.map(e=>e.toLowerCase())),e.authorizationList&&(t.authorizationList=e.authorizationList.map(e=>{const t=Ba(e);return{address:t.address,nonce:cr(t.nonce),chainId:cr(t.chainId),yParity:cr(t.signature.yParity),r:cr(t.signature.r),s:cr(t.signature.s)}})),t}getRpcRequest(e){switch(e.method){case"chainId":return{method:"eth_chainId",args:[]};case"getBlockNumber":return{method:"eth_blockNumber",args:[]};case"getGasPrice":return{method:"eth_gasPrice",args:[]};case"getPriorityFee":return{method:"eth_maxPriorityFeePerGas",args:[]};case"getBalance":return{method:"eth_getBalance",args:[_f(e.address),e.blockTag]};case"getTransactionCount":return{method:"eth_getTransactionCount",args:[_f(e.address),e.blockTag]};case"getCode":return{method:"eth_getCode",args:[_f(e.address),e.blockTag]};case"getStorage":return{method:"eth_getStorageAt",args:[_f(e.address),"0x"+e.position.toString(16),e.blockTag]};case"broadcastTransaction":return{method:"eth_sendRawTransaction",args:[e.signedTransaction]};case"getBlock":if("blockTag"in e)return{method:"eth_getBlockByNumber",args:[e.blockTag,!!e.includeTransactions]};if("blockHash"in e)return{method:"eth_getBlockByHash",args:[e.blockHash,!!e.includeTransactions]};break;case"getTransaction":return{method:"eth_getTransactionByHash",args:[e.hash]};case"getTransactionReceipt":return{method:"eth_getTransactionReceipt",args:[e.hash]};case"call":return{method:"eth_call",args:[this.getRpcTransaction(e.transaction),e.blockTag]};case"estimateGas":return{method:"eth_estimateGas",args:[this.getRpcTransaction(e.transaction)]};case"getLogs":return e.filter&&null!=e.filter.address&&(Array.isArray(e.filter.address)?e.filter.address=e.filter.address.map(_f):e.filter.address=_f(e.filter.address)),{method:"eth_getLogs",args:[e.filter]}}return null}getRpcError(e,t){const{method:n}=e,{error:r}=t;if("eth_estimateGas"===n&&r.message){const t=r.message;if(!t.match(/revert/i)&&t.match(/insufficient funds/i))return Dn("insufficient funds","INSUFFICIENT_FUNDS",{transaction:e.params[0],info:{payload:e,error:r}});if(t.match(/nonce/i)&&t.match(/too low/i))return Dn("nonce has already been used","NONCE_EXPIRED",{transaction:e.params[0],info:{payload:e,error:r}})}if("eth_call"===n||"eth_estimateGas"===n){const t=Tf(r),i=ph.getBuiltinCallException("eth_call"===n?"call":"estimateGas",e.params[0],t?t.data:null);return i.info={error:r,payload:e},i}const i=JSON.stringify(Df(r));if("string"==typeof r.message&&r.message.match(/user denied|ethers-user-denied/i))return Dn("user rejected action","ACTION_REJECTED",{action:{eth_sign:"signMessage",personal_sign:"signMessage",eth_signTypedData_v4:"signTypedData",eth_signTransaction:"signTransaction",eth_sendTransaction:"sendTransaction",eth_requestAccounts:"requestAccess",wallet_requestAccounts:"requestAccess"}[n]||"unknown",reason:"rejected",info:{payload:e,error:r}});if("eth_sendRawTransaction"===n||"eth_sendTransaction"===n){const t=e.params[0];if(i.match(/insufficient funds|base fee exceeds gas limit/i))return Dn("insufficient funds for intrinsic transaction cost","INSUFFICIENT_FUNDS",{transaction:t,info:{error:r}});if(i.match(/nonce/i)&&i.match(/too low/i))return Dn("nonce has already been used","NONCE_EXPIRED",{transaction:t,info:{error:r}});if(i.match(/replacement transaction/i)&&i.match(/underpriced/i))return Dn("replacement fee too low","REPLACEMENT_UNDERPRICED",{transaction:t,info:{error:r}});if(i.match(/only replay-protected/i))return Dn("legacy pre-eip-155 transactions not supported","UNSUPPORTED_OPERATION",{operation:n,info:{transaction:t,info:{error:r}}})}let o=!!i.match(/the method .* does not exist/i);return o||r&&r.details&&r.details.startsWith("Unauthorized method:")&&(o=!0),o?Dn("unsupported operation","UNSUPPORTED_OPERATION",{operation:e.method,info:{error:r,payload:e}}):Dn("could not coalesce error","UNKNOWN_ERROR",{error:r,payload:e})}send(e,t){if(this.destroyed)return Promise.reject(Dn("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:e}));const n=_n(this,nn)._++,r=new Promise((r,i)=>{wn(this,rn).push({resolve:r,reject:i,payload:{method:e,params:t,id:n,jsonrpc:"2.0"}})});return En(this,ln,un).call(this),r}async getSigner(e){null==e&&(e=0);const t=this.send("eth_accounts",[]);if("number"==typeof e){const n=await t;if(e>=n.length)throw new Error("no such account");return new Af(this,n[e])}const{accounts:n}=await An({network:this.getNetwork(),accounts:t});e=ua(e);for(const r of n)if(ua(r)===e)return new Af(this,e);throw new Error("invalid account")}async listAccounts(){return(await this.send("eth_accounts",[])).map(e=>new Af(this,e))}destroy(){wn(this,on)&&(clearTimeout(wn(this,on)),On(this,on,null));for(const{payload:e,reject:t}of wn(this,rn))t(Dn("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:e.method}));On(this,rn,[]),super.destroy()}}tn=new WeakMap,nn=new WeakMap,rn=new WeakMap,on=new WeakMap,sn=new WeakMap,an=new WeakMap,cn=new WeakMap,ln=new WeakSet,un=function(){if(wn(this,on))return;const e=1===this._getOption("batchMaxCount")?0:this._getOption("batchStallTime");On(this,on,setTimeout(()=>{On(this,on,null);const e=wn(this,rn);for(On(this,rn,[]);e.length;){const t=[e.shift()];for(;e.length&&t.length!==wn(this,tn).batchMaxCount;)if(t.push(e.shift()),JSON.stringify(t.map(e=>e.payload)).length>wn(this,tn).batchMaxSize){e.unshift(t.pop());break}(async()=>{const e=1===t.length?t[0].payload:t.map(e=>e.payload);this.emit("debug",{action:"sendRpcPayload",payload:e});try{const r=await this._send(e);this.emit("debug",{action:"receiveRpcResult",result:r});for(const{resolve:e,reject:n,payload:i}of t){if(this.destroyed){n(Dn("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:i.method}));continue}const t=r.filter(e=>e.id===i.id)[0];if(null!=t)"error"in t?n(this.getRpcError(i,t)):e(t.result);else{const e=Dn("missing response for request","BAD_DATA",{value:r,info:{payload:i}});this.emit("error",e),n(e)}}}catch(n){this.emit("debug",{action:"receiveRpcError",error:n});for(const{reject:e}of t)e(n)}})()}},e))};class Sf extends Rf{constructor(e,t){super(e,t),bn(this,hn);let n=this._getOption("pollingInterval");null==n&&(n=Nf.pollingInterval),On(this,hn,n)}_getSubscriber(e){const t=super._getSubscriber(e);return Cf(t)&&(t.pollingInterval=wn(this,hn)),t}get pollingInterval(){return wn(this,hn)}set pollingInterval(e){if(!Number.isInteger(e)||e<0)throw new Error("invalid interval");On(this,hn,e),this._forEachSubscriber(e=>{Cf(e)&&(e.pollingInterval=wn(this,hn))})}}function Tf(e){if(null==e)return null;if("string"==typeof e.message&&e.message.match(/revert/i)&&Bn(e.data))return{message:e.message,data:e.data};if("object"==typeof e){for(const t in e){const n=Tf(e[t]);if(n)return n}return null}if("string"==typeof e)try{return Tf(JSON.parse(e))}catch{}return null}function Pf(e,t){if(null!=e){if("string"==typeof e.message&&t.push(e.message),"object"==typeof e)for(const n in e)Pf(e[n],t);if("string"==typeof e)try{return Pf(JSON.parse(e),t)}catch{}}}function Df(e){const t=[];return Pf(e,t),t}hn=new WeakMap,dn=new WeakMap,fn=new WeakMap;let kf=class e extends Sf{constructor(e,t,n){const r=Object.assign({},null!=n?n:{},{batchMaxCount:1});In(e&&e.request,"invalid EIP-1193 provider","ethereum",e),super(t,r),bn(this,dn),bn(this,fn),On(this,fn,null),n&&n.providerInfo&&On(this,fn,n.providerInfo),On(this,dn,async(t,n)=>{const r={method:t,params:n};this.emit("debug",{action:"sendEip1193Request",payload:r});try{const t=await e.request(r);return this.emit("debug",{action:"receiveEip1193Result",result:t}),t}catch(i){const e=new Error(i.message);throw e.code=i.code,e.data=i.data,e.payload=r,this.emit("debug",{action:"receiveEip1193Error",error:e}),e}})}get providerInfo(){return wn(this,fn)}async send(e,t){return await this._start(),await super.send(e,t)}async _send(e){In(!Array.isArray(e),"EIP-1193 does not support batch request","payload",e);try{const n=await wn(this,dn).call(this,e.method,e.params||[]);return[{id:e.id,result:n}]}catch(t){return[{id:e.id,error:{code:t.code,data:t.data,message:t.message}}]}}getRpcError(e,t){switch((t=JSON.parse(JSON.stringify(t))).error.code||-1){case 4001:t.error.message=`ethers-user-denied: ${t.error.message}`;break;case 4200:t.error.message=`ethers-unsupported: ${t.error.message}`}return super.getRpcError(e,t)}async hasSigner(e){null==e&&(e=0);const t=await this.send("eth_accounts",[]);return"number"==typeof e?t.length>e:(e=e.toLowerCase(),0!==t.filter(t=>t.toLowerCase()===e).length)}async getSigner(e){if(null==e&&(e=0),!(await this.hasSigner(e)))try{await wn(this,dn).call(this,"eth_requestAccounts",[])}catch(t){const e=t.payload;throw this.getRpcError(e,{id:e.id,error:t})}return await super.getSigner(e)}static async discover(t){if(null==t&&(t={}),t.provider)return new e(t.provider);const n=t.window?t.window:"undefined"!=typeof window?window:null;if(null==n)return null;const r=t.anyProvider;if(r&&n.ethereum)return new e(n.ethereum);if(!("addEventListener"in n&&"dispatchEvent"in n&&"removeEventListener"in n))return null;const i=t.timeout?t.timeout:300;return 0===i?null:await new Promise((o,s)=>{let a=[];const c=e=>{a.push(e.detail),r&&l()},l=()=>{if(clearTimeout(u),a.length)if(t&&t.filter){const n=t.filter(a.map(e=>Object.assign({},e.info)));if(null==n)o(null);else if(n instanceof e)o(n);else{let t=null;if(n.uuid&&(t=a.filter(e=>n.uuid===e.info.uuid)[0]),t){const{provider:n,info:r}=t;o(new e(n,void 0,{providerInfo:r}))}else s(Dn("filter returned unknown info","UNSUPPORTED_OPERATION",{value:n}))}}else{const{provider:t,info:n}=a[0];o(new e(t,void 0,{providerInfo:n}))}else o(null);n.removeEventListener("eip6963:announceProvider",c)},u=setTimeout(()=>{l()},i);n.addEventListener("eip6963:announceProvider",c),n.dispatchEvent(new Event("eip6963:requestProvider"))})}};class If{constructor(){yn(this,"providerConfig",{}),yn(this,"tokenConfig",{}),yn(this,"_address",""),yn(this,"_provider",null),yn(this,"_signer",null),yn(this,"curChainId",97),yn(this,"contractMap",new Map),yn(this,"contractReadMap",new Map)}async init(){}async initProviderConfig(e){this.providerConfig=e}async initTokenConfig(e){this.tokenConfig=e}async initCurChainId(e){this.curChainId=e}async connect(e,t){}async isConnected(){return!1}async sign(e,t){}async getAddress(){return this._address}async getChainId(){return 0}async changeChain(e){}async setContractMap(e,t,n){let r=new dd(t,n,this._signer);this.contractMap.set(e,r)}async setContractReadMap(e,t,n){let r=new dd(t,n,this._provider);this.contractReadMap.set(e,r)}async getContractMap(e){return this.contractMap.get(e)}async getContractReadMap(e){return this.contractReadMap.get(e)}async contractBalance(e,t,n=!1){try{const i=await e.balanceOf(t);let o="";return o=n?i.toString():await this.formatEther(i),Number(o)}catch(r){return console.log(" contractBalance error ",r),0}}async approveContract(e,t,n,r=!1){let i=0;i=r?n:await this.amountToWei(n);const o=await e.approve(t,i);console.log("approve tx:",o)}async allowanceNum(e,t,n){try{const i=await e.allowance(t,n);let o=await this.formatEther(i);return Number(o)}catch(r){return console.log(" ----------- allowanceNum error  ",r),0}}async transferToken(e,t,n,r){let i=await this.amountToWei(n);console.log(" == amountWei",i);try{let n=await e.transfer(t,i);console.log("tx",n);const s=await n.wait();return console.log("receipt",s),n}catch(o){return console.log("transferToken error",o),r&&r(),null}}async formatEther(e){return Number((t=e,ri(t,18))).toFixed(8);var t}async amountToWei(e){return ii(e.toString(),18)}async accountChangedHandler(e){this._address&&e[0]!=this._address&&this.errorHandler("accountChanged")}async chainChangedHandler(e){console.log("change chainId: ",e),this.errorHandler("chainChanged")}async disconnectHandler(){console.log("disconnect"),this.errorHandler("disconnect")}async errorHandler(e){console.log(" error ",e);try{this._provider&&this._provider.disconnect&&this._provider.disconnect()}catch(t){console.log(" --- error ",t)}localStorage.clear(),sessionStorage.clear(),window.location.reload()}}const xf=class e extends If{static get instance(){return this._instance||(this._instance=new e),this._instance}async init(){try{"undefined"!==window.ethereum&&void 0!==window.ethereum&&(window.ethereum.on("disconnect",this.disconnectHandler.bind(this)),window.ethereum.on("accountsChanged",this.accountChangedHandler.bind(this)),window.ethereum.on("chainChanged",this.chainChangedHandler.bind(this)))}catch(e){console.error("MetaMaskEVMApi init error",e)}}async connect(e,t){try{if("undefined"===window.ethereum||void 0===window.ethereum)return console.log("ethereum  not installed"),void(t&&t());if(!window.ethereum.isMetaMask)return console.log("MetaMask not installed"),void(t&&t());{let n=await window.ethereum.request({method:"eth_accounts"});if(n.length>0)this._address=n[0];else{let e=await window.ethereum.request({method:"eth_requestAccounts"});this._address=e[0]}""!=this._address?(this._provider=new kf(window.ethereum),this._signer=await this._provider.getSigner(),await this.getChainId()==this.curChainId?this.sign(this._address,e):this.changeChain(()=>{this.sign(this._address,e)})):t&&t()}}catch{t&&t()}}async getAddress(){return this._address}async isConnected(){return(await window.ethereum.request({method:"eth_accounts"})).length>0}async sign(e,t){try{await this._signer.signMessage("Welcome to Coinop Game!"),t(e)}catch(n){this.errorHandler(n)}}async getChainId(){try{return(await this._provider.getNetwork()).chainId}catch(e){return console.error("error:",e),0}}async changeChain(e){try{await this.getChainId()!=this.curChainId&&window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:"0x"+Number(this.curChainId).toString(16)}]}).then(()=>{console.log("\u6210\u529f")}).catch(async e=>{console.error(`ERROR:${e.message}`),4902===e.code?window.ethereum.request({method:"wallet_addEthereumChain",params:[this.providerConfig[this.curChainId]]}).then(()=>{}).catch(e=>{this.errorHandler(e)}):(console.log("error: \u5207\u94fe\u5931\u8d25",e),this.errorHandler(""))})}catch(t){console.log("error: \u5207\u94fe\u5931\u8d25",t),this.errorHandler("")}}async transferToken(e,t,n,r){let i=this.amountToWei(n);try{let n=await e.transfer(t,i);console.log("tx",n);const s=await n.wait();return console.log("receipt",s),n}catch(o){return console.log("transferToken error",o),r&&r(),null}}};yn(xf,"_instance");let Mf=xf;var Kf="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Lf(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if("function"==typeof t){var n=function e(){return this instanceof e?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(t){var r=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(n,t,r.get?r:{enumerable:!0,get:function(){return e[t]}})}),n}var Uf,Bf={},jf={},Hf={};var Wf,Xf,Ff={};function Jf(){return Xf||(Xf=1,e=jf,t=jf&&jf.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=jf&&jf.__exportStar||function(e,n){for(var r in e)"default"!==r&&!Object.prototype.hasOwnProperty.call(n,r)&&t(n,e,r)},Object.defineProperty(e,"__esModule",{value:!0}),n(Uf?Hf:(Uf=1,Object.defineProperty(Hf,"__esModule",{value:!0}),Hf.IJSONRpcProvider=Hf.IJSONRpcConnection=void 0,Hf.IJSONRpcConnection=class{},Hf.IJSONRpcProvider=class{constructor(e){}},Hf),e),n((Wf||(Wf=1,Object.defineProperty(Ff,"__esModule",{value:!0})),Ff),e)),jf;var e,t,n}var Gf,qf={},Vf={},zf={},Qf={},$f={},Yf={},Zf={};function ep(){return Gf||(Gf=1,e=Zf,Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectorState=e.CONNECT_PROTOCOL_VER=e.CONNECT_JSONRPC_VER=e.OKXCONNECTOR_SESSION_LIVE_TTL=e.OKXCONNECTOR_MESSAGE_DISCONNECT_TTL=e.OKXCONNECTOR_MESSAGE_TTL=e.OKXCONNECTOR_WS_URL_PENDING_CLOSE_CODE=e.OKXCONNECTOR_WS_URL_LIST=e.OKXCONNECTOR_WS_URL_IDX_KEY=e.OKXCONNECTOR_WS_URL_3=e.OKXCONNECTOR_WS_URL_2=e.OKXCONNECTOR_WS_URL_1=e.EVENT_EMITTER_MAX_LISTENERS=e.OKXCONNECTOR_PROTOCOL_VERSION=void 0,e.OKXCONNECTOR_PROTOCOL_VERSION=2,e.EVENT_EMITTER_MAX_LISTENERS=10,e.OKXCONNECTOR_WS_URL_1="wss://wsdexpri.okx.com/ws/v1/wallet-connect-relay",e.OKXCONNECTOR_WS_URL_2="wss://wsdexpri.okx.ac/ws/v1/wallet-connect-relay",e.OKXCONNECTOR_WS_URL_3="wss://wsdexpri.coinall.ltd/ws/v1/wallet-connect-relay",e.OKXCONNECTOR_WS_URL_IDX_KEY="wuik",e.OKXCONNECTOR_WS_URL_LIST=[e.OKXCONNECTOR_WS_URL_1,e.OKXCONNECTOR_WS_URL_2,e.OKXCONNECTOR_WS_URL_3],e.OKXCONNECTOR_WS_URL_PENDING_CLOSE_CODE={TIME_OUT:3990,CANCELED:3991,FINISHED:3992},e.OKXCONNECTOR_MESSAGE_TTL=3e5,e.OKXCONNECTOR_MESSAGE_DISCONNECT_TTL=864e5,e.OKXCONNECTOR_SESSION_LIVE_TTL=864e5,e.CONNECT_JSONRPC_VER="2.0",e.CONNECT_PROTOCOL_VER=2,e.ConnectorState={InitState:0,Connecting:1,Connected:2,Disconnected:3,OnError:4}),Zf;var e}var tp,np={};function rp(){return tp||(tp=1,Object.defineProperty(np,"__esModule",{value:!0}),np.OKXCONNECTOR_STORAGE_TOPIC_WALLET_EXPIRE_CACHE=np.OKXCONNECTOR_STORAGE_TOPIC_EXPIRE_CACHE=np.OKXCONNECTOR_STORAGE_PROTOCOL_CACHE=np.OKXCONNECTOR_STORAGE_CIPHER_METHOD=np.OKXCONNECTOR_STORAGE_CRYPTO_CIPHERIV=np.OKXCONNECTOR_STORAGER_CRYPTO_SALT=np.OKXCONNECTOR_STORAGE_CRYPTO_PASSWORD=np.OKXCONNECTOR_TON_KEY=np.OKXCONNECTOR_CRYPTO_SENDER_PK_CACHE=np.OKXCONNECTOR_TOKEN_CACHE=np.OKXCONNECTOR_JWT_KEY=np.OKXCONNECTOR_SESSION_PREFIX_KEY=np.OKXCONNECTOR_CRYPTO_KEY=np.OKXCONNECTOR_CACHE_KEY_DAPP=np.OKXCONNECTOR_CACHE_KEY=void 0,np.OKXCONNECTOR_CACHE_KEY="ck",np.OKXCONNECTOR_CACHE_KEY_DAPP="ck_dapp",np.OKXCONNECTOR_CRYPTO_KEY="cck_k",np.OKXCONNECTOR_SESSION_PREFIX_KEY="cspk_",np.OKXCONNECTOR_JWT_KEY="cjk_k",np.OKXCONNECTOR_TOKEN_CACHE="ct",np.OKXCONNECTOR_CRYPTO_SENDER_PK_CACHE="csp",np.OKXCONNECTOR_TON_KEY="OKXStorage_ctc",np.OKXCONNECTOR_STORAGE_CRYPTO_PASSWORD="scp",np.OKXCONNECTOR_STORAGER_CRYPTO_SALT="scs",np.OKXCONNECTOR_STORAGE_CRYPTO_CIPHERIV="scpc",np.OKXCONNECTOR_STORAGE_CIPHER_METHOD="aes-256-cbc",np.OKXCONNECTOR_STORAGE_PROTOCOL_CACHE="okx_connect_split_cache_key",np.OKXCONNECTOR_STORAGE_TOPIC_EXPIRE_CACHE="okx_connect_te_cache_key",np.OKXCONNECTOR_STORAGE_TOPIC_WALLET_EXPIRE_CACHE="okx_connect_twe_cache_key"),np}var ip={};function op(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var sp={exports:{}};const ap=Lf(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})));var cp;function lp(){return cp||(cp=1,function(e){var t=function(e){var t,n=new Float64Array(16);if(e)for(t=0;t<e.length;t++)n[t]=e[t];return n},n=function(){throw new Error("no PRNG")},r=new Uint8Array(16),i=new Uint8Array(32);i[0]=9;var o=t(),s=t([1]),a=t([56129,1]),c=t([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),l=t([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),u=t([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),h=t([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),d=t([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function f(e,t,n,r){e[t]=n>>24&255,e[t+1]=n>>16&255,e[t+2]=n>>8&255,e[t+3]=255&n,e[t+4]=r>>24&255,e[t+5]=r>>16&255,e[t+6]=r>>8&255,e[t+7]=255&r}function p(e,t,n,r,i){var o,s=0;for(o=0;o<i;o++)s|=e[t+o]^n[r+o];return(1&s-1>>>8)-1}function g(e,t,n,r){return p(e,t,n,r,16)}function m(e,t,n,r){return p(e,t,n,r,32)}function y(e,t,n,r){for(var i,o=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,s=255&n[0]|(255&n[1])<<8|(255&n[2])<<16|(255&n[3])<<24,a=255&n[4]|(255&n[5])<<8|(255&n[6])<<16|(255&n[7])<<24,c=255&n[8]|(255&n[9])<<8|(255&n[10])<<16|(255&n[11])<<24,l=255&n[12]|(255&n[13])<<8|(255&n[14])<<16|(255&n[15])<<24,u=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,h=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,d=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,f=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,p=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,g=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,m=255&n[16]|(255&n[17])<<8|(255&n[18])<<16|(255&n[19])<<24,y=255&n[20]|(255&n[21])<<8|(255&n[22])<<16|(255&n[23])<<24,v=255&n[24]|(255&n[25])<<8|(255&n[26])<<16|(255&n[27])<<24,w=255&n[28]|(255&n[29])<<8|(255&n[30])<<16|(255&n[31])<<24,b=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,O=o,E=s,_=a,C=c,N=l,A=u,R=h,S=d,T=f,P=p,D=g,k=m,I=y,x=v,M=w,K=b,L=0;L<20;L+=2)O^=(i=(I^=(i=(T^=(i=(N^=(i=O+I|0)<<7|i>>>25)+O|0)<<9|i>>>23)+N|0)<<13|i>>>19)+T|0)<<18|i>>>14,A^=(i=(E^=(i=(x^=(i=(P^=(i=A+E|0)<<7|i>>>25)+A|0)<<9|i>>>23)+P|0)<<13|i>>>19)+x|0)<<18|i>>>14,D^=(i=(R^=(i=(_^=(i=(M^=(i=D+R|0)<<7|i>>>25)+D|0)<<9|i>>>23)+M|0)<<13|i>>>19)+_|0)<<18|i>>>14,K^=(i=(k^=(i=(S^=(i=(C^=(i=K+k|0)<<7|i>>>25)+K|0)<<9|i>>>23)+C|0)<<13|i>>>19)+S|0)<<18|i>>>14,O^=(i=(C^=(i=(_^=(i=(E^=(i=O+C|0)<<7|i>>>25)+O|0)<<9|i>>>23)+E|0)<<13|i>>>19)+_|0)<<18|i>>>14,A^=(i=(N^=(i=(S^=(i=(R^=(i=A+N|0)<<7|i>>>25)+A|0)<<9|i>>>23)+R|0)<<13|i>>>19)+S|0)<<18|i>>>14,D^=(i=(P^=(i=(T^=(i=(k^=(i=D+P|0)<<7|i>>>25)+D|0)<<9|i>>>23)+k|0)<<13|i>>>19)+T|0)<<18|i>>>14,K^=(i=(M^=(i=(x^=(i=(I^=(i=K+M|0)<<7|i>>>25)+K|0)<<9|i>>>23)+I|0)<<13|i>>>19)+x|0)<<18|i>>>14;O=O+o|0,E=E+s|0,_=_+a|0,C=C+c|0,N=N+l|0,A=A+u|0,R=R+h|0,S=S+d|0,T=T+f|0,P=P+p|0,D=D+g|0,k=k+m|0,I=I+y|0,x=x+v|0,M=M+w|0,K=K+b|0,e[0]=O>>>0&255,e[1]=O>>>8&255,e[2]=O>>>16&255,e[3]=O>>>24&255,e[4]=E>>>0&255,e[5]=E>>>8&255,e[6]=E>>>16&255,e[7]=E>>>24&255,e[8]=_>>>0&255,e[9]=_>>>8&255,e[10]=_>>>16&255,e[11]=_>>>24&255,e[12]=C>>>0&255,e[13]=C>>>8&255,e[14]=C>>>16&255,e[15]=C>>>24&255,e[16]=N>>>0&255,e[17]=N>>>8&255,e[18]=N>>>16&255,e[19]=N>>>24&255,e[20]=A>>>0&255,e[21]=A>>>8&255,e[22]=A>>>16&255,e[23]=A>>>24&255,e[24]=R>>>0&255,e[25]=R>>>8&255,e[26]=R>>>16&255,e[27]=R>>>24&255,e[28]=S>>>0&255,e[29]=S>>>8&255,e[30]=S>>>16&255,e[31]=S>>>24&255,e[32]=T>>>0&255,e[33]=T>>>8&255,e[34]=T>>>16&255,e[35]=T>>>24&255,e[36]=P>>>0&255,e[37]=P>>>8&255,e[38]=P>>>16&255,e[39]=P>>>24&255,e[40]=D>>>0&255,e[41]=D>>>8&255,e[42]=D>>>16&255,e[43]=D>>>24&255,e[44]=k>>>0&255,e[45]=k>>>8&255,e[46]=k>>>16&255,e[47]=k>>>24&255,e[48]=I>>>0&255,e[49]=I>>>8&255,e[50]=I>>>16&255,e[51]=I>>>24&255,e[52]=x>>>0&255,e[53]=x>>>8&255,e[54]=x>>>16&255,e[55]=x>>>24&255,e[56]=M>>>0&255,e[57]=M>>>8&255,e[58]=M>>>16&255,e[59]=M>>>24&255,e[60]=K>>>0&255,e[61]=K>>>8&255,e[62]=K>>>16&255,e[63]=K>>>24&255}function v(e,t,n,r){for(var i,o=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,s=255&n[0]|(255&n[1])<<8|(255&n[2])<<16|(255&n[3])<<24,a=255&n[4]|(255&n[5])<<8|(255&n[6])<<16|(255&n[7])<<24,c=255&n[8]|(255&n[9])<<8|(255&n[10])<<16|(255&n[11])<<24,l=255&n[12]|(255&n[13])<<8|(255&n[14])<<16|(255&n[15])<<24,u=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,h=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,d=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,f=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,p=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,g=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,m=255&n[16]|(255&n[17])<<8|(255&n[18])<<16|(255&n[19])<<24,y=255&n[20]|(255&n[21])<<8|(255&n[22])<<16|(255&n[23])<<24,v=255&n[24]|(255&n[25])<<8|(255&n[26])<<16|(255&n[27])<<24,w=255&n[28]|(255&n[29])<<8|(255&n[30])<<16|(255&n[31])<<24,b=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,O=0;O<20;O+=2)o^=(i=(y^=(i=(f^=(i=(l^=(i=o+y|0)<<7|i>>>25)+o|0)<<9|i>>>23)+l|0)<<13|i>>>19)+f|0)<<18|i>>>14,u^=(i=(s^=(i=(v^=(i=(p^=(i=u+s|0)<<7|i>>>25)+u|0)<<9|i>>>23)+p|0)<<13|i>>>19)+v|0)<<18|i>>>14,g^=(i=(h^=(i=(a^=(i=(w^=(i=g+h|0)<<7|i>>>25)+g|0)<<9|i>>>23)+w|0)<<13|i>>>19)+a|0)<<18|i>>>14,b^=(i=(m^=(i=(d^=(i=(c^=(i=b+m|0)<<7|i>>>25)+b|0)<<9|i>>>23)+c|0)<<13|i>>>19)+d|0)<<18|i>>>14,o^=(i=(c^=(i=(a^=(i=(s^=(i=o+c|0)<<7|i>>>25)+o|0)<<9|i>>>23)+s|0)<<13|i>>>19)+a|0)<<18|i>>>14,u^=(i=(l^=(i=(d^=(i=(h^=(i=u+l|0)<<7|i>>>25)+u|0)<<9|i>>>23)+h|0)<<13|i>>>19)+d|0)<<18|i>>>14,g^=(i=(p^=(i=(f^=(i=(m^=(i=g+p|0)<<7|i>>>25)+g|0)<<9|i>>>23)+m|0)<<13|i>>>19)+f|0)<<18|i>>>14,b^=(i=(w^=(i=(v^=(i=(y^=(i=b+w|0)<<7|i>>>25)+b|0)<<9|i>>>23)+y|0)<<13|i>>>19)+v|0)<<18|i>>>14;e[0]=o>>>0&255,e[1]=o>>>8&255,e[2]=o>>>16&255,e[3]=o>>>24&255,e[4]=u>>>0&255,e[5]=u>>>8&255,e[6]=u>>>16&255,e[7]=u>>>24&255,e[8]=g>>>0&255,e[9]=g>>>8&255,e[10]=g>>>16&255,e[11]=g>>>24&255,e[12]=b>>>0&255,e[13]=b>>>8&255,e[14]=b>>>16&255,e[15]=b>>>24&255,e[16]=h>>>0&255,e[17]=h>>>8&255,e[18]=h>>>16&255,e[19]=h>>>24&255,e[20]=d>>>0&255,e[21]=d>>>8&255,e[22]=d>>>16&255,e[23]=d>>>24&255,e[24]=f>>>0&255,e[25]=f>>>8&255,e[26]=f>>>16&255,e[27]=f>>>24&255,e[28]=p>>>0&255,e[29]=p>>>8&255,e[30]=p>>>16&255,e[31]=p>>>24&255}function w(e,t,n,r){y(e,t,n,r)}function b(e,t,n,r){v(e,t,n,r)}var O=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function E(e,t,n,r,i,o,s){var a,c,l=new Uint8Array(16),u=new Uint8Array(64);for(c=0;c<16;c++)l[c]=0;for(c=0;c<8;c++)l[c]=o[c];for(;i>=64;){for(w(u,l,s,O),c=0;c<64;c++)e[t+c]=n[r+c]^u[c];for(a=1,c=8;c<16;c++)a=a+(255&l[c])|0,l[c]=255&a,a>>>=8;i-=64,t+=64,r+=64}if(i>0)for(w(u,l,s,O),c=0;c<i;c++)e[t+c]=n[r+c]^u[c];return 0}function _(e,t,n,r,i){var o,s,a=new Uint8Array(16),c=new Uint8Array(64);for(s=0;s<16;s++)a[s]=0;for(s=0;s<8;s++)a[s]=r[s];for(;n>=64;){for(w(c,a,i,O),s=0;s<64;s++)e[t+s]=c[s];for(o=1,s=8;s<16;s++)o=o+(255&a[s])|0,a[s]=255&o,o>>>=8;n-=64,t+=64}if(n>0)for(w(c,a,i,O),s=0;s<n;s++)e[t+s]=c[s];return 0}function C(e,t,n,r,i){var o=new Uint8Array(32);b(o,r,i,O);for(var s=new Uint8Array(8),a=0;a<8;a++)s[a]=r[a+16];return _(e,t,n,s,o)}function N(e,t,n,r,i,o,s){var a=new Uint8Array(32);b(a,o,s,O);for(var c=new Uint8Array(8),l=0;l<8;l++)c[l]=o[l+16];return E(e,t,n,r,i,c,a)}var A=function(e){var t,n,r,i,o,s,a,c;this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0,t=255&e[0]|(255&e[1])<<8,this.r[0]=8191&t,n=255&e[2]|(255&e[3])<<8,this.r[1]=8191&(t>>>13|n<<3),r=255&e[4]|(255&e[5])<<8,this.r[2]=7939&(n>>>10|r<<6),i=255&e[6]|(255&e[7])<<8,this.r[3]=8191&(r>>>7|i<<9),o=255&e[8]|(255&e[9])<<8,this.r[4]=255&(i>>>4|o<<12),this.r[5]=o>>>1&8190,s=255&e[10]|(255&e[11])<<8,this.r[6]=8191&(o>>>14|s<<2),a=255&e[12]|(255&e[13])<<8,this.r[7]=8065&(s>>>11|a<<5),c=255&e[14]|(255&e[15])<<8,this.r[8]=8191&(a>>>8|c<<8),this.r[9]=c>>>5&127,this.pad[0]=255&e[16]|(255&e[17])<<8,this.pad[1]=255&e[18]|(255&e[19])<<8,this.pad[2]=255&e[20]|(255&e[21])<<8,this.pad[3]=255&e[22]|(255&e[23])<<8,this.pad[4]=255&e[24]|(255&e[25])<<8,this.pad[5]=255&e[26]|(255&e[27])<<8,this.pad[6]=255&e[28]|(255&e[29])<<8,this.pad[7]=255&e[30]|(255&e[31])<<8};function R(e,t,n,r,i,o){var s=new A(o);return s.update(n,r,i),s.finish(e,t),0}function S(e,t,n,r,i,o){var s=new Uint8Array(16);return R(s,0,n,r,i,o),g(e,t,s,0)}function T(e,t,n,r,i){var o;if(n<32)return-1;for(N(e,0,t,0,n,r,i),R(e,16,e,32,n-32,e),o=0;o<16;o++)e[o]=0;return 0}function P(e,t,n,r,i){var o,s=new Uint8Array(32);if(n<32||(C(s,0,32,r,i),0!==S(t,16,t,32,n-32,s)))return-1;for(N(e,0,t,0,n,r,i),o=0;o<32;o++)e[o]=0;return 0}function D(e,t){var n;for(n=0;n<16;n++)e[n]=0|t[n]}function k(e){var t,n,r=1;for(t=0;t<16;t++)n=e[t]+r+65535,r=Math.floor(n/65536),e[t]=n-65536*r;e[0]+=r-1+37*(r-1)}function I(e,t,n){for(var r,i=~(n-1),o=0;o<16;o++)r=i&(e[o]^t[o]),e[o]^=r,t[o]^=r}function x(e,n){var r,i,o,s=t(),a=t();for(r=0;r<16;r++)a[r]=n[r];for(k(a),k(a),k(a),i=0;i<2;i++){for(s[0]=a[0]-65517,r=1;r<15;r++)s[r]=a[r]-65535-(s[r-1]>>16&1),s[r-1]&=65535;s[15]=a[15]-32767-(s[14]>>16&1),o=s[15]>>16&1,s[14]&=65535,I(a,s,1-o)}for(r=0;r<16;r++)e[2*r]=255&a[r],e[2*r+1]=a[r]>>8}function M(e,t){var n=new Uint8Array(32),r=new Uint8Array(32);return x(n,e),x(r,t),m(n,0,r,0)}function K(e){var t=new Uint8Array(32);return x(t,e),1&t[0]}function L(e,t){var n;for(n=0;n<16;n++)e[n]=t[2*n]+(t[2*n+1]<<8);e[15]&=32767}function U(e,t,n){for(var r=0;r<16;r++)e[r]=t[r]+n[r]}function B(e,t,n){for(var r=0;r<16;r++)e[r]=t[r]-n[r]}function j(e,t,n){var r,i,o=0,s=0,a=0,c=0,l=0,u=0,h=0,d=0,f=0,p=0,g=0,m=0,y=0,v=0,w=0,b=0,O=0,E=0,_=0,C=0,N=0,A=0,R=0,S=0,T=0,P=0,D=0,k=0,I=0,x=0,M=0,K=n[0],L=n[1],U=n[2],B=n[3],j=n[4],H=n[5],W=n[6],X=n[7],F=n[8],J=n[9],G=n[10],q=n[11],V=n[12],z=n[13],Q=n[14],$=n[15];o+=(r=t[0])*K,s+=r*L,a+=r*U,c+=r*B,l+=r*j,u+=r*H,h+=r*W,d+=r*X,f+=r*F,p+=r*J,g+=r*G,m+=r*q,y+=r*V,v+=r*z,w+=r*Q,b+=r*$,s+=(r=t[1])*K,a+=r*L,c+=r*U,l+=r*B,u+=r*j,h+=r*H,d+=r*W,f+=r*X,p+=r*F,g+=r*J,m+=r*G,y+=r*q,v+=r*V,w+=r*z,b+=r*Q,O+=r*$,a+=(r=t[2])*K,c+=r*L,l+=r*U,u+=r*B,h+=r*j,d+=r*H,f+=r*W,p+=r*X,g+=r*F,m+=r*J,y+=r*G,v+=r*q,w+=r*V,b+=r*z,O+=r*Q,E+=r*$,c+=(r=t[3])*K,l+=r*L,u+=r*U,h+=r*B,d+=r*j,f+=r*H,p+=r*W,g+=r*X,m+=r*F,y+=r*J,v+=r*G,w+=r*q,b+=r*V,O+=r*z,E+=r*Q,_+=r*$,l+=(r=t[4])*K,u+=r*L,h+=r*U,d+=r*B,f+=r*j,p+=r*H,g+=r*W,m+=r*X,y+=r*F,v+=r*J,w+=r*G,b+=r*q,O+=r*V,E+=r*z,_+=r*Q,C+=r*$,u+=(r=t[5])*K,h+=r*L,d+=r*U,f+=r*B,p+=r*j,g+=r*H,m+=r*W,y+=r*X,v+=r*F,w+=r*J,b+=r*G,O+=r*q,E+=r*V,_+=r*z,C+=r*Q,N+=r*$,h+=(r=t[6])*K,d+=r*L,f+=r*U,p+=r*B,g+=r*j,m+=r*H,y+=r*W,v+=r*X,w+=r*F,b+=r*J,O+=r*G,E+=r*q,_+=r*V,C+=r*z,N+=r*Q,A+=r*$,d+=(r=t[7])*K,f+=r*L,p+=r*U,g+=r*B,m+=r*j,y+=r*H,v+=r*W,w+=r*X,b+=r*F,O+=r*J,E+=r*G,_+=r*q,C+=r*V,N+=r*z,A+=r*Q,R+=r*$,f+=(r=t[8])*K,p+=r*L,g+=r*U,m+=r*B,y+=r*j,v+=r*H,w+=r*W,b+=r*X,O+=r*F,E+=r*J,_+=r*G,C+=r*q,N+=r*V,A+=r*z,R+=r*Q,S+=r*$,p+=(r=t[9])*K,g+=r*L,m+=r*U,y+=r*B,v+=r*j,w+=r*H,b+=r*W,O+=r*X,E+=r*F,_+=r*J,C+=r*G,N+=r*q,A+=r*V,R+=r*z,S+=r*Q,T+=r*$,g+=(r=t[10])*K,m+=r*L,y+=r*U,v+=r*B,w+=r*j,b+=r*H,O+=r*W,E+=r*X,_+=r*F,C+=r*J,N+=r*G,A+=r*q,R+=r*V,S+=r*z,T+=r*Q,P+=r*$,m+=(r=t[11])*K,y+=r*L,v+=r*U,w+=r*B,b+=r*j,O+=r*H,E+=r*W,_+=r*X,C+=r*F,N+=r*J,A+=r*G,R+=r*q,S+=r*V,T+=r*z,P+=r*Q,D+=r*$,y+=(r=t[12])*K,v+=r*L,w+=r*U,b+=r*B,O+=r*j,E+=r*H,_+=r*W,C+=r*X,N+=r*F,A+=r*J,R+=r*G,S+=r*q,T+=r*V,P+=r*z,D+=r*Q,k+=r*$,v+=(r=t[13])*K,w+=r*L,b+=r*U,O+=r*B,E+=r*j,_+=r*H,C+=r*W,N+=r*X,A+=r*F,R+=r*J,S+=r*G,T+=r*q,P+=r*V,D+=r*z,k+=r*Q,I+=r*$,w+=(r=t[14])*K,b+=r*L,O+=r*U,E+=r*B,_+=r*j,C+=r*H,N+=r*W,A+=r*X,R+=r*F,S+=r*J,T+=r*G,P+=r*q,D+=r*V,k+=r*z,I+=r*Q,x+=r*$,b+=(r=t[15])*K,s+=38*(E+=r*U),a+=38*(_+=r*B),c+=38*(C+=r*j),l+=38*(N+=r*H),u+=38*(A+=r*W),h+=38*(R+=r*X),d+=38*(S+=r*F),f+=38*(T+=r*J),p+=38*(P+=r*G),g+=38*(D+=r*q),m+=38*(k+=r*V),y+=38*(I+=r*z),v+=38*(x+=r*Q),w+=38*(M+=r*$),o=(r=(o+=38*(O+=r*L))+(i=1)+65535)-65536*(i=Math.floor(r/65536)),s=(r=s+i+65535)-65536*(i=Math.floor(r/65536)),a=(r=a+i+65535)-65536*(i=Math.floor(r/65536)),c=(r=c+i+65535)-65536*(i=Math.floor(r/65536)),l=(r=l+i+65535)-65536*(i=Math.floor(r/65536)),u=(r=u+i+65535)-65536*(i=Math.floor(r/65536)),h=(r=h+i+65535)-65536*(i=Math.floor(r/65536)),d=(r=d+i+65535)-65536*(i=Math.floor(r/65536)),f=(r=f+i+65535)-65536*(i=Math.floor(r/65536)),p=(r=p+i+65535)-65536*(i=Math.floor(r/65536)),g=(r=g+i+65535)-65536*(i=Math.floor(r/65536)),m=(r=m+i+65535)-65536*(i=Math.floor(r/65536)),y=(r=y+i+65535)-65536*(i=Math.floor(r/65536)),v=(r=v+i+65535)-65536*(i=Math.floor(r/65536)),w=(r=w+i+65535)-65536*(i=Math.floor(r/65536)),b=(r=b+i+65535)-65536*(i=Math.floor(r/65536)),o=(r=(o+=i-1+37*(i-1))+(i=1)+65535)-65536*(i=Math.floor(r/65536)),s=(r=s+i+65535)-65536*(i=Math.floor(r/65536)),a=(r=a+i+65535)-65536*(i=Math.floor(r/65536)),c=(r=c+i+65535)-65536*(i=Math.floor(r/65536)),l=(r=l+i+65535)-65536*(i=Math.floor(r/65536)),u=(r=u+i+65535)-65536*(i=Math.floor(r/65536)),h=(r=h+i+65535)-65536*(i=Math.floor(r/65536)),d=(r=d+i+65535)-65536*(i=Math.floor(r/65536)),f=(r=f+i+65535)-65536*(i=Math.floor(r/65536)),p=(r=p+i+65535)-65536*(i=Math.floor(r/65536)),g=(r=g+i+65535)-65536*(i=Math.floor(r/65536)),m=(r=m+i+65535)-65536*(i=Math.floor(r/65536)),y=(r=y+i+65535)-65536*(i=Math.floor(r/65536)),v=(r=v+i+65535)-65536*(i=Math.floor(r/65536)),w=(r=w+i+65535)-65536*(i=Math.floor(r/65536)),b=(r=b+i+65535)-65536*(i=Math.floor(r/65536)),o+=i-1+37*(i-1),e[0]=o,e[1]=s,e[2]=a,e[3]=c,e[4]=l,e[5]=u,e[6]=h,e[7]=d,e[8]=f,e[9]=p,e[10]=g,e[11]=m,e[12]=y,e[13]=v,e[14]=w,e[15]=b}function H(e,t){j(e,t,t)}function W(e,n){var r,i=t();for(r=0;r<16;r++)i[r]=n[r];for(r=253;r>=0;r--)H(i,i),2!==r&&4!==r&&j(i,i,n);for(r=0;r<16;r++)e[r]=i[r]}function X(e,n){var r,i=t();for(r=0;r<16;r++)i[r]=n[r];for(r=250;r>=0;r--)H(i,i),1!==r&&j(i,i,n);for(r=0;r<16;r++)e[r]=i[r]}function F(e,n,r){var i,o,s=new Uint8Array(32),c=new Float64Array(80),l=t(),u=t(),h=t(),d=t(),f=t(),p=t();for(o=0;o<31;o++)s[o]=n[o];for(s[31]=127&n[31]|64,s[0]&=248,L(c,r),o=0;o<16;o++)u[o]=c[o],d[o]=l[o]=h[o]=0;for(l[0]=d[0]=1,o=254;o>=0;--o)I(l,u,i=s[o>>>3]>>>(7&o)&1),I(h,d,i),U(f,l,h),B(l,l,h),U(h,u,d),B(u,u,d),H(d,f),H(p,l),j(l,h,l),j(h,u,f),U(f,l,h),B(l,l,h),H(u,l),B(h,d,p),j(l,h,a),U(l,l,d),j(h,h,l),j(l,d,p),j(d,u,c),H(u,f),I(l,u,i),I(h,d,i);for(o=0;o<16;o++)c[o+16]=l[o],c[o+32]=h[o],c[o+48]=u[o],c[o+64]=d[o];var g=c.subarray(32),m=c.subarray(16);return W(g,g),j(m,m,g),x(e,m),0}function J(e,t){return F(e,t,i)}function G(e,t){return n(t,32),J(e,t)}function q(e,t,n){var i=new Uint8Array(32);return F(i,n,t),b(e,r,i,O)}A.prototype.blocks=function(e,t,n){for(var r,i,o,s,a,c,l,u,h,d,f,p,g,m,y,v,w,b,O,E=this.fin?0:2048,_=this.h[0],C=this.h[1],N=this.h[2],A=this.h[3],R=this.h[4],S=this.h[5],T=this.h[6],P=this.h[7],D=this.h[8],k=this.h[9],I=this.r[0],x=this.r[1],M=this.r[2],K=this.r[3],L=this.r[4],U=this.r[5],B=this.r[6],j=this.r[7],H=this.r[8],W=this.r[9];n>=16;)d=h=0,d+=(_+=8191&(r=255&e[t+0]|(255&e[t+1])<<8))*I,d+=5*(C+=8191&(r>>>13|(i=255&e[t+2]|(255&e[t+3])<<8)<<3))*W,d+=5*(N+=8191&(i>>>10|(o=255&e[t+4]|(255&e[t+5])<<8)<<6))*H,d+=5*(A+=8191&(o>>>7|(s=255&e[t+6]|(255&e[t+7])<<8)<<9))*j,h=(d+=5*(R+=8191&(s>>>4|(a=255&e[t+8]|(255&e[t+9])<<8)<<12))*B)>>>13,d&=8191,d+=5*(S+=a>>>1&8191)*U,d+=5*(T+=8191&(a>>>14|(c=255&e[t+10]|(255&e[t+11])<<8)<<2))*L,d+=5*(P+=8191&(c>>>11|(l=255&e[t+12]|(255&e[t+13])<<8)<<5))*K,d+=5*(D+=8191&(l>>>8|(u=255&e[t+14]|(255&e[t+15])<<8)<<8))*M,f=h+=(d+=5*(k+=u>>>5|E)*x)>>>13,f+=_*x,f+=C*I,f+=5*N*W,f+=5*A*H,h=(f+=5*R*j)>>>13,f&=8191,f+=5*S*B,f+=5*T*U,f+=5*P*L,f+=5*D*K,h+=(f+=5*k*M)>>>13,f&=8191,p=h,p+=_*M,p+=C*x,p+=N*I,p+=5*A*W,h=(p+=5*R*H)>>>13,p&=8191,p+=5*S*j,p+=5*T*B,p+=5*P*U,p+=5*D*L,g=h+=(p+=5*k*K)>>>13,g+=_*K,g+=C*M,g+=N*x,g+=A*I,h=(g+=5*R*W)>>>13,g&=8191,g+=5*S*H,g+=5*T*j,g+=5*P*B,g+=5*D*U,m=h+=(g+=5*k*L)>>>13,m+=_*L,m+=C*K,m+=N*M,m+=A*x,h=(m+=R*I)>>>13,m&=8191,m+=5*S*W,m+=5*T*H,m+=5*P*j,m+=5*D*B,y=h+=(m+=5*k*U)>>>13,y+=_*U,y+=C*L,y+=N*K,y+=A*M,h=(y+=R*x)>>>13,y&=8191,y+=S*I,y+=5*T*W,y+=5*P*H,y+=5*D*j,v=h+=(y+=5*k*B)>>>13,v+=_*B,v+=C*U,v+=N*L,v+=A*K,h=(v+=R*M)>>>13,v&=8191,v+=S*x,v+=T*I,v+=5*P*W,v+=5*D*H,w=h+=(v+=5*k*j)>>>13,w+=_*j,w+=C*B,w+=N*U,w+=A*L,h=(w+=R*K)>>>13,w&=8191,w+=S*M,w+=T*x,w+=P*I,w+=5*D*W,b=h+=(w+=5*k*H)>>>13,b+=_*H,b+=C*j,b+=N*B,b+=A*U,h=(b+=R*L)>>>13,b&=8191,b+=S*K,b+=T*M,b+=P*x,b+=D*I,O=h+=(b+=5*k*W)>>>13,O+=_*W,O+=C*H,O+=N*j,O+=A*B,h=(O+=R*U)>>>13,O&=8191,O+=S*L,O+=T*K,O+=P*M,O+=D*x,_=d=8191&(h=(h=((h+=(O+=k*I)>>>13)<<2)+h|0)+(d&=8191)|0),C=f+=h>>>=13,N=p&=8191,A=g&=8191,R=m&=8191,S=y&=8191,T=v&=8191,P=w&=8191,D=b&=8191,k=O&=8191,t+=16,n-=16;this.h[0]=_,this.h[1]=C,this.h[2]=N,this.h[3]=A,this.h[4]=R,this.h[5]=S,this.h[6]=T,this.h[7]=P,this.h[8]=D,this.h[9]=k},A.prototype.finish=function(e,t){var n,r,i,o,s=new Uint16Array(10);if(this.leftover){for(o=this.leftover,this.buffer[o++]=1;o<16;o++)this.buffer[o]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(n=this.h[1]>>>13,this.h[1]&=8191,o=2;o<10;o++)this.h[o]+=n,n=this.h[o]>>>13,this.h[o]&=8191;for(this.h[0]+=5*n,n=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=n,n=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=n,s[0]=this.h[0]+5,n=s[0]>>>13,s[0]&=8191,o=1;o<10;o++)s[o]=this.h[o]+n,n=s[o]>>>13,s[o]&=8191;for(s[9]-=8192,r=(1^n)-1,o=0;o<10;o++)s[o]&=r;for(r=~r,o=0;o<10;o++)this.h[o]=this.h[o]&r|s[o];for(this.h[0]=65535&(this.h[0]|this.h[1]<<13),this.h[1]=65535&(this.h[1]>>>3|this.h[2]<<10),this.h[2]=65535&(this.h[2]>>>6|this.h[3]<<7),this.h[3]=65535&(this.h[3]>>>9|this.h[4]<<4),this.h[4]=65535&(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14),this.h[5]=65535&(this.h[6]>>>2|this.h[7]<<11),this.h[6]=65535&(this.h[7]>>>5|this.h[8]<<8),this.h[7]=65535&(this.h[8]>>>8|this.h[9]<<5),i=this.h[0]+this.pad[0],this.h[0]=65535&i,o=1;o<8;o++)i=(this.h[o]+this.pad[o]|0)+(i>>>16)|0,this.h[o]=65535&i;e[t+0]=this.h[0]>>>0&255,e[t+1]=this.h[0]>>>8&255,e[t+2]=this.h[1]>>>0&255,e[t+3]=this.h[1]>>>8&255,e[t+4]=this.h[2]>>>0&255,e[t+5]=this.h[2]>>>8&255,e[t+6]=this.h[3]>>>0&255,e[t+7]=this.h[3]>>>8&255,e[t+8]=this.h[4]>>>0&255,e[t+9]=this.h[4]>>>8&255,e[t+10]=this.h[5]>>>0&255,e[t+11]=this.h[5]>>>8&255,e[t+12]=this.h[6]>>>0&255,e[t+13]=this.h[6]>>>8&255,e[t+14]=this.h[7]>>>0&255,e[t+15]=this.h[7]>>>8&255},A.prototype.update=function(e,t,n){var r,i;if(this.leftover){for((i=16-this.leftover)>n&&(i=n),r=0;r<i;r++)this.buffer[this.leftover+r]=e[t+r];if(n-=i,t+=i,this.leftover+=i,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(n>=16&&(i=n-n%16,this.blocks(e,t,i),t+=i,n-=i),n){for(r=0;r<n;r++)this.buffer[this.leftover+r]=e[t+r];this.leftover+=n}};var V=T,z=P,Q=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function $(e,t,n,r){for(var i,o,s,a,c,l,u,h,d,f,p,g,m,y,v,w,b,O,E,_,C,N,A,R,S,T,P=new Int32Array(16),D=new Int32Array(16),k=e[0],I=e[1],x=e[2],M=e[3],K=e[4],L=e[5],U=e[6],B=e[7],j=t[0],H=t[1],W=t[2],X=t[3],F=t[4],J=t[5],G=t[6],q=t[7],V=0;r>=128;){for(E=0;E<16;E++)_=8*E+V,P[E]=n[_+0]<<24|n[_+1]<<16|n[_+2]<<8|n[_+3],D[E]=n[_+4]<<24|n[_+5]<<16|n[_+6]<<8|n[_+7];for(E=0;E<80;E++)if(i=k,o=I,s=x,a=M,c=K,l=L,u=U,d=j,f=H,p=W,g=X,m=F,y=J,v=G,A=65535&(N=q),R=N>>>16,S=65535&(C=B),T=C>>>16,A+=65535&(N=(F>>>14|K<<18)^(F>>>18|K<<14)^(K>>>9|F<<23)),R+=N>>>16,S+=65535&(C=(K>>>14|F<<18)^(K>>>18|F<<14)^(F>>>9|K<<23)),T+=C>>>16,A+=65535&(N=F&J^~F&G),R+=N>>>16,S+=65535&(C=K&L^~K&U),T+=C>>>16,C=Q[2*E],A+=65535&(N=Q[2*E+1]),R+=N>>>16,S+=65535&C,T+=C>>>16,C=P[E%16],R+=(N=D[E%16])>>>16,S+=65535&C,T+=C>>>16,S+=(R+=(A+=65535&N)>>>16)>>>16,A=65535&(N=O=65535&A|R<<16),R=N>>>16,S=65535&(C=b=65535&S|(T+=S>>>16)<<16),T=C>>>16,A+=65535&(N=(j>>>28|k<<4)^(k>>>2|j<<30)^(k>>>7|j<<25)),R+=N>>>16,S+=65535&(C=(k>>>28|j<<4)^(j>>>2|k<<30)^(j>>>7|k<<25)),T+=C>>>16,R+=(N=j&H^j&W^H&W)>>>16,S+=65535&(C=k&I^k&x^I&x),T+=C>>>16,h=65535&(S+=(R+=(A+=65535&N)>>>16)>>>16)|(T+=S>>>16)<<16,w=65535&A|R<<16,A=65535&(N=g),R=N>>>16,S=65535&(C=a),T=C>>>16,R+=(N=O)>>>16,S+=65535&(C=b),T+=C>>>16,I=i,x=o,M=s,K=a=65535&(S+=(R+=(A+=65535&N)>>>16)>>>16)|(T+=S>>>16)<<16,L=c,U=l,B=u,k=h,H=d,W=f,X=p,F=g=65535&A|R<<16,J=m,G=y,q=v,j=w,E%16==15)for(_=0;_<16;_++)C=P[_],A=65535&(N=D[_]),R=N>>>16,S=65535&C,T=C>>>16,C=P[(_+9)%16],A+=65535&(N=D[(_+9)%16]),R+=N>>>16,S+=65535&C,T+=C>>>16,b=P[(_+1)%16],A+=65535&(N=((O=D[(_+1)%16])>>>1|b<<31)^(O>>>8|b<<24)^(O>>>7|b<<25)),R+=N>>>16,S+=65535&(C=(b>>>1|O<<31)^(b>>>8|O<<24)^b>>>7),T+=C>>>16,b=P[(_+14)%16],R+=(N=((O=D[(_+14)%16])>>>19|b<<13)^(b>>>29|O<<3)^(O>>>6|b<<26))>>>16,S+=65535&(C=(b>>>19|O<<13)^(O>>>29|b<<3)^b>>>6),T+=C>>>16,T+=(S+=(R+=(A+=65535&N)>>>16)>>>16)>>>16,P[_]=65535&S|T<<16,D[_]=65535&A|R<<16;A=65535&(N=j),R=N>>>16,S=65535&(C=k),T=C>>>16,C=e[0],R+=(N=t[0])>>>16,S+=65535&C,T+=C>>>16,T+=(S+=(R+=(A+=65535&N)>>>16)>>>16)>>>16,e[0]=k=65535&S|T<<16,t[0]=j=65535&A|R<<16,A=65535&(N=H),R=N>>>16,S=65535&(C=I),T=C>>>16,C=e[1],R+=(N=t[1])>>>16,S+=65535&C,T+=C>>>16,T+=(S+=(R+=(A+=65535&N)>>>16)>>>16)>>>16,e[1]=I=65535&S|T<<16,t[1]=H=65535&A|R<<16,A=65535&(N=W),R=N>>>16,S=65535&(C=x),T=C>>>16,C=e[2],R+=(N=t[2])>>>16,S+=65535&C,T+=C>>>16,T+=(S+=(R+=(A+=65535&N)>>>16)>>>16)>>>16,e[2]=x=65535&S|T<<16,t[2]=W=65535&A|R<<16,A=65535&(N=X),R=N>>>16,S=65535&(C=M),T=C>>>16,C=e[3],R+=(N=t[3])>>>16,S+=65535&C,T+=C>>>16,T+=(S+=(R+=(A+=65535&N)>>>16)>>>16)>>>16,e[3]=M=65535&S|T<<16,t[3]=X=65535&A|R<<16,A=65535&(N=F),R=N>>>16,S=65535&(C=K),T=C>>>16,C=e[4],R+=(N=t[4])>>>16,S+=65535&C,T+=C>>>16,T+=(S+=(R+=(A+=65535&N)>>>16)>>>16)>>>16,e[4]=K=65535&S|T<<16,t[4]=F=65535&A|R<<16,A=65535&(N=J),R=N>>>16,S=65535&(C=L),T=C>>>16,C=e[5],R+=(N=t[5])>>>16,S+=65535&C,T+=C>>>16,T+=(S+=(R+=(A+=65535&N)>>>16)>>>16)>>>16,e[5]=L=65535&S|T<<16,t[5]=J=65535&A|R<<16,A=65535&(N=G),R=N>>>16,S=65535&(C=U),T=C>>>16,C=e[6],R+=(N=t[6])>>>16,S+=65535&C,T+=C>>>16,T+=(S+=(R+=(A+=65535&N)>>>16)>>>16)>>>16,e[6]=U=65535&S|T<<16,t[6]=G=65535&A|R<<16,A=65535&(N=q),R=N>>>16,S=65535&(C=B),T=C>>>16,C=e[7],R+=(N=t[7])>>>16,S+=65535&C,T+=C>>>16,T+=(S+=(R+=(A+=65535&N)>>>16)>>>16)>>>16,e[7]=B=65535&S|T<<16,t[7]=q=65535&A|R<<16,V+=128,r-=128}return r}function Y(e,t,n){var r,i=new Int32Array(8),o=new Int32Array(8),s=new Uint8Array(256),a=n;for(i[0]=1779033703,i[1]=3144134277,i[2]=1013904242,i[3]=2773480762,i[4]=1359893119,i[5]=2600822924,i[6]=528734635,i[7]=1541459225,o[0]=4089235720,o[1]=2227873595,o[2]=4271175723,o[3]=1595750129,o[4]=2917565137,o[5]=725511199,o[6]=4215389547,o[7]=327033209,$(i,o,t,n),n%=128,r=0;r<n;r++)s[r]=t[a-n+r];for(s[n]=128,s[(n=256-128*(n<112?1:0))-9]=0,f(s,n-8,a/536870912|0,a<<3),$(i,o,s,n),r=0;r<8;r++)f(e,8*r,i[r],o[r]);return 0}function Z(e,n){var r=t(),i=t(),o=t(),s=t(),a=t(),c=t(),u=t(),h=t(),d=t();B(r,e[1],e[0]),B(d,n[1],n[0]),j(r,r,d),U(i,e[0],e[1]),U(d,n[0],n[1]),j(i,i,d),j(o,e[3],n[3]),j(o,o,l),j(s,e[2],n[2]),U(s,s,s),B(a,i,r),B(c,s,o),U(u,s,o),U(h,i,r),j(e[0],a,c),j(e[1],h,u),j(e[2],u,c),j(e[3],a,h)}function ee(e,t,n){var r;for(r=0;r<4;r++)I(e[r],t[r],n)}function te(e,n){var r=t(),i=t(),o=t();W(o,n[2]),j(r,n[0],o),j(i,n[1],o),x(e,i),e[31]^=K(r)<<7}function ne(e,t,n){var r,i;for(D(e[0],o),D(e[1],s),D(e[2],s),D(e[3],o),i=255;i>=0;--i)ee(e,t,r=n[i/8|0]>>(7&i)&1),Z(t,e),Z(e,e),ee(e,t,r)}function re(e,n){var r=[t(),t(),t(),t()];D(r[0],u),D(r[1],h),D(r[2],s),j(r[3],u,h),ne(e,r,n)}function ie(e,r,i){var o,s=new Uint8Array(64),a=[t(),t(),t(),t()];for(i||n(r,32),Y(s,r,32),s[0]&=248,s[31]&=127,s[31]|=64,re(a,s),te(e,a),o=0;o<32;o++)r[o+32]=e[o];return 0}var oe=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function se(e,t){var n,r,i,o;for(r=63;r>=32;--r){for(n=0,i=r-32,o=r-12;i<o;++i)t[i]+=n-16*t[r]*oe[i-(r-32)],n=Math.floor((t[i]+128)/256),t[i]-=256*n;t[i]+=n,t[r]=0}for(n=0,i=0;i<32;i++)t[i]+=n-(t[31]>>4)*oe[i],n=t[i]>>8,t[i]&=255;for(i=0;i<32;i++)t[i]-=n*oe[i];for(r=0;r<32;r++)t[r+1]+=t[r]>>8,e[r]=255&t[r]}function ae(e){var t,n=new Float64Array(64);for(t=0;t<64;t++)n[t]=e[t];for(t=0;t<64;t++)e[t]=0;se(e,n)}function ce(e,n,r,i){var o,s,a=new Uint8Array(64),c=new Uint8Array(64),l=new Uint8Array(64),u=new Float64Array(64),h=[t(),t(),t(),t()];Y(a,i,32),a[0]&=248,a[31]&=127,a[31]|=64;var d=r+64;for(o=0;o<r;o++)e[64+o]=n[o];for(o=0;o<32;o++)e[32+o]=a[32+o];for(Y(l,e.subarray(32),r+32),ae(l),re(h,l),te(e,h),o=32;o<64;o++)e[o]=i[o];for(Y(c,e,r+64),ae(c),o=0;o<64;o++)u[o]=0;for(o=0;o<32;o++)u[o]=l[o];for(o=0;o<32;o++)for(s=0;s<32;s++)u[o+s]+=c[o]*a[s];return se(e.subarray(32),u),d}function le(e,n){var r=t(),i=t(),a=t(),l=t(),u=t(),h=t(),f=t();return D(e[2],s),L(e[1],n),H(a,e[1]),j(l,a,c),B(a,a,e[2]),U(l,e[2],l),H(u,l),H(h,u),j(f,h,u),j(r,f,a),j(r,r,l),X(r,r),j(r,r,a),j(r,r,l),j(r,r,l),j(e[0],r,l),H(i,e[0]),j(i,i,l),M(i,a)&&j(e[0],e[0],d),H(i,e[0]),j(i,i,l),M(i,a)?-1:(K(e[0])===n[31]>>7&&B(e[0],o,e[0]),j(e[3],e[0],e[1]),0)}function ue(e,n,r,i){var o,s=new Uint8Array(32),a=new Uint8Array(64),c=[t(),t(),t(),t()],l=[t(),t(),t(),t()];if(r<64||le(l,i))return-1;for(o=0;o<r;o++)e[o]=n[o];for(o=0;o<32;o++)e[o+32]=i[o];if(Y(a,e,r),ae(a),ne(c,l,a),re(l,n.subarray(32)),Z(c,l),te(s,c),r-=64,m(n,0,s,0)){for(o=0;o<r;o++)e[o]=0;return-1}for(o=0;o<r;o++)e[o]=n[o+64];return r}var he,de=32,fe=24,pe=32,ge=32,me=fe;function ye(e,t){if(e.length!==de)throw new Error("bad key size");if(t.length!==fe)throw new Error("bad nonce size")}function ve(e,t){if(e.length!==pe)throw new Error("bad public key size");if(t.length!==ge)throw new Error("bad secret key size")}function we(){for(var e=0;e<arguments.length;e++)if(!(arguments[e]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function be(e){for(var t=0;t<e.length;t++)e[t]=0}e.lowlevel={crypto_core_hsalsa20:b,crypto_stream_xor:N,crypto_stream:C,crypto_stream_salsa20_xor:E,crypto_stream_salsa20:_,crypto_onetimeauth:R,crypto_onetimeauth_verify:S,crypto_verify_16:g,crypto_verify_32:m,crypto_secretbox:T,crypto_secretbox_open:P,crypto_scalarmult:F,crypto_scalarmult_base:J,crypto_box_beforenm:q,crypto_box_afternm:V,crypto_box:function(e,t,n,r,i,o){var s=new Uint8Array(32);return q(s,i,o),V(e,t,n,r,s)},crypto_box_open:function(e,t,n,r,i,o){var s=new Uint8Array(32);return q(s,i,o),z(e,t,n,r,s)},crypto_box_keypair:G,crypto_hash:Y,crypto_sign:ce,crypto_sign_keypair:ie,crypto_sign_open:ue,crypto_secretbox_KEYBYTES:de,crypto_secretbox_NONCEBYTES:fe,crypto_secretbox_ZEROBYTES:32,crypto_secretbox_BOXZEROBYTES:16,crypto_scalarmult_BYTES:32,crypto_scalarmult_SCALARBYTES:32,crypto_box_PUBLICKEYBYTES:pe,crypto_box_SECRETKEYBYTES:ge,crypto_box_BEFORENMBYTES:32,crypto_box_NONCEBYTES:me,crypto_box_ZEROBYTES:32,crypto_box_BOXZEROBYTES:16,crypto_sign_BYTES:64,crypto_sign_PUBLICKEYBYTES:32,crypto_sign_SECRETKEYBYTES:64,crypto_sign_SEEDBYTES:32,crypto_hash_BYTES:64,gf:t,D:c,L:oe,pack25519:x,unpack25519:L,M:j,A:U,S:H,Z:B,pow2523:X,add:Z,set25519:D,modL:se,scalarmult:ne,scalarbase:re},e.randomBytes=function(e){var t=new Uint8Array(e);return n(t,e),t},e.secretbox=function(e,t,n){we(e,t,n),ye(n,t);for(var r=new Uint8Array(32+e.length),i=new Uint8Array(r.length),o=0;o<e.length;o++)r[o+32]=e[o];return T(i,r,r.length,t,n),i.subarray(16)},e.secretbox.open=function(e,t,n){we(e,t,n),ye(n,t);for(var r=new Uint8Array(16+e.length),i=new Uint8Array(r.length),o=0;o<e.length;o++)r[o+16]=e[o];return r.length<32||0!==P(i,r,r.length,t,n)?null:i.subarray(32)},e.secretbox.keyLength=de,e.secretbox.nonceLength=fe,e.secretbox.overheadLength=16,e.scalarMult=function(e,t){if(we(e,t),32!==e.length)throw new Error("bad n size");if(32!==t.length)throw new Error("bad p size");var n=new Uint8Array(32);return F(n,e,t),n},e.scalarMult.base=function(e){if(we(e),32!==e.length)throw new Error("bad n size");var t=new Uint8Array(32);return J(t,e),t},e.scalarMult.scalarLength=32,e.scalarMult.groupElementLength=32,e.box=function(t,n,r,i){var o=e.box.before(r,i);return e.secretbox(t,n,o)},e.box.before=function(e,t){we(e,t),ve(e,t);var n=new Uint8Array(32);return q(n,e,t),n},e.box.after=e.secretbox,e.box.open=function(t,n,r,i){var o=e.box.before(r,i);return e.secretbox.open(t,n,o)},e.box.open.after=e.secretbox.open,e.box.keyPair=function(){var e=new Uint8Array(pe),t=new Uint8Array(ge);return G(e,t),{publicKey:e,secretKey:t}},e.box.keyPair.fromSecretKey=function(e){if(we(e),e.length!==ge)throw new Error("bad secret key size");var t=new Uint8Array(pe);return J(t,e),{publicKey:t,secretKey:new Uint8Array(e)}},e.box.publicKeyLength=pe,e.box.secretKeyLength=ge,e.box.sharedKeyLength=32,e.box.nonceLength=me,e.box.overheadLength=e.secretbox.overheadLength,e.sign=function(e,t){if(we(e,t),64!==t.length)throw new Error("bad secret key size");var n=new Uint8Array(64+e.length);return ce(n,e,e.length,t),n},e.sign.open=function(e,t){if(we(e,t),32!==t.length)throw new Error("bad public key size");var n=new Uint8Array(e.length),r=ue(n,e,e.length,t);if(r<0)return null;for(var i=new Uint8Array(r),o=0;o<i.length;o++)i[o]=n[o];return i},e.sign.detached=function(t,n){for(var r=e.sign(t,n),i=new Uint8Array(64),o=0;o<i.length;o++)i[o]=r[o];return i},e.sign.detached.verify=function(e,t,n){if(we(e,t,n),64!==t.length)throw new Error("bad signature size");if(32!==n.length)throw new Error("bad public key size");var r,i=new Uint8Array(64+e.length),o=new Uint8Array(64+e.length);for(r=0;r<64;r++)i[r]=t[r];for(r=0;r<e.length;r++)i[r+64]=e[r];return ue(o,i,i.length,n)>=0},e.sign.keyPair=function(){var e=new Uint8Array(32),t=new Uint8Array(64);return ie(e,t),{publicKey:e,secretKey:t}},e.sign.keyPair.fromSecretKey=function(e){if(we(e),64!==e.length)throw new Error("bad secret key size");for(var t=new Uint8Array(32),n=0;n<t.length;n++)t[n]=e[32+n];return{publicKey:t,secretKey:new Uint8Array(e)}},e.sign.keyPair.fromSeed=function(e){if(we(e),32!==e.length)throw new Error("bad seed size");for(var t=new Uint8Array(32),n=new Uint8Array(64),r=0;r<32;r++)n[r]=e[r];return ie(t,n,!0),{publicKey:t,secretKey:n}},e.sign.publicKeyLength=32,e.sign.secretKeyLength=64,e.sign.seedLength=32,e.sign.signatureLength=64,e.hash=function(e){we(e);var t=new Uint8Array(64);return Y(t,e,e.length),t},e.hash.hashLength=64,e.verify=function(e,t){return we(e,t),0!==e.length&&0!==t.length&&e.length===t.length&&0===p(e,0,t,0,e.length)},e.setPRNG=function(e){n=e},(he="undefined"!=typeof self?self.crypto||self.msCrypto:null)&&he.getRandomValues?e.setPRNG(function(e,t){var n,r=new Uint8Array(t);for(n=0;n<t;n+=65536)he.getRandomValues(r.subarray(n,n+Math.min(t-n,65536)));for(n=0;n<t;n++)e[n]=r[n];be(r)}):void 0!==op&&(he=ap)&&he.randomBytes&&e.setPRNG(function(e,t){var n,r=he.randomBytes(t);for(n=0;n<t;n++)e[n]=r[n];be(r)})}((e=sp).exports?e.exports:self.nacl=self.nacl||{})),sp.exports;var e}var up,hp={},dp={exports:{}},fp=dp.exports;function pp(){return up||(up=1,e=dp,function(t,n){e.exports?e.exports=n():(t.nacl||(t.nacl={}),t.nacl.util=n())}(fp,function(){var e={};function t(e){if(!/^(?:[A-Za-z0-9+\/]{2}[A-Za-z0-9+\/]{2})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(e))throw new TypeError("invalid encoding")}return e.decodeUTF8=function(e){if("string"!=typeof e)throw new TypeError("expected string");var t,n=unescape(encodeURIComponent(e)),r=new Uint8Array(n.length);for(t=0;t<n.length;t++)r[t]=n.charCodeAt(t);return r},e.encodeUTF8=function(e){var t,n=[];for(t=0;t<e.length;t++)n.push(String.fromCharCode(e[t]));return decodeURIComponent(escape(n.join("")))},"undefined"==typeof atob?void 0!==Buffer.from?(e.encodeBase64=function(e){return Buffer.from(e).toString("base64")},e.decodeBase64=function(e){return t(e),new Uint8Array(Array.prototype.slice.call(Buffer.from(e,"base64"),0))}):(e.encodeBase64=function(e){return new Buffer(e).toString("base64")},e.decodeBase64=function(e){return t(e),new Uint8Array(Array.prototype.slice.call(new Buffer(e,"base64"),0))}):(e.encodeBase64=function(e){var t,n=[],r=e.length;for(t=0;t<r;t++)n.push(String.fromCharCode(e[t]));return btoa(n.join(""))},e.decodeBase64=function(e){t(e);var n,r=atob(e),i=new Uint8Array(r.length);for(n=0;n<r.length;n++)i[n]=r.charCodeAt(n);return i}),e})),dp.exports;var e}var gp=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==n[s])throw new TypeError(o+" is ambiguous");n[s]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var r=0,i=0;e[t]===c;)r++,t++;for(var o=(e.length-t)*l+1>>>0,s=new Uint8Array(o);e[t];){var u=n[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=o-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*s[d]>>>0,s[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var f=o-i;f!==o&&0===s[f];)f++;for(var p=new Uint8Array(r+(o-f)),g=r;f!==o;)p[g++]=s[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,i=0,o=t.length;i!==o&&0===t[i];)i++,n++;for(var s=(o-i)*u+1>>>0,l=new Uint8Array(s);i!==o;){for(var h=t[i],d=0,f=s-1;(0!==h||d<r)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");r=d,i++}for(var p=s-r;p!==s&&0===l[p];)p++;for(var g=c.repeat(n);p<s;++p)g+=e.charAt(l[p]);return g},decodeUnsafe:h,decode:function(e){var n=h(e);if(n)return n;throw new Error(`Non-${t} character`)}}};const mp=new Uint8Array(0),yp=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0},vp=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},wp=e=>(new TextEncoder).encode(e),bp=e=>(new TextDecoder).decode(e),Op=Object.freeze(Object.defineProperty({__proto__:null,coerce:vp,empty:mp,equals:yp,fromHex:e=>{const t=e.match(/../g);return t?new Uint8Array(t.map(e=>parseInt(e,16))):mp},fromString:wp,isBinary:e=>e instanceof ArrayBuffer||ArrayBuffer.isView(e),toHex:e=>e.reduce((e,t)=>e+t.toString(16).padStart(2,"0"),""),toString:bp},Symbol.toStringTag,{value:"Module"}));class Ep{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class _p{constructor(e,t,n){this.name=e,this.prefix=t,this.baseDecode=n}decode(e){if("string"!=typeof e)throw Error("Can only multibase decode strings");switch(e[0]){case this.prefix:return this.baseDecode(e.slice(1));default:throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`)}}or(e){const t={[this.prefix]:this,...e.decoders||{[e.prefix]:e}};return new Cp(t)}}class Cp{constructor(e){this.decoders=e}or(e){const t=e.decoders||{[e.prefix]:e};return new Cp({...this.decoders,...t})}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}class Np{constructor(e,t,n,r){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=r,this.encoder=new Ep(e,t,n),this.decoder=new _p(e,t,r)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Ap=({name:e,prefix:t,encode:n,decode:r})=>new Np(e,t,n,r),Rp=({prefix:e,name:t,alphabet:n})=>{const{encode:r,decode:i}=gp(n,t);return Ap({prefix:e,name:t,encode:r,decode:e=>vp(i(e))})},Sp=(e,t,n,r)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*n/8|0);let a=0,c=0,l=0;for(let u=0;u<o;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError(`Non-${r} character`);c=c<<n|t,(a+=n)>=8&&(a-=8,s[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s},Tp=(e,t,n)=>{const r="="===t[t.length-1],i=(1<<n)-1;let o="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>n;)o+=t[i&a>>(s-=n)];if(s&&(o+=t[i&a<<n-s]),r)for(;o.length*n&7;)o+="=";return o},Pp=({name:e,prefix:t,bitsPerChar:n,alphabet:r})=>Ap({prefix:t,name:e,encode:e=>Tp(e,r,n),decode:t=>Sp(t,r,n,e)}),Dp=Ap({prefix:"\0",name:"identity",encode:e=>bp(e),decode:e=>wp(e)}),kp=Object.freeze(Object.defineProperty({__proto__:null,identity:Dp},Symbol.toStringTag,{value:"Module"})),Ip=Pp({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),xp=Object.freeze(Object.defineProperty({__proto__:null,base2:Ip},Symbol.toStringTag,{value:"Module"})),Mp=Pp({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),Kp=Object.freeze(Object.defineProperty({__proto__:null,base8:Mp},Symbol.toStringTag,{value:"Module"})),Lp=Rp({prefix:"9",name:"base10",alphabet:"0123456789"}),Up=Object.freeze(Object.defineProperty({__proto__:null,base10:Lp},Symbol.toStringTag,{value:"Module"})),Bp=Pp({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),jp=Pp({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Hp=Object.freeze(Object.defineProperty({__proto__:null,base16:Bp,base16upper:jp},Symbol.toStringTag,{value:"Module"})),Wp=Pp({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Xp=Pp({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Fp=Pp({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Jp=Pp({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Gp=Pp({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),qp=Pp({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Vp=Pp({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),zp=Pp({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Qp=Pp({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),$p=Object.freeze(Object.defineProperty({__proto__:null,base32:Wp,base32hex:Gp,base32hexpad:Vp,base32hexpadupper:zp,base32hexupper:qp,base32pad:Fp,base32padupper:Jp,base32upper:Xp,base32z:Qp},Symbol.toStringTag,{value:"Module"})),Yp=Rp({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Zp=Rp({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),eg=Object.freeze(Object.defineProperty({__proto__:null,base36:Yp,base36upper:Zp},Symbol.toStringTag,{value:"Module"})),tg=Rp({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),ng=Rp({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),rg=Object.freeze(Object.defineProperty({__proto__:null,base58btc:tg,base58flickr:ng},Symbol.toStringTag,{value:"Module"})),ig=Pp({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),og=Pp({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),sg=Pp({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),ag=Pp({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),cg=Object.freeze(Object.defineProperty({__proto__:null,base64:ig,base64pad:og,base64url:sg,base64urlpad:ag},Symbol.toStringTag,{value:"Module"}));var lg=128,ug=-128,hg=Math.pow(2,31),dg=128,fg=127,pg=Math.pow(2,7),gg=Math.pow(2,14),mg=Math.pow(2,21),yg=Math.pow(2,28),vg=Math.pow(2,35),wg=Math.pow(2,42),bg=Math.pow(2,49),Og=Math.pow(2,56),Eg=Math.pow(2,63),_g=function e(t,n,r){n=n||[];for(var i=r=r||0;t>=hg;)n[r++]=255&t|lg,t/=128;for(;t&ug;)n[r++]=255&t|lg,t>>>=7;return n[r]=0|t,e.bytes=r-i+1,n},Cg=function e(t,n){var r,i=0,o=0,s=n=n||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");r=t[s++],i+=o<28?(r&fg)<<o:(r&fg)*Math.pow(2,o),o+=7}while(r>=dg);return e.bytes=s-n,i},Ng=function(e){return e<pg?1:e<gg?2:e<mg?3:e<yg?4:e<vg?5:e<wg?6:e<bg?7:e<Og?8:e<Eg?9:10};const Ag=e=>[Cg(e),Cg.bytes],Rg=(e,t,n=0)=>(_g(e,t,n),t),Sg=e=>Ng(e),Tg=Object.freeze(Object.defineProperty({__proto__:null,decode:Ag,encodeTo:Rg,encodingLength:Sg},Symbol.toStringTag,{value:"Module"})),Pg=(e,t)=>{const n=t.byteLength,r=Sg(e),i=r+Sg(n),o=new Uint8Array(i+n);return Rg(e,o,0),Rg(n,o,r),o.set(t,i),new Ig(e,n,t,o)},Dg=e=>{const t=vp(e),[n,r]=Ag(t),[i,o]=Ag(t.subarray(r)),s=t.subarray(r+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new Ig(n,i,s,t)},kg=(e,t)=>e===t||e.code===t.code&&e.size===t.size&&yp(e.bytes,t.bytes);class Ig{constructor(e,t,n,r){this.code=e,this.size=t,this.digest=n,this.bytes=r}}const xg=Object.freeze(Object.defineProperty({__proto__:null,Digest:Ig,create:Pg,decode:Dg,equals:kg},Symbol.toStringTag,{value:"Module"})),Mg=({name:e,code:t,encode:n})=>new Kg(e,t,n);class Kg{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}async digest(e){if(e instanceof Uint8Array){const t=await this.encode(e);return Pg(this.code,t)}throw Error("Unknown type, must be binary type")}}const Lg=Object.freeze(Object.defineProperty({__proto__:null,Hasher:Kg,from:Mg},Symbol.toStringTag,{value:"Module"})),Ug=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Bg=Mg({name:"sha2-256",code:18,encode:Ug("SHA-256")}),jg=Mg({name:"sha2-512",code:19,encode:Ug("SHA-512")}),Hg=Object.freeze(Object.defineProperty({__proto__:null,sha256:Bg,sha512:jg},Symbol.toStringTag,{value:"Module"})),Wg=Mg({name:"identity",code:0,encode:e=>vp(e)}),Xg=Object.freeze(Object.defineProperty({__proto__:null,identity:Wg},Symbol.toStringTag,{value:"Module"})),Fg=e=>vp(e),{name:Jg,code:Gg,encode:qg,decode:Vg}={name:"raw",code:85,decode:Fg,encode:Fg},zg=Object.freeze(Object.defineProperty({__proto__:null,code:Gg,decode:Vg,encode:qg,name:Jg},Symbol.toStringTag,{value:"Module"})),{name:Qg,code:$g,encode:Yg,decode:Zg}={name:"json",code:512,encode:e=>(new TextEncoder).encode(JSON.stringify(e)),decode:e=>JSON.parse((new TextDecoder).decode(e))},em=Object.freeze(Object.defineProperty({__proto__:null,code:$g,decode:Zg,encode:Yg,name:Qg},Symbol.toStringTag,{value:"Module"}));class tm{constructor(e,t,n,r){this.code=t,this.version=e,this.multihash=n,this.bytes=r,this.byteOffset=r.byteOffset,this.byteLength=r.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:um,byteLength:um,code:lm,version:lm,multihash:lm,bytes:lm,_baseCache:um,asCID:um})}toV0(){switch(this.version){case 0:return this;default:{const{code:e,multihash:t}=this;if(e!==om)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==sm)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return tm.createV0(t)}}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=Pg(e,t);return tm.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(e){return e&&this.code===e.code&&this.version===e.version&&kg(this.multihash,e.multihash)}toString(e){const{bytes:t,version:n,_baseCache:r}=this;switch(n){case 0:return rm(t,r,e||tg.encoder);default:return im(t,r,e||Wp.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(e){return hm(/^0\.0/,dm),!(!e||!e[cm]&&e.asCID!==e)}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(e){if(e instanceof tm)return e;if(null!=e&&e.asCID===e){const{version:t,code:n,multihash:r,bytes:i}=e;return new tm(t,n,r,i||am(t,n,r.bytes))}if(null!=e&&!0===e[cm]){const{version:t,multihash:n,code:r}=e,i=Dg(n);return tm.create(t,r,i)}return null}static create(e,t,n){if("number"!=typeof t)throw new Error("String codecs are no longer supported");switch(e){case 0:if(t!==om)throw new Error(`Version 0 CID must use dag-pb (code: ${om}) block encoding`);return new tm(e,t,n,n.bytes);case 1:{const r=am(e,t,n.bytes);return new tm(e,t,n,r)}default:throw new Error("Invalid version")}}static createV0(e){return tm.create(0,om,e)}static createV1(e,t){return tm.create(1,e,t)}static decode(e){const[t,n]=tm.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=tm.inspectBytes(e),n=t.size-t.multihashSize,r=vp(e.subarray(n,n+t.multihashSize));if(r.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=r.subarray(t.multihashSize-t.digestSize),o=new Ig(t.multihashCode,t.digestSize,i,r);return[0===t.version?tm.createV0(o):tm.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[n,r]=Ag(e.subarray(t));return t+=r,n};let r=n(),i=om;if(18===r?(r=0,t=0):1===r&&(i=n()),0!==r&&1!==r)throw new RangeError(`Invalid CID version ${r}`);const o=t,s=n(),a=n(),c=t+a;return{version:r,codec:i,multihashCode:s,digestSize:a,multihashSize:c-o,size:c}}static parse(e,t){const[n,r]=nm(e,t),i=tm.decode(r);return i._baseCache.set(n,e),i}}const nm=(e,t)=>{switch(e[0]){case"Q":{const n=t||tg;return[tg.prefix,n.decode(`${tg.prefix}${e}`)]}case tg.prefix:{const n=t||tg;return[tg.prefix,n.decode(e)]}case Wp.prefix:{const n=t||Wp;return[Wp.prefix,n.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},rm=(e,t,n)=>{const{prefix:r}=n;if(r!==tg.prefix)throw Error(`Cannot string encode V0 in ${n.name} encoding`);const i=t.get(r);if(null==i){const i=n.encode(e).slice(1);return t.set(r,i),i}return i},im=(e,t,n)=>{const{prefix:r}=n,i=t.get(r);if(null==i){const i=n.encode(e);return t.set(r,i),i}return i},om=112,sm=18,am=(e,t,n)=>{const r=Sg(e),i=r+Sg(t),o=new Uint8Array(i+n.byteLength);return Rg(e,o,0),Rg(t,o,r),o.set(n,i),o},cm=Symbol.for("@ipld/js-cid/CID"),lm={writable:!1,configurable:!1,enumerable:!0},um={writable:!1,enumerable:!1,configurable:!1},hm=(e,t)=>{if(!e.test("0.0.0-dev"))throw new Error(t);console.warn(t)},dm="CID.isCID(v) is deprecated and will be removed in the next major release.\nFollowing code pattern:\n\nif (CID.isCID(value)) {\n  doSomethingWithCID(value)\n}\n\nIs replaced with:\n\nconst cid = CID.asCID(value)\nif (cid) {\n  // Make sure to use cid instead of value\n  doSomethingWithCID(cid)\n}\n",fm={...kp,...xp,...Kp,...Up,...Hp,...$p,...eg,...rg,...cg},pm={...Hg,...Xg},gm=Object.freeze(Object.defineProperty({__proto__:null,CID:tm,bases:fm,bytes:Op,codecs:{raw:zg,json:em},digest:xg,hasher:Lg,hashes:pm,varint:Tg},Symbol.toStringTag,{value:"Module"}));function mm(e=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?globalThis.Buffer.allocUnsafe(e):new Uint8Array(e)}function ym(e,t,n,r){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:r}}}const vm=ym("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>(new TextEncoder).encode(e.substring(1))),wm=ym("ascii","a",e=>{let t="a";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},e=>{const t=mm((e=e.substring(1)).length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}),bm={utf8:vm,"utf-8":vm,hex:fm.base16,latin1:wm,ascii:wm,binary:wm,...fm},Om=Lf(Object.freeze(Object.defineProperty({__proto__:null,toString:function(e,t="utf8"){const n=bm[t];if(!n)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}},Symbol.toStringTag,{value:"Module"})));var Em,_m,Cm={},Nm={},Am={};function Rm(){return Em||(Em=1,e=Am,Object.defineProperty(e,"__esModule",{value:!0}),e.mul=Math.imul||function(e,t){var n=65535&e,r=65535&t;return n*r+((e>>>16&65535)*r+n*(t>>>16&65535)<<16>>>0)|0},e.add=function(e,t){return e+t|0},e.sub=function(e,t){return e-t|0},e.rotl=function(e,t){return e<<t|e>>>32-t},e.rotr=function(e,t){return e<<32-t|e>>>t},e.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},e.MAX_SAFE_INTEGER=9007199254740991,e.isSafeInteger=function(t){return e.isInteger(t)&&t>=-e.MAX_SAFE_INTEGER&&t<=e.MAX_SAFE_INTEGER}),Am;var e}function Sm(){if(_m)return Nm;_m=1,Object.defineProperty(Nm,"__esModule",{value:!0});var e=Rm();function t(e,t,n){return void 0===t&&(t=new Uint8Array(2)),void 0===n&&(n=0),t[n+0]=e>>>8,t[n+1]=e>>>0,t}function n(e,t,n){return void 0===t&&(t=new Uint8Array(2)),void 0===n&&(n=0),t[n+0]=e>>>0,t[n+1]=e>>>8,t}function r(e,t){return void 0===t&&(t=0),e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function i(e,t){return void 0===t&&(t=0),(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}function o(e,t){return void 0===t&&(t=0),e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]}function s(e,t){return void 0===t&&(t=0),(e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t])>>>0}function a(e,t,n){return void 0===t&&(t=new Uint8Array(4)),void 0===n&&(n=0),t[n+0]=e>>>24,t[n+1]=e>>>16,t[n+2]=e>>>8,t[n+3]=e>>>0,t}function c(e,t,n){return void 0===t&&(t=new Uint8Array(4)),void 0===n&&(n=0),t[n+0]=e>>>0,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24,t}function l(e,t,n){return void 0===t&&(t=new Uint8Array(8)),void 0===n&&(n=0),a(e/4294967296>>>0,t,n),a(e>>>0,t,n+4),t}function u(e,t,n){return void 0===t&&(t=new Uint8Array(8)),void 0===n&&(n=0),c(e>>>0,t,n),c(e/4294967296>>>0,t,n+4),t}return Nm.readInt16BE=function(e,t){return void 0===t&&(t=0),(e[t+0]<<8|e[t+1])<<16>>16},Nm.readUint16BE=function(e,t){return void 0===t&&(t=0),(e[t+0]<<8|e[t+1])>>>0},Nm.readInt16LE=function(e,t){return void 0===t&&(t=0),(e[t+1]<<8|e[t])<<16>>16},Nm.readUint16LE=function(e,t){return void 0===t&&(t=0),(e[t+1]<<8|e[t])>>>0},Nm.writeUint16BE=t,Nm.writeInt16BE=t,Nm.writeUint16LE=n,Nm.writeInt16LE=n,Nm.readInt32BE=r,Nm.readUint32BE=i,Nm.readInt32LE=o,Nm.readUint32LE=s,Nm.writeUint32BE=a,Nm.writeInt32BE=a,Nm.writeUint32LE=c,Nm.writeInt32LE=c,Nm.readInt64BE=function(e,t){void 0===t&&(t=0);var n=r(e,t),i=r(e,t+4);return 4294967296*n+i-4294967296*(i>>31)},Nm.readUint64BE=function(e,t){return void 0===t&&(t=0),4294967296*i(e,t)+i(e,t+4)},Nm.readInt64LE=function(e,t){void 0===t&&(t=0);var n=o(e,t);return 4294967296*o(e,t+4)+n-4294967296*(n>>31)},Nm.readUint64LE=function(e,t){void 0===t&&(t=0);var n=s(e,t);return 4294967296*s(e,t+4)+n},Nm.writeUint64BE=l,Nm.writeInt64BE=l,Nm.writeUint64LE=u,Nm.writeInt64LE=u,Nm.readUintBE=function(e,t,n){if(void 0===n&&(n=0),e%8!=0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(e/8>t.length-n)throw new Error("readUintBE: array is too short for the given bitLength");for(var r=0,i=1,o=e/8+n-1;o>=n;o--)r+=t[o]*i,i*=256;return r},Nm.readUintLE=function(e,t,n){if(void 0===n&&(n=0),e%8!=0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(e/8>t.length-n)throw new Error("readUintLE: array is too short for the given bitLength");for(var r=0,i=1,o=n;o<n+e/8;o++)r+=t[o]*i,i*=256;return r},Nm.writeUintBE=function(t,n,r,i){if(void 0===r&&(r=new Uint8Array(t/8)),void 0===i&&(i=0),t%8!=0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!e.isSafeInteger(n))throw new Error("writeUintBE value must be an integer");for(var o=1,s=t/8+i-1;s>=i;s--)r[s]=n/o&255,o*=256;return r},Nm.writeUintLE=function(t,n,r,i){if(void 0===r&&(r=new Uint8Array(t/8)),void 0===i&&(i=0),t%8!=0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!e.isSafeInteger(n))throw new Error("writeUintLE value must be an integer");for(var o=1,s=i;s<i+t/8;s++)r[s]=n/o&255,o*=256;return r},Nm.readFloat32BE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat32(t)},Nm.readFloat32LE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat32(t,!0)},Nm.readFloat64BE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat64(t)},Nm.readFloat64LE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat64(t,!0)},Nm.writeFloat32BE=function(e,t,n){return void 0===t&&(t=new Uint8Array(4)),void 0===n&&(n=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat32(n,e),t},Nm.writeFloat32LE=function(e,t,n){return void 0===t&&(t=new Uint8Array(4)),void 0===n&&(n=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat32(n,e,!0),t},Nm.writeFloat64BE=function(e,t,n){return void 0===t&&(t=new Uint8Array(8)),void 0===n&&(n=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat64(n,e),t},Nm.writeFloat64LE=function(e,t,n){return void 0===t&&(t=new Uint8Array(8)),void 0===n&&(n=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat64(n,e,!0),t},Nm}var Tm,Pm,Dm={};function km(){return Tm?Dm:(Tm=1,Object.defineProperty(Dm,"__esModule",{value:!0}),Dm.wipe=function(e){for(var t=0;t<e.length;t++)e[t]=0;return e},Dm)}var Im,xm,Mm,Km={},Lm={},Um={},Bm={exports:{}},jm={},Hm={},Wm={},Xm={};function Fm(){return xm||(xm=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DEFAULT_ERROR=e.STANDARD_ERROR_MAP=e.SERVER_ERROR_CODE_RANGE=e.RESERVED_ERROR_CODES=e.SERVER_ERROR=e.INTERNAL_ERROR=e.INVALID_PARAMS=e.METHOD_NOT_FOUND=e.INVALID_REQUEST=e.PARSE_ERROR=e.OKX_CONNECT_ERROR_CODES=e.OKXConnectError=void 0;class t extends Error{constructor(e,r){var i;null==r&&(r=(i=e)==n.UNKNOWN_ERROR?"unknown error":i==n.BAD_REQUEST_ERROR?"bad request error":i==n.ALREADY_CONNECTED_ERROR?"already connected error":i==n.NOT_CONNECTED_ERROR?"not connected error":i==n.UNKNOWN_APP_ERROR?"unknown app error":i==n.USER_REJECTS_ERROR?"user rejects error":i==n.USER_REJECTS_ERROR_CAUSE_REGISTER?"wallet address are registering":i==n.METHOD_NOT_SUPPORTED?"method not supported":i==n.CONNECTION_ERROR?"connect error":i==n.CHAIN_NOT_SUPPORTED?"chain not supported":"unknown error"),super(r),this.code=e,this.message=`${t.prefix} ${r?"\n"+r:""}`,Object.setPrototypeOf(this,t.prototype)}toJSON(){return{message:this.message,code:this.code}}}var n,r;e.OKXConnectError=t,t.prefix="[OKX_CONNECT_SDK_ERROR]",(r=n||(e.OKX_CONNECT_ERROR_CODES=n={}))[r.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",r[r.BAD_REQUEST_ERROR=1]="BAD_REQUEST_ERROR",r[r.ALREADY_CONNECTED_ERROR=11]="ALREADY_CONNECTED_ERROR",r[r.NOT_CONNECTED_ERROR=12]="NOT_CONNECTED_ERROR",r[r.UNKNOWN_APP_ERROR=100]="UNKNOWN_APP_ERROR",r[r.USER_REJECTS_ERROR=300]="USER_REJECTS_ERROR",r[r.USER_REJECTS_ERROR_CAUSE_REGISTER=301]="USER_REJECTS_ERROR_CAUSE_REGISTER",r[r.METHOD_NOT_SUPPORTED=400]="METHOD_NOT_SUPPORTED",r[r.CHAIN_NOT_SUPPORTED=500]="CHAIN_NOT_SUPPORTED",r[r.WALLET_NOT_SUPPORTED=600]="WALLET_NOT_SUPPORTED",r[r.CONNECTION_ERROR=700]="CONNECTION_ERROR",e.PARSE_ERROR="PARSE_ERROR",e.INVALID_REQUEST="INVALID_REQUEST",e.METHOD_NOT_FOUND="METHOD_NOT_FOUND",e.INVALID_PARAMS="INVALID_PARAMS",e.INTERNAL_ERROR="INTERNAL_ERROR",e.SERVER_ERROR="SERVER_ERROR",e.RESERVED_ERROR_CODES=[-32700,-32600,-32601,-32602,-32603],e.SERVER_ERROR_CODE_RANGE=[-32e3,-32099],e.STANDARD_ERROR_MAP={[e.PARSE_ERROR]:{code:-32700,message:"Parse error"},[e.INVALID_REQUEST]:{code:-32600,message:"Invalid Request"},[e.METHOD_NOT_FOUND]:{code:-32601,message:"Method not found"},[e.INVALID_PARAMS]:{code:-32602,message:"Invalid params"},[e.INTERNAL_ERROR]:{code:-32603,message:"Internal error"},[e.SERVER_ERROR]:{code:-32e3,message:"Server error"}},e.DEFAULT_ERROR=e.SERVER_ERROR}(Xm)),Xm}var Jm,Gm={};function qm(){return Jm?Gm:(Jm=1,Object.defineProperty(Gm,"__esModule",{value:!0}),Gm.NameSpaceKeyStarknet=Gm.NameSpaceKeyTron=Gm.NameSpaceKeyCosmos=Gm.NameSpaceKeyAptos=Gm.NameSpaceKeyBtc=Gm.NameSpaceKeySui=Gm.NameSpaceKeyTON=Gm.NameSpaceKeySOL=Gm.NameSpaceKeyEip155=Gm.OpenAppLinkType=void 0,(t=e||(Gm.OpenAppLinkType=e={})).UniversalLink="universallink",t.DeepLink="deeplink",Gm.NameSpaceKeyEip155="eip155",Gm.NameSpaceKeySOL="solana",Gm.NameSpaceKeyTON="ton",Gm.NameSpaceKeySui="sui",Gm.NameSpaceKeyBtc="btc",Gm.NameSpaceKeyAptos="aptos",Gm.NameSpaceKeyCosmos="cosmos",Gm.NameSpaceKeyTron="tron",Gm.NameSpaceKeyStarknet="starknet",Gm);var e,t}var Vm,zm={};function Qm(){return Vm||(Vm=1,e=zm,Object.defineProperty(e,"__esModule",{value:!0}),e.OKX_MINI_WALLET_NAME=e.OKX_APP_WALLET_NAME=e.stackDeepLink=e.tgwalletAppName=e.tgwalletName=e.tonConnectSdkVersion=e.standardDeeplink=e.downloadUrl=e.shortUniversalLink=e.standardUniversalLink=e.okxDeeplink=void 0,e.getTestTwaUrl=function(){return window.okxTesttwaUrl},e.getTestTgTwaUrl=function(){return window.okxTestTgtwaUrl},e.getBotNameAndAppName=function(e){const t=new URL(e).pathname.split("/").filter(Boolean);if(t.length>=2){return{botName:t[0],appName:t[1]}}},e.okxDeeplink="okx://web3",e.standardUniversalLink="undefined"!=typeof window&&window.location.hostname.includes("okx.com")?"https://link.okx.com/download":"https://www.okx.com/download",e.shortUniversalLink="undefined"!=typeof window&&window.location.hostname.includes("okx.com")?"https://link.okx.com/ul/connect":"https://www.okx.com/ul/connect",e.downloadUrl="https://www.okx.com/download",e.standardDeeplink=`${e.okxDeeplink}/wallet/connect`,e.tonConnectSdkVersion="1",e.tgwalletName="OKX_WALLET_BOT",e.tgwalletAppName="start",e.stackDeepLink="okx://web3?stack=true",e.OKX_APP_WALLET_NAME="OKX Wallet",e.OKX_MINI_WALLET_NAME="OKX Mini Wallet"),zm;var e}var $m,Ym={},Zm={};function ey(){if($m)return Zm;$m=1;var e=Zm&&Zm.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};function t(e){return"object"==typeof e&&"id"in e&&"jsonrpc"in e&&"2.0"===e.jsonrpc}function n(e){return"result"in e}function r(e){return"error"in e}Object.defineProperty(Zm,"__esModule",{value:!0}),Zm.isJsonRpcPayload=t,Zm.isJsonRpcRequest=function(e){return t(e)&&"method"in e},Zm.isJsonRpcResponse=function(e){return t(e)&&(n(e)||r(e))},Zm.isJsonRpcResult=n,Zm.isJsonRpcError=r,Zm.payloadId=l,Zm.getBigIntRpcId=function(){return BigInt(Date.now())*BigInt(1e6)+BigInt(c.getNextValue())},Zm.formatJsonRpcRequest=function(e,t,n){return{id:n||l(),jsonrpc:"2.0",method:e,params:t}},Zm.formatJsonRpcResult=function(e,t){return{id:e,jsonrpc:"2.0",result:t}},Zm.formatJsonRpcError=function(e,t,n){return{id:e,jsonrpc:"2.0",error:f(t,n)}},Zm.isReservedErrorCode=u,Zm.getError=h,Zm.getErrorByCode=d,Zm.formatErrorMessage=f,Zm.isHttpUrl=function(e){return g(e,"^https?:")},Zm.isWsUrl=function(e){return g(e,"^wss?:")},Zm.parseConnectionError=function(e,t,n){return e.message.includes("getaddrinfo ENOTFOUND")||e.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${n} RPC url at ${t}`):e};const i=Fm(),o=e(lp());class s{constructor(e){this.i=1,this.initialValue=e?o.default.randomBytes(e/8)[0]:0}getNextValue(){return this.initialValue+this.i++}}const a=new s(8),c=new s(16);function l(){return 1e3*Date.now()+a.getNextValue()}function u(e){return i.RESERVED_ERROR_CODES.includes(e)}function h(e){return Object.keys(i.STANDARD_ERROR_MAP).includes(e)?i.STANDARD_ERROR_MAP[e]:i.STANDARD_ERROR_MAP[i.DEFAULT_ERROR]}function d(e){return Object.values(i.STANDARD_ERROR_MAP).find(t=>t.code===e)||i.STANDARD_ERROR_MAP[i.DEFAULT_ERROR]}function f(e,t){return void 0===e?h(i.INTERNAL_ERROR):("string"==typeof e&&(e=Object.assign(Object.assign({},h(i.SERVER_ERROR)),{message:e})),void 0!==t&&(e.data=t),u(e.code)&&(e=d(e.code)),e)}function p(e){const t=e.match(new RegExp(/^\w+:/,"gi"));if(t&&t.length)return t[0]}function g(e,t){const n=p(e);return void 0!==n&&new RegExp(t).test(n)}return Zm}var ty,ny,ry={},iy={exports:{}};function oy(){return ty||(ty=1,function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function o(e,t,r,o,s){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new i(r,o||e,s),c=n?n+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],a]:e._events[c].push(a):(e._events[c]=a,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),a.prototype.eventNames=function(){var e,r,i=[];if(0===this._eventsCount)return i;for(r in e=this._events)t.call(e,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},a.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,o=r.length,s=new Array(o);i<o;i++)s[i]=r[i].fn;return s},a.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},a.prototype.emit=function(e,t,r,i,o,s){var a=n?n+e:e;if(!this._events[a])return!1;var c,l,u=this._events[a],h=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),h){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,r),!0;case 4:return u.fn.call(u.context,t,r,i),!0;case 5:return u.fn.call(u.context,t,r,i,o),!0;case 6:return u.fn.call(u.context,t,r,i,o,s),!0}for(l=1,c=new Array(h-1);l<h;l++)c[l-1]=arguments[l];u.fn.apply(u.context,c)}else{var d,f=u.length;for(l=0;l<f;l++)switch(u[l].once&&this.removeListener(e,u[l].fn,void 0,!0),h){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,t);break;case 3:u[l].fn.call(u[l].context,t,r);break;case 4:u[l].fn.call(u[l].context,t,r,i);break;default:if(!c)for(d=1,c=new Array(h-1);d<h;d++)c[d-1]=arguments[d];u[l].fn.apply(u[l].context,c)}}return!0},a.prototype.on=function(e,t,n){return o(this,e,t,n,!1)},a.prototype.once=function(e,t,n){return o(this,e,t,n,!0)},a.prototype.removeListener=function(e,t,r,i){var o=n?n+e:e;if(!this._events[o])return this;if(!t)return s(this,o),this;var a=this._events[o];if(a.fn)a.fn===t&&(!i||a.once)&&(!r||a.context===r)&&s(this,o);else{for(var c=0,l=[],u=a.length;c<u;c++)(a[c].fn!==t||i&&!a[c].once||r&&a[c].context!==r)&&l.push(a[c]);l.length?this._events[o]=1===l.length?l[0]:l:s(this,o)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&s(this,t)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a}(iy)),iy.exports}function sy(){if(ny)return ry;ny=1;var e=ry&&ry.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ry,"__esModule",{value:!0}),ry.IEngine=ry.ISignClient=ry.ISignClientEvents=ry.IEngineEvents=void 0;const t=e(oy());return ry.IEngineEvents=class extends t.default{constructor(){super()}},ry.ISignClientEvents=class extends t.default{constructor(){super()}},ry.ISignClient=class{constructor(e){this.data=e}},ry.IEngine=class{constructor(e){this.client=e}},ry}var ay,cy={},ly={};function uy(){return ay?ly:(ay=1,Object.defineProperty(ly,"__esModule",{value:!0}),ly.TONCHAIN=void 0,(e||(ly.TONCHAIN=e={})).MAINNET="-239",ly);var e}var hy,dy,fy={};function py(){return hy?fy:(hy=1,Object.defineProperty(fy,"__esModule",{value:!0}),fy.CONNECT_ITEM_ERROR_CODES=void 0,(t=e||(fy.CONNECT_ITEM_ERROR_CODES=e={}))[t.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",t[t.METHOD_NOT_SUPPORTED=400]="METHOD_NOT_SUPPORTED",fy);var e,t}var gy,my,yy={};function vy(){return gy||(gy=1,e=yy,Object.defineProperty(e,"__esModule",{value:!0}),e.AptosAppleWalletName=e.AptosGoogleWalletName=e.OKXInjectWalletName=e.OKXMiniWalletName=e.OKXWalletName=void 0,e.creatOKXWalletInfo=function(){return{appName:"okxAppWallet",name:e.OKXWalletName,imageUrl:"https://static.okx.com/cdn/assets/imgs/247/58E63FEA47A2B7D7.png"}},e.creatOKXMiniAppWalletInfo=function(){return{appName:"okxMiniApp",name:e.OKXMiniWalletName,imageUrl:"https://static.okx.com/cdn/assets/imgs/247/58E63FEA47A2B7D7.png"}},e.creatOKXInjectWalletInfo=function(){return{appName:"okxInjectWallet",name:e.OKXInjectWalletName,imageUrl:""}},e.OKXWalletName="OKX Wallet",e.OKXMiniWalletName="OKX Mini Wallet",e.OKXInjectWalletName="OKX Inject Wallet",e.AptosGoogleWalletName="Continue with Google",e.AptosAppleWalletName="Continue with Apple"),yy;var e}var wy,by,Oy={};function Ey(){return by||(by=1,function(e){var t=Hm&&Hm.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=Hm&&Hm.__exportStar||function(e,n){for(var r in e)"default"!==r&&!Object.prototype.hasOwnProperty.call(n,r)&&t(n,e,r)};Object.defineProperty(e,"__esModule",{value:!0}),e.NAMES_CHAINS=e.TON_CHAINS=e.COSMOS_CHAINS=e.APTOS_CHAINS=e.SUI_CHAINS=e.SOLANA_CHAINS=e.BTC_CHAINS=e.shortUniversalLink=e.downloadUrl=e.okxDeeplink=e.tonConnectSdkVersion=e.standardDeeplink=e.standardUniversalLink=e.OpenAppLinkType=e.NameSpaceKeyStarknet=e.NameSpaceKeyTron=e.NameSpaceKeyCosmos=e.NameSpaceKeyAptos=e.NameSpaceKeyBtc=e.NameSpaceKeySui=e.NameSpaceKeyTON=e.NameSpaceKeySOL=e.NameSpaceKeyEip155=void 0,n((Mm||(Mm=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.OKX_CONNECT_ERROR_CODES=e.OKXConnectError=void 0;var t=Fm();Object.defineProperty(e,"OKXConnectError",{enumerable:!0,get:function(){return t.OKXConnectError}}),Object.defineProperty(e,"OKX_CONNECT_ERROR_CODES",{enumerable:!0,get:function(){return t.OKX_CONNECT_ERROR_CODES}})}(Wm)),Wm),e);var r=qm();Object.defineProperty(e,"NameSpaceKeyEip155",{enumerable:!0,get:function(){return r.NameSpaceKeyEip155}}),Object.defineProperty(e,"NameSpaceKeySOL",{enumerable:!0,get:function(){return r.NameSpaceKeySOL}}),Object.defineProperty(e,"NameSpaceKeyTON",{enumerable:!0,get:function(){return r.NameSpaceKeyTON}}),Object.defineProperty(e,"NameSpaceKeySui",{enumerable:!0,get:function(){return r.NameSpaceKeySui}}),Object.defineProperty(e,"NameSpaceKeyBtc",{enumerable:!0,get:function(){return r.NameSpaceKeyBtc}}),Object.defineProperty(e,"NameSpaceKeyAptos",{enumerable:!0,get:function(){return r.NameSpaceKeyAptos}}),Object.defineProperty(e,"NameSpaceKeyCosmos",{enumerable:!0,get:function(){return r.NameSpaceKeyCosmos}}),Object.defineProperty(e,"NameSpaceKeyTron",{enumerable:!0,get:function(){return r.NameSpaceKeyTron}}),Object.defineProperty(e,"NameSpaceKeyStarknet",{enumerable:!0,get:function(){return r.NameSpaceKeyStarknet}}),Object.defineProperty(e,"OpenAppLinkType",{enumerable:!0,get:function(){return r.OpenAppLinkType}});var i=Qm();Object.defineProperty(e,"standardUniversalLink",{enumerable:!0,get:function(){return i.standardUniversalLink}}),Object.defineProperty(e,"standardDeeplink",{enumerable:!0,get:function(){return i.standardDeeplink}}),Object.defineProperty(e,"tonConnectSdkVersion",{enumerable:!0,get:function(){return i.tonConnectSdkVersion}}),Object.defineProperty(e,"okxDeeplink",{enumerable:!0,get:function(){return i.okxDeeplink}}),Object.defineProperty(e,"downloadUrl",{enumerable:!0,get:function(){return i.downloadUrl}}),Object.defineProperty(e,"shortUniversalLink",{enumerable:!0,get:function(){return i.shortUniversalLink}}),n((my||(my=1,function(e){var t=Ym&&Ym.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=Ym&&Ym.__exportStar||function(e,n){for(var r in e)"default"!==r&&!Object.prototype.hasOwnProperty.call(n,r)&&t(n,e,r)};Object.defineProperty(e,"__esModule",{value:!0}),e.ISignClientEvents=e.IEngine=e.IEngineEvents=e.ISignClient=e.getBigIntRpcId=e.formatJsonRpcRequest=e.isJsonRpcError=e.isJsonRpcResponse=e.parseConnectionError=e.isHttpUrl=e.formatJsonRpcError=void 0;var r=ey();Object.defineProperty(e,"formatJsonRpcError",{enumerable:!0,get:function(){return r.formatJsonRpcError}}),Object.defineProperty(e,"isHttpUrl",{enumerable:!0,get:function(){return r.isHttpUrl}}),Object.defineProperty(e,"parseConnectionError",{enumerable:!0,get:function(){return r.parseConnectionError}}),Object.defineProperty(e,"isJsonRpcResponse",{enumerable:!0,get:function(){return r.isJsonRpcResponse}}),Object.defineProperty(e,"isJsonRpcError",{enumerable:!0,get:function(){return r.isJsonRpcError}}),Object.defineProperty(e,"formatJsonRpcRequest",{enumerable:!0,get:function(){return r.formatJsonRpcRequest}}),Object.defineProperty(e,"getBigIntRpcId",{enumerable:!0,get:function(){return r.getBigIntRpcId}});var i=sy();Object.defineProperty(e,"ISignClient",{enumerable:!0,get:function(){return i.ISignClient}}),Object.defineProperty(e,"IEngineEvents",{enumerable:!0,get:function(){return i.IEngineEvents}}),Object.defineProperty(e,"IEngine",{enumerable:!0,get:function(){return i.IEngine}}),Object.defineProperty(e,"ISignClientEvents",{enumerable:!0,get:function(){return i.ISignClientEvents}}),n((dy||(dy=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CONNECT_ITEM_ERROR_CODES=e.TONCHAIN=void 0;var t=uy();Object.defineProperty(e,"TONCHAIN",{enumerable:!0,get:function(){return t.TONCHAIN}});var n=py();Object.defineProperty(e,"CONNECT_ITEM_ERROR_CODES",{enumerable:!0,get:function(){return n.CONNECT_ITEM_ERROR_CODES}})}(cy)),cy),e),n(vy(),e)}(Ym)),Ym),e);var o=(wy||(wy=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.NAMES_CHAINS=e.TON_CHAINS=e.COSMOS_CHAINS=e.APTOS_CHAINS=e.SUI_CHAINS=e.SOLANA_CHAINS=e.BTC_CHAINS=void 0;const t=qm();e.BTC_CHAINS={MAINNET:"btc:mainnet",FRACTAL:"fractal:mainnet"},e.SOLANA_CHAINS={MAINNET:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",TESTNET:"solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z",SONIC_TESTNET:"sonic:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z"},e.SUI_CHAINS={MAINNET:"sui:mainnet"},e.APTOS_CHAINS={MAINNET:"aptos:mainnet",MOVEMENT_MAINNET:"movement:mainnet",MOVEMENT_TESTNET:"movement:testnet"},e.COSMOS_CHAINS={COSMOS_MAINNET:"cosmos:cosmoshub-4"},e.TON_CHAINS={MAINNET:"ton:-239"},e.NAMES_CHAINS={[t.NameSpaceKeyBtc]:Object.values(e.BTC_CHAINS),[t.NameSpaceKeySOL]:Object.values(e.SOLANA_CHAINS),[t.NameSpaceKeyTON]:Object.values(e.TON_CHAINS),[t.NameSpaceKeySui]:Object.values(e.SUI_CHAINS),[t.NameSpaceKeyAptos]:Object.values(e.APTOS_CHAINS),[t.NameSpaceKeyCosmos]:Object.values(e.COSMOS_CHAINS)}}(Oy)),Oy);Object.defineProperty(e,"BTC_CHAINS",{enumerable:!0,get:function(){return o.BTC_CHAINS}}),Object.defineProperty(e,"SOLANA_CHAINS",{enumerable:!0,get:function(){return o.SOLANA_CHAINS}}),Object.defineProperty(e,"SUI_CHAINS",{enumerable:!0,get:function(){return o.SUI_CHAINS}}),Object.defineProperty(e,"APTOS_CHAINS",{enumerable:!0,get:function(){return o.APTOS_CHAINS}}),Object.defineProperty(e,"COSMOS_CHAINS",{enumerable:!0,get:function(){return o.COSMOS_CHAINS}}),Object.defineProperty(e,"TON_CHAINS",{enumerable:!0,get:function(){return o.TON_CHAINS}}),Object.defineProperty(e,"NAMES_CHAINS",{enumerable:!0,get:function(){return o.NAMES_CHAINS}})}(Hm)),Hm}var _y,Cy,Ny,Ay,Ry={},Sy={},Ty={exports:{}},Py=Ty.exports;function Dy(){return _y||(_y=1,e=Ty,t=Ty.exports,function(n,r){var i="function",o="undefined",s="object",a="string",c="major",l="model",u="name",h="type",d="vendor",f="version",p="architecture",g="console",m="mobile",y="tablet",v="smarttv",w="wearable",b="embedded",O="Amazon",E="Apple",_="ASUS",C="BlackBerry",N="Browser",A="Chrome",R="Firefox",S="Google",T="Huawei",P="LG",D="Microsoft",k="Motorola",I="Opera",x="Samsung",M="Sony",K="Xiaomi",L="Zebra",U="Facebook",B="Chromium OS",j="Mac OS",H=" Browser",W=function(e,t){var n={};for(var r in e)t[r]&&t[r].length%2==0?n[r]=t[r].concat(e[r]):n[r]=e[r];return n},X=function(e){for(var t={},n=0;n<e.length;n++)t[e[n].toUpperCase()]=e[n];return t},F=function(e,t){return typeof e===a&&-1!==J(t).indexOf(J(e))},J=function(e){return e.toLowerCase()},G=function(e){return typeof e===a?e.replace(/[^\d\.]/g,"").split(".")[0]:r},q=function(e,t){if(typeof e===a)return e=e.replace(/^\s\s*/,""),typeof t===o?e:e.substring(0,500)},V=function(e,t){for(var n,o,a,c,l,u,h=0;h<t.length&&!l;){var d=t[h],f=t[h+1];for(n=o=0;n<d.length&&!l&&d[n];)if(l=d[n++].exec(e))for(a=0;a<f.length;a++)u=l[++o],typeof(c=f[a])===s&&c.length>0?2===c.length?typeof c[1]==i?this[c[0]]=c[1].call(this,u):this[c[0]]=c[1]:3===c.length?typeof c[1]!==i||c[1].exec&&c[1].test?this[c[0]]=u?u.replace(c[1],c[2]):r:this[c[0]]=u?c[1].call(this,u,c[2]):r:4===c.length&&(this[c[0]]=u?c[3].call(this,u.replace(c[1],c[2])):r):this[c]=u||r;h+=2}},z=function(e,t){for(var n in t)if(typeof t[n]===s&&t[n].length>0){for(var i=0;i<t[n].length;i++)if(F(t[n][i],e))return"?"===n?r:n}else if(F(t[n],e))return"?"===n?r:n;return t.hasOwnProperty("*")?t["*"]:e},Q={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},$={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[f,[u,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[f,[u,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[u,f],[/opios[\/ ]+([\w\.]+)/i],[f,[u,I+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[f,[u,I+" GX"]],[/\bopr\/([\w\.]+)/i],[f,[u,I]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[f,[u,"Baidu"]],[/\b(?:mxbrowser|mxios|myie2)\/?([-\w\.]*)\b/i],[f,[u,"Maxthon"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer|sleipnir)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim(?:browser|boat|jet))[\/ ]?([\d\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|duckduckgo|klar|helio|(?=comodo_)?dragon)\/([-\w\.]+)/i,/(heytap|ovi|115)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[u,f],[/quark(?:pc)?\/([-\w\.]+)/i],[f,[u,"Quark"]],[/\bddg\/([\w\.]+)/i],[f,[u,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[f,[u,"UC"+N]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[f,[u,"WeChat"]],[/konqueror\/([\w\.]+)/i],[f,[u,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[f,[u,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[f,[u,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[f,[u,"Smart Lenovo "+N]],[/(avast|avg)\/([\w\.]+)/i],[[u,/(.+)/,"$1 Secure "+N],f],[/\bfocus\/([\w\.]+)/i],[f,[u,R+" Focus"]],[/\bopt\/([\w\.]+)/i],[f,[u,I+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[f,[u,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[f,[u,"Dolphin"]],[/coast\/([\w\.]+)/i],[f,[u,I+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[f,[u,"MIUI"+H]],[/fxios\/([\w\.-]+)/i],[f,[u,R]],[/\bqihoobrowser\/?([\w\.]*)/i],[f,[u,"360"]],[/\b(qq)\/([\w\.]+)/i],[[u,/(.+)/,"$1Browser"],f],[/(oculus|sailfish|huawei|vivo|pico)browser\/([\w\.]+)/i],[[u,/(.+)/,"$1"+H],f],[/samsungbrowser\/([\w\.]+)/i],[f,[u,x+" Internet"]],[/metasr[\/ ]?([\d\.]+)/i],[f,[u,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[u,"Sogou Mobile"],f],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345(?=browser|chrome|explorer))\w*[\/ ]?v?([\w\.]+)/i],[u,f],[/(lbbrowser|rekonq)/i,/\[(linkedin)app\]/i],[u],[/ome\/([\w\.]+) \w* ?(iron) saf/i,/ome\/([\w\.]+).+qihu (360)[es]e/i],[f,u],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[u,U],f],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[u,f],[/\bgsa\/([\w\.]+) .*safari\//i],[f,[u,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[f,[u,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[f,[u,A+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[u,A+" WebView"],f],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[f,[u,"Android "+N]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[u,f],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[f,[u,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[f,u],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[u,[f,z,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[u,f],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[u,"Netscape"],f],[/(wolvic|librewolf)\/([\w\.]+)/i],[u,f],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[f,[u,R+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[u,[f,/_/g,"."]],[/(cobalt)\/([\w\.]+)/i],[u,[f,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[p,"amd64"]],[/(ia32(?=;))/i],[[p,J]],[/((?:i[346]|x)86)[;\)]/i],[[p,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[p,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[p,"armhf"]],[/windows (ce|mobile); ppc;/i],[[p,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[p,/ower/,"",J]],[/(sun4\w)[;\)]/i],[[p,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[p,J]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[l,[d,x],[h,y]],[/\b((?:s[cgp]h|gt|sm)-(?![lr])\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]((?!sm-[lr])[-\w]+)/i,/sec-(sgh\w+)/i],[l,[d,x],[h,m]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[l,[d,E],[h,m]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[l,[d,E],[h,y]],[/(macintosh);/i],[l,[d,E]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[l,[d,"Sharp"],[h,m]],[/(?:honor)([-\w ]+)[;\)]/i],[l,[d,"Honor"],[h,m]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[l,[d,T],[h,y]],[/(?:huawei)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[l,[d,T],[h,m]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite|pro)?)(?: bui|\))/i],[[l,/_/g," "],[d,K],[h,m]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[l,/_/g," "],[d,K],[h,y]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[l,[d,"OPPO"],[h,m]],[/\b(opd2\d{3}a?) bui/i],[l,[d,"OPPO"],[h,y]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[l,[d,"Vivo"],[h,m]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[l,[d,"Realme"],[h,m]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[l,[d,k],[h,m]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[l,[d,k],[h,y]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[l,[d,P],[h,y]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[l,[d,P],[h,m]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[l,[d,"Lenovo"],[h,y]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[l,/_/g," "],[d,"Nokia"],[h,m]],[/(pixel c)\b/i],[l,[d,S],[h,y]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[l,[d,S],[h,m]],[/droid.+; (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[l,[d,M],[h,m]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[l,"Xperia Tablet"],[d,M],[h,y]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[l,[d,"OnePlus"],[h,m]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo(?!bc)\w\w)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[l,[d,O],[h,y]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[l,/(.+)/g,"Fire Phone $1"],[d,O],[h,m]],[/(playbook);[-\w\),; ]+(rim)/i],[l,d,[h,y]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[l,[d,C],[h,m]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[l,[d,_],[h,y]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[l,[d,_],[h,m]],[/(nexus 9)/i],[l,[d,"HTC"],[h,y]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[d,[l,/_/g," "],[h,m]],[/droid [\w\.]+; ((?:8[14]9[16]|9(?:0(?:48|60|8[01])|1(?:3[27]|66)|2(?:6[69]|9[56])|466))[gqswx])\w*(\)| bui)/i],[l,[d,"TCL"],[h,y]],[/(itel) ((\w+))/i],[[d,J],l,[h,z,{tablet:["p10001l","w7001"],"*":"mobile"}]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[l,[d,"Acer"],[h,y]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[l,[d,"Meizu"],[h,m]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[l,[d,"Ulefone"],[h,m]],[/; (energy ?\w+)(?: bui|\))/i,/; energizer ([\w ]+)(?: bui|\))/i],[l,[d,"Energizer"],[h,m]],[/; cat (b35);/i,/; (b15q?|s22 flip|s48c|s62 pro)(?: bui|\))/i],[l,[d,"Cat"],[h,m]],[/((?:new )?andromax[\w- ]+)(?: bui|\))/i],[l,[d,"Smartfren"],[h,m]],[/droid.+; (a(?:015|06[35]|142p?))/i],[l,[d,"Nothing"],[h,m]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno|micromax|advan)[-_ ]?([-\w]*)/i,/; (imo) ((?!tab)[\w ]+?)(?: bui|\))/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[d,l,[h,m]],[/(imo) (tab \w+)/i,/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[d,l,[h,y]],[/(surface duo)/i],[l,[d,D],[h,y]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[l,[d,"Fairphone"],[h,m]],[/(u304aa)/i],[l,[d,"AT&T"],[h,m]],[/\bsie-(\w*)/i],[l,[d,"Siemens"],[h,m]],[/\b(rct\w+) b/i],[l,[d,"RCA"],[h,y]],[/\b(venue[\d ]{2,7}) b/i],[l,[d,"Dell"],[h,y]],[/\b(q(?:mv|ta)\w+) b/i],[l,[d,"Verizon"],[h,y]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[l,[d,"Barnes & Noble"],[h,y]],[/\b(tm\d{3}\w+) b/i],[l,[d,"NuVision"],[h,y]],[/\b(k88) b/i],[l,[d,"ZTE"],[h,y]],[/\b(nx\d{3}j) b/i],[l,[d,"ZTE"],[h,m]],[/\b(gen\d{3}) b.+49h/i],[l,[d,"Swiss"],[h,m]],[/\b(zur\d{3}) b/i],[l,[d,"Swiss"],[h,y]],[/\b((zeki)?tb.*\b) b/i],[l,[d,"Zeki"],[h,y]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[d,"Dragon Touch"],l,[h,y]],[/\b(ns-?\w{0,9}) b/i],[l,[d,"Insignia"],[h,y]],[/\b((nxa|next)-?\w{0,9}) b/i],[l,[d,"NextBook"],[h,y]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[d,"Voice"],l,[h,m]],[/\b(lvtel\-)?(v1[12]) b/i],[[d,"LvTel"],l,[h,m]],[/\b(ph-1) /i],[l,[d,"Essential"],[h,m]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[l,[d,"Envizen"],[h,y]],[/\b(trio[-\w\. ]+) b/i],[l,[d,"MachSpeed"],[h,y]],[/\btu_(1491) b/i],[l,[d,"Rotor"],[h,y]],[/(shield[\w ]+) b/i],[l,[d,"Nvidia"],[h,y]],[/(sprint) (\w+)/i],[d,l,[h,m]],[/(kin\.[onetw]{3})/i],[[l,/\./g," "],[d,D],[h,m]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[l,[d,L],[h,y]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[l,[d,L],[h,m]],[/smart-tv.+(samsung)/i],[d,[h,v]],[/hbbtv.+maple;(\d+)/i],[[l,/^/,"SmartTV"],[d,x],[h,v]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[d,P],[h,v]],[/(apple) ?tv/i],[d,[l,E+" TV"],[h,v]],[/crkey/i],[[l,A+"cast"],[d,S],[h,v]],[/droid.+aft(\w+)( bui|\))/i],[l,[d,O],[h,v]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[l,[d,"Sharp"],[h,v]],[/(bravia[\w ]+)( bui|\))/i],[l,[d,M],[h,v]],[/(mitv-\w{5}) bui/i],[l,[d,K],[h,v]],[/Hbbtv.*(technisat) (.*);/i],[d,l,[h,v]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[d,q],[l,q],[h,v]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[h,v]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[d,l,[h,g]],[/droid.+; (shield) bui/i],[l,[d,"Nvidia"],[h,g]],[/(playstation [345portablevi]+)/i],[l,[d,M],[h,g]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[l,[d,D],[h,g]],[/\b(sm-[lr]\d\d[05][fnuw]?s?)\b/i],[l,[d,x],[h,w]],[/((pebble))app/i],[d,l,[h,w]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[l,[d,E],[h,w]],[/droid.+; (glass) \d/i],[l,[d,S],[h,w]],[/droid.+; (wt63?0{2,3})\)/i],[l,[d,L],[h,w]],[/droid.+; (glass) \d/i],[l,[d,S],[h,w]],[/(pico) (4|neo3(?: link|pro)?)/i],[d,l,[h,w]],[/; (quest( \d| pro)?)/i],[l,[d,U],[h,w]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[d,[h,b]],[/(aeobc)\b/i],[l,[d,O],[h,b]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[l,[h,m]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[l,[h,y]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[h,y]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[h,m]],[/(android[-\w\. ]{0,9});.+buil/i],[l,[d,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[f,[u,"EdgeHTML"]],[/(arkweb)\/([\w\.]+)/i],[u,f],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[f,[u,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna|servo)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[u,f],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[f,u]],os:[[/microsoft (windows) (vista|xp)/i],[u,f],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[u,[f,z,Q]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[f,z,Q],[u,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[f,/_/g,"."],[u,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[u,j],[f,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[f,u],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish|openharmony)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[u,f],[/\(bb(10);/i],[f,[u,C]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[f,[u,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[f,[u,R+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[f,[u,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[f,[u,"watchOS"]],[/crkey\/([\d\.]+)/i],[f,[u,A+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[u,B],f],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[u,f],[/(sunos) ?([\w\.\d]*)/i],[[u,"Solaris"],f],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[u,f]]},Y=function(e,t){if(typeof e===s&&(t=e,e=r),!(this instanceof Y))return new Y(e,t).getResult();var g=typeof n!==o&&n.navigator?n.navigator:r,v=e||(g&&g.userAgent?g.userAgent:""),w=g&&g.userAgentData?g.userAgentData:r,b=t?W($,t):$,O=g&&g.userAgent==v;return this.getBrowser=function(){var e={};return e[u]=r,e[f]=r,V.call(e,v,b.browser),e[c]=G(e[f]),O&&g&&g.brave&&typeof g.brave.isBrave==i&&(e[u]="Brave"),e},this.getCPU=function(){var e={};return e[p]=r,V.call(e,v,b.cpu),e},this.getDevice=function(){var e={};return e[d]=r,e[l]=r,e[h]=r,V.call(e,v,b.device),O&&!e[h]&&w&&w.mobile&&(e[h]=m),O&&"Macintosh"==e[l]&&g&&typeof g.standalone!==o&&g.maxTouchPoints&&g.maxTouchPoints>2&&(e[l]="iPad",e[h]=y),e},this.getEngine=function(){var e={};return e[u]=r,e[f]=r,V.call(e,v,b.engine),e},this.getOS=function(){var e={};return e[u]=r,e[f]=r,V.call(e,v,b.os),O&&!e[u]&&w&&w.platform&&"Unknown"!=w.platform&&(e[u]=w.platform.replace(/chrome os/i,B).replace(/macos/i,j)),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return v},this.setUA=function(e){return v=typeof e===a&&e.length>500?q(e,500):e,this},this.setUA(v),this};Y.VERSION="1.0.40",Y.BROWSER=X([u,f,c]),Y.CPU=X([p]),Y.DEVICE=X([l,d,h,g,m,v,y,w,b]),Y.ENGINE=Y.OS=X([u,f]),e.exports&&(t=e.exports=Y),t.UAParser=Y;var Z=typeof n!==o&&(n.jQuery||n.Zepto);if(Z&&!Z.ua){var ee=new Y;Z.ua=ee.getResult(),Z.ua.get=function(){return ee.getUA()},Z.ua.set=function(e){ee.setUA(e);var t=ee.getResult();for(var n in t)Z.ua[n]=t[n]}}}("object"==typeof window?window:Py)),Ty.exports;var e,t}function ky(){if(Cy)return Sy;Cy=1;var e=Sy&&Sy.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Sy,"__esModule",{value:!0}),Sy.openLink=i,Sy.openLinkBlank=function(e){i(e,"_blank")},Sy.openDeeplinkWithFallback=function(e,t){const n=setTimeout(()=>void(a("safari")||s("android")&&a("firefox")||t()),500);window.addEventListener("blur",()=>clearTimeout(n),{once:!0}),s("android")&&(0,r.inTg)()?i(e,"_blank"):i(e,"_self")},Sy.isMobileUserAgent=function(){let e=!1;return t=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.slice(0,4)))&&(e=!0),e;var t},Sy.getUserAgent=o,Sy.isOS=s,Sy.isBrowser=a;const t=e(Dy()),n=ev(),r=Iy();function i(e,t="_self"){(0,n.logDebug)("openLink",e,t),window.open(e,t,"noopener noreferrer")}function o(){var e,n,r;const i=(new t.default).getResult(),o=null===(e=i.os.name)||void 0===e?void 0:e.toLowerCase();let s;switch(!0){case"ipad"===(null===(n=i.device.model)||void 0===n?void 0:n.toLowerCase()):s="ipad";break;case"ios"===o:s="ios";break;case"android"===o:s="android";break;case"mac os"===o:s="macos";break;case"linux"===o:s="linux";break;case null==o?void 0:o.includes("windows"):s="windows"}const a=null===(r=i.browser.name)||void 0===r?void 0:r.toLowerCase();let c;switch(!0){case"chrome"===a:c="chrome";break;case"firefox"===a:c="firefox";break;case null==a?void 0:a.includes("safari"):c="safari";break;case null==a?void 0:a.includes("opera"):c="opera"}return{os:s,browser:c}}function s(...e){return e.includes(o().os)}function a(...e){return e.includes(o().browser)}return Sy}function Iy(){if(Ny)return Ry;var e,t,n,r,i,o,s;Ny=1,Object.defineProperty(Ry,"__esModule",{value:!0}),Ry.isTmaPlatform=function(...e){return e.includes(d)},Ry.isInTMA=p,Ry.inTg=function(){return g()||p()},Ry.isInTelegramBrowser=g,Ry.sendExpand=function(){y("web_app_expand",{})},Ry.sendOpenTelegramLink=function(e,t){const n=new URL(e);if("http:"!==n.protocol&&"https:"!==n.protocol){if(t)return t();throw new l.OKXConnectError(l.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`Url protocol is not supported: ${n}`)}if("t.me"!==n.hostname){if(t)return t();throw new l.OKXConnectError(l.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`Url host is not supported: ${n}`)}const r=n.pathname+n.search;m()||O("6.1")?y("web_app_open_tg_link",{path_full:r}):(0,u.openLinkBlank)("https://t.me"+r)},Ry.versionCompare=b;const a=xy(),c=ev(),l=Ey(),u=ky();let h={};try{h=function(e){let t={};if(!(e=e.replace(/^#/,"")).length)return t;if(e.indexOf("=")<0&&e.indexOf("?")<0)return t._path=v(e),t;let n=e.indexOf("?");if(n>=0){let r=e.substr(0,n);t._path=v(r),e=e.substr(n+1)}let r=w(e);for(let i in r)t[i]=r[i];return t}(location.hash.toString())}catch{}let d="unknown";if(null!=h&&h.tgWebAppPlatform&&(d=null!==(e=h.tgWebAppPlatform)&&void 0!==e?e:"unknown"),"unknown"===d){const e=(0,a.getWindow)();d=null!==(r=null===(n=null===(t=null==e?void 0:e.Telegram)||void 0===t?void 0:t.WebApp)||void 0===n?void 0:n.platform)&&void 0!==r?r:"unknown"}let f="6.0";if(null!=h&&h.tgWebAppVersion&&(f=h.tgWebAppVersion),!f){const e=(0,a.getWindow)();f=null!==(s=null===(o=null===(i=null==e?void 0:e.Telegram)||void 0===i?void 0:i.WebApp)||void 0===o?void 0:o.version)&&void 0!==s?s:"6.0"}function p(){var e;return"unknown"!==d||!(null===(e=(0,a.getWindow)())||void 0===e||!e.TelegramWebviewProxy)}function g(){var e;const t=!(null===(e=(0,a.getWindow)())||void 0===e||!e.TelegramWebview);return(p()||t)&&"unknown"===d}function m(){try{const e=(0,a.getWindow)();return!!e&&null!=e.parent&&e!==e.parent}catch{return!1}}function y(e,t){try{const r=(0,a.getWindow)();if(!r)throw new l.OKXConnectError(l.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"Can't post event to parent window: window is not defined");if(void 0!==r.TelegramWebviewProxy)(0,c.logDebug)("postEvent",e,t),r.TelegramWebviewProxy.postEvent(e,JSON.stringify(t));else if(r.external&&"notify"in r.external)(0,c.logDebug)("postEvent",e,t),r.external.notify(JSON.stringify({eventType:e,eventData:t}));else{if(!m())throw new l.OKXConnectError(l.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"Can't post event to TMA");{const n="*",i=JSON.stringify({eventType:e,eventData:t});(0,c.logDebug)("postEvent",e,t),r.parent.postMessage(i,n)}}}catch(n){(0,c.logError)(`Can't post event to parent window: ${n}`)}}function v(e){try{return e=e.replace(/\+/g,"%20"),decodeURIComponent(e)}catch{return e}}function w(e){let t={};if(!e.length)return t;let n,r,i,o,s=e.split("&");for(n=0;n<s.length;n++)i=v((r=s[n].split("="))[0]),o=null==r[1]?null:v(r[1]),t[i]=o;return t}function b(e,t){"string"!=typeof e&&(e=""),"string"!=typeof t&&(t="");let n,r,i,o,s=e.replace(/^\s+|\s+$/g,"").split("."),a=t.replace(/^\s+|\s+$/g,"").split(".");for(n=Math.max(s.length,a.length),r=0;r<n;r++)if((i=parseInt(s[r])||0)!==(o=parseInt(a[r])||0))return i>o?1:-1;return 0}function O(e){return b(f,e)>=0}return Ry}function xy(){if(Ay)return jm;var e,t,n,r;Ay=1,Object.defineProperty(jm,"__esModule",{value:!0}),jm.removeUrlLastSlash=u,jm.addPathToUrl=function(e,t){return u(e)+"/"+t},jm.getUniversalLink=h,jm.openOKXDeeplink=function(e,t,n){d(e,t,n,!1)},jm.openOKXDeeplinkWithFallback=d,jm.getWindow=f,jm.isTelegramUrl=function(e){if(!e)return!1;const t=new URL(e);return"tg:"===t.protocol||"t.me"===t.hostname},jm.encodeTelegramUrlParameters=function(e){let t=e;return(t=(t=(t=(t=(t=t.replace(/\./g,"%2E")).replace(/-/g,"%2D")).replace(/_/g,"%5F")).replace(/&/g,"-")).replace(/=/g,"__")).replace(/%/g,"--")},jm.encodeConnectParams=p,jm.encodeTWAConnectURLParams=g,jm.getAppWalletDeepLink=function(e){return`${i.standardDeeplink}?param=${e}`},jm.getAppWalletShortDeepLink=m,jm.getTelegramWalletTWAUrl=y,jm.openOKXTMAWalletlinkWithFallback=function(e){var t,n,r,i,a;(0,o.logDebug)("[TWA] open link:",e,"isInTMA ==> ",E()),E()?null!==(n=null===(t=f())||void 0===t?void 0:t.Telegram)&&void 0!==n&&n.WebApp?null===(a=null===(i=null===(r=f())||void 0===r?void 0:r.Telegram)||void 0===i?void 0:i.WebApp)||void 0===a||a.openTelegramLink(e):(0,c.sendOpenTelegramLink)(e):(0,s.getTestTwaUrl)()?window.open(e,"_blank"):window.open(e,"_self")},jm.isInTMA=E,jm.isInTelegramBrowser=function(){var e;const t=!(null===(e=f())||void 0===e||!e.TelegramWebview);return(E()||t)&&"unknown"===O},jm.getOKXLink=function(e,t=!1,n){if((0,o.logDebug)(`url  getOKXLink() called connectRequest==> ${JSON.stringify(e)}  useMini=> ${t}  tmaReturnUrl==> ${n}`),t)return e?{universalLink:y(g(e),null!=n?n:"back")}:{universalLink:y(void 0,null!=n?n:"back")};{let t=e?`${i.standardDeeplink}?param=${p(e)}`:i.standardDeeplink;return(0,a.useShortLink)()?{universalLink:e?m(e.topic,e.clientId):s.shortUniversalLink,deepLink:t}:{universalLink:h(t),deepLink:t}}};const i=Ey(),o=ev(),s=Qm(),a=cb(),c=Iy(),l=ep();function u(e){return"/"===e.slice(-1)?e.slice(0,-1):e}function h(e,t=!1){console.log("getUniversalLink deeplinkUrl:",e,", useStandardUniversalLink:",t);const n=encodeURIComponent(e);return console.log("getUniversalLink standardUniversalLink:",i.standardUniversalLink),console.log("getUniversalLink standardUniversalLink:",`${i.standardUniversalLink}?deeplink=${n}`),`${i.standardUniversalLink}?deeplink=${n}`}function d(e,t,n,r=!0){var o;const s=!(null===(o=f())||void 0===o||!o.TelegramWebviewProxy);console.log("openOKXDeeplinkWithFallback fullUrl:",t);let c=!1;i.standardUniversalLink,console.log("openOKXDeeplinkWithFallback standardUniversalLink:",i.standardUniversalLink);let l=null,u=()=>{console.log("fallbackToDownloadPage :empty")},h=!1;if(h=n===i.OpenAppLinkType.UniversalLink?(0,a.isInIOSChrome)()||(0,a.isInIOSLine)()||(0,a.isInIOSLark)()||(0,a.isInIOSWeChat)():!1===s&&(0,a.isIos)(),r&&((0,a.isIos)()?h&&(u=()=>{console.log("windowOpen --\x3e fallbackToDownloadPage --",c),c||(console.log("windowOpen --\x3e fallbackToDownloadPage universal link"),window.open(t,"_self"))}):u=()=>{c||(l?l.open(t,"_self"):window.open(t,"_blank"))}),!(0,a.isIos)()||h){if(s?l=window.open(e,"_blank"):(console.log("windowOpen --\x3e deeplinkUrl"),window.location.href=e),r){setTimeout(u,3e3);let e=0,t=setInterval(()=>{e++,console.log("windowOpen --\x3e interval:",e,document.hidden,document.visibilityState),document.hidden&&(c=!0),(e>10||document.hidden)&&(clearInterval(t),console.log("windowOpen :cleat: ${count}"))},200);window.addEventListener("blur",()=>{console.log("windowOpen :blur"),c=!0},{once:!0}),document.addEventListener("visibilitychange",()=>{console.log("windowOpen :visibilitychange:",document.visibilityState),"hidden"===document.visibilityState&&(c=!0)})}}else s?window.open(t,"_blank"):(console.log("windowOpen[before]: ",Date.now()),null!=window&&window.okxLogDebug?window.open(t,"_blank"):window.open(t,"_self"),console.log("windowOpen[after]: ",Date.now()))}function f(){if("undefined"!=typeof window)return window}function p(e){let t=Object.assign(Object.assign({},e),{protocolVersion:l.CONNECT_PROTOCOL_VER});const n=JSON.stringify(t);(0,o.logDebug)("url encodeConnectParams connectRequestStr ",n);const r=(new TextEncoder).encode(n),i=btoa(String.fromCharCode(...r));return(0,o.logDebug)("url encodeConnectParams base64Encoded ",i),i}function g(e){const t=JSON.stringify({topic:e.topic,clientId:e.clientId});(0,o.logDebug)("url encodeConnectParams connectRequestStr",t);const n=(new TextEncoder).encode(t);return btoa(String.fromCharCode(...n))}function m(e,t){return`${s.shortUniversalLink}?topic=${e}${(0,a.getLastSixMd5Hash)(t)}`}function y(e,t){let n={okxconnect:"",redirect:"",extraparams:"",fromtg:!1};e&&(n.okxconnect=e),t&&(n.redirect=t),E()?n.fromtg=!0:n.fromtg=!1,(0,o.logDebug)("getTelegramWalletTWAUrl redirect:",n.redirect);let r=JSON.stringify(n);const i=(new TextEncoder).encode(r),c=btoa(String.fromCharCode(...i)),l=(0,a.toSafeBase64FromBase64)(c);if((0,o.logDebug)("[TWA] open link:",n,c),e||t){if(E())return(0,s.getTestTgTwaUrl)()?`${(0,s.getTestTgTwaUrl)()}?startapp=${l}`:`https://t.me/${s.tgwalletName}/start?startapp=${l}`;if((0,s.getTestTwaUrl)())return`${(0,s.getTestTwaUrl)()}?tgWebAppStartParam=${l}`;if((0,s.getTestTgTwaUrl)()){let e=(0,s.getBotNameAndAppName)((0,s.getTestTgTwaUrl)());if(e){let{botName:t,appName:n}=e;return`tg://resolve?domain=${t}&appname=${n}&startapp=${l}`}return`tg://resolve?domain=${s.tgwalletName}&appname=${s.tgwalletAppName}&startapp=${l}`}return`tg://resolve?domain=${s.tgwalletName}&appname=${s.tgwalletAppName}&startapp=${l}`}if(E())return(0,s.getTestTgTwaUrl)()?`${(0,s.getTestTgTwaUrl)()}`:`https://t.me/${s.tgwalletName}/start`;if((0,s.getTestTwaUrl)())return`${(0,s.getTestTwaUrl)()}`;if((0,s.getTestTgTwaUrl)()){let e=(0,s.getBotNameAndAppName)((0,s.getTestTgTwaUrl)());if(e){let{botName:t,appName:n}=e;return`tg://resolve?domain=${t}&appname=${n}`}return`tg://resolve?domain=${s.tgwalletName}&appname=${s.tgwalletAppName}`}return`tg://resolve?domain=${s.tgwalletName}&appname=${s.tgwalletAppName}`}function v(e){try{return e=e.replace(/\+/g,"%20"),decodeURIComponent(e)}catch{return e}}function w(e){let t={};if(!e.length)return t;let n,r,i,o,s=e.split("&");for(n=0;n<s.length;n++)i=v((r=s[n].split("="))[0]),o=null==r[1]?null:v(r[1]),t[i]=o;return t}let b={};try{b=function(e){let t={};if(!(e=e.replace(/^#/,"")).length)return t;if(e.indexOf("=")<0&&e.indexOf("?")<0)return t._path=v(e),t;let n=e.indexOf("?");if(n>=0){let r=e.substr(0,n);t._path=v(r),e=e.substr(n+1)}let r=w(e);for(let i in r)t[i]=r[i];return t}(location.hash.toString())}catch{}let O="unknown";if(null!=b&&b.tgWebAppPlatform&&(O=null!==(e=b.tgWebAppPlatform)&&void 0!==e?e:"unknown"),"unknown"===O){const e=f();O=null!==(r=null===(n=null===(t=null==e?void 0:e.Telegram)||void 0===t?void 0:t.WebApp)||void 0===n?void 0:n.platform)&&void 0!==r?r:"unknown"}function E(){var e;return"unknown"!==O||!(null===(e=f())||void 0===e||!e.TelegramWebviewProxy)}return jm}var My,Ky={},Ly={};function Uy(){if(My)return Ly;My=1;var e=Ly&&Ly.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})};function t(t,n){return e(this,void 0,void 0,function*(){return new Promise((e,r)=>{var i,o;if(null!==(i=null==n?void 0:n.signal)&&void 0!==i&&i.aborted)return void r(new Error("Delay aborted"));const s=setTimeout(()=>e(),t);null===(o=null==n?void 0:n.signal)||void 0===o||o.addEventListener("abort",()=>{clearTimeout(s),r(new Error("Delay aborted"))})})})}return Object.defineProperty(Ly,"__esModule",{value:!0}),Ly.callForSuccess=function(n,r){return e(this,void 0,void 0,function*(){var e,i;const o=null!==(e=null==r?void 0:r.attempts)&&void 0!==e?e:3,s=null!==(i=null==r?void 0:r.delayMs)&&void 0!==i?i:800;if("function"!=typeof n)throw new Error(`Expected a function, got ${typeof n}`);let a,c=0;for(;c<o;)try{return yield n()}catch(l){a=l,++c<o&&(yield t(s))}throw a})},Ly.delay=t,Ly}var By,jy,Hy,Wy={},Xy={};function Fy(){if(jy)return Xy;jy=1,Object.defineProperty(Xy,"__esModule",{value:!0}),Xy.checkMetaData=function(t){if(!t)throw new e.OKXConnectError(e.OKX_CONNECT_ERROR_CODES.BAD_REQUEST_ERROR,"You have to specify a `dappMetaData`in the options.");if(!t.name)throw new e.OKXConnectError(e.OKX_CONNECT_ERROR_CODES.BAD_REQUEST_ERROR,"dappName is required");return!0};const e=Ey();return Xy}function Jy(){return Hy||(Hy=1,function(e){var t=Ky&&Ky.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=Ky&&Ky.__exportStar||function(e,n){for(var r in e)"default"!==r&&!Object.prototype.hasOwnProperty.call(n,r)&&t(n,e,r)};Object.defineProperty(e,"__esModule",{value:!0}),e.getNamespaceKeyByChain=e.chainName2IdMap=e.replaceChainIdToChainName=e.replaceChainNameToChainId=e.checkMetaData=e.versionCompare=e.isBrowser=e.isOS=e.isMobileUserAgent=e.openDeeplinkWithFallback=e.openLinkBlank=e.openLink=e.getChainId=e.useShortLink=e.toSafeBase64FromBase64=e.isValidObject=e.isIos=e.base64decode=e.base64encode=e.splitToUint8Arrays=e.concatUint8Arrays=e.toHexString=e.hexToByteArray=e.getOKXLink=e.getAppWalletShortDeepLink=e.encodeTWAConnectURLParams=e.encodeConnectParams=e.openOKXTMAWalletlinkWithFallback=e.getTelegramWalletTWAUrl=e.getAppWalletDeepLink=e.encodeTelegramUrlParameters=e.isTelegramUrl=e.openOKXDeeplinkWithFallback=e.openOKXDeeplink=e.getUniversalLink=e.safeJsonStringify=e.safeJsonParse=e.getDefaultReporter=e.reportEvent=e.reportLog=e.logWarning=e.logError=e.logDebug=e.callForSuccess=void 0;var r=Uy();Object.defineProperty(e,"callForSuccess",{enumerable:!0,get:function(){return r.callForSuccess}});var i=ev();Object.defineProperty(e,"logDebug",{enumerable:!0,get:function(){return i.logDebug}}),Object.defineProperty(e,"logError",{enumerable:!0,get:function(){return i.logError}}),Object.defineProperty(e,"logWarning",{enumerable:!0,get:function(){return i.logWarning}}),Object.defineProperty(e,"reportLog",{enumerable:!0,get:function(){return i.reportLog}}),Object.defineProperty(e,"reportEvent",{enumerable:!0,get:function(){return i.reportEvent}}),Object.defineProperty(e,"getDefaultReporter",{enumerable:!0,get:function(){return i.getDefaultReporter}}),n((By||(By=1,Object.defineProperty(Wy,"__esModule",{value:!0}),Wy.Report_WalletType_Key=Wy.Report_OKXConnectSDK_RequestError_Log=Wy.Report_OKXConnectSDK_RequestSuccess_Log=Wy.Report_OKXConnectSDK_RequestStart_Log=Wy.Report_OKXConnectSDKExtension_ConnectDapp_Button_Click=Wy.Report_OKXConnectSDKExtension_Module_Retry_Click=Wy.Report_ConnectDapp_ConnectAndSign_Click=Wy.Report_Proceed_QRCode_Click=Wy.Report_ChooseType_Download_Click=Wy.Report_ChooseType_ConnectWallet_Click=Wy.Report_Proceed_Retry_Click=Wy.Report_OKXConnectSDKExtension_ConnectDapp_ConnectSuccess_View=Wy.Report_OKXConnectSDKExtension_ConnectDapp_Page_View=Wy.Report_ChooseType_ConnectWallet_View=Wy.Report_Loading_ConnectWallet_View=Wy.Report_Proceed_QRCode_View=Wy.Report_Proceed_Proceed_View=void 0,Wy.Report_Proceed_Proceed_View="OKXConnectSDK_Proceed_Proceed_View",Wy.Report_Proceed_QRCode_View="OKXConnectSDK_Proceed_QRCode_View",Wy.Report_Loading_ConnectWallet_View="OKXConnectSDK_Loading_ConnectWallet_View",Wy.Report_ChooseType_ConnectWallet_View="OKXConnectSDK_ChooseType_ConnectWallet_View",Wy.Report_OKXConnectSDKExtension_ConnectDapp_Page_View="OKXConnectSDKExtension_ConnectDapp_Page_View",Wy.Report_OKXConnectSDKExtension_ConnectDapp_ConnectSuccess_View="OKXConnectSDKExtension_ConnectDapp_ConnectSuccess_View",Wy.Report_Proceed_Retry_Click="OKXConnectSDK_Proceed_Retry_Click",Wy.Report_ChooseType_ConnectWallet_Click="OKXConnectSDK_ChooseType_ConnectWallet_Click",Wy.Report_ChooseType_Download_Click="OKXConnectSDK_ChooseType_Download_Click",Wy.Report_Proceed_QRCode_Click="OKXConnectSDK_Proceed_QRCode_Click",Wy.Report_ConnectDapp_ConnectAndSign_Click="OKXConnectSDK_ConnectDapp_ConnectAndSign_Click",Wy.Report_OKXConnectSDKExtension_Module_Retry_Click="OKXConnectSDKExtension_Module_Retry_Click",Wy.Report_OKXConnectSDKExtension_ConnectDapp_Button_Click="OKXConnectSDKExtension_ConnectDapp_Button_Click",Wy.Report_OKXConnectSDK_RequestStart_Log="Report_OKXConnectSDK_RequestStart_View",Wy.Report_OKXConnectSDK_RequestSuccess_Log="Report_OKXConnectSDK_RequestSuccess_View",Wy.Report_OKXConnectSDK_RequestError_Log="Report_OKXConnectSDK_RequestError_View",Wy.Report_WalletType_Key="wallet_type"),Wy),e),n(Qy(),e);var o=tv();Object.defineProperty(e,"safeJsonParse",{enumerable:!0,get:function(){return o.safeJsonParse}}),Object.defineProperty(e,"safeJsonStringify",{enumerable:!0,get:function(){return o.safeJsonStringify}});var s=xy();Object.defineProperty(e,"getUniversalLink",{enumerable:!0,get:function(){return s.getUniversalLink}}),Object.defineProperty(e,"openOKXDeeplink",{enumerable:!0,get:function(){return s.openOKXDeeplink}}),Object.defineProperty(e,"openOKXDeeplinkWithFallback",{enumerable:!0,get:function(){return s.openOKXDeeplinkWithFallback}}),Object.defineProperty(e,"isTelegramUrl",{enumerable:!0,get:function(){return s.isTelegramUrl}}),Object.defineProperty(e,"encodeTelegramUrlParameters",{enumerable:!0,get:function(){return s.encodeTelegramUrlParameters}}),Object.defineProperty(e,"getAppWalletDeepLink",{enumerable:!0,get:function(){return s.getAppWalletDeepLink}}),Object.defineProperty(e,"getTelegramWalletTWAUrl",{enumerable:!0,get:function(){return s.getTelegramWalletTWAUrl}}),Object.defineProperty(e,"openOKXTMAWalletlinkWithFallback",{enumerable:!0,get:function(){return s.openOKXTMAWalletlinkWithFallback}}),Object.defineProperty(e,"encodeConnectParams",{enumerable:!0,get:function(){return s.encodeConnectParams}}),Object.defineProperty(e,"encodeTWAConnectURLParams",{enumerable:!0,get:function(){return s.encodeTWAConnectURLParams}}),Object.defineProperty(e,"getAppWalletShortDeepLink",{enumerable:!0,get:function(){return s.getAppWalletShortDeepLink}}),Object.defineProperty(e,"getOKXLink",{enumerable:!0,get:function(){return s.getOKXLink}});var a=cb();Object.defineProperty(e,"hexToByteArray",{enumerable:!0,get:function(){return a.hexToByteArray}}),Object.defineProperty(e,"toHexString",{enumerable:!0,get:function(){return a.toHexString}}),Object.defineProperty(e,"concatUint8Arrays",{enumerable:!0,get:function(){return a.concatUint8Arrays}}),Object.defineProperty(e,"splitToUint8Arrays",{enumerable:!0,get:function(){return a.splitToUint8Arrays}}),Object.defineProperty(e,"base64encode",{enumerable:!0,get:function(){return a.base64encode}}),Object.defineProperty(e,"base64decode",{enumerable:!0,get:function(){return a.base64decode}}),Object.defineProperty(e,"isIos",{enumerable:!0,get:function(){return a.isIos}}),Object.defineProperty(e,"isValidObject",{enumerable:!0,get:function(){return a.isValidObject}}),Object.defineProperty(e,"toSafeBase64FromBase64",{enumerable:!0,get:function(){return a.toSafeBase64FromBase64}}),Object.defineProperty(e,"useShortLink",{enumerable:!0,get:function(){return a.useShortLink}}),Object.defineProperty(e,"getChainId",{enumerable:!0,get:function(){return a.getChainId}});var c=ky();Object.defineProperty(e,"openLink",{enumerable:!0,get:function(){return c.openLink}}),Object.defineProperty(e,"openLinkBlank",{enumerable:!0,get:function(){return c.openLinkBlank}}),Object.defineProperty(e,"openDeeplinkWithFallback",{enumerable:!0,get:function(){return c.openDeeplinkWithFallback}}),Object.defineProperty(e,"isMobileUserAgent",{enumerable:!0,get:function(){return c.isMobileUserAgent}}),Object.defineProperty(e,"isOS",{enumerable:!0,get:function(){return c.isOS}}),Object.defineProperty(e,"isBrowser",{enumerable:!0,get:function(){return c.isBrowser}});var l=Iy();Object.defineProperty(e,"versionCompare",{enumerable:!0,get:function(){return l.versionCompare}});var u=Fy();Object.defineProperty(e,"checkMetaData",{enumerable:!0,get:function(){return u.checkMetaData}});var h=cb();Object.defineProperty(e,"replaceChainNameToChainId",{enumerable:!0,get:function(){return h.replaceChainNameToChainId}}),Object.defineProperty(e,"replaceChainIdToChainName",{enumerable:!0,get:function(){return h.replaceChainIdToChainName}}),Object.defineProperty(e,"chainName2IdMap",{enumerable:!0,get:function(){return h.chainName2IdMap}}),Object.defineProperty(e,"getNamespaceKeyByChain",{enumerable:!0,get:function(){return h.getNamespaceKeyByChain}})}(Ky)),Ky}var Gy,qy,Vy={exports:{}};function zy(){return Gy||(Gy=1,Vy.exports=function e(t,n,r){function i(s,a){if(!n[s]){if(!t[s]){if(!a&&op)return op(s);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[s]={exports:{}};t[s][0].call(l.exports,function(e){return i(t[s][1][e]||e)},l,l.exports,e,t,n,r)}return n[s].exports}for(var o=op,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(e,t){(function(e){var n,r=e.MutationObserver||e.WebKitMutationObserver;if(r){var i=0,o=new r(u),s=e.document.createTextNode("");o.observe(s,{characterData:!0}),n=function(){s.data=i=++i%2}}else if(e.setImmediate||void 0===e.MessageChannel)n="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){u(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(u,0)};else{var a=new e.MessageChannel;a.port1.onmessage=u,n=function(){a.port2.postMessage(0)}}var c,l=[];function u(){c=!0;for(var e,t,n=l.length;n;){for(t=l,l=[],e=-1;++e<n;)t[e]();n=l.length}c=!1}t.exports=function(e){1===l.push(e)&&!c&&n()}}).call(this,void 0!==Kf?Kf:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t){var n=e(1);function r(){}var i={},o=["REJECTED"],s=["FULFILLED"],a=["PENDING"];function c(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=a,this.queue=[],this.outcome=void 0,e!==r&&d(this,e)}function l(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function u(e,t,r){n(function(){var n;try{n=t(r)}catch(o){return i.reject(e,o)}n===e?i.reject(e,new TypeError("Cannot resolve promise with itself")):i.resolve(e,n)})}function h(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function d(e,t){var n=!1;function r(t){n||(n=!0,i.reject(e,t))}function o(t){n||(n=!0,i.resolve(e,t))}var s=f(function(){t(o,r)});"error"===s.status&&r(s.value)}function f(e,t){var n={};try{n.value=e(t),n.status="success"}catch(r){n.status="error",n.value=r}return n}t.exports=c,c.prototype.catch=function(e){return this.then(null,e)},c.prototype.then=function(e,t){if("function"!=typeof e&&this.state===s||"function"!=typeof t&&this.state===o)return this;var n=new this.constructor(r);return this.state!==a?u(n,this.state===s?e:t,this.outcome):this.queue.push(new l(n,e,t)),n},l.prototype.callFulfilled=function(e){i.resolve(this.promise,e)},l.prototype.otherCallFulfilled=function(e){u(this.promise,this.onFulfilled,e)},l.prototype.callRejected=function(e){i.reject(this.promise,e)},l.prototype.otherCallRejected=function(e){u(this.promise,this.onRejected,e)},i.resolve=function(e,t){var n=f(h,t);if("error"===n.status)return i.reject(e,n.value);var r=n.value;if(r)d(e,r);else{e.state=s,e.outcome=t;for(var o=-1,a=e.queue.length;++o<a;)e.queue[o].callFulfilled(t)}return e},i.reject=function(e,t){e.state=o,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e},c.resolve=function(e){return e instanceof this?e:i.resolve(new this(r),e)},c.reject=function(e){var t=new this(r);return i.reject(t,e)},c.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,o=!1;if(!n)return this.resolve([]);for(var s=new Array(n),a=0,c=-1,l=new this(r);++c<n;)u(e[c],c);return l;function u(e,r){t.resolve(e).then(function(e){s[r]=e,++a===n&&!o&&(o=!0,i.resolve(l,s))},function(e){o||(o=!0,i.reject(l,e))})}},c.race=function(e){if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var t,n=e.length,o=!1;if(!n)return this.resolve([]);for(var s=-1,a=new this(r);++s<n;)t=e[s],this.resolve(t).then(function(e){o||(o=!0,i.resolve(a,e))},function(e){o||(o=!0,i.reject(a,e))});return a}},{1:1}],3:[function(e){(function(t){"function"!=typeof t.Promise&&(t.Promise=e(2))}).call(this,void 0!==Kf?Kf:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,t){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch{return}}();function o(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(i){if("TypeError"!==i.name)throw i;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),r=0;r<e.length;r+=1)n.append(e[r]);return n.getBlob(t.type)}}"undefined"==typeof Promise&&e(3);var s=Promise;function a(e,t){t&&e.then(function(e){t(null,e)},function(e){t(e)})}function c(e,t,n){"function"==typeof t&&e.then(t),"function"==typeof n&&e.catch(n)}function l(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function u(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var h="local-forage-detect-blob-support",d=void 0,f={},p=Object.prototype.toString,g="readonly",m="readwrite";function y(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),i=0;i<t;i++)r[i]=e.charCodeAt(i);return n}function v(e){return new s(function(t){var n=e.transaction(h,m),r=o([""]);n.objectStore(h).put(r,"key"),n.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},n.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);t(n||!e||parseInt(e[1],10)>=43)}}).catch(function(){return!1})}function w(e){return"boolean"==typeof d?s.resolve(d):v(e).then(function(e){return d=e})}function b(e){var t=f[e.name],n={};n.promise=new s(function(e,t){n.resolve=e,n.reject=t}),t.deferredOperations.push(n),t.dbReady?t.dbReady=t.dbReady.then(function(){return n.promise}):t.dbReady=n.promise}function O(e){var t=f[e.name].deferredOperations.pop();if(t)return t.resolve(),t.promise}function E(e,t){var n=f[e.name].deferredOperations.pop();if(n)return n.reject(t),n.promise}function _(e,t){return new s(function(n,r){if(f[e.name]=f[e.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},e.db){if(!t)return n(e.db);b(e),e.db.close()}var o=[e.name];t&&o.push(e.version);var s=i.open.apply(i,o);t&&(s.onupgradeneeded=function(t){var n=s.result;try{n.createObjectStore(e.storeName),t.oldVersion<=1&&n.createObjectStore(h)}catch(r){if("ConstraintError"!==r.name)throw r;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),s.onerror=function(e){e.preventDefault(),r(s.error)},s.onsuccess=function(){var t=s.result;t.onversionchange=function(e){e.target.close()},n(t),O(e)}})}function C(e){return _(e,!1)}function N(e){return _(e,!0)}function A(e,t){if(!e.db)return!0;var n=!e.db.objectStoreNames.contains(e.storeName),r=e.version<e.db.version,i=e.version>e.db.version;if(r&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),i||n){if(n){var o=e.db.version+1;o>e.version&&(e.version=o)}return!0}return!1}function R(e){return new s(function(t,n){var r=new FileReader;r.onerror=n,r.onloadend=function(n){var r=btoa(n.target.result||"");t({__local_forage_encoded_blob:!0,data:r,type:e.type})},r.readAsBinaryString(e)})}function S(e){return o([y(atob(e.data))],{type:e.type})}function T(e){return e&&e.__local_forage_encoded_blob}function P(e){var t=this,n=t._initReady().then(function(){var e=f[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady});return c(n,e,e),n}function D(e){b(e);for(var t=f[e.name],n=t.forages,r=0;r<n.length;r++){var i=n[r];i._dbInfo.db&&(i._dbInfo.db.close(),i._dbInfo.db=null)}return e.db=null,C(e).then(function(t){return e.db=t,A(e)?N(e):t}).then(function(r){e.db=t.db=r;for(var i=0;i<n.length;i++)n[i]._dbInfo.db=r}).catch(function(t){throw E(e,t),t})}function k(e,t,n,r){void 0===r&&(r=1);try{var i=e.db.transaction(e.storeName,t);n(null,i)}catch(o){if(r>0&&(!e.db||"InvalidStateError"===o.name||"NotFoundError"===o.name))return s.resolve().then(function(){if(!e.db||"NotFoundError"===o.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),N(e)}).then(function(){return D(e).then(function(){k(e,t,n,r-1)})}).catch(n);n(o)}}var I={_driver:"asyncStorage",_initStorage:function(e){var t=this,n={db:null};if(e)for(var r in e)n[r]=e[r];var i=f[n.name];i||(i={forages:[],db:null,dbReady:null,deferredOperations:[]},f[n.name]=i),i.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=P);var o=[];function a(){return s.resolve()}for(var c=0;c<i.forages.length;c++){var l=i.forages[c];l!==t&&o.push(l._initReady().catch(a))}var u=i.forages.slice(0);return s.all(o).then(function(){return n.db=i.db,C(n)}).then(function(e){return n.db=e,A(n,t._defaultConfig.version)?N(n):e}).then(function(e){n.db=i.db=e,t._dbInfo=n;for(var r=0;r<u.length;r++){var o=u[r];o!==t&&(o._dbInfo.db=n.db,o._dbInfo.version=n.version)}})},_support:function(){try{if(!i||!i.open)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch{return!1}}(),iterate:function(e,t){var n=this,r=new s(function(t,r){n.ready().then(function(){k(n._dbInfo,g,function(i,o){if(i)return r(i);try{var s=o.objectStore(n._dbInfo.storeName).openCursor(),a=1;s.onsuccess=function(){var n=s.result;if(n){var r=n.value;T(r)&&(r=S(r));var i=e(r,n.key,a++);void 0!==i?t(i):n.continue()}else t()},s.onerror=function(){r(s.error)}}catch(c){r(c)}})}).catch(r)});return a(r,t),r},getItem:function(e,t){var n=this;e=l(e);var r=new s(function(t,r){n.ready().then(function(){k(n._dbInfo,g,function(i,o){if(i)return r(i);try{var s=o.objectStore(n._dbInfo.storeName).get(e);s.onsuccess=function(){var e=s.result;void 0===e&&(e=null),T(e)&&(e=S(e)),t(e)},s.onerror=function(){r(s.error)}}catch(a){r(a)}})}).catch(r)});return a(r,t),r},setItem:function(e,t,n){var r=this;e=l(e);var i=new s(function(n,i){var o;r.ready().then(function(){return o=r._dbInfo,"[object Blob]"===p.call(t)?w(o.db).then(function(e){return e?t:R(t)}):t}).then(function(t){k(r._dbInfo,m,function(o,s){if(o)return i(o);try{var a=s.objectStore(r._dbInfo.storeName);null===t&&(t=void 0);var c=a.put(t,e);s.oncomplete=function(){void 0===t&&(t=null),n(t)},s.onabort=s.onerror=function(){var e=c.error?c.error:c.transaction.error;i(e)}}catch(l){i(l)}})}).catch(i)});return a(i,n),i},removeItem:function(e,t){var n=this;e=l(e);var r=new s(function(t,r){n.ready().then(function(){k(n._dbInfo,m,function(i,o){if(i)return r(i);try{var s=o.objectStore(n._dbInfo.storeName).delete(e);o.oncomplete=function(){t()},o.onerror=function(){r(s.error)},o.onabort=function(){var e=s.error?s.error:s.transaction.error;r(e)}}catch(a){r(a)}})}).catch(r)});return a(r,t),r},clear:function(e){var t=this,n=new s(function(e,n){t.ready().then(function(){k(t._dbInfo,m,function(r,i){if(r)return n(r);try{var o=i.objectStore(t._dbInfo.storeName).clear();i.oncomplete=function(){e()},i.onabort=i.onerror=function(){var e=o.error?o.error:o.transaction.error;n(e)}}catch(s){n(s)}})}).catch(n)});return a(n,e),n},length:function(e){var t=this,n=new s(function(e,n){t.ready().then(function(){k(t._dbInfo,g,function(r,i){if(r)return n(r);try{var o=i.objectStore(t._dbInfo.storeName).count();o.onsuccess=function(){e(o.result)},o.onerror=function(){n(o.error)}}catch(s){n(s)}})}).catch(n)});return a(n,e),n},key:function(e,t){var n=this,r=new s(function(t,r){e<0?t(null):n.ready().then(function(){k(n._dbInfo,g,function(i,o){if(i)return r(i);try{var s=o.objectStore(n._dbInfo.storeName),a=!1,c=s.openKeyCursor();c.onsuccess=function(){var n=c.result;n?0===e||a?t(n.key):(a=!0,n.advance(e)):t(null)},c.onerror=function(){r(c.error)}}catch(l){r(l)}})}).catch(r)});return a(r,t),r},keys:function(e){var t=this,n=new s(function(e,n){t.ready().then(function(){k(t._dbInfo,g,function(r,i){if(r)return n(r);try{var o=i.objectStore(t._dbInfo.storeName).openKeyCursor(),s=[];o.onsuccess=function(){var t=o.result;t?(s.push(t.key),t.continue()):e(s)},o.onerror=function(){n(o.error)}}catch(a){n(a)}})}).catch(n)});return a(n,e),n},dropInstance:function(e,t){t=u.apply(this,arguments);var n,r=this.config();if((e="function"!=typeof e&&e||{}).name||(e.name=e.name||r.name,e.storeName=e.storeName||r.storeName),e.name){var o=e.name===r.name&&this._dbInfo.db?s.resolve(this._dbInfo.db):C(e).then(function(t){var n=f[e.name],r=n.forages;n.db=t;for(var i=0;i<r.length;i++)r[i]._dbInfo.db=t;return t});n=e.storeName?o.then(function(t){if(t.objectStoreNames.contains(e.storeName)){var n=t.version+1;b(e);var r=f[e.name],o=r.forages;t.close();for(var a=0;a<o.length;a++){var c=o[a];c._dbInfo.db=null,c._dbInfo.version=n}return new s(function(t,r){var o=i.open(e.name,n);o.onerror=function(e){o.result.close(),r(e)},o.onupgradeneeded=function(){o.result.deleteObjectStore(e.storeName)},o.onsuccess=function(){var e=o.result;e.close(),t(e)}}).then(function(e){r.db=e;for(var t=0;t<o.length;t++){var n=o[t];n._dbInfo.db=e,O(n._dbInfo)}}).catch(function(t){throw(E(e,t)||s.resolve()).catch(function(){}),t})}}):o.then(function(t){b(e);var n=f[e.name],r=n.forages;t.close();for(var o=0;o<r.length;o++)r[o]._dbInfo.db=null;return new s(function(t,n){var r=i.deleteDatabase(e.name);r.onerror=function(){var e=r.result;e&&e.close(),n(r.error)},r.onblocked=function(){console.warn('dropInstance blocked for database "'+e.name+'" until all open connections are closed')},r.onsuccess=function(){var e=r.result;e&&e.close(),t(e)}}).then(function(e){n.db=e;for(var t=0;t<r.length;t++)O(r[t]._dbInfo)}).catch(function(t){throw(E(e,t)||s.resolve()).catch(function(){}),t})})}else n=s.reject("Invalid arguments");return a(n,t),n}},x="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",M=/^~~local_forage_type~([^~]+)~/,K="__lfsc__:",L=K.length,U="arbf",B="blob",j=L+U.length,H=Object.prototype.toString;function W(e){var t,n,r,i,o,s=.75*e.length,a=e.length,c=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var l=new ArrayBuffer(s),u=new Uint8Array(l);for(t=0;t<a;t+=4)n=x.indexOf(e[t]),r=x.indexOf(e[t+1]),i=x.indexOf(e[t+2]),o=x.indexOf(e[t+3]),u[c++]=n<<2|r>>4,u[c++]=(15&r)<<4|i>>2,u[c++]=(3&i)<<6|63&o;return l}function X(e){var t,n=new Uint8Array(e),r="";for(t=0;t<n.length;t+=3)r+=x[n[t]>>2],r+=x[(3&n[t])<<4|n[t+1]>>4],r+=x[(15&n[t+1])<<2|n[t+2]>>6],r+=x[63&n[t+2]];return n.length%3==2?r=r.substring(0,r.length-1)+"=":n.length%3==1&&(r=r.substring(0,r.length-2)+"=="),r}var F={serialize:function(e,t){var n="";if(e&&(n=H.call(e)),e&&("[object ArrayBuffer]"===n||e.buffer&&"[object ArrayBuffer]"===H.call(e.buffer))){var r,i=K;e instanceof ArrayBuffer?(r=e,i+=U):(r=e.buffer,"[object Int8Array]"===n?i+="si08":"[object Uint8Array]"===n?i+="ui08":"[object Uint8ClampedArray]"===n?i+="uic8":"[object Int16Array]"===n?i+="si16":"[object Uint16Array]"===n?i+="ur16":"[object Int32Array]"===n?i+="si32":"[object Uint32Array]"===n?i+="ui32":"[object Float32Array]"===n?i+="fl32":"[object Float64Array]"===n?i+="fl64":t(new Error("Failed to get type for BinaryArray"))),t(i+X(r))}else if("[object Blob]"===n){var o=new FileReader;o.onload=function(){var n="~~local_forage_type~"+e.type+"~"+X(this.result);t(K+B+n)},o.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(s){console.error("Couldn't convert value into a JSON string: ",e),t(null,s)}},deserialize:function(e){if(e.substring(0,L)!==K)return JSON.parse(e);var t,n=e.substring(j),r=e.substring(L,j);if(r===B&&M.test(n)){var i=n.match(M);t=i[1],n=n.substring(i[0].length)}var s=W(n);switch(r){case U:return s;case B:return o([s],{type:t});case"si08":return new Int8Array(s);case"ui08":return new Uint8Array(s);case"uic8":return new Uint8ClampedArray(s);case"si16":return new Int16Array(s);case"ur16":return new Uint16Array(s);case"si32":return new Int32Array(s);case"ui32":return new Uint32Array(s);case"fl32":return new Float32Array(s);case"fl64":return new Float64Array(s);default:throw new Error("Unkown type: "+r)}},stringToBuffer:W,bufferToString:X};function J(e,t,n,r){e.executeSql("CREATE TABLE IF NOT EXISTS "+t.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],n,r)}function G(e,t,n,r,i,o){e.executeSql(n,r,i,function(e,s){s.code===s.SYNTAX_ERR?e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[t.storeName],function(e,a){a.rows.length?o(e,s):J(e,t,function(){e.executeSql(n,r,i,o)},o)},o):o(e,s)},o)}function q(e,t,n,r){var i=this;e=l(e);var o=new s(function(o,s){i.ready().then(function(){void 0===t&&(t=null);var a=t,c=i._dbInfo;c.serializer.serialize(t,function(t,l){l?s(l):c.db.transaction(function(n){G(n,c,"INSERT OR REPLACE INTO "+c.storeName+" (key, value) VALUES (?, ?)",[e,t],function(){o(a)},function(e,t){s(t)})},function(t){if(t.code===t.QUOTA_ERR){if(r>0)return void o(q.apply(i,[e,a,n,r-1]));s(t)}})})}).catch(s)});return a(o,n),o}function V(e){return new s(function(t,n){e.transaction(function(r){r.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(n,r){for(var i=[],o=0;o<r.rows.length;o++)i.push(r.rows.item(o).name);t({db:e,storeNames:i})},function(e,t){n(t)})},function(e){n(e)})})}var z={_driver:"webSQLStorage",_initStorage:function(e){var t=this,n={db:null};if(e)for(var r in e)n[r]="string"!=typeof e[r]?e[r].toString():e[r];var i=new s(function(e,r){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(i){return r(i)}n.db.transaction(function(i){J(i,n,function(){t._dbInfo=n,e()},function(e,t){r(t)})},r)});return n.serializer=F,i},_support:"function"==typeof openDatabase,iterate:function(e,t){var n=this,r=new s(function(t,r){n.ready().then(function(){var i=n._dbInfo;i.db.transaction(function(n){G(n,i,"SELECT * FROM "+i.storeName,[],function(n,r){for(var o=r.rows,s=o.length,a=0;a<s;a++){var c=o.item(a),l=c.value;if(l&&(l=i.serializer.deserialize(l)),void 0!==(l=e(l,c.key,a+1)))return void t(l)}t()},function(e,t){r(t)})})}).catch(r)});return a(r,t),r},getItem:function(e,t){var n=this;e=l(e);var r=new s(function(t,r){n.ready().then(function(){var i=n._dbInfo;i.db.transaction(function(n){G(n,i,"SELECT * FROM "+i.storeName+" WHERE key = ? LIMIT 1",[e],function(e,n){var r=n.rows.length?n.rows.item(0).value:null;r&&(r=i.serializer.deserialize(r)),t(r)},function(e,t){r(t)})})}).catch(r)});return a(r,t),r},setItem:function(e,t,n){return q.apply(this,[e,t,n,1])},removeItem:function(e,t){var n=this;e=l(e);var r=new s(function(t,r){n.ready().then(function(){var i=n._dbInfo;i.db.transaction(function(n){G(n,i,"DELETE FROM "+i.storeName+" WHERE key = ?",[e],function(){t()},function(e,t){r(t)})})}).catch(r)});return a(r,t),r},clear:function(e){var t=this,n=new s(function(e,n){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(t){G(t,r,"DELETE FROM "+r.storeName,[],function(){e()},function(e,t){n(t)})})}).catch(n)});return a(n,e),n},length:function(e){var t=this,n=new s(function(e,n){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(t){G(t,r,"SELECT COUNT(key) as c FROM "+r.storeName,[],function(t,n){var r=n.rows.item(0).c;e(r)},function(e,t){n(t)})})}).catch(n)});return a(n,e),n},key:function(e,t){var n=this,r=new s(function(t,r){n.ready().then(function(){var i=n._dbInfo;i.db.transaction(function(n){G(n,i,"SELECT key FROM "+i.storeName+" WHERE id = ? LIMIT 1",[e+1],function(e,n){var r=n.rows.length?n.rows.item(0).key:null;t(r)},function(e,t){r(t)})})}).catch(r)});return a(r,t),r},keys:function(e){var t=this,n=new s(function(e,n){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(t){G(t,r,"SELECT key FROM "+r.storeName,[],function(t,n){for(var r=[],i=0;i<n.rows.length;i++)r.push(n.rows.item(i).key);e(r)},function(e,t){n(t)})})}).catch(n)});return a(n,e),n},dropInstance:function(e,t){t=u.apply(this,arguments);var n=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName);var r,i=this;return a(r=e.name?new s(function(t){var r;r=e.name===n.name?i._dbInfo.db:openDatabase(e.name,"","",0),e.storeName?t({db:r,storeNames:[e.storeName]}):t(V(r))}).then(function(e){return new s(function(t,n){e.db.transaction(function(r){function i(e){return new s(function(t,n){r.executeSql("DROP TABLE IF EXISTS "+e,[],function(){t()},function(e,t){n(t)})})}for(var o=[],a=0,c=e.storeNames.length;a<c;a++)o.push(i(e.storeNames[a]));s.all(o).then(function(){t()}).catch(function(e){n(e)})},function(e){n(e)})})}):s.reject("Invalid arguments"),t),r}};function Q(e,t){var n=e.name+"/";return e.storeName!==t.storeName&&(n+=e.storeName+"/"),n}function $(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch{return!0}}var Y={_driver:"localStorageWrapper",_initStorage:function(e){var t={};if(e)for(var n in e)t[n]=e[n];return t.keyPrefix=Q(e,this._defaultConfig),!$()||localStorage.length>0?(this._dbInfo=t,t.serializer=F,s.resolve()):s.reject()},_support:function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}(),iterate:function(e,t){var n=this,r=n.ready().then(function(){for(var t=n._dbInfo,r=t.keyPrefix,i=r.length,o=localStorage.length,s=1,a=0;a<o;a++){var c=localStorage.key(a);if(0===c.indexOf(r)){var l=localStorage.getItem(c);if(l&&(l=t.serializer.deserialize(l)),void 0!==(l=e(l,c.substring(i),s++)))return l}}});return a(r,t),r},getItem:function(e,t){var n=this;e=l(e);var r=n.ready().then(function(){var t=n._dbInfo,r=localStorage.getItem(t.keyPrefix+e);return r&&(r=t.serializer.deserialize(r)),r});return a(r,t),r},setItem:function(e,t,n){var r=this;e=l(e);var i=r.ready().then(function(){void 0===t&&(t=null);var n=t;return new s(function(i,o){var s=r._dbInfo;s.serializer.serialize(t,function(t,r){if(r)o(r);else try{localStorage.setItem(s.keyPrefix+e,t),i(n)}catch(a){("QuotaExceededError"===a.name||"NS_ERROR_DOM_QUOTA_REACHED"===a.name)&&o(a),o(a)}})})});return a(i,n),i},removeItem:function(e,t){var n=this;e=l(e);var r=n.ready().then(function(){var t=n._dbInfo;localStorage.removeItem(t.keyPrefix+e)});return a(r,t),r},clear:function(e){var t=this,n=t.ready().then(function(){for(var e=t._dbInfo.keyPrefix,n=localStorage.length-1;n>=0;n--){var r=localStorage.key(n);0===r.indexOf(e)&&localStorage.removeItem(r)}});return a(n,e),n},length:function(e){var t=this.keys().then(function(e){return e.length});return a(t,e),t},key:function(e,t){var n=this,r=n.ready().then(function(){var t,r=n._dbInfo;try{t=localStorage.key(e)}catch{t=null}return t&&(t=t.substring(r.keyPrefix.length)),t});return a(r,t),r},keys:function(e){var t=this,n=t.ready().then(function(){for(var e=t._dbInfo,n=localStorage.length,r=[],i=0;i<n;i++){var o=localStorage.key(i);0===o.indexOf(e.keyPrefix)&&r.push(o.substring(e.keyPrefix.length))}return r});return a(n,e),n},dropInstance:function(e,t){if(t=u.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){var n=this.config();e.name=e.name||n.name,e.storeName=e.storeName||n.storeName}var r,i=this;return a(r=e.name?new s(function(t){e.storeName?t(Q(e,i._defaultConfig)):t(e.name+"/")}).then(function(e){for(var t=localStorage.length-1;t>=0;t--){var n=localStorage.key(t);0===n.indexOf(e)&&localStorage.removeItem(n)}}):s.reject("Invalid arguments"),t),r}},Z=function(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)},ee=function(e,t){for(var n=e.length,r=0;r<n;){if(Z(e[r],t))return!0;r++}return!1},te=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},ne={},re={},ie={INDEXEDDB:I,WEBSQL:z,LOCALSTORAGE:Y},oe=[ie.INDEXEDDB._driver,ie.WEBSQL._driver,ie.LOCALSTORAGE._driver],se=["dropInstance"],ae=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(se),ce={description:"",driver:oe.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function le(e,t){e[t]=function(){var n=arguments;return e.ready().then(function(){return e[t].apply(e,n)})}}function ue(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var n in t)t.hasOwnProperty(n)&&(te(t[n])?arguments[0][n]=t[n].slice():arguments[0][n]=t[n])}return arguments[0]}var he=new(function(){function e(t){for(var n in r(this,e),ie)if(ie.hasOwnProperty(n)){var i=ie[n],o=i._driver;this[n]=o,ne[o]||this.defineDriver(i)}this._defaultConfig=ue({},ce),this._config=ue({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return e.prototype.config=function(e){if("object"===(void 0===e?"undefined":n(e))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e&&e.driver)||this.setDriver(this._config.driver)}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,n){var r=new s(function(t,n){try{var r=e._driver,i=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!e._driver)return void n(i);for(var o=ae.concat("_initStorage"),c=0,l=o.length;c<l;c++){var u=o[c];if((!ee(se,u)||e[u])&&"function"!=typeof e[u])return void n(i)}(function(){for(var t=function(e){return function(){var t=new Error("Method "+e+" is not implemented by the current driver"),n=s.reject(t);return a(n,arguments[arguments.length-1]),n}},n=0,r=se.length;n<r;n++){var i=se[n];e[i]||(e[i]=t(i))}})();var h=function(n){ne[r]&&console.info("Redefining LocalForage driver: "+r),ne[r]=e,re[r]=n,t()};"_support"in e?e._support&&"function"==typeof e._support?e._support().then(h,n):h(!!e._support):h(!0)}catch(d){n(d)}});return c(r,t,n),r},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,n){var r=ne[e]?s.resolve(ne[e]):s.reject(new Error("Driver not found."));return c(r,t,n),r},e.prototype.getSerializer=function(e){var t=s.resolve(F);return c(t,e),t},e.prototype.ready=function(e){var t=this,n=t._driverSet.then(function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready});return c(n,e,e),n},e.prototype.setDriver=function(e,t,n){var r=this;te(e)||(e=[e]);var i=this._getSupportedDrivers(e);function o(){r._config.driver=r.driver()}function a(e){return r._extend(e),o(),r._ready=r._initStorage(r._config),r._ready}function l(e){return function(){var t=0;return function n(){for(;t<e.length;){var i=e[t];return t++,r._dbInfo=null,r._ready=null,r.getDriver(i).then(a).catch(n)}o();var c=new Error("No available storage method found.");return r._driverSet=s.reject(c),r._driverSet}()}}var u=null!==this._driverSet?this._driverSet.catch(function(){return s.resolve()}):s.resolve();return this._driverSet=u.then(function(){var e=i[0];return r._dbInfo=null,r._ready=null,r.getDriver(e).then(function(e){r._driver=e._driver,o(),r._wrapLibraryMethodsWithReady(),r._initDriver=l(i)})}).catch(function(){o();var e=new Error("No available storage method found.");return r._driverSet=s.reject(e),r._driverSet}),c(this._driverSet,t,n),this._driverSet},e.prototype.supports=function(e){return!!re[e]},e.prototype._extend=function(e){ue(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n];this.supports(i)&&t.push(i)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0,t=ae.length;e<t;e++)le(this,ae[e])},e.prototype.createInstance=function(t){return new e(t)},e}());t.exports=he},{3:3}]},{},[4])(4)),Vy.exports}function Qy(){return qy||(qy=1,function(e){var t=Um&&Um.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})},n=Um&&Um.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0}),e.OKXReporter=e.OKXReportSide=e.OKXReportType=e.versionStr=void 0;const r=n((Im||(Im=1,function(e,t){var n,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||void 0!==Kf&&Kf,i=function(){function e(){this.fetch=!1,this.DOMException=r.DOMException}return e.prototype=r,new e}();n=i,function(e){var t=void 0!==n&&n||"undefined"!=typeof self&&self||void 0!==Kf&&Kf||{},r={searchParams:"URLSearchParams"in t,iterable:"Symbol"in t&&"iterator"in Symbol,blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};function i(e){return e&&DataView.prototype.isPrototypeOf(e)}if(r.arrayBuffer)var o=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],s=ArrayBuffer.isView||function(e){return e&&o.indexOf(Object.prototype.toString.call(e))>-1};function a(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||""===e)throw new TypeError('Invalid character in header field name: "'+e+'"');return e.toLowerCase()}function c(e){return"string"!=typeof e&&(e=String(e)),e}function l(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return r.iterable&&(t[Symbol.iterator]=function(){return t}),t}function u(e){this.map={},e instanceof u?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){if(2!=e.length)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+e.length);this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function h(e){if(!e._noBody){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}}function d(e){return new Promise(function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function f(e){var t=new FileReader,n=d(t);return t.readAsArrayBuffer(e),n}function p(e){var t=new FileReader,n=d(t),r=/charset=([A-Za-z0-9_-]+)/.exec(e.type),i=r?r[1]:"utf-8";return t.readAsText(e,i),n}function g(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}function m(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function y(){return this.bodyUsed=!1,this._initBody=function(e){this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:r.blob&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:r.formData&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:r.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():r.arrayBuffer&&r.blob&&i(e)?(this._bodyArrayBuffer=m(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):r.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(e)||s(e))?this._bodyArrayBuffer=m(e):this._bodyText=e=Object.prototype.toString.call(e):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):r.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},r.blob&&(this.blob=function(){var e=h(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer)return h(this)||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer));if(r.blob)return this.blob().then(f);throw new Error("could not read as ArrayBuffer")},this.text=function(){var e=h(this);if(e)return e;if(this._bodyBlob)return p(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(g(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},r.formData&&(this.formData=function(){return this.text().then(O)}),this.json=function(){return this.text().then(JSON.parse)},this}u.prototype.append=function(e,t){e=a(e),t=c(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},u.prototype.delete=function(e){delete this.map[a(e)]},u.prototype.get=function(e){return e=a(e),this.has(e)?this.map[e]:null},u.prototype.has=function(e){return this.map.hasOwnProperty(a(e))},u.prototype.set=function(e,t){this.map[a(e)]=c(t)},u.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},u.prototype.keys=function(){var e=[];return this.forEach(function(t,n){e.push(n)}),l(e)},u.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),l(e)},u.prototype.entries=function(){var e=[];return this.forEach(function(t,n){e.push([n,t])}),l(e)},r.iterable&&(u.prototype[Symbol.iterator]=u.prototype.entries);var v=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function w(e){var t=e.toUpperCase();return v.indexOf(t)>-1?t:e}function b(e,n){if(!(this instanceof b))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var r=(n=n||{}).body;if(e instanceof b){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,n.headers||(this.headers=new u(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,!r&&null!=e._bodyInit&&(r=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=n.credentials||this.credentials||"same-origin",(n.headers||!this.headers)&&(this.headers=new u(n.headers)),this.method=w(n.method||this.method||"GET"),this.mode=n.mode||this.mode||null,this.signal=n.signal||this.signal||function(){if("AbortController"in t)return(new AbortController).signal}(),this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(r),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==n.cache&&"no-cache"!==n.cache)){var i=/([?&])_=[^&]*/;i.test(this.url)?this.url=this.url.replace(i,"$1_="+(new Date).getTime()):this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}function O(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}}),t}function E(e){var t=new u;return e.replace(/\r?\n[\t ]+/g," ").split("\r").map(function(e){return 0===e.indexOf("\n")?e.substr(1,e.length):e}).forEach(function(e){var n=e.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();try{t.append(r,i)}catch(o){console.warn("Response "+o.message)}}}),t}function _(e,t){if(!(this instanceof _))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=void 0===t.statusText?"":""+t.statusText,this.headers=new u(t.headers),this.url=t.url||"",this._initBody(e)}b.prototype.clone=function(){return new b(this,{body:this._bodyInit})},y.call(b.prototype),y.call(_.prototype),_.prototype.clone=function(){return new _(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new u(this.headers),url:this.url})},_.error=function(){var e=new _(null,{status:200,statusText:""});return e.ok=!1,e.status=0,e.type="error",e};var C=[301,302,303,307,308];_.redirect=function(e,t){if(-1===C.indexOf(t))throw new RangeError("Invalid status code");return new _(null,{status:t,headers:{location:e}})},e.DOMException=t.DOMException;try{new e.DOMException}catch{e.DOMException=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function N(n,i){return new Promise(function(o,s){var l=new b(n,i);if(l.signal&&l.signal.aborted)return s(new e.DOMException("Aborted","AbortError"));var h=new XMLHttpRequest;function d(){h.abort()}if(h.onload=function(){var e={statusText:h.statusText,headers:E(h.getAllResponseHeaders()||"")};0===l.url.indexOf("file://")&&(h.status<200||h.status>599)?e.status=200:e.status=h.status,e.url="responseURL"in h?h.responseURL:e.headers.get("X-Request-URL");var t="response"in h?h.response:h.responseText;setTimeout(function(){o(new _(t,e))},0)},h.onerror=function(){setTimeout(function(){s(new TypeError("Network request failed"))},0)},h.ontimeout=function(){setTimeout(function(){s(new TypeError("Network request timed out"))},0)},h.onabort=function(){setTimeout(function(){s(new e.DOMException("Aborted","AbortError"))},0)},h.open(l.method,function(e){try{return""===e&&t.location.href?t.location.href:e}catch{return e}}(l.url),!0),"include"===l.credentials?h.withCredentials=!0:"omit"===l.credentials&&(h.withCredentials=!1),"responseType"in h&&(r.blob?h.responseType="blob":r.arrayBuffer&&(h.responseType="arraybuffer")),i&&"object"==typeof i.headers&&!(i.headers instanceof u||t.Headers&&i.headers instanceof t.Headers)){var f=[];Object.getOwnPropertyNames(i.headers).forEach(function(e){f.push(a(e)),h.setRequestHeader(e,c(i.headers[e]))}),l.headers.forEach(function(e,t){-1===f.indexOf(t)&&h.setRequestHeader(t,e)})}else l.headers.forEach(function(e,t){h.setRequestHeader(t,e)});l.signal&&(l.signal.addEventListener("abort",d),h.onreadystatechange=function(){4===h.readyState&&l.signal.removeEventListener("abort",d)}),h.send(void 0===l._bodyInit?null:l._bodyInit)})}N.polyfill=!0,t.fetch||(t.fetch=N,t.Headers=u,t.Request=b,t.Response=_),e.Headers=u,e.Request=b,e.Response=_,e.fetch=N}({}),i.fetch.ponyfill=!0,delete i.fetch.polyfill;var o=r.fetch?r:i;(t=o.fetch).default=o.fetch,t.fetch=o.fetch,t.Headers=o.Headers,t.Request=o.Request,t.Response=o.Response,e.exports=t}(Bm,Bm.exports)),Bm.exports)),i=ev(),o=xy(),s=Jy(),a=n(zy());e.versionStr="1.8.6";const c=["https://www.okx.com/dappstat/wallet-connect","https://www.okx.ac/dappstat/wallet-connect"],l="OKX_RP_UUID_CK",u={headers:{Accept:"*/*","Content-Type":"text/plain"},method:"POST"};e.OKXReportType={PAGE_IN:"page_in",PAGE_OUT:"page_out",CLICK:"click",LOG:"log"},e.OKXReportSide={DAPP:"dapp",WALLET:"wallet"};const h=(e,...n)=>t(void 0,[e,...n],void 0,function*(e,t={},n=5e3){for(const o of e)try{const e=new AbortController,s=e.signal,a=(0,r.default)(o,Object.assign(Object.assign({},t),{signal:s})),c=new Promise((t,r)=>setTimeout(()=>{e.abort(),r(new Error("Request timed out"))},n)),l=yield Promise.race([a,c]);if(l.ok)return l;if(502==l.status)return console.error("Fetch error status 502",o),l}catch(i){console.error(`Fetch error for ${o}:`,i)}throw console.error("'All fetch attempts failed.'"),new Error("All fetch attempts failed.")});e.OKXReporter=class{constructor(){this.currentSide=e.OKXReportSide.DAPP,this.currentVersion=e.versionStr,this.storage=a.default.createInstance({name:"OKXReporter"}),this.recordList=new Array,this.currentUUID="fjdkakfjsadkfklasdkfsdjkljfklsdjklfioruer3239084dkskfsa"}configVersionAndSide(e,t,n){this.currentVersion=e+i.logVersion,this.currentSide=t,this.appName=n}get recordCacheKey(){return"OKX_RP_CK@"+this.appName}get reportPlatform(){return(0,s.isMobileUserAgent)()?(0,s.isIos)()?"iOS":"android":"pc"}beginReport(){return t(this,void 0,void 0,function*(){this.startErrorCatching();let e=yield this.storage.getItem(this.recordCacheKey),t=yield this.storage.getItem(l);t?this.currentUUID=t:this.storage.setItem(l,this.currentUUID),e&&(this.recordList=e,(0,i.logDebug)("resume records from cache length: ",this.recordList.length),yield this.sendCachedRecords())})}startErrorCatching(){(0,o.getWindow)()&&(0,i.logDebug)("begin capture console error")}cachedErrors(){return this.recordList}sendRecord(e){return t(this,void 0,void 0,function*(){return new Promise((n,r)=>t(this,void 0,void 0,function*(){try{const o=JSON.stringify(e);(0,i.logDebug)("[REPORT] record: ",o);const s=yield h(c,Object.assign(Object.assign({},u),{body:o}));(0,i.logDebug)("[REPORT] get rsp:",s),s&&s.status&&200==s.status?(this.recordList=this.recordList.filter(t=>t.timestamp!=e.timestamp||t.content!=e.content),yield this.storage.setItem(this.recordCacheKey,this.recordList),n(!0)):r(!1)}catch(t){(0,i.logDebug)("send record error:",t),n(!0)}}))})}sendRecordContent(e,n,r){return t(this,arguments,void 0,function*(e,t,n,r,i,s,a,c,l){var u,h,d,f;let p=null===(u=(0,o.getWindow)())||void 0===u?void 0:u.location.pathname,g=null===(h=(0,o.getWindow)())||void 0===h?void 0:h.location.origin;p&&g&&(g+=p);let m=null===(d=(0,o.getWindow)())||void 0===d?void 0:d.navigator.language,y=null===(f=(0,o.getWindow)())||void 0===f?void 0:f.navigator.userAgent,v=this.reportPlatform,w={uuid:this.currentUUID,version:this.currentVersion,content:e,action:n,side:this.currentSide,timestamp:(new Date).getTime(),url:g,lang:m,type:t,platform:v,"user-agent":y,reverved1:r,reverved2:i,reverved3:s,reverved4:a,reverved5:c,reverved6:l};yield this.markRecordItem(w),yield this.sendRecord(w)})}sendCachedRecords(){return t(this,void 0,void 0,function*(){return new Promise((e,n)=>t(this,void 0,void 0,function*(){let t=this.recordList.map(e=>this.sendRecord(e));(0,i.logDebug)("[REPORT] submit & clean recorded caches begin @",(new Date).toUTCString()),Promise.allSettled(t).then(t=>{(0,i.logDebug)("[REPORT] submit & clean recorded caches ends @",(new Date).toUTCString());let r=[];t.forEach((e,t)=>{"rejected"==e.status&&r.push(t)}),this.recordList=this.recordList.filter((e,t)=>!r.includes(t)),this.storage.setItem(this.recordCacheKey,this.recordList).then(function(){e()}).catch(function(e){n(e)})})}))})}markRecordItem(e){return t(this,void 0,void 0,function*(){if(this.recordList.push(e),this.recordList.length>100){let e=this.recordList.length-100;this.recordList.splice(0,e)}return new Promise((t,n)=>{this.storage.setItem(this.recordCacheKey,this.recordList).then(function(){t(e)}).catch(function(e){n(e)})})})}}}(Um)),Um}const $y={version:"1.8.6"};var Yy,Zy;function ev(){if(Yy)return Lm;Yy=1;var e=Lm&&Lm.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(Lm,"__esModule",{value:!0}),Lm.logVersion=void 0,Lm.getDefaultReporter=function(){return i},Lm.logDebug=function(...e){if("undefined"!=typeof console)try{(t||null!=window&&window.okxLogDebug)&&console.log(`[OKX_CONNECT_SDK1] ${o} `,...e)}catch{}},Lm.logError=function(...e){if("undefined"!=typeof console)try{if((t||null!=window&&window.okxLogDebug)&&console.error(`[OKX_CONNECT_SDK1] ${o} `,...e),n||!t){let t="";t+=[...e].reduce((e,t)=>{"string"==typeof t||"object"==typeof t&&JSON.stringify(t)}),i.sendRecordContent(t,r.OKXReportType.LOG,"")}}catch{}},Lm.logWarning=function(...e){if("undefined"!=typeof console)try{(t||null!=window&&window.okxLogDebug)&&console.warn(`[OKX_CONNECT_SDK1] ${o} `,...e)}catch{}},Lm.reportEvent=function(t,n,r){return e(this,arguments,void 0,function*(e,t,n,r,o,s,a,c,l){try{yield i.sendRecordContent(n,e,t,r,o,s,a,c,l)}catch{}})},Lm.reportLog=function(t){return e(this,arguments,void 0,function*(){})};const t=!1,n=!1,r=Qy(),i=new r.OKXReporter,o=$y.version;return Lm.logVersion=o,Lm}function tv(){if(Zy)return Km;Zy=1,Object.defineProperty(Km,"__esModule",{value:!0}),Km.safeJsonParse=function(t){if("string"!=typeof t)throw(0,e.logDebug)(t),new Error(`Cannot safe json parse value of type ${typeof t}`);try{return n(t)}catch(r){return console.error("safeJsonParse error:",r),t}},Km.safeJsonStringify=function(e){return"string"==typeof e?e:t(e)||""};const e=ev(),t=e=>JSON.stringify(e,(e,t)=>"bigint"==typeof t?t.toString()+"n":t),n=e=>{const t=e.replace(/:(\b\d{17,}|\b(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))(?=[,\}\]]|$)/g,(e,t)=>`:"${t}n"`);try{return JSON.parse(t,(e,t)=>"string"==typeof t&&t.match(/^\d+n$/)?BigInt(t.substring(0,t.length-1)):t)}catch{return JSON.parse(e)}};return Km}var nv={};const rv=Lf(gm);var iv;function ov(){if(iv)return nv;iv=1,Object.defineProperty(nv,"__esModule",{value:!0}),nv.okxfromString=function(e,n="utf8"){const r=s[n];if((0,t.logDebug)("okxfromstring ====> "),!r)throw new Error(`Unsupported encoding "${n}"`);return r.decoder.decode(`${r.prefix}${e}`)},nv.okxtoString=function(e,n="utf8"){const r=s[n];if((0,t.logDebug)("okxtoString ====> "),!r)throw new Error(`Unsupported encoding "${n}"`);return r.encoder.encode(e).substring(1)},nv.alloc=function(e=0){return new Uint8Array(e)},nv.allocUnsafe=n;const e=rv,t=ev();function n(e=0){return new Uint8Array(e)}function r(e,t,n,r){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:r}}}const i=r("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>(new TextEncoder).encode(e.substring(1))),o=r("ascii","a",e=>{let t="a";for(let n=0;n<e.length;n++){let r=e[n];r&&String.fromCharCode(r)&&(t+=String.fromCharCode(r))}return t},e=>{const t=n((e=e.substring(1)).length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}),s=Object.assign({utf8:i,"utf-8":i,hex:e.bases.base16,latin1:o,ascii:o,binary:o},e.bases);return nv}var sv,av={exports:{}},cv={exports:{}};function lv(){return sv||(sv=1,cv.exports=e=e||function(e){var t;if("undefined"!=typeof window&&window.crypto&&(t=window.crypto),"undefined"!=typeof self&&self.crypto&&(t=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(t=globalThis.crypto),!t&&"undefined"!=typeof window&&window.msCrypto&&(t=window.msCrypto),!t&&void 0!==Kf&&Kf.crypto&&(t=Kf.crypto),!t)try{t=ap}catch{}var n=function(){if(t){if("function"==typeof t.getRandomValues)try{return t.getRandomValues(new Uint32Array(1))[0]}catch{}if("function"==typeof t.randomBytes)try{return t.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},r=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),i={},o=i.lib={},s=o.Base={extend:function(e){var t=r(this);return e&&t.mixIn(e),(!t.hasOwnProperty("init")||this.init===t.init)&&(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},a=o.WordArray=s.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||l).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,i=e.sigBytes;if(this.clamp(),r%4)for(var o=0;o<i;o++){var s=n[o>>>2]>>>24-o%4*8&255;t[r+o>>>2]|=s<<24-(r+o)%4*8}else for(var a=0;a<i;a+=4)t[r+a>>>2]=n[a>>>2];return this.sigBytes+=i,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=s.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],r=0;r<e;r+=4)t.push(n());return new a.init(t,e)}}),c=i.enc={},l=c.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i++){var o=t[i>>>2]>>>24-i%4*8&255;r.push((o>>>4).toString(16)),r.push((15&o).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new a.init(n,t/2)}},u=c.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i++){var o=t[i>>>2]>>>24-i%4*8&255;r.push(String.fromCharCode(o))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new a.init(n,t)}},h=c.Utf8={stringify:function(e){try{return decodeURIComponent(escape(u.stringify(e)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(e){return u.parse(unescape(encodeURIComponent(e)))}},d=o.BufferedBlockAlgorithm=s.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=h.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n,r=this._data,i=r.words,o=r.sigBytes,s=this.blockSize,c=o/(4*s),l=(c=t?e.ceil(c):e.max((0|c)-this._minBufferSize,0))*s,u=e.min(4*l,o);if(l){for(var h=0;h<l;h+=s)this._doProcessBlock(i,h);n=i.splice(0,l),r.sigBytes-=u}return new a.init(n,u)},clone:function(){var e=s.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});o.Hasher=d.extend({cfg:s.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new f.HMAC.init(e,n).finalize(t)}}});var f=i.algo={};return i}(Math)),cv.exports;var e}cv.exports;var uv,hv={exports:{}};function dv(){return uv||(uv=1,hv.exports=(n=(t=e=lv()).lib,r=n.Base,i=n.WordArray,(o=t.x64={}).Word=r.extend({init:function(e,t){this.high=e,this.low=t}}),o.WordArray=r.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:8*e.length},toX32:function(){for(var e=this.words,t=e.length,n=[],r=0;r<t;r++){var o=e[r];n.push(o.high),n.push(o.low)}return i.create(n,this.sigBytes)},clone:function(){for(var e=r.clone.call(this),t=e.words=this.words.slice(0),n=t.length,i=0;i<n;i++)t[i]=t[i].clone();return e}}),e)),hv.exports;var e,t,n,r,i,o}hv.exports;var fv,pv={exports:{}};function gv(){return fv||(fv=1,pv.exports=(e=lv(),function(){if("function"==typeof ArrayBuffer){var t=e.lib.WordArray,n=t.init;(t.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var t=e.byteLength,r=[],i=0;i<t;i++)r[i>>>2]|=e[i]<<24-i%4*8;n.call(this,r,t)}else n.apply(this,arguments)}).prototype=t}}(),e.lib.WordArray)),pv.exports;var e}pv.exports;var mv,yv={exports:{}};function vv(){return mv||(mv=1,yv.exports=(e=lv(),function(){var t=e,n=t.lib.WordArray,r=t.enc;function i(e){return e<<8&4278255360|e>>>8&16711935}r.Utf16=r.Utf16BE={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i+=2){var o=t[i>>>2]>>>16-i%4*8&65535;r.push(String.fromCharCode(o))}return r.join("")},parse:function(e){for(var t=e.length,r=[],i=0;i<t;i++)r[i>>>1]|=e.charCodeAt(i)<<16-i%2*16;return n.create(r,2*t)}},r.Utf16LE={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],o=0;o<n;o+=2){var s=i(t[o>>>2]>>>16-o%4*8&65535);r.push(String.fromCharCode(s))}return r.join("")},parse:function(e){for(var t=e.length,r=[],o=0;o<t;o++)r[o>>>1]|=i(e.charCodeAt(o)<<16-o%2*16);return n.create(r,2*t)}}}(),e.enc.Utf16)),yv.exports;var e}yv.exports;var wv,bv={exports:{}};function Ov(){return wv||(wv=1,bv.exports=(e=lv(),function(){var t=e,n=t.lib.WordArray;function r(e,t,r){for(var i=[],o=0,s=0;s<t;s++)if(s%4){var a=r[e.charCodeAt(s-1)]<<s%4*2|r[e.charCodeAt(s)]>>>6-s%4*2;i[o>>>2]|=a<<24-o%4*8,o++}return n.create(i,o)}t.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp();for(var i=[],o=0;o<n;o+=3)for(var s=(t[o>>>2]>>>24-o%4*8&255)<<16|(t[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|t[o+2>>>2]>>>24-(o+2)%4*8&255,a=0;a<4&&o+.75*a<n;a++)i.push(r.charAt(s>>>6*(3-a)&63));var c=r.charAt(64);if(c)for(;i.length%4;)i.push(c);return i.join("")},parse:function(e){var t=e.length,n=this._map,i=this._reverseMap;if(!i){i=this._reverseMap=[];for(var o=0;o<n.length;o++)i[n.charCodeAt(o)]=o}var s=n.charAt(64);if(s){var a=e.indexOf(s);-1!==a&&(t=a)}return r(e,t,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),e.enc.Base64)),bv.exports;var e}bv.exports;var Ev,_v={exports:{}};_v.exports;var Cv,Nv={exports:{}};function Av(){return Cv||(Cv=1,Nv.exports=(e=lv(),function(t){var n=e,r=n.lib,i=r.WordArray,o=r.Hasher,s=n.algo,a=[];(function(){for(var e=0;e<64;e++)a[e]=4294967296*t.abs(t.sin(e+1))|0})();var c=s.MD5=o.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var r=t+n,i=e[r];e[r]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}var o=this._hash.words,s=e[t+0],c=e[t+1],f=e[t+2],p=e[t+3],g=e[t+4],m=e[t+5],y=e[t+6],v=e[t+7],w=e[t+8],b=e[t+9],O=e[t+10],E=e[t+11],_=e[t+12],C=e[t+13],N=e[t+14],A=e[t+15],R=o[0],S=o[1],T=o[2],P=o[3];R=l(R,S,T,P,s,7,a[0]),P=l(P,R,S,T,c,12,a[1]),T=l(T,P,R,S,f,17,a[2]),S=l(S,T,P,R,p,22,a[3]),R=l(R,S,T,P,g,7,a[4]),P=l(P,R,S,T,m,12,a[5]),T=l(T,P,R,S,y,17,a[6]),S=l(S,T,P,R,v,22,a[7]),R=l(R,S,T,P,w,7,a[8]),P=l(P,R,S,T,b,12,a[9]),T=l(T,P,R,S,O,17,a[10]),S=l(S,T,P,R,E,22,a[11]),R=l(R,S,T,P,_,7,a[12]),P=l(P,R,S,T,C,12,a[13]),T=l(T,P,R,S,N,17,a[14]),R=u(R,S=l(S,T,P,R,A,22,a[15]),T,P,c,5,a[16]),P=u(P,R,S,T,y,9,a[17]),T=u(T,P,R,S,E,14,a[18]),S=u(S,T,P,R,s,20,a[19]),R=u(R,S,T,P,m,5,a[20]),P=u(P,R,S,T,O,9,a[21]),T=u(T,P,R,S,A,14,a[22]),S=u(S,T,P,R,g,20,a[23]),R=u(R,S,T,P,b,5,a[24]),P=u(P,R,S,T,N,9,a[25]),T=u(T,P,R,S,p,14,a[26]),S=u(S,T,P,R,w,20,a[27]),R=u(R,S,T,P,C,5,a[28]),P=u(P,R,S,T,f,9,a[29]),T=u(T,P,R,S,v,14,a[30]),R=h(R,S=u(S,T,P,R,_,20,a[31]),T,P,m,4,a[32]),P=h(P,R,S,T,w,11,a[33]),T=h(T,P,R,S,E,16,a[34]),S=h(S,T,P,R,N,23,a[35]),R=h(R,S,T,P,c,4,a[36]),P=h(P,R,S,T,g,11,a[37]),T=h(T,P,R,S,v,16,a[38]),S=h(S,T,P,R,O,23,a[39]),R=h(R,S,T,P,C,4,a[40]),P=h(P,R,S,T,s,11,a[41]),T=h(T,P,R,S,p,16,a[42]),S=h(S,T,P,R,y,23,a[43]),R=h(R,S,T,P,b,4,a[44]),P=h(P,R,S,T,_,11,a[45]),T=h(T,P,R,S,A,16,a[46]),R=d(R,S=h(S,T,P,R,f,23,a[47]),T,P,s,6,a[48]),P=d(P,R,S,T,v,10,a[49]),T=d(T,P,R,S,N,15,a[50]),S=d(S,T,P,R,m,21,a[51]),R=d(R,S,T,P,_,6,a[52]),P=d(P,R,S,T,p,10,a[53]),T=d(T,P,R,S,O,15,a[54]),S=d(S,T,P,R,c,21,a[55]),R=d(R,S,T,P,w,6,a[56]),P=d(P,R,S,T,A,10,a[57]),T=d(T,P,R,S,y,15,a[58]),S=d(S,T,P,R,C,21,a[59]),R=d(R,S,T,P,g,6,a[60]),P=d(P,R,S,T,E,10,a[61]),T=d(T,P,R,S,f,15,a[62]),S=d(S,T,P,R,b,21,a[63]),o[0]=o[0]+R|0,o[1]=o[1]+S|0,o[2]=o[2]+T|0,o[3]=o[3]+P|0},_doFinalize:function(){var e=this._data,n=e.words,r=8*this._nDataBytes,i=8*e.sigBytes;n[i>>>5]|=128<<24-i%32;var o=t.floor(r/4294967296),s=r;n[15+(i+64>>>9<<4)]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),n[14+(i+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),e.sigBytes=4*(n.length+1),this._process();for(var a=this._hash,c=a.words,l=0;l<4;l++){var u=c[l];c[l]=16711935&(u<<8|u>>>24)|4278255360&(u<<24|u>>>8)}return a},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});function l(e,t,n,r,i,o,s){var a=e+(t&n|~t&r)+i+s;return(a<<o|a>>>32-o)+t}function u(e,t,n,r,i,o,s){var a=e+(t&r|n&~r)+i+s;return(a<<o|a>>>32-o)+t}function h(e,t,n,r,i,o,s){var a=e+(t^n^r)+i+s;return(a<<o|a>>>32-o)+t}function d(e,t,n,r,i,o,s){var a=e+(n^(t|~r))+i+s;return(a<<o|a>>>32-o)+t}n.MD5=o._createHelper(c),n.HmacMD5=o._createHmacHelper(c)}(Math),e.MD5)),Nv.exports;var e}Nv.exports;var Rv,Sv={exports:{}};function Tv(){return Rv||(Rv=1,Sv.exports=(n=(t=e=lv()).lib,r=n.WordArray,i=n.Hasher,o=t.algo,s=[],a=o.SHA1=i.extend({_doReset:function(){this._hash=new r.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],o=n[2],a=n[3],c=n[4],l=0;l<80;l++){if(l<16)s[l]=0|e[t+l];else{var u=s[l-3]^s[l-8]^s[l-14]^s[l-16];s[l]=u<<1|u>>>31}var h=(r<<5|r>>>27)+c+s[l];h+=l<20?1518500249+(i&o|~i&a):l<40?1859775393+(i^o^a):l<60?(i&o|i&a|o&a)-1894007588:(i^o^a)-899497514,c=a,a=o,o=i<<30|i>>>2,i=r,r=h}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+o|0,n[3]=n[3]+a|0,n[4]=n[4]+c|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[14+(r+64>>>9<<4)]=Math.floor(n/4294967296),t[15+(r+64>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}}),t.SHA1=i._createHelper(a),t.HmacSHA1=i._createHmacHelper(a),e.SHA1)),Sv.exports;var e,t,n,r,i,o,s,a}Sv.exports;var Pv,Dv={exports:{}};function kv(){return Pv||(Pv=1,Dv.exports=(e=lv(),function(t){var n=e,r=n.lib,i=r.WordArray,o=r.Hasher,s=n.algo,a=[],c=[];(function(){function e(e){for(var n=t.sqrt(e),r=2;r<=n;r++)if(!(e%r))return!1;return!0}function n(e){return 4294967296*(e-(0|e))|0}for(var r=2,i=0;i<64;)e(r)&&(i<8&&(a[i]=n(t.pow(r,.5))),c[i]=n(t.pow(r,1/3)),i++),r++})();var l=[],u=s.SHA256=o.extend({_doReset:function(){this._hash=new i.init(a.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],o=n[2],s=n[3],a=n[4],u=n[5],h=n[6],d=n[7],f=0;f<64;f++){if(f<16)l[f]=0|e[t+f];else{var p=l[f-15],g=(p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3,m=l[f-2],y=(m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10;l[f]=g+l[f-7]+y+l[f-16]}var v=r&i^r&o^i&o,w=(r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22),b=d+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&u^~a&h)+c[f]+l[f];d=h,h=u,u=a,a=s+b|0,s=o,o=i,i=r,r=b+(w+v)|0}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+o|0,n[3]=n[3]+s|0,n[4]=n[4]+a|0,n[5]=n[5]+u|0,n[6]=n[6]+h|0,n[7]=n[7]+d|0},_doFinalize:function(){var e=this._data,n=e.words,r=8*this._nDataBytes,i=8*e.sigBytes;return n[i>>>5]|=128<<24-i%32,n[14+(i+64>>>9<<4)]=t.floor(r/4294967296),n[15+(i+64>>>9<<4)]=r,e.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});n.SHA256=o._createHelper(u),n.HmacSHA256=o._createHmacHelper(u)}(Math),e.SHA256)),Dv.exports;var e}Dv.exports;var Iv,xv={exports:{}};function Mv(){return Iv||(Iv=1,xv.exports=(e=lv(),kv(),n=(t=e).lib.WordArray,r=t.algo,i=r.SHA256,o=r.SHA224=i.extend({_doReset:function(){this._hash=new n.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=i._doFinalize.call(this);return e.sigBytes-=4,e}}),t.SHA224=i._createHelper(o),t.HmacSHA224=i._createHmacHelper(o),e.SHA224)),xv.exports;var e,t,n,r,i,o}xv.exports;var Kv,Lv={exports:{}};function Uv(){return Kv||(Kv=1,Lv.exports=(e=lv(),dv(),function(){var t=e,n=t.lib.Hasher,r=t.x64,i=r.Word,o=r.WordArray,s=t.algo;function a(){return i.create.apply(i,arguments)}var c=[a(1116352408,3609767458),a(1899447441,602891725),a(3049323471,3964484399),a(3921009573,2173295548),a(961987163,4081628472),a(1508970993,3053834265),a(2453635748,2937671579),a(2870763221,3664609560),a(3624381080,2734883394),a(310598401,1164996542),a(607225278,1323610764),a(1426881987,3590304994),a(1925078388,4068182383),a(2162078206,991336113),a(2614888103,633803317),a(3248222580,3479774868),a(3835390401,2666613458),a(4022224774,944711139),a(264347078,2341262773),a(604807628,2007800933),a(770255983,1495990901),a(1249150122,1856431235),a(1555081692,3175218132),a(1996064986,2198950837),a(2554220882,3999719339),a(2821834349,766784016),a(2952996808,2566594879),a(3210313671,3203337956),a(3336571891,1034457026),a(3584528711,2466948901),a(113926993,3758326383),a(338241895,168717936),a(666307205,1188179964),a(773529912,1546045734),a(1294757372,1522805485),a(1396182291,2643833823),a(1695183700,2343527390),a(1986661051,1014477480),a(2177026350,1206759142),a(2456956037,344077627),a(2730485921,1290863460),a(2820302411,3158454273),a(3259730800,3505952657),a(3345764771,106217008),a(3516065817,3606008344),a(3600352804,1432725776),a(4094571909,1467031594),a(275423344,851169720),a(430227734,3100823752),a(506948616,1363258195),a(659060556,3750685593),a(883997877,3785050280),a(958139571,3318307427),a(1322822218,3812723403),a(1537002063,2003034995),a(1747873779,3602036899),a(1955562222,1575990012),a(2024104815,1125592928),a(2227730452,2716904306),a(2361852424,442776044),a(2428436474,593698344),a(2756734187,3733110249),a(3204031479,2999351573),a(3329325298,3815920427),a(3391569614,3928383900),a(3515267271,566280711),a(3940187606,3454069534),a(4118630271,4000239992),a(116418474,1914138554),a(174292421,2731055270),a(289380356,3203993006),a(460393269,320620315),a(685471733,587496836),a(852142971,1086792851),a(1017036298,365543100),a(1126000580,2618297676),a(1288033470,3409855158),a(1501505948,4234509866),a(1607167915,987167468),a(1816402316,1246189591)],l=[];(function(){for(var e=0;e<80;e++)l[e]=a()})();var u=s.SHA512=n.extend({_doReset:function(){this._hash=new o.init([new i.init(1779033703,4089235720),new i.init(3144134277,2227873595),new i.init(1013904242,4271175723),new i.init(2773480762,1595750129),new i.init(1359893119,2917565137),new i.init(2600822924,725511199),new i.init(528734635,4215389547),new i.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],o=n[2],s=n[3],a=n[4],u=n[5],h=n[6],d=n[7],f=r.high,p=r.low,g=i.high,m=i.low,y=o.high,v=o.low,w=s.high,b=s.low,O=a.high,E=a.low,_=u.high,C=u.low,N=h.high,A=h.low,R=d.high,S=d.low,T=f,P=p,D=g,k=m,I=y,x=v,M=w,K=b,L=O,U=E,B=_,j=C,H=N,W=A,X=R,F=S,J=0;J<80;J++){var G,q,V=l[J];if(J<16)q=V.high=0|e[t+2*J],G=V.low=0|e[t+2*J+1];else{var z=l[J-15],Q=z.high,$=z.low,Y=(Q>>>1|$<<31)^(Q>>>8|$<<24)^Q>>>7,Z=($>>>1|Q<<31)^($>>>8|Q<<24)^($>>>7|Q<<25),ee=l[J-2],te=ee.high,ne=ee.low,re=(te>>>19|ne<<13)^(te<<3|ne>>>29)^te>>>6,ie=(ne>>>19|te<<13)^(ne<<3|te>>>29)^(ne>>>6|te<<26),oe=l[J-7],se=oe.high,ae=oe.low,ce=l[J-16],le=ce.high,ue=ce.low;q=(q=(q=Y+se+((G=Z+ae)>>>0<Z>>>0?1:0))+re+((G+=ie)>>>0<ie>>>0?1:0))+le+((G+=ue)>>>0<ue>>>0?1:0),V.high=q,V.low=G}var he,de=L&B^~L&H,fe=U&j^~U&W,pe=T&D^T&I^D&I,ge=P&k^P&x^k&x,me=(T>>>28|P<<4)^(T<<30|P>>>2)^(T<<25|P>>>7),ye=(P>>>28|T<<4)^(P<<30|T>>>2)^(P<<25|T>>>7),ve=(L>>>14|U<<18)^(L>>>18|U<<14)^(L<<23|U>>>9),we=(U>>>14|L<<18)^(U>>>18|L<<14)^(U<<23|L>>>9),be=c[J],Oe=be.high,Ee=be.low,_e=X+ve+((he=F+we)>>>0<F>>>0?1:0),Ce=ye+ge;X=H,F=W,H=B,W=j,B=L,j=U,L=M+(_e=(_e=(_e=_e+de+((he+=fe)>>>0<fe>>>0?1:0))+Oe+((he+=Ee)>>>0<Ee>>>0?1:0))+q+((he+=G)>>>0<G>>>0?1:0))+((U=K+he|0)>>>0<K>>>0?1:0)|0,M=I,K=x,I=D,x=k,D=T,k=P,T=_e+(me+pe+(Ce>>>0<ye>>>0?1:0))+((P=he+Ce|0)>>>0<he>>>0?1:0)|0}p=r.low=p+P,r.high=f+T+(p>>>0<P>>>0?1:0),m=i.low=m+k,i.high=g+D+(m>>>0<k>>>0?1:0),v=o.low=v+x,o.high=y+I+(v>>>0<x>>>0?1:0),b=s.low=b+K,s.high=w+M+(b>>>0<K>>>0?1:0),E=a.low=E+U,a.high=O+L+(E>>>0<U>>>0?1:0),C=u.low=C+j,u.high=_+B+(C>>>0<j>>>0?1:0),A=h.low=A+W,h.high=N+H+(A>>>0<W>>>0?1:0),S=d.low=S+F,d.high=R+X+(S>>>0<F>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[30+(r+128>>>10<<5)]=Math.floor(n/4294967296),t[31+(r+128>>>10<<5)]=n,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=n.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32});t.SHA512=n._createHelper(u),t.HmacSHA512=n._createHmacHelper(u)}(),e.SHA512)),Lv.exports;var e}Lv.exports;var Bv,jv={exports:{}};function Hv(){return Bv||(Bv=1,jv.exports=(e=lv(),dv(),Uv(),n=(t=e).x64,r=n.Word,i=n.WordArray,o=t.algo,s=o.SHA512,a=o.SHA384=s.extend({_doReset:function(){this._hash=new i.init([new r.init(3418070365,3238371032),new r.init(1654270250,914150663),new r.init(2438529370,812702999),new r.init(355462360,4144912697),new r.init(1731405415,4290775857),new r.init(2394180231,1750603025),new r.init(3675008525,1694076839),new r.init(1203062813,3204075428)])},_doFinalize:function(){var e=s._doFinalize.call(this);return e.sigBytes-=16,e}}),t.SHA384=s._createHelper(a),t.HmacSHA384=s._createHmacHelper(a),e.SHA384)),jv.exports;var e,t,n,r,i,o,s,a}jv.exports;var Wv,Xv={exports:{}};function Fv(){return Wv||(Wv=1,Xv.exports=(e=lv(),dv(),function(t){var n=e,r=n.lib,i=r.WordArray,o=r.Hasher,s=n.x64.Word,a=n.algo,c=[],l=[],u=[];(function(){for(var e=1,t=0,n=0;n<24;n++){c[e+5*t]=(n+1)*(n+2)/2%64;var r=(2*e+3*t)%5;e=t%5,t=r}for(e=0;e<5;e++)for(t=0;t<5;t++)l[e+5*t]=t+(2*e+3*t)%5*5;for(var i=1,o=0;o<24;o++){for(var a=0,h=0,d=0;d<7;d++){if(1&i){var f=(1<<d)-1;f<32?h^=1<<f:a^=1<<f-32}128&i?i=i<<1^113:i<<=1}u[o]=s.create(a,h)}})();var h=[];(function(){for(var e=0;e<25;e++)h[e]=s.create()})();var d=a.SHA3=o.extend({cfg:o.cfg.extend({outputLength:512}),_doReset:function(){for(var e=this._state=[],t=0;t<25;t++)e[t]=new s.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(e,t){for(var n=this._state,r=this.blockSize/2,i=0;i<r;i++){var o=e[t+2*i],s=e[t+2*i+1];o=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),s=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),(S=n[i]).high^=s,S.low^=o}for(var a=0;a<24;a++){for(var d=0;d<5;d++){for(var f=0,p=0,g=0;g<5;g++)f^=(S=n[d+5*g]).high,p^=S.low;var m=h[d];m.high=f,m.low=p}for(d=0;d<5;d++){var y=h[(d+4)%5],v=h[(d+1)%5],w=v.high,b=v.low;for(f=y.high^(w<<1|b>>>31),p=y.low^(b<<1|w>>>31),g=0;g<5;g++)(S=n[d+5*g]).high^=f,S.low^=p}for(var O=1;O<25;O++){var E=(S=n[O]).high,_=S.low,C=c[O];C<32?(f=E<<C|_>>>32-C,p=_<<C|E>>>32-C):(f=_<<C-32|E>>>64-C,p=E<<C-32|_>>>64-C);var N=h[l[O]];N.high=f,N.low=p}var A=h[0],R=n[0];for(A.high=R.high,A.low=R.low,d=0;d<5;d++)for(g=0;g<5;g++){var S=n[O=d+5*g],T=h[O],P=h[(d+1)%5+5*g],D=h[(d+2)%5+5*g];S.high=T.high^~P.high&D.high,S.low=T.low^~P.low&D.low}S=n[0];var k=u[a];S.high^=k.high,S.low^=k.low}},_doFinalize:function(){var e=this._data,n=e.words;this._nDataBytes;var r=8*e.sigBytes,o=32*this.blockSize;n[r>>>5]|=1<<24-r%32,n[(t.ceil((r+1)/o)*o>>>5)-1]|=128,e.sigBytes=4*n.length,this._process();for(var s=this._state,a=this.cfg.outputLength/8,c=a/8,l=[],u=0;u<c;u++){var h=s[u],d=h.high,f=h.low;d=16711935&(d<<8|d>>>24)|4278255360&(d<<24|d>>>8),f=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8),l.push(f),l.push(d)}return new i.init(l,a)},clone:function(){for(var e=o.clone.call(this),t=e._state=this._state.slice(0),n=0;n<25;n++)t[n]=t[n].clone();return e}});n.SHA3=o._createHelper(d),n.HmacSHA3=o._createHmacHelper(d)}(Math),e.SHA3)),Xv.exports;var e}Xv.exports;var Jv,Gv={exports:{}};function qv(){return Jv||(Jv=1,Gv.exports=(e=lv(),function(){var t=e,n=t.lib,r=n.WordArray,i=n.Hasher,o=t.algo,s=r.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),a=r.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),c=r.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),l=r.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),u=r.create([0,1518500249,1859775393,2400959708,2840853838]),h=r.create([1352829926,1548603684,1836072691,2053994217,0]),d=o.RIPEMD160=i.extend({_doReset:function(){this._hash=r.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var r=t+n,i=e[r];e[r]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}var o,d,w,b,O,E,_,C,N,A,R,S=this._hash.words,T=u.words,P=h.words,D=s.words,k=a.words,I=c.words,x=l.words;for(E=o=S[0],_=d=S[1],C=w=S[2],N=b=S[3],A=O=S[4],n=0;n<80;n+=1)R=o+e[t+D[n]]|0,R+=n<16?f(d,w,b)+T[0]:n<32?p(d,w,b)+T[1]:n<48?g(d,w,b)+T[2]:n<64?m(d,w,b)+T[3]:y(d,w,b)+T[4],R=(R=v(R|=0,I[n]))+O|0,o=O,O=b,b=v(w,10),w=d,d=R,R=E+e[t+k[n]]|0,R+=n<16?y(_,C,N)+P[0]:n<32?m(_,C,N)+P[1]:n<48?g(_,C,N)+P[2]:n<64?p(_,C,N)+P[3]:f(_,C,N)+P[4],R=(R=v(R|=0,x[n]))+A|0,E=A,A=N,N=v(C,10),C=_,_=R;R=S[1]+w+N|0,S[1]=S[2]+b+A|0,S[2]=S[3]+O+E|0,S[3]=S[4]+o+_|0,S[4]=S[0]+d+C|0,S[0]=R},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;t[r>>>5]|=128<<24-r%32,t[14+(r+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),e.sigBytes=4*(t.length+1),this._process();for(var i=this._hash,o=i.words,s=0;s<5;s++){var a=o[s];o[s]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}return i},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});function f(e,t,n){return e^t^n}function p(e,t,n){return e&t|~e&n}function g(e,t,n){return(e|~t)^n}function m(e,t,n){return e&n|t&~n}function y(e,t,n){return e^(t|~n)}function v(e,t){return e<<t|e>>>32-t}t.RIPEMD160=i._createHelper(d),t.HmacRIPEMD160=i._createHmacHelper(d)}(),e.RIPEMD160)),Gv.exports;var e}Gv.exports;var Vv,zv={exports:{}};function Qv(){return Vv||(Vv=1,zv.exports=(t=(e=lv()).lib.Base,n=e.enc.Utf8,void(e.algo.HMAC=t.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=n.parse(t));var r=e.blockSize,i=4*r;t.sigBytes>i&&(t=e.finalize(t)),t.clamp();for(var o=this._oKey=t.clone(),s=this._iKey=t.clone(),a=o.words,c=s.words,l=0;l<r;l++)a[l]^=1549556828,c[l]^=909522486;o.sigBytes=s.sigBytes=i,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,n=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(n))}})))),zv.exports;var e,t,n}zv.exports;var $v,Yv={exports:{}};function Zv(){return $v||($v=1,Yv.exports=(e=lv(),kv(),Qv(),r=(n=(t=e).lib).Base,i=n.WordArray,s=(o=t.algo).SHA256,a=o.HMAC,c=o.PBKDF2=r.extend({cfg:r.extend({keySize:4,hasher:s,iterations:25e4}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,r=a.create(n.hasher,e),o=i.create(),s=i.create([1]),c=o.words,l=s.words,u=n.keySize,h=n.iterations;c.length<u;){var d=r.update(t).finalize(s);r.reset();for(var f=d.words,p=f.length,g=d,m=1;m<h;m++){g=r.finalize(g),r.reset();for(var y=g.words,v=0;v<p;v++)f[v]^=y[v]}o.concat(d),l[0]++}return o.sigBytes=4*u,o}}),t.PBKDF2=function(e,t,n){return c.create(n).compute(e,t)},e.PBKDF2)),Yv.exports;var e,t,n,r,i,o,s,a,c}Yv.exports;var ew,tw={exports:{}};function nw(){return ew||(ew=1,tw.exports=(e=lv(),Tv(),Qv(),r=(n=(t=e).lib).Base,i=n.WordArray,s=(o=t.algo).MD5,a=o.EvpKDF=r.extend({cfg:r.extend({keySize:4,hasher:s,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n,r=this.cfg,o=r.hasher.create(),s=i.create(),a=s.words,c=r.keySize,l=r.iterations;a.length<c;){n&&o.update(n),n=o.update(e).finalize(t),o.reset();for(var u=1;u<l;u++)n=o.finalize(n),o.reset();s.concat(n)}return s.sigBytes=4*c,s}}),t.EvpKDF=function(e,t,n){return a.create(n).compute(e,t)},e.EvpKDF)),tw.exports;var e,t,n,r,i,o,s,a}tw.exports;var rw,iw={exports:{}};function ow(){return rw||(rw=1,iw.exports=(e=lv(),nw(),void(e.lib.Cipher||function(t){var n=e,r=n.lib,i=r.Base,o=r.WordArray,s=r.BufferedBlockAlgorithm,a=n.enc;a.Utf8;var c=a.Base64,l=n.algo.EvpKDF,u=r.Cipher=s.extend({cfg:i.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){s.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?w:y}return function(t){return{encrypt:function(n,r,i){return e(r).encrypt(t,n,r,i)},decrypt:function(n,r,i){return e(r).decrypt(t,n,r,i)}}}}()});r.StreamCipher=u.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var h=n.mode={},d=r.BlockCipherMode=i.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),f=h.CBC=function(){var e=d.extend();function n(e,n,r){var i,o=this._iv;o?(i=o,this._iv=t):i=this._prevBlock;for(var s=0;s<r;s++)e[n+s]^=i[s]}return e.Encryptor=e.extend({processBlock:function(e,t){var r=this._cipher,i=r.blockSize;n.call(this,e,t,i),r.encryptBlock(e,t),this._prevBlock=e.slice(t,t+i)}}),e.Decryptor=e.extend({processBlock:function(e,t){var r=this._cipher,i=r.blockSize,o=e.slice(t,t+i);r.decryptBlock(e,t),n.call(this,e,t,i),this._prevBlock=o}}),e}(),p=(n.pad={}).Pkcs7={pad:function(e,t){for(var n=4*t,r=n-e.sigBytes%n,i=r<<24|r<<16|r<<8|r,s=[],a=0;a<r;a+=4)s.push(i);var c=o.create(s,r);e.concat(c)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}};r.BlockCipher=u.extend({cfg:u.cfg.extend({mode:f,padding:p}),reset:function(){var e;u.reset.call(this);var t=this.cfg,n=t.iv,r=t.mode;this._xformMode==this._ENC_XFORM_MODE?e=r.createEncryptor:(e=r.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==e?this._mode.init(this,n&&n.words):(this._mode=e.call(r,this,n&&n.words),this._mode.__creator=e)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e,t=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(t.pad(this._data,this.blockSize),e=this._process(!0)):(e=this._process(!0),t.unpad(e)),e},blockSize:4});var g=r.CipherParams=i.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),m=(n.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext,n=e.salt;return(n?o.create([1398893684,1701076831]).concat(n).concat(t):t).toString(c)},parse:function(e){var t,n=c.parse(e),r=n.words;return 1398893684==r[0]&&1701076831==r[1]&&(t=o.create(r.slice(2,4)),r.splice(0,4),n.sigBytes-=16),g.create({ciphertext:n,salt:t})}},y=r.SerializableCipher=i.extend({cfg:i.extend({format:m}),encrypt:function(e,t,n,r){r=this.cfg.extend(r);var i=e.createEncryptor(n,r),o=i.finalize(t),s=i.cfg;return g.create({ciphertext:o,key:n,iv:s.iv,algorithm:e,mode:s.mode,padding:s.padding,blockSize:e.blockSize,formatter:r.format})},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),e.createDecryptor(n,r).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),v=(n.kdf={}).OpenSSL={execute:function(e,t,n,r,i){if(r||(r=o.random(8)),i)var s=l.create({keySize:t+n,hasher:i}).compute(e,r);else s=l.create({keySize:t+n}).compute(e,r);var a=o.create(s.words.slice(t),4*n);return s.sigBytes=4*t,g.create({key:s,iv:a,salt:r})}},w=r.PasswordBasedCipher=y.extend({cfg:y.cfg.extend({kdf:v}),encrypt:function(e,t,n,r){var i=(r=this.cfg.extend(r)).kdf.execute(n,e.keySize,e.ivSize,r.salt,r.hasher);r.iv=i.iv;var o=y.encrypt.call(this,e,t,i.key,r);return o.mixIn(i),o},decrypt:function(e,t,n,r){r=this.cfg.extend(r),t=this._parse(t,r.format);var i=r.kdf.execute(n,e.keySize,e.ivSize,t.salt,r.hasher);return r.iv=i.iv,y.decrypt.call(this,e,t,i.key,r)}})}()))),iw.exports;var e}iw.exports;var sw,aw={exports:{}};function cw(){return sw||(sw=1,aw.exports=(e=lv(),ow(),e.mode.CFB=function(){var t=e.lib.BlockCipherMode.extend();function n(e,t,n,r){var i,o=this._iv;o?(i=o.slice(0),this._iv=void 0):i=this._prevBlock,r.encryptBlock(i,0);for(var s=0;s<n;s++)e[t+s]^=i[s]}return t.Encryptor=t.extend({processBlock:function(e,t){var r=this._cipher,i=r.blockSize;n.call(this,e,t,i,r),this._prevBlock=e.slice(t,t+i)}}),t.Decryptor=t.extend({processBlock:function(e,t){var r=this._cipher,i=r.blockSize,o=e.slice(t,t+i);n.call(this,e,t,i,r),this._prevBlock=o}}),t}(),e.mode.CFB)),aw.exports;var e}aw.exports;var lw,uw={exports:{}};function hw(){return lw||(lw=1,uw.exports=(e=lv(),ow(),e.mode.CTR=(n=(t=e.lib.BlockCipherMode.extend()).Encryptor=t.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,i=this._iv,o=this._counter;i&&(o=this._counter=i.slice(0),this._iv=void 0);var s=o.slice(0);n.encryptBlock(s,0),o[r-1]=o[r-1]+1|0;for(var a=0;a<r;a++)e[t+a]^=s[a]}}),t.Decryptor=n,t),e.mode.CTR)),uw.exports;var e,t,n}uw.exports;var dw,fw={exports:{}};function pw(){return dw||(dw=1,fw.exports=(e=lv(),ow(),e.mode.CTRGladman=function(){var t=e.lib.BlockCipherMode.extend();function n(e){if(255==(e>>24&255)){var t=e>>16&255,n=e>>8&255,r=255&e;255===t?(t=0,255===n?(n=0,255===r?r=0:++r):++n):++t,e=0,e+=t<<16,e+=n<<8,e+=r}else e+=1<<24;return e}function r(e){return 0===(e[0]=n(e[0]))&&(e[1]=n(e[1])),e}var i=t.Encryptor=t.extend({processBlock:function(e,t){var n=this._cipher,i=n.blockSize,o=this._iv,s=this._counter;o&&(s=this._counter=o.slice(0),this._iv=void 0),r(s);var a=s.slice(0);n.encryptBlock(a,0);for(var c=0;c<i;c++)e[t+c]^=a[c]}});return t.Decryptor=i,t}(),e.mode.CTRGladman)),fw.exports;var e}fw.exports;var gw,mw={exports:{}};function yw(){return gw||(gw=1,mw.exports=(e=lv(),ow(),e.mode.OFB=(n=(t=e.lib.BlockCipherMode.extend()).Encryptor=t.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,i=this._iv,o=this._keystream;i&&(o=this._keystream=i.slice(0),this._iv=void 0),n.encryptBlock(o,0);for(var s=0;s<r;s++)e[t+s]^=o[s]}}),t.Decryptor=n,t),e.mode.OFB)),mw.exports;var e,t,n}mw.exports;var vw,ww={exports:{}};function bw(){return vw||(vw=1,ww.exports=(e=lv(),ow(),e.mode.ECB=((t=e.lib.BlockCipherMode.extend()).Encryptor=t.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),t.Decryptor=t.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),t),e.mode.ECB)),ww.exports;var e,t}ww.exports;var Ow,Ew={exports:{}};function _w(){return Ow||(Ow=1,Ew.exports=(e=lv(),ow(),e.pad.AnsiX923={pad:function(e,t){var n=e.sigBytes,r=4*t,i=r-n%r,o=n+i-1;e.clamp(),e.words[o>>>2]|=i<<24-o%4*8,e.sigBytes+=i},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},e.pad.Ansix923)),Ew.exports;var e}Ew.exports;var Cw,Nw={exports:{}};function Aw(){return Cw||(Cw=1,Nw.exports=(e=lv(),ow(),e.pad.Iso10126={pad:function(t,n){var r=4*n,i=r-t.sigBytes%r;t.concat(e.lib.WordArray.random(i-1)).concat(e.lib.WordArray.create([i<<24],1))},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},e.pad.Iso10126)),Nw.exports;var e}Nw.exports;var Rw,Sw={exports:{}};function Tw(){return Rw||(Rw=1,Sw.exports=(e=lv(),ow(),e.pad.Iso97971={pad:function(t,n){t.concat(e.lib.WordArray.create([2147483648],1)),e.pad.ZeroPadding.pad(t,n)},unpad:function(t){e.pad.ZeroPadding.unpad(t),t.sigBytes--}},e.pad.Iso97971)),Sw.exports;var e}Sw.exports;var Pw,Dw={exports:{}};function kw(){return Pw||(Pw=1,Dw.exports=(e=lv(),ow(),e.pad.ZeroPadding={pad:function(e,t){var n=4*t;e.clamp(),e.sigBytes+=n-(e.sigBytes%n||n)},unpad:function(e){var t=e.words,n=e.sigBytes-1;for(n=e.sigBytes-1;n>=0;n--)if(t[n>>>2]>>>24-n%4*8&255){e.sigBytes=n+1;break}}},e.pad.ZeroPadding)),Dw.exports;var e}Dw.exports;var Iw,xw={exports:{}};function Mw(){return Iw||(Iw=1,xw.exports=(e=lv(),ow(),e.pad.NoPadding={pad:function(){},unpad:function(){}},e.pad.NoPadding)),xw.exports;var e}xw.exports;var Kw,Lw={exports:{}};function Uw(){return Kw||(Kw=1,Lw.exports=(e=lv(),ow(),n=(t=e).lib.CipherParams,r=t.enc.Hex,t.format.Hex={stringify:function(e){return e.ciphertext.toString(r)},parse:function(e){var t=r.parse(e);return n.create({ciphertext:t})}},e.format.Hex)),Lw.exports;var e,t,n,r}Lw.exports;var Bw,jw={exports:{}};function Hw(){return Bw||(Bw=1,jw.exports=(e=lv(),Ov(),Av(),nw(),ow(),function(){var t=e,n=t.lib.BlockCipher,r=t.algo,i=[],o=[],s=[],a=[],c=[],l=[],u=[],h=[],d=[],f=[];(function(){for(var e=[],t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;var n=0,r=0;for(t=0;t<256;t++){var p=r^r<<1^r<<2^r<<3^r<<4;p=p>>>8^255&p^99,i[n]=p,o[p]=n;var g=e[n],m=e[g],y=e[m],v=257*e[p]^16843008*p;s[n]=v<<24|v>>>8,a[n]=v<<16|v>>>16,c[n]=v<<8|v>>>24,l[n]=v,v=16843009*y^65537*m^257*g^16843008*n,u[p]=v<<24|v>>>8,h[p]=v<<16|v>>>16,d[p]=v<<8|v>>>24,f[p]=v,n?(n=g^e[e[e[y^g]]],r^=e[e[r]]):n=r=1}})();var p=[0,1,2,4,8,16,32,64,128,27,54],g=r.AES=n.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,n=e.sigBytes/4,r=4*((this._nRounds=n+6)+1),o=this._keySchedule=[],s=0;s<r;s++)s<n?o[s]=t[s]:(l=o[s-1],s%n?n>6&&s%n==4&&(l=i[l>>>24]<<24|i[l>>>16&255]<<16|i[l>>>8&255]<<8|i[255&l]):(l=i[(l=l<<8|l>>>24)>>>24]<<24|i[l>>>16&255]<<16|i[l>>>8&255]<<8|i[255&l],l^=p[s/n|0]<<24),o[s]=o[s-n]^l);for(var a=this._invKeySchedule=[],c=0;c<r;c++){if(s=r-c,c%4)var l=o[s];else l=o[s-4];a[c]=c<4||s<=4?l:u[i[l>>>24]]^h[i[l>>>16&255]]^d[i[l>>>8&255]]^f[i[255&l]]}}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,s,a,c,l,i)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,u,h,d,f,o),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,r,i,o,s,a){for(var c=this._nRounds,l=e[t]^n[0],u=e[t+1]^n[1],h=e[t+2]^n[2],d=e[t+3]^n[3],f=4,p=1;p<c;p++){var g=r[l>>>24]^i[u>>>16&255]^o[h>>>8&255]^s[255&d]^n[f++],m=r[u>>>24]^i[h>>>16&255]^o[d>>>8&255]^s[255&l]^n[f++],y=r[h>>>24]^i[d>>>16&255]^o[l>>>8&255]^s[255&u]^n[f++],v=r[d>>>24]^i[l>>>16&255]^o[u>>>8&255]^s[255&h]^n[f++];l=g,u=m,h=y,d=v}g=(a[l>>>24]<<24|a[u>>>16&255]<<16|a[h>>>8&255]<<8|a[255&d])^n[f++],m=(a[u>>>24]<<24|a[h>>>16&255]<<16|a[d>>>8&255]<<8|a[255&l])^n[f++],y=(a[h>>>24]<<24|a[d>>>16&255]<<16|a[l>>>8&255]<<8|a[255&u])^n[f++],v=(a[d>>>24]<<24|a[l>>>16&255]<<16|a[u>>>8&255]<<8|a[255&h])^n[f++],e[t]=g,e[t+1]=m,e[t+2]=y,e[t+3]=v},keySize:8});t.AES=n._createHelper(g)}(),e.AES)),jw.exports;var e}jw.exports;var Ww,Xw={exports:{}};function Fw(){return Ww||(Ww=1,Xw.exports=(e=lv(),Ov(),Av(),nw(),ow(),function(){var t=e,n=t.lib,r=n.WordArray,i=n.BlockCipher,o=t.algo,s=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],a=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],c=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],l=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],u=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],h=o.DES=i.extend({_doReset:function(){for(var e=this._key.words,t=[],n=0;n<56;n++){var r=s[n]-1;t[n]=e[r>>>5]>>>31-r%32&1}for(var i=this._subKeys=[],o=0;o<16;o++){var l=i[o]=[],u=c[o];for(n=0;n<24;n++)l[n/6|0]|=t[(a[n]-1+u)%28]<<31-n%6,l[4+(n/6|0)]|=t[28+(a[n+24]-1+u)%28]<<31-n%6;for(l[0]=l[0]<<1|l[0]>>>31,n=1;n<7;n++)l[n]=l[n]>>>4*(n-1)+3;l[7]=l[7]<<5|l[7]>>>27}var h=this._invSubKeys=[];for(n=0;n<16;n++)h[n]=i[15-n]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._subKeys)},decryptBlock:function(e,t){this._doCryptBlock(e,t,this._invSubKeys)},_doCryptBlock:function(e,t,n){this._lBlock=e[t],this._rBlock=e[t+1],d.call(this,4,252645135),d.call(this,16,65535),f.call(this,2,858993459),f.call(this,8,16711935),d.call(this,1,1431655765);for(var r=0;r<16;r++){for(var i=n[r],o=this._lBlock,s=this._rBlock,a=0,c=0;c<8;c++)a|=l[c][((s^i[c])&u[c])>>>0];this._lBlock=s,this._rBlock=o^a}var h=this._lBlock;this._lBlock=this._rBlock,this._rBlock=h,d.call(this,1,1431655765),f.call(this,8,16711935),f.call(this,2,858993459),d.call(this,16,65535),d.call(this,4,252645135),e[t]=this._lBlock,e[t+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function d(e,t){var n=(this._lBlock>>>e^this._rBlock)&t;this._rBlock^=n,this._lBlock^=n<<e}function f(e,t){var n=(this._rBlock>>>e^this._lBlock)&t;this._lBlock^=n,this._rBlock^=n<<e}t.DES=i._createHelper(h);var p=o.TripleDES=i.extend({_doReset:function(){var e=this._key.words;if(2!==e.length&&4!==e.length&&e.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var t=e.slice(0,2),n=e.length<4?e.slice(0,2):e.slice(2,4),i=e.length<6?e.slice(0,2):e.slice(4,6);this._des1=h.createEncryptor(r.create(t)),this._des2=h.createEncryptor(r.create(n)),this._des3=h.createEncryptor(r.create(i))},encryptBlock:function(e,t){this._des1.encryptBlock(e,t),this._des2.decryptBlock(e,t),this._des3.encryptBlock(e,t)},decryptBlock:function(e,t){this._des3.decryptBlock(e,t),this._des2.encryptBlock(e,t),this._des1.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2});t.TripleDES=i._createHelper(p)}(),e.TripleDES)),Xw.exports;var e}Xw.exports;var Jw,Gw={exports:{}};function qw(){return Jw||(Jw=1,Gw.exports=(e=lv(),Ov(),Av(),nw(),ow(),function(){var t=e,n=t.lib.StreamCipher,r=t.algo,i=r.RC4=n.extend({_doReset:function(){for(var e=this._key,t=e.words,n=e.sigBytes,r=this._S=[],i=0;i<256;i++)r[i]=i;i=0;for(var o=0;i<256;i++){var s=i%n,a=t[s>>>2]>>>24-s%4*8&255;o=(o+r[i]+a)%256;var c=r[i];r[i]=r[o],r[o]=c}this._i=this._j=0},_doProcessBlock:function(e,t){e[t]^=o.call(this)},keySize:8,ivSize:0});function o(){for(var e=this._S,t=this._i,n=this._j,r=0,i=0;i<4;i++){n=(n+e[t=(t+1)%256])%256;var o=e[t];e[t]=e[n],e[n]=o,r|=e[(e[t]+e[n])%256]<<24-8*i}return this._i=t,this._j=n,r}t.RC4=n._createHelper(i);var s=r.RC4Drop=i.extend({cfg:i.cfg.extend({drop:192}),_doReset:function(){i._doReset.call(this);for(var e=this.cfg.drop;e>0;e--)o.call(this)}});t.RC4Drop=n._createHelper(s)}(),e.RC4)),Gw.exports;var e}Gw.exports;var Vw,zw={exports:{}};function Qw(){return Vw||(Vw=1,zw.exports=(e=lv(),Ov(),Av(),nw(),ow(),function(){var t=e,n=t.lib.StreamCipher,r=t.algo,i=[],o=[],s=[],a=r.Rabbit=n.extend({_doReset:function(){for(var e=this._key.words,t=this.cfg.iv,n=0;n<4;n++)e[n]=16711935&(e[n]<<8|e[n]>>>24)|4278255360&(e[n]<<24|e[n]>>>8);var r=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],i=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];for(this._b=0,n=0;n<4;n++)c.call(this);for(n=0;n<8;n++)i[n]^=r[n+4&7];if(t){var o=t.words,s=o[0],a=o[1],l=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),u=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),h=l>>>16|4294901760&u,d=u<<16|65535&l;for(i[0]^=l,i[1]^=h,i[2]^=u,i[3]^=d,i[4]^=l,i[5]^=h,i[6]^=u,i[7]^=d,n=0;n<4;n++)c.call(this)}},_doProcessBlock:function(e,t){var n=this._X;c.call(this),i[0]=n[0]^n[5]>>>16^n[3]<<16,i[1]=n[2]^n[7]>>>16^n[5]<<16,i[2]=n[4]^n[1]>>>16^n[7]<<16,i[3]=n[6]^n[3]>>>16^n[1]<<16;for(var r=0;r<4;r++)i[r]=16711935&(i[r]<<8|i[r]>>>24)|4278255360&(i[r]<<24|i[r]>>>8),e[t+r]^=i[r]},blockSize:4,ivSize:2});function c(){for(var e=this._X,t=this._C,n=0;n<8;n++)o[n]=t[n];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<o[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<o[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<o[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<o[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<o[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<o[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<o[6]>>>0?1:0)|0,this._b=t[7]>>>0<o[7]>>>0?1:0,n=0;n<8;n++){var r=e[n]+t[n],i=65535&r,a=r>>>16,c=((i*i>>>17)+i*a>>>15)+a*a,l=((4294901760&r)*r|0)+((65535&r)*r|0);s[n]=c^l}e[0]=s[0]+(s[7]<<16|s[7]>>>16)+(s[6]<<16|s[6]>>>16)|0,e[1]=s[1]+(s[0]<<8|s[0]>>>24)+s[7]|0,e[2]=s[2]+(s[1]<<16|s[1]>>>16)+(s[0]<<16|s[0]>>>16)|0,e[3]=s[3]+(s[2]<<8|s[2]>>>24)+s[1]|0,e[4]=s[4]+(s[3]<<16|s[3]>>>16)+(s[2]<<16|s[2]>>>16)|0,e[5]=s[5]+(s[4]<<8|s[4]>>>24)+s[3]|0,e[6]=s[6]+(s[5]<<16|s[5]>>>16)+(s[4]<<16|s[4]>>>16)|0,e[7]=s[7]+(s[6]<<8|s[6]>>>24)+s[5]|0}t.Rabbit=n._createHelper(a)}(),e.Rabbit)),zw.exports;var e}zw.exports;var $w,Yw={exports:{}};function Zw(){return $w||($w=1,Yw.exports=(e=lv(),Ov(),Av(),nw(),ow(),function(){var t=e,n=t.lib.StreamCipher,r=t.algo,i=[],o=[],s=[],a=r.RabbitLegacy=n.extend({_doReset:function(){var e=this._key.words,t=this.cfg.iv,n=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],r=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];this._b=0;for(var i=0;i<4;i++)c.call(this);for(i=0;i<8;i++)r[i]^=n[i+4&7];if(t){var o=t.words,s=o[0],a=o[1],l=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),u=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),h=l>>>16|4294901760&u,d=u<<16|65535&l;for(r[0]^=l,r[1]^=h,r[2]^=u,r[3]^=d,r[4]^=l,r[5]^=h,r[6]^=u,r[7]^=d,i=0;i<4;i++)c.call(this)}},_doProcessBlock:function(e,t){var n=this._X;c.call(this),i[0]=n[0]^n[5]>>>16^n[3]<<16,i[1]=n[2]^n[7]>>>16^n[5]<<16,i[2]=n[4]^n[1]>>>16^n[7]<<16,i[3]=n[6]^n[3]>>>16^n[1]<<16;for(var r=0;r<4;r++)i[r]=16711935&(i[r]<<8|i[r]>>>24)|4278255360&(i[r]<<24|i[r]>>>8),e[t+r]^=i[r]},blockSize:4,ivSize:2});function c(){for(var e=this._X,t=this._C,n=0;n<8;n++)o[n]=t[n];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<o[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<o[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<o[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<o[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<o[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<o[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<o[6]>>>0?1:0)|0,this._b=t[7]>>>0<o[7]>>>0?1:0,n=0;n<8;n++){var r=e[n]+t[n],i=65535&r,a=r>>>16,c=((i*i>>>17)+i*a>>>15)+a*a,l=((4294901760&r)*r|0)+((65535&r)*r|0);s[n]=c^l}e[0]=s[0]+(s[7]<<16|s[7]>>>16)+(s[6]<<16|s[6]>>>16)|0,e[1]=s[1]+(s[0]<<8|s[0]>>>24)+s[7]|0,e[2]=s[2]+(s[1]<<16|s[1]>>>16)+(s[0]<<16|s[0]>>>16)|0,e[3]=s[3]+(s[2]<<8|s[2]>>>24)+s[1]|0,e[4]=s[4]+(s[3]<<16|s[3]>>>16)+(s[2]<<16|s[2]>>>16)|0,e[5]=s[5]+(s[4]<<8|s[4]>>>24)+s[3]|0,e[6]=s[6]+(s[5]<<16|s[5]>>>16)+(s[4]<<16|s[4]>>>16)|0,e[7]=s[7]+(s[6]<<8|s[6]>>>24)+s[5]|0}t.RabbitLegacy=n._createHelper(a)}(),e.RabbitLegacy)),Yw.exports;var e}Yw.exports;var eb,tb,nb,rb,ib,ob={exports:{}};function sb(){return eb||(eb=1,ob.exports=(e=lv(),Ov(),Av(),nw(),ow(),function(){var t=e,n=t.lib.BlockCipher,r=t.algo;const i=16,o=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],s=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var a={pbox:[],sbox:[]};function c(e,t){let n=t>>24&255,r=t>>16&255,i=t>>8&255,o=255&t,s=e.sbox[0][n]+e.sbox[1][r];return(s^=e.sbox[2][i])+e.sbox[3][o]}function l(e,t,n){let r,o=t,s=n;for(let a=0;a<i;++a)r=o^=e.pbox[a],o=s=c(e,o)^s,s=r;return r=o,o=s,s=r,s^=e.pbox[i],{left:o^=e.pbox[i+1],right:s}}function u(e,t,n){let r,o=t,s=n;for(let a=i+1;a>1;--a)r=o^=e.pbox[a],o=s=c(e,o)^s,s=r;return r=o,o=s,s=r,s^=e.pbox[1],{left:o^=e.pbox[0],right:s}}function h(e,t,n){for(let i=0;i<4;i++){e.sbox[i]=[];for(let t=0;t<256;t++)e.sbox[i][t]=s[i][t]}let r=0;for(let s=0;s<i+2;s++)e.pbox[s]=o[s]^t[r],++r>=n&&(r=0);let a=0,c=0,u=0;for(let o=0;o<i+2;o+=2)a=(u=l(e,a,c)).left,c=u.right,e.pbox[o]=a,e.pbox[o+1]=c;for(let i=0;i<4;i++)for(let t=0;t<256;t+=2)a=(u=l(e,a,c)).left,c=u.right,e.sbox[i][t]=a,e.sbox[i][t+1]=c;return!0}var d=r.Blowfish=n.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var e=this._keyPriorReset=this._key,t=e.words,n=e.sigBytes/4;h(a,t,n)}},encryptBlock:function(e,t){var n=l(a,e[t],e[t+1]);e[t]=n.left,e[t+1]=n.right},decryptBlock:function(e,t){var n=u(a,e[t],e[t+1]);e[t]=n.left,e[t+1]=n.right},blockSize:2,keySize:4,ivSize:2});t.Blowfish=n._createHelper(d)}(),e.Blowfish)),ob.exports;var e}function ab(){return tb||(tb=1,av.exports=function(e){return e}(lv(),dv(),gv(),vv(),Ov(),(Ev||(Ev=1,_v.exports=(e=lv(),function(){var t=e,n=t.lib.WordArray;function r(e,t,r){for(var i=[],o=0,s=0;s<t;s++)if(s%4){var a=r[e.charCodeAt(s-1)]<<s%4*2|r[e.charCodeAt(s)]>>>6-s%4*2;i[o>>>2]|=a<<24-o%4*8,o++}return n.create(i,o)}t.enc.Base64url={stringify:function(e,t){void 0===t&&(t=!0);var n=e.words,r=e.sigBytes,i=t?this._safe_map:this._map;e.clamp();for(var o=[],s=0;s<r;s+=3)for(var a=(n[s>>>2]>>>24-s%4*8&255)<<16|(n[s+1>>>2]>>>24-(s+1)%4*8&255)<<8|n[s+2>>>2]>>>24-(s+2)%4*8&255,c=0;c<4&&s+.75*c<r;c++)o.push(i.charAt(a>>>6*(3-c)&63));var l=i.charAt(64);if(l)for(;o.length%4;)o.push(l);return o.join("")},parse:function(e,t){void 0===t&&(t=!0);var n=e.length,i=t?this._safe_map:this._map,o=this._reverseMap;if(!o){o=this._reverseMap=[];for(var s=0;s<i.length;s++)o[i.charCodeAt(s)]=s}var a=i.charAt(64);if(a){var c=e.indexOf(a);-1!==c&&(n=c)}return r(e,n,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"}}(),e.enc.Base64url)),_v.exports),Av(),Tv(),kv(),Mv(),Uv(),Hv(),Fv(),qv(),Qv(),Zv(),nw(),ow(),cw(),hw(),pw(),yw(),bw(),_w(),Aw(),Tw(),kw(),Mw(),Uw(),Hw(),Fw(),qw(),Qw(),Zw(),sb())),av.exports;var e}function cb(){return nb||(nb=1,function(e){var t=hp&&hp.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0}),e.chainName2IdMap=e.isValidObject=e.RANDOM_LENGTH=e.isBrowser=e.resolveLocalStorage=e.hasLocalStorage=e.hasBuiltInWebSocket=e.resolveWebSocketImplementation=void 0,e.hexToByteArray=function(e){if(e.length%2!=0)throw new Error(`Cannot convert ${e} to bytesArray`);const t=new Uint8Array(e.length/2);for(let n=0;n<e.length;n+=2)t[n/2]=parseInt(e.slice(n,n+2),16);return t},e.getChainId=function(e){return e.includes(":")?e.split(":")[1]:e},e.toHexString=function(e){let t="";return e.forEach(e=>{t+=("0"+(255&e).toString(16)).slice(-2)}),t},e.concatUint8Arrays=function(e,t){const n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n},e.splitToUint8Arrays=function(e,t){if(t>=e.length)throw new Error("Index is out of buffer");return[e.slice(0,t),e.slice(t)]},e.base64encode=function(e,t){let n;return e instanceof Uint8Array?n=e:("string"!=typeof e&&(e=(0,s.safeJsonStringify)(e)),n=r.default.decodeUTF8(e)),d(n,t)},e.base64decode=function(e,t){const n=f(e,t);return{toString:()=>r.default.encodeUTF8(n),toObject(){try{return(0,s.safeJsonParse)(r.default.encodeUTF8(n))}catch{return null}},toUint8Array:()=>n}},e.checkWSUrl=function(e){const t=e.match(new RegExp(/^\w+:/,"gi"));if(!t||!t.length)return!1;let n=t[0];return void 0!==n&&new RegExp("^wss?:").test(n)},e.hashKey=p,e.generateRandomBytes32=g,e.generateTopic=function(){let e=g();return(0,a.logDebug)(`generate topic called ${e}`),p((0,i.toString)(e,h))},e.generateGroupId=function(){let e=n.default.randomBytes(16);return(0,a.logDebug)(`generate groupid called ${e}`),p((0,i.toString)(e,h))},e.isInIOSLine=function(){return navigator.userAgent.includes("Safari Line/")&&m()},e.isInIOSLark=function(){return navigator.userAgent.includes("Lark/")&&m()},e.isInIOSChrome=function(){return navigator.userAgent.includes("CriOS/")&&m()},e.isInIOSWeChat=function(){return navigator.userAgent.includes("MicroMessenger/")&&m()},e.isIos=m,e.getLastSixMd5Hash=function(e){return l.default.MD5(e).toString().slice(-6)},e.toSafeBase64FromBase64=function(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},e.useShortLink=function(){return!0},e.replaceChainNameToChainId=function(t){return e.chainName2IdMap.forEach((e,n)=>{t.includes(n)&&(t=t.replace(n,e))}),t},e.replaceChainIdToChainName=function(t){return e.chainName2IdMap.forEach((e,n)=>{t.includes(e)&&(t=t.replace(e,n))}),t},e.getNamespaceKeyByChain=function(e){for(const[t,n]of Object.entries(u.NAMES_CHAINS))if(Object.values(n).includes(e))return t;return e},e.scopePollingDetectionStrategy=function(e){if("undefined"==typeof window||"undefined"==typeof document)return;const t=[];function n(){if(e())for(const e of t)e()}const r=setInterval(n,1e3);t.push(()=>clearInterval(r)),"loading"===document.readyState&&(document.addEventListener("DOMContentLoaded",n,{once:!0}),t.push(()=>document.removeEventListener("DOMContentLoaded",n))),"complete"!==document.readyState&&(window.addEventListener("load",n,{once:!0}),t.push(()=>window.removeEventListener("load",n))),n()};const n=t(lp()),r=t(pp()),i=Om,o=(Pm||(Pm=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=Sm(),n=km();e.DIGEST_LENGTH=32,e.BLOCK_SIZE=64;var r=function(){function r(){this.digestLength=e.DIGEST_LENGTH,this.blockSize=e.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return r.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},r.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},r.prototype.clean=function(){n.wipe(this._buffer),n.wipe(this._temp),this.reset()},r.prototype.update=function(e,t){if(void 0===t&&(t=e.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var n=0;if(this._bytesHashed+=t,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&t>0;)this._buffer[this._bufferLength++]=e[n++],t--;this._bufferLength===this.blockSize&&(o(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(t>=this.blockSize&&(n=o(this._temp,this._state,e,n,t),t%=this.blockSize);t>0;)this._buffer[this._bufferLength++]=e[n++],t--;return this},r.prototype.finish=function(e){if(!this._finished){var n=this._bytesHashed,r=this._bufferLength,i=n/536870912|0,s=n<<3,a=n%64<56?64:128;this._buffer[r]=128;for(var c=r+1;c<a-8;c++)this._buffer[c]=0;t.writeUint32BE(i,this._buffer,a-8),t.writeUint32BE(s,this._buffer,a-4),o(this._temp,this._state,this._buffer,0,a),this._finished=!0}for(c=0;c<this.digestLength/4;c++)t.writeUint32BE(this._state[c],e,4*c);return this},r.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},r.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},r.prototype.restoreState=function(e){return this._state.set(e.state),this._bufferLength=e.bufferLength,e.buffer&&this._buffer.set(e.buffer),this._bytesHashed=e.bytesHashed,this._finished=!1,this},r.prototype.cleanSavedState=function(e){n.wipe(e.state),e.buffer&&n.wipe(e.buffer),e.bufferLength=0,e.bytesHashed=0},r}();e.SHA256=r;var i=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function o(e,n,r,o,s){for(;s>=64;){for(var a=n[0],c=n[1],l=n[2],u=n[3],h=n[4],d=n[5],f=n[6],p=n[7],g=0;g<16;g++){var m=o+4*g;e[g]=t.readUint32BE(r,m)}for(g=16;g<64;g++){var y=e[g-2],v=(y>>>17|y<<15)^(y>>>19|y<<13)^y>>>10,w=((y=e[g-15])>>>7|y<<25)^(y>>>18|y<<14)^y>>>3;e[g]=(v+e[g-7]|0)+(w+e[g-16]|0)}for(g=0;g<64;g++)v=(((h>>>6|h<<26)^(h>>>11|h<<21)^(h>>>25|h<<7))+(h&d^~h&f)|0)+(p+(i[g]+e[g]|0)|0)|0,w=((a>>>2|a<<30)^(a>>>13|a<<19)^(a>>>22|a<<10))+(a&c^a&l^c&l)|0,p=f,f=d,d=h,h=u+v|0,u=l,l=c,c=a,a=v+w|0;n[0]+=a,n[1]+=c,n[2]+=l,n[3]+=u,n[4]+=h,n[5]+=d,n[6]+=f,n[7]+=p,o+=64,s-=64}return o}e.hash=function(e){var t=new r;t.update(e);var n=t.digest();return t.clean(),n}}(Cm)),Cm),s=tv(),a=ev(),c=ov(),l=t(ab()),u=Ey(),h="base16";function d(e,t){const n=r.default.encodeBase64(e);return t?encodeURIComponent(n):n}function f(e,t){return t&&(e=decodeURIComponent(e)),r.default.decodeBase64(e)}function p(e,t=h){(0,a.logDebug)(`hash key called ${e}`);const n=(0,o.hash)((0,c.okxfromString)(e,t));return(0,i.toString)(n,t)}function g(){return n.default.randomBytes(e.RANDOM_LENGTH)}function m(){const e=navigator.userAgent,t=navigator.maxTouchPoints||0,n=/iPad|iPhone|iPod/.test(e)&&!window.MSStream,r=e.includes("Mac")&&t>1;return(0,a.logDebug)(`utils isIos >>>isIOSDevice: ${n}    >> isIPadOS: ${r}`),n||r}e.resolveWebSocketImplementation=()=>"undefined"!=typeof WebSocket?WebSocket:void 0!==Kf&&void 0!==Kf.WebSocket?Kf.WebSocket:"undefined"!=typeof window&&void 0!==window.WebSocket?window.WebSocket:"undefined"!=typeof self&&void 0!==self.WebSocket?self.WebSocket:WebSocket,e.hasBuiltInWebSocket=()=>"undefined"!=typeof WebSocket||void 0!==Kf&&void 0!==Kf.WebSocket||"undefined"!=typeof window&&void 0!==window.WebSocket||"undefined"!=typeof self&&void 0!==self.WebSocket,e.hasLocalStorage=()=>void 0!==Kf&&void 0!==Kf.localStorage||"undefined"!=typeof window&&void 0!==window.localStorage,e.resolveLocalStorage=()=>void 0!==Kf&&void 0!==Kf.localStorage?Kf.localStorage:"undefined"!=typeof window&&void 0!==window.localStorage?window.localStorage:localStorage,e.isBrowser=()=>"undefined"!=typeof window,e.RANDOM_LENGTH=32,e.isValidObject=e=>Object.getPrototypeOf(e)===Object.prototype&&Object.keys(e).length,e.chainName2IdMap=new Map,e.chainName2IdMap.set("aptos:mainnet","aptos:637"),e.chainName2IdMap.set("movement:testnet","aptos:70000060"),e.chainName2IdMap.set("movement:mainnet","aptos:70000066"),e.chainName2IdMap.set("soon:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","svm:70000069"),e.chainName2IdMap.set("soon:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","svm:70000067"),e.chainName2IdMap.set("eclipse:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","svm:70000068"),e.chainName2IdMap.set("sonic:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","svm:70000073")}(hp)),hp}function lb(){if(rb)return ip;rb=1;var e,t=ip&&ip.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=ip&&ip.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=ip&&ip.__importStar||(e=function(t){return(e=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t})(t)},function(r){if(r&&r.__esModule)return r;var i={};if(null!=r)for(var o=e(r),s=0;s<o.length;s++)"default"!==o[s]&&t(i,r,o[s]);return n(i,r),i}),i=ip&&ip.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ip,"__esModule",{value:!0}),ip.Storage=void 0;const o=rp(),s=i(lp()),a=cb(),c=Jy(),l=r(ev()),u=Jy(),h=ab();class d{constructor(e,t){const n=(0,a.resolveLocalStorage)();this.storeKey="",this.cipherIV="",this.subKey=e,l.logDebug("--------get current local storage --------"),l.logDebug(n),this.synchronizedCache()}checkAndUpgradeCache(e,t){if(e&&e.length>0&&t&&t.length>0){l.logDebug("--------get current local storage --------"),l.logDebug(localStorage);const n=localStorage.getItem(d.cacheKey+e);if(null==n)return void l.logDebug("no pre cache content");l.logDebug(n),(null==n?void 0:n.length)>0&&(l.logDebug("write in cache content: ",e,"->",t),localStorage.setItem(d.cacheKey+t,n),l.logDebug("clean in cache content: ",e),localStorage.removeItem(d.cacheKey+e))}else l.logDebug("no pre cache key:",e)}saveContent(e,t,n="-"){let r={id:n,timestamp:Date.now().toString(),content:e};this.saveItem(r,t)}saveItem(e,t){let n=d.cacheKey+this.subKey;const r=(0,a.resolveLocalStorage)();l.logDebug(this.cache),l.logDebug(`get cache obj: ${this.cache}, ${t}, ${e}`),this.cache[t]=e;let i=(0,c.safeJsonStringify)(this.cache);l.logDebug(`STORAGE: ${t} @ ${this.cache}`),r.setItem(n,i)}getItem(e){return l.logDebug(`STORAGE >> getItem: ${e} @ ${this.cache}`),this.cache[e]}synchronizedCache(){const e=localStorage.getItem(d.cacheKey+this.subKey);if(null==e)return l.logDebug("with no cache"),void(this.cache={});if(l.logDebug(e),(null==e?void 0:e.length)>0){var t=(0,c.safeJsonParse)(e);this.cache=t}l.logDebug(`get cache obj: ${this.cache}`),(void 0===this.cache||null==this.cache)&&(this.cache={})}getCachedPBKDF2InfoKey(){var e,t,n,r;if(this.storeKey.length>0&&(null===(e=this.cipherIV)||void 0===e?void 0:e.length)>0)return{pw:this.storeKey,iv:this.cipherIV};let i=null===(t=this.getItem(o.OKXCONNECTOR_STORAGER_CRYPTO_SALT))||void 0===t?void 0:t.content;i||(i=(0,a.toHexString)(s.default.randomBytes(24)),this.saveContent(i,o.OKXCONNECTOR_STORAGER_CRYPTO_SALT));let c=null===(n=this.getItem(o.OKXCONNECTOR_STORAGE_CRYPTO_PASSWORD))||void 0===n?void 0:n.content;c||(c=(0,a.toHexString)(s.default.randomBytes(32)),this.saveContent(c,o.OKXCONNECTOR_STORAGE_CRYPTO_PASSWORD));let l=null===(r=this.getItem(o.OKXCONNECTOR_STORAGE_CRYPTO_CIPHERIV))||void 0===r?void 0:r.content;if(!l){let e=s.default.randomBytes(16);l=(0,a.toHexString)(e),this.saveContent(l,o.OKXCONNECTOR_STORAGE_CRYPTO_CIPHERIV)}return this.cipherIV=l,this.storeKey=(0,h.PBKDF2)(c,i,{iterations:10}).toString(),{pw:this.storeKey,iv:this.cipherIV}}encryptStoreMsg(e,t){(0,u.logDebug)(`encryptStoreMsg  encryptStoreMsg start ${Date.now()}`);let n=this.getCachedPBKDF2InfoKey();(0,u.logDebug)(`encryptStoreMsg  encryptStoreMsg mid ${Date.now()}`);var r=h.AES.encrypt(e,n.pw).toString();this.saveContent(r,t),(0,u.logDebug)(`encryptStoreMsg  encryptStoreMsg end ${Date.now()}`)}getAndDecrypt(e){(0,u.logDebug)(`encryptStoreMsg  getAndDecrypt start ${Date.now()}`);let t=this.getItem(e);if(t&&t.content){let e=this.getCachedPBKDF2InfoKey();(0,u.logDebug)(`encryptStoreMsg  getAndDecrypt mid ${Date.now()}`);let n=h.AES.decrypt(t.content,e.pw).toString(h.enc.Utf8);return(0,u.logDebug)(`encryptStoreMsg  getAndDecrypt end ${Date.now()}`),n}return null}clearCache(e){if(void 0===e){const e=(0,a.resolveLocalStorage)();this.cache={};let t=d.cacheKey+this.subKey;e.setItem(t,"")}else{let t=d.cacheKey+this.subKey;const n=(0,a.resolveLocalStorage)();l.logDebug(this.cache),this.cache[e]=null;let r=(0,c.safeJsonStringify)(this.cache);l.logDebug(`STORAGE: clean key ${e} @ ${this.cache}`),n.setItem(t,r)}}}return ip.Storage=d,d.cacheKey="OKXStorageKey",ip}function ub(){if(ib)return Yf;ib=1;var e,t=Yf&&Yf.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=Yf&&Yf.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=Yf&&Yf.__importStar||(e=function(t){return(e=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t})(t)},function(r){if(r&&r.__esModule)return r;var i={};if(null!=r)for(var o=e(r),s=0;s<o.length;s++)"default"!==o[s]&&t(i,r,o[s]);return n(i,r),i}),i=Yf&&Yf.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(Yf,"__esModule",{value:!0}),Yf.OKXWalletConnector=void 0;const o=ep(),s=rp(),a=lb(),c=Jy(),l=cb(),u=oy(),h=r(ev()),d=Ey(),f=Qy(),p=(0,l.resolveWebSocketImplementation)();return Yf.OKXWalletConnector=class{constructor(e){if(this.events=new u.EventEmitter,this.state=o.ConnectorState.InitState,this.selectedUrlIndex=0,this.retryCount=0,this.timeOutLimit=8e3,!(0,l.checkWSUrl)(e))throw new Error(`CONNECTOR: invalid url ${e}`);this.url=e,this.heartbeatTimer=null,this.connectionTimeoutTimer=null,this.connectURLStorage=new a.Storage(s.OKXCONNECTOR_CACHE_KEY+s.OKXCONNECTOR_CACHE_KEY)}get connecting(){return this.state==o.ConnectorState.Connecting}onPayload(e){if(void 0!==e.data){if(h.logDebug("get received data"),h.logDebug(e),"string"==typeof e.data&&"pong"===e.data)return void h.logDebug(`CONNECT: receive pong ${Date.now().toString()}`);this.events.emit("payload",e.data)}}onClose(e){var t;h.logDebug("socket get closed: ",null===(t=this.socket)||void 0===t?void 0:t.url,e.code),this.socket=void 0,this.events.emit("close",e)}onError(e,t){const n={id:e,msg:t.toString()};this.events.emit("payload",n)}onopen(e){e.onmessage=e=>this.onPayload(e),e.onclose=e=>this.onClose(e),this.socket=e,this.state=o.ConnectorState.Connected,this.events.emit("open")}emitError(e){this.events.emit("fail",e)}heartbeat(){return i(this,void 0,void 0,function*(){if(this.heartbeatTimer&&clearTimeout(this.heartbeatTimer),this.state==o.ConnectorState.Connected||this.state==o.ConnectorState.OnError){if(this.socket){if(this.socket.readyState===WebSocket.OPEN)h.logDebug(`send ping heart beat: ${Date.now().toString()}, ${this.socket}`),this.socket.send("ping"),this.heartbeatTimer=setTimeout(this.heartbeat.bind(this),5e3);else if(h.logDebug("socket not ready"),this.state==o.ConnectorState.Connected||this.state==o.ConnectorState.OnError){h.logDebug("socket reconnect by heartbeat with state",this.state,this.socket.readyState);try{yield this.tryRegistOpen()}catch{h.logError("regist open failed"),this.heartbeatTimer=setTimeout(this.heartbeat.bind(this),5e3)}}}else if(h.logDebug("socket not exist"),this.state==o.ConnectorState.Connected||this.state==o.ConnectorState.OnError){h.logDebug("socket reconnect by heartbeat");try{yield this.tryRegistOpen()}catch{h.logError("regist open failed"),this.heartbeatTimer=setTimeout(this.heartbeat.bind(this),5e3)}}}else h.logDebug("heart beat close")})}registOpen(e=this.url,t=!1){if(!(0,l.checkWSUrl)(e))throw new Error(`CONNECTOR: invalid url ${e}`);return this.url=e,t||h.logDebug("Connection connect:",this.url,(new Date).toUTCString()),this.state=o.ConnectorState.Connecting,new URLSearchParams(e).get("origin"),new Promise((t,n)=>{const r=new p(e,[]);h.logDebug("Connection connect Begin:",this.url,(new Date).toUTCString()),this.startTimeOutTimer(r),(0,l.hasBuiltInWebSocket)()?(h.logDebug("Add socket error handler"),r.onerror=()=>{n(new Error("socket error")),r.close()}):(h.logDebug("Add socket error handler"),r.on("error",()=>{n(new Error("socket error")),r.close()})),r.onopen=()=>{h.logDebug("socket opened"),this.resetTimeOutTimer(o.OKXCONNECTOR_WS_URL_PENDING_CLOSE_CODE.FINISHED),this.onopen(r),this.heartbeat(),t(r)}})}checkMaxRetry(){return h.logDebug("current retry count:",this.retryCount,"of",o.OKXCONNECTOR_WS_URL_LIST.length),this.retryCount>3*o.OKXCONNECTOR_WS_URL_LIST.length}connectionTryNext(){return i(this,void 0,void 0,function*(){if(!this.checkMaxRetry()){this.retryCount+=1;let e=this.getNextSelectUrl();return h.logDebug("Connection retry:",e,(new Date).toUTCString()),this.registOpen(e,!0)}h.logDebug("Max Connection retry ",this.retryCount,(new Date).toUTCString())})}startTimeOutTimer(e){this.connectionTimeoutTimer&&this.resetTimeOutTimer(o.OKXCONNECTOR_WS_URL_PENDING_CLOSE_CODE.CANCELED),this.pendingSocket=e,this.connectionTimeoutTimer=setTimeout(()=>{this.pendingSocket&&this.resetTimeOutTimer(o.OKXCONNECTOR_WS_URL_PENDING_CLOSE_CODE.TIME_OUT)},this.timeOutLimit)}resetTimeOutTimer(e){var t;if(e==o.OKXCONNECTOR_WS_URL_PENDING_CLOSE_CODE.TIME_OUT)throw clearTimeout(this.connectionTimeoutTimer),null===(t=this.pendingSocket)||void 0===t||t.close(),this.pendingSocket=void 0,h.reportEvent(f.OKXReportType.LOG,"timeout",this.retryCount.toString()),new Error("socket timeout");this.pendingSocket=void 0,clearTimeout(this.connectionTimeoutTimer)}cacheSuccessUrlSelect(){this.connectURLStorage.saveContent(this.selectedUrlIndex.toString(),s.OKXCONNECTOR_CACHE_KEY)}getNextSelectUrl(){return this.selectedUrlIndex+=1,this.selectedUrlIndex=this.selectedUrlIndex%o.OKXCONNECTOR_WS_URL_LIST.length,o.OKXCONNECTOR_WS_URL_LIST[this.selectedUrlIndex]}onVisibleChanged(){return i(this,void 0,void 0,function*(){if("visible"!==document.visibilityState||(h.logDebug(`get changed ${this.state}, ${this.socket}`),this.state!=o.ConnectorState.Connected||void 0!==this.socket));else{h.logDebug("CONNECTION need reopen");try{yield this.tryRegistOpen()}catch{h.logError("regist open failed")}}})}tryRegistOpen(){return i(this,arguments,void 0,function*(e=this.url){if(this.connecting)return h.logDebug("tryRegistOpen => connecting state"),new Promise((e,t)=>{this.events.once("fail",e=>(h.logDebug("tryRegistOpen => connecting fail listener",e),t(e))),this.events.once("open",()=>void 0===this.socket?t(new Error("Connect lost")):e(this.socket))});h.logDebug("tryRegistOpen => try registOpen until retry limit is hit");let t=!1;for(;!this.checkMaxRetry()&&!this.socket;)try{h.logDebug("tryRegistOpen => call registOpen, try count:",this.retryCount,t),yield this.registOpen(e,t)}catch(n){h.logDebug("tryRegistOpen => registOpen failed",n),this.retryCount+=1,e=this.getNextSelectUrl(),t=!0}if(h.logDebug("tryRegistOpen => exit while loop",this.retryCount,this.socket),!this.socket&&this.checkMaxRetry())throw h.logDebug("tryRegistOpen => failed to open a socket",this.retryCount,this.socket),this.retryCount=0,this.state=o.ConnectorState.OnError,this.emitError(new Error("tryRegistOpen failed")),new d.OKXConnectError(d.OKX_CONNECT_ERROR_CODES.CONNECTION_ERROR,"Failed to connect")})}connect(){return i(this,void 0,void 0,function*(){try{yield this.tryRegistOpen(),document.removeEventListener("visibilitychange",this.onVisibleChanged.bind(this)),document.addEventListener("visibilitychange",this.onVisibleChanged.bind(this))}catch(e){throw h.logDebug("connect => failed to connect",e),e}})}disconnect(){return i(this,void 0,void 0,function*(){return this.state=o.ConnectorState.Disconnected,new Promise(e=>{void 0!==this.socket?(this.socket.onclose=t=>{this.onClose(t),e()},this.socket.close(),this.heartbeatTimer&&clearTimeout(this.heartbeatTimer)):e()})})}currentStatus(){return{state:this.state,url:this.url}}addListener(e,t,n,r,o){this.listenPayloadHandler&&this.events.removeListener("payload",this.listenPayloadHandler),this.listenPayloadHandler=s=>i(this,void 0,void 0,function*(){var i;h.logDebug(`<<< get payload ${s}`);let a=(0,c.safeJsonParse)(s);if(a.params&&a.params.data){let s=null===(i=a.params.data)||void 0===i?void 0:i.message,c=!1;if(s&&o){let e=yield o(a.params.data);c=e.isSplitPackage&&!e.finalMessage,e.isSplitPackage&&(e.finalMessage&&e.finalMessage.length>0?(h.logDebug("CONNECT: update raw msg content"),s=e.finalMessage):(h.logDebug("CONNECT: skip raw msg content"),c=!0))}if(!c)try{let i=t(s);void 0===i?(h.logDebug("CONNECT: decrypt undefined"),r(e,"Decrypt undefined")):n(e,i)}catch(l){h.logDebug(`CONNECT: decrypt failed: ${l}`),r(e,l.message)}}}),this.events.on("payload",this.listenPayloadHandler),this.failHandler&&this.events.removeListener("fail",this.failHandler),this.failHandler=t=>{t?(h.logDebug(`CONNECT failed: ${t}`),r(e,t.message)):r(e,"Unkonow error")},this.events.on("fail",this.failHandler)}addPackageParse(e){this.payloadHandler&&this.events.removeListener("payload",this.payloadHandler),this.payloadHandler=t=>i(this,void 0,void 0,function*(){h.logDebug(`CONNECTION @[${(new Date).toUTCString()}] <<<< received e:${t}`);let n=(0,c.safeJsonParse)(t);yield e(n)}),this.events.on("payload",this.payloadHandler)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}send(e,t){return i(this,void 0,void 0,function*(){try{void 0===this.socket&&(h.logDebug(`>>> send payload undefined ${t}`),yield e()),h.logDebug(`CONNECTION @[${(new Date).toUTCString()}]>>> send payload ${(0,c.safeJsonStringify)(t)}`),this.socket&&this.socket.send((0,c.safeJsonStringify)(t))}catch(n){this.onError(t.id,n)}})}getMsgPayloadFromHistory(e){return i(this,void 0,void 0,function*(){if(void 0===e)return;let t={params:{data:e}},n=(0,c.safeJsonStringify)(e);h.logDebug("get received data from history"),h.logDebug(n),n=(0,c.safeJsonStringify)(t),this.events.emit("payload",n)})}onOpen(e){this.openHandler&&this.events.removeListener("open",this.openHandler),this.openHandler=()=>i(this,void 0,void 0,function*(){h.logDebug(`CONNECTION @[${(new Date).toUTCString()}] >>> ws opened: `),yield e()}),this.events.on("open",this.openHandler),this.cacheSuccessUrlSelect()}},Yf}ob.exports,av.exports;var hb,db={},fb={};function pb(){return hb||(hb=1,Object.defineProperty(fb,"__esModule",{value:!0}),fb.CONNECT_METHOD_RECV_DISCONNECT=fb.CONNECT_METHOD_DISCONNECT=fb.CONNECT_METHOD_BATCH_FETCHMSG=fb.CONNECT_METHOD_FETCHMSG=fb.CONNECT_METHOD_RECEIVE=fb.CONNECT_METHOD_UNSUB=fb.CONNECT_METHOD_SUB=fb.CONNECT_METHOD_PUBLISH=fb.CONNECT_METHOD_LOGIN=fb.CONNECT_METHOD_PUSH=void 0,fb.CONNECT_METHOD_PUSH="push",fb.CONNECT_METHOD_LOGIN="login",fb.CONNECT_METHOD_PUBLISH="publish",fb.CONNECT_METHOD_SUB="subscribe",fb.CONNECT_METHOD_UNSUB="unsubscribe",fb.CONNECT_METHOD_RECEIVE="receive",fb.CONNECT_METHOD_FETCHMSG="fetchMessages",fb.CONNECT_METHOD_BATCH_FETCHMSG="batchFetchMessages",fb.CONNECT_METHOD_DISCONNECT="disconnect",fb.CONNECT_METHOD_RECV_DISCONNECT="receiveDisconnect"),fb}var gb,mb={};function yb(){return gb||(gb=1,Object.defineProperty(mb,"__esModule",{value:!0}),mb.OKXCONNECTOR_JWT_TTL=mb.OKXCONNECTOR_JWT_WALLET_SIDE=mb.OKXCONNECTOR_JWT_SIDE=void 0,mb.OKXCONNECTOR_JWT_SIDE="wallet",mb.OKXCONNECTOR_JWT_WALLET_SIDE="dapp",mb.OKXCONNECTOR_JWT_TTL=864e5),mb}var vb,wb={};function bb(){if(vb)return wb;vb=1;var e=wb&&wb.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(wb,"__esModule",{value:!0}),wb.SessionCrypto=void 0;const t=e(lp()),n=cb();return wb.SessionCrypto=class{constructor(e){this.nonceLength=24,this.sessionKeyPair=e?this.createKeypairFromString(e):this.createKeypair()}createKeypair(){return t.default.box.keyPair()}createKeypairFromString(e){return{publicKey:(0,n.hexToByteArray)(e.publicKey),secretKey:(0,n.hexToByteArray)(e.secretKey)}}createNonce(){return t.default.randomBytes(this.nonceLength)}get keyPair(){return this.sessionKeyPair}encrypt(e,r){const i=(new TextEncoder).encode(e),o=this.createNonce(),s=t.default.box(i,o,(0,n.hexToByteArray)(r),this.keyPair.secretKey);let a=(0,n.concatUint8Arrays)(o,s);var c=(0,n.toHexString)(a),l=(new TextEncoder).encode(c);return(0,n.base64encode)(l,!1)}encryptWallet(e,r){const i=(new TextEncoder).encode(e),o=this.createNonce(),s=t.default.box(i,o,(0,n.hexToByteArray)(r),this.keyPair.secretKey);let a=(0,n.concatUint8Arrays)(o,s);return(0,n.base64encode)(a,!1)}decrypt(e,r){let i=(0,n.base64decode)(e,!0).toUint8Array();const[o,s]=(0,n.splitToUint8Arrays)(i,this.nonceLength),a=t.default.box.open(s,o,(0,n.hexToByteArray)(r),this.keyPair.secretKey);if(!a)throw new Error(`Decryption error: \n message: ${e.toString()} \n sender pubkey: ${r.toString()} \n keypair pubkey: ${(0,n.toHexString)(this.keyPair.publicKey)} \n keypair secretkey: ${(0,n.toHexString)(this.keyPair.secretKey)}`);return(new TextDecoder).decode(a)}decryptWallet(e,r){let i=(0,n.base64decode)(e,!0),o=(0,n.hexToByteArray)(i.toString());const[s,a]=(0,n.splitToUint8Arrays)(o,this.nonceLength),c=t.default.box.open(a,s,(0,n.hexToByteArray)(r),this.keyPair.secretKey);if(!c)throw new Error(`Decryption error: \n message: ${e.toString()} \n sender pubkey: ${r.toString()} \n keypair pubkey: ${(0,n.toHexString)(this.keyPair.publicKey)} \n keypair secretkey: ${(0,n.toHexString)(this.keyPair.secretKey)}`);return(new TextDecoder).decode(c)}stringifyKeypair(){return{publicKey:(0,n.toHexString)(this.keyPair.publicKey),secretKey:(0,n.toHexString)(this.keyPair.secretKey)}}},wb}var Ob,Eb={},_b={},Cb={},Nb={},Ab={};function Rb(){if(Ob)return Ab;Ob=1,Object.defineProperty(Ab,"__esModule",{value:!0}),Ab.BrowserRandomSource=void 0;return Ab.BrowserRandomSource=class{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e="undefined"!=typeof self?self.crypto||self.msCrypto:null;e&&void 0!==e.getRandomValues&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const t=new Uint8Array(e);for(let n=0;n<t.length;n+=65536)this._crypto.getRandomValues(t.subarray(n,n+Math.min(t.length-n,65536)));return t}},Ab}var Sb,Tb,Pb,Db={};function kb(){if(Sb)return Db;Sb=1,Object.defineProperty(Db,"__esModule",{value:!0}),Db.NodeRandomSource=void 0;const e=km();return Db.NodeRandomSource=class{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,void 0!==op){const e=ap;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let n=this._crypto.randomBytes(t);if(n.length!==t)throw new Error("NodeRandomSource: got fewer bytes than requested");const r=new Uint8Array(t);for(let e=0;e<r.length;e++)r[e]=n[e];return(0,e.wipe)(n),r}},Db}function Ib(){if(Tb)return Nb;Tb=1,Object.defineProperty(Nb,"__esModule",{value:!0}),Nb.SystemRandomSource=void 0;const e=Rb(),t=kb();return Nb.SystemRandomSource=class{constructor(){return this.isAvailable=!1,this.name="",this._source=new e.BrowserRandomSource,this._source.isAvailable?(this.isAvailable=!0,void(this.name="Browser")):(this._source=new t.NodeRandomSource,this._source.isAvailable?(this.isAvailable=!0,void(this.name="Node")):void 0)}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}},Nb}var xb,Mb,Kb,Lb={};function Ub(){return Kb||(Kb=1,function(e){var t,n=Eb&&Eb.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),r=Eb&&Eb.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=Eb&&Eb.__importStar||(t=function(e){return(t=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t})(e)},function(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var o=t(e),s=0;s<o.length;s++)"default"!==o[s]&&n(i,e,o[s]);return r(i,e),i}),o=Eb&&Eb.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})},s=Eb&&Eb.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0}),e.MULTICODEC_ED25519_LENGTH=e.MULTICODEC_ED25519_HEADER=e.MULTICODEC_ED25519_BASE=e.MULTICODEC_ED25519_ENCODING=e.DID_METHOD=e.DID_PREFIX=e.DID_DELIMITER=e.KEY_PAIR_SEED_LENGTH=e.DATA_ENCODING=e.JSON_ENCODING=e.JWT_ENCODING=e.JWT_DELIMITER=e.JWT_IRIDIUM_TYP=e.JWT_IRIDIUM_ALG=e.JWTHeaderType=void 0,e.generateKeyPair=function(){return u.default.sign.keyPair()},e.decodeJSON=f,e.encodeJSON=p,e.encodeIss=g,e.decodeIss=m,e.encodeSig=y,e.decodeSig=v,e.encodeData=w,e.decodeData=function(t){var n,r;const i=(0,d.okxtoString)(t,e.DATA_ENCODING).split(e.JWT_DELIMITER);return{header:f(null!==(n=i[0])&&void 0!==n?n:"{}"),payload:f(null!==(r=i[1])&&void 0!==r?r:"{}")}},e.encodeJWT=b,e.decodeJWT=O,e.signJWT=function(t,n,r,i){return o(this,arguments,void 0,function*(t,n,r,i,o=Math.floor(Date.now())){const s={alg:e.JWT_IRIDIUM_ALG,typ:e.JWT_IRIDIUM_TYP},a={iss:g(i.publicKey),sub:t,aud:n,act:"authenticate user",iat:o,exp:o+r},c=w({header:s,payload:a});return h.logDebug(`get sec kp: ${i.secretKey} {${i.secretKey.length}}`),b({header:s,payload:a,signature:u.default.sign.detached(c,i.secretKey)})})},e.verifyJWT=function(t){return o(this,void 0,void 0,function*(){const{header:n,payload:r,data:i,signature:o}=O(t);if(n.alg!==e.JWT_IRIDIUM_ALG||n.typ!==e.JWT_IRIDIUM_TYP)throw new Error("JWT must use EdDSA algorithm");const s=m(r.iss);return a.verify(s,i,o)})};const a=i((Mb||(Mb=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.convertSecretKeyToX25519=e.convertPublicKeyToX25519=e.verify=e.sign=e.extractPublicKeyFromSecretKey=e.generateKeyPair=e.generateKeyPairFromSeed=e.SEED_LENGTH=e.SECRET_KEY_LENGTH=e.PUBLIC_KEY_LENGTH=e.SIGNATURE_LENGTH=void 0;const t=(Pb||(Pb=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.randomStringForEntropy=e.randomString=e.randomUint32=e.randomBytes=e.defaultRandomSource=void 0;const t=Ib(),n=Sm(),r=km();function i(t,n=e.defaultRandomSource){return n.randomBytes(t)}e.defaultRandomSource=new t.SystemRandomSource,e.randomBytes=i,e.randomUint32=function(t=e.defaultRandomSource){const o=i(4,t),s=(0,n.readUint32LE)(o);return(0,r.wipe)(o),s};const o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function s(t,n=o,s=e.defaultRandomSource){if(n.length<2)throw new Error("randomString charset is too short");if(n.length>256)throw new Error("randomString charset is too long");let a="";const c=n.length,l=256-256%c;for(;t>0;){const e=i(Math.ceil(256*t/l),s);for(let r=0;r<e.length&&t>0;r++){const i=e[r];i<l&&(a+=n.charAt(i%c),t--)}(0,r.wipe)(e)}return a}e.randomString=s,e.randomStringForEntropy=function(t,n=o,r=e.defaultRandomSource){return s(Math.ceil(t/(Math.log(n.length)/Math.LN2)),n,r)}}(Cb)),Cb),n=(xb||(xb=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=Sm(),n=km();e.DIGEST_LENGTH=64,e.BLOCK_SIZE=128;var r=function(){function r(){this.digestLength=e.DIGEST_LENGTH,this.blockSize=e.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return r.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},r.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},r.prototype.clean=function(){n.wipe(this._buffer),n.wipe(this._tempHi),n.wipe(this._tempLo),this.reset()},r.prototype.update=function(t,n){if(void 0===n&&(n=t.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var r=0;if(this._bytesHashed+=n,this._bufferLength>0){for(;this._bufferLength<e.BLOCK_SIZE&&n>0;)this._buffer[this._bufferLength++]=t[r++],n--;this._bufferLength===this.blockSize&&(o(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(n>=this.blockSize&&(r=o(this._tempHi,this._tempLo,this._stateHi,this._stateLo,t,r,n),n%=this.blockSize);n>0;)this._buffer[this._bufferLength++]=t[r++],n--;return this},r.prototype.finish=function(e){if(!this._finished){var n=this._bytesHashed,r=this._bufferLength,i=n/536870912|0,s=n<<3,a=n%128<112?128:256;this._buffer[r]=128;for(var c=r+1;c<a-8;c++)this._buffer[c]=0;t.writeUint32BE(i,this._buffer,a-8),t.writeUint32BE(s,this._buffer,a-4),o(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,a),this._finished=!0}for(c=0;c<this.digestLength/8;c++)t.writeUint32BE(this._stateHi[c],e,8*c),t.writeUint32BE(this._stateLo[c],e,8*c+4);return this},r.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},r.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},r.prototype.restoreState=function(e){return this._stateHi.set(e.stateHi),this._stateLo.set(e.stateLo),this._bufferLength=e.bufferLength,e.buffer&&this._buffer.set(e.buffer),this._bytesHashed=e.bytesHashed,this._finished=!1,this},r.prototype.cleanSavedState=function(e){n.wipe(e.stateHi),n.wipe(e.stateLo),e.buffer&&n.wipe(e.buffer),e.bufferLength=0,e.bytesHashed=0},r}();e.SHA512=r;var i=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function o(e,n,r,o,s,a,c){for(var l,u,h,d,f,p,g,m,y=r[0],v=r[1],w=r[2],b=r[3],O=r[4],E=r[5],_=r[6],C=r[7],N=o[0],A=o[1],R=o[2],S=o[3],T=o[4],P=o[5],D=o[6],k=o[7];c>=128;){for(var I=0;I<16;I++){var x=8*I+a;e[I]=t.readUint32BE(s,x),n[I]=t.readUint32BE(s,x+4)}for(I=0;I<80;I++){var M,K,L=y,U=v,B=w,j=b,H=O,W=E,X=_,F=N,J=A,G=R,q=S,V=T,z=P,Q=D;if(f=65535&(u=k),p=u>>>16,g=65535&(l=C),m=l>>>16,f+=65535&(u=(T>>>14|O<<18)^(T>>>18|O<<14)^(O>>>9|T<<23)),p+=u>>>16,g+=65535&(l=(O>>>14|T<<18)^(O>>>18|T<<14)^(T>>>9|O<<23)),m+=l>>>16,f+=65535&(u=T&P^~T&D),p+=u>>>16,g+=65535&(l=O&E^~O&_),m+=l>>>16,l=i[2*I],f+=65535&(u=i[2*I+1]),p+=u>>>16,g+=65535&l,m+=l>>>16,l=e[I%16],p+=(u=n[I%16])>>>16,g+=65535&l,m+=l>>>16,g+=(p+=(f+=65535&u)>>>16)>>>16,f=65535&(u=d=65535&f|p<<16),p=u>>>16,g=65535&(l=h=65535&g|(m+=g>>>16)<<16),m=l>>>16,f+=65535&(u=(N>>>28|y<<4)^(y>>>2|N<<30)^(y>>>7|N<<25)),p+=u>>>16,g+=65535&(l=(y>>>28|N<<4)^(N>>>2|y<<30)^(N>>>7|y<<25)),m+=l>>>16,p+=(u=N&A^N&R^A&R)>>>16,g+=65535&(l=y&v^y&w^v&w),m+=l>>>16,M=65535&(g+=(p+=(f+=65535&u)>>>16)>>>16)|(m+=g>>>16)<<16,K=65535&f|p<<16,f=65535&(u=q),p=u>>>16,g=65535&(l=j),m=l>>>16,p+=(u=d)>>>16,g+=65535&(l=h),m+=l>>>16,v=L,w=U,b=B,O=j=65535&(g+=(p+=(f+=65535&u)>>>16)>>>16)|(m+=g>>>16)<<16,E=H,_=W,C=X,y=M,A=F,R=J,S=G,T=q=65535&f|p<<16,P=V,D=z,k=Q,N=K,I%16==15)for(x=0;x<16;x++)l=e[x],f=65535&(u=n[x]),p=u>>>16,g=65535&l,m=l>>>16,l=e[(x+9)%16],f+=65535&(u=n[(x+9)%16]),p+=u>>>16,g+=65535&l,m+=l>>>16,h=e[(x+1)%16],f+=65535&(u=((d=n[(x+1)%16])>>>1|h<<31)^(d>>>8|h<<24)^(d>>>7|h<<25)),p+=u>>>16,g+=65535&(l=(h>>>1|d<<31)^(h>>>8|d<<24)^h>>>7),m+=l>>>16,h=e[(x+14)%16],p+=(u=((d=n[(x+14)%16])>>>19|h<<13)^(h>>>29|d<<3)^(d>>>6|h<<26))>>>16,g+=65535&(l=(h>>>19|d<<13)^(d>>>29|h<<3)^h>>>6),m+=l>>>16,m+=(g+=(p+=(f+=65535&u)>>>16)>>>16)>>>16,e[x]=65535&g|m<<16,n[x]=65535&f|p<<16}f=65535&(u=N),p=u>>>16,g=65535&(l=y),m=l>>>16,l=r[0],p+=(u=o[0])>>>16,g+=65535&l,m+=l>>>16,m+=(g+=(p+=(f+=65535&u)>>>16)>>>16)>>>16,r[0]=y=65535&g|m<<16,o[0]=N=65535&f|p<<16,f=65535&(u=A),p=u>>>16,g=65535&(l=v),m=l>>>16,l=r[1],p+=(u=o[1])>>>16,g+=65535&l,m+=l>>>16,m+=(g+=(p+=(f+=65535&u)>>>16)>>>16)>>>16,r[1]=v=65535&g|m<<16,o[1]=A=65535&f|p<<16,f=65535&(u=R),p=u>>>16,g=65535&(l=w),m=l>>>16,l=r[2],p+=(u=o[2])>>>16,g+=65535&l,m+=l>>>16,m+=(g+=(p+=(f+=65535&u)>>>16)>>>16)>>>16,r[2]=w=65535&g|m<<16,o[2]=R=65535&f|p<<16,f=65535&(u=S),p=u>>>16,g=65535&(l=b),m=l>>>16,l=r[3],p+=(u=o[3])>>>16,g+=65535&l,m+=l>>>16,m+=(g+=(p+=(f+=65535&u)>>>16)>>>16)>>>16,r[3]=b=65535&g|m<<16,o[3]=S=65535&f|p<<16,f=65535&(u=T),p=u>>>16,g=65535&(l=O),m=l>>>16,l=r[4],p+=(u=o[4])>>>16,g+=65535&l,m+=l>>>16,m+=(g+=(p+=(f+=65535&u)>>>16)>>>16)>>>16,r[4]=O=65535&g|m<<16,o[4]=T=65535&f|p<<16,f=65535&(u=P),p=u>>>16,g=65535&(l=E),m=l>>>16,l=r[5],p+=(u=o[5])>>>16,g+=65535&l,m+=l>>>16,m+=(g+=(p+=(f+=65535&u)>>>16)>>>16)>>>16,r[5]=E=65535&g|m<<16,o[5]=P=65535&f|p<<16,f=65535&(u=D),p=u>>>16,g=65535&(l=_),m=l>>>16,l=r[6],p+=(u=o[6])>>>16,g+=65535&l,m+=l>>>16,m+=(g+=(p+=(f+=65535&u)>>>16)>>>16)>>>16,r[6]=_=65535&g|m<<16,o[6]=D=65535&f|p<<16,f=65535&(u=k),p=u>>>16,g=65535&(l=C),m=l>>>16,l=r[7],p+=(u=o[7])>>>16,g+=65535&l,m+=l>>>16,m+=(g+=(p+=(f+=65535&u)>>>16)>>>16)>>>16,r[7]=C=65535&g|m<<16,o[7]=k=65535&f|p<<16,a+=128,c-=128}return a}e.hash=function(e){var t=new r;t.update(e);var n=t.digest();return t.clean(),n}}(Lb)),Lb),r=km();function i(e){const t=new Float64Array(16);if(e)for(let n=0;n<e.length;n++)t[n]=e[n];return t}e.SIGNATURE_LENGTH=64,e.PUBLIC_KEY_LENGTH=32,e.SECRET_KEY_LENGTH=64,e.SEED_LENGTH=32,new Uint8Array(32)[0]=9;const o=i(),s=i([1]),a=i([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),c=i([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),l=i([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),u=i([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),h=i([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function d(e,t){for(let n=0;n<16;n++)e[n]=0|t[n]}function f(e){let t=1;for(let n=0;n<16;n++){let r=e[n]+t+65535;t=Math.floor(r/65536),e[n]=r-65536*t}e[0]+=t-1+37*(t-1)}function p(e,t,n){const r=~(n-1);for(let i=0;i<16;i++){const n=r&(e[i]^t[i]);e[i]^=n,t[i]^=n}}function g(e,t){const n=i(),r=i();for(let i=0;i<16;i++)r[i]=t[i];f(r),f(r),f(r);for(let i=0;i<2;i++){n[0]=r[0]-65517;for(let t=1;t<15;t++)n[t]=r[t]-65535-(n[t-1]>>16&1),n[t-1]&=65535;n[15]=r[15]-32767-(n[14]>>16&1);const e=n[15]>>16&1;n[14]&=65535,p(r,n,1-e)}for(let i=0;i<16;i++)e[2*i]=255&r[i],e[2*i+1]=r[i]>>8}function m(e,t){let n=0;for(let r=0;r<32;r++)n|=e[r]^t[r];return(1&n-1>>>8)-1}function y(e,t){const n=new Uint8Array(32),r=new Uint8Array(32);return g(n,e),g(r,t),m(n,r)}function v(e){const t=new Uint8Array(32);return g(t,e),1&t[0]}function w(e,t){for(let n=0;n<16;n++)e[n]=t[2*n]+(t[2*n+1]<<8);e[15]&=32767}function b(e,t,n){for(let r=0;r<16;r++)e[r]=t[r]+n[r]}function O(e,t,n){for(let r=0;r<16;r++)e[r]=t[r]-n[r]}function E(e,t,n){let r,i,o=0,s=0,a=0,c=0,l=0,u=0,h=0,d=0,f=0,p=0,g=0,m=0,y=0,v=0,w=0,b=0,O=0,E=0,_=0,C=0,N=0,A=0,R=0,S=0,T=0,P=0,D=0,k=0,I=0,x=0,M=0,K=n[0],L=n[1],U=n[2],B=n[3],j=n[4],H=n[5],W=n[6],X=n[7],F=n[8],J=n[9],G=n[10],q=n[11],V=n[12],z=n[13],Q=n[14],$=n[15];o+=(r=t[0])*K,s+=r*L,a+=r*U,c+=r*B,l+=r*j,u+=r*H,h+=r*W,d+=r*X,f+=r*F,p+=r*J,g+=r*G,m+=r*q,y+=r*V,v+=r*z,w+=r*Q,b+=r*$,s+=(r=t[1])*K,a+=r*L,c+=r*U,l+=r*B,u+=r*j,h+=r*H,d+=r*W,f+=r*X,p+=r*F,g+=r*J,m+=r*G,y+=r*q,v+=r*V,w+=r*z,b+=r*Q,O+=r*$,a+=(r=t[2])*K,c+=r*L,l+=r*U,u+=r*B,h+=r*j,d+=r*H,f+=r*W,p+=r*X,g+=r*F,m+=r*J,y+=r*G,v+=r*q,w+=r*V,b+=r*z,O+=r*Q,E+=r*$,c+=(r=t[3])*K,l+=r*L,u+=r*U,h+=r*B,d+=r*j,f+=r*H,p+=r*W,g+=r*X,m+=r*F,y+=r*J,v+=r*G,w+=r*q,b+=r*V,O+=r*z,E+=r*Q,_+=r*$,l+=(r=t[4])*K,u+=r*L,h+=r*U,d+=r*B,f+=r*j,p+=r*H,g+=r*W,m+=r*X,y+=r*F,v+=r*J,w+=r*G,b+=r*q,O+=r*V,E+=r*z,_+=r*Q,C+=r*$,u+=(r=t[5])*K,h+=r*L,d+=r*U,f+=r*B,p+=r*j,g+=r*H,m+=r*W,y+=r*X,v+=r*F,w+=r*J,b+=r*G,O+=r*q,E+=r*V,_+=r*z,C+=r*Q,N+=r*$,h+=(r=t[6])*K,d+=r*L,f+=r*U,p+=r*B,g+=r*j,m+=r*H,y+=r*W,v+=r*X,w+=r*F,b+=r*J,O+=r*G,E+=r*q,_+=r*V,C+=r*z,N+=r*Q,A+=r*$,d+=(r=t[7])*K,f+=r*L,p+=r*U,g+=r*B,m+=r*j,y+=r*H,v+=r*W,w+=r*X,b+=r*F,O+=r*J,E+=r*G,_+=r*q,C+=r*V,N+=r*z,A+=r*Q,R+=r*$,f+=(r=t[8])*K,p+=r*L,g+=r*U,m+=r*B,y+=r*j,v+=r*H,w+=r*W,b+=r*X,O+=r*F,E+=r*J,_+=r*G,C+=r*q,N+=r*V,A+=r*z,R+=r*Q,S+=r*$,p+=(r=t[9])*K,g+=r*L,m+=r*U,y+=r*B,v+=r*j,w+=r*H,b+=r*W,O+=r*X,E+=r*F,_+=r*J,C+=r*G,N+=r*q,A+=r*V,R+=r*z,S+=r*Q,T+=r*$,g+=(r=t[10])*K,m+=r*L,y+=r*U,v+=r*B,w+=r*j,b+=r*H,O+=r*W,E+=r*X,_+=r*F,C+=r*J,N+=r*G,A+=r*q,R+=r*V,S+=r*z,T+=r*Q,P+=r*$,m+=(r=t[11])*K,y+=r*L,v+=r*U,w+=r*B,b+=r*j,O+=r*H,E+=r*W,_+=r*X,C+=r*F,N+=r*J,A+=r*G,R+=r*q,S+=r*V,T+=r*z,P+=r*Q,D+=r*$,y+=(r=t[12])*K,v+=r*L,w+=r*U,b+=r*B,O+=r*j,E+=r*H,_+=r*W,C+=r*X,N+=r*F,A+=r*J,R+=r*G,S+=r*q,T+=r*V,P+=r*z,D+=r*Q,k+=r*$,v+=(r=t[13])*K,w+=r*L,b+=r*U,O+=r*B,E+=r*j,_+=r*H,C+=r*W,N+=r*X,A+=r*F,R+=r*J,S+=r*G,T+=r*q,P+=r*V,D+=r*z,k+=r*Q,I+=r*$,w+=(r=t[14])*K,b+=r*L,O+=r*U,E+=r*B,_+=r*j,C+=r*H,N+=r*W,A+=r*X,R+=r*F,S+=r*J,T+=r*G,P+=r*q,D+=r*V,k+=r*z,I+=r*Q,x+=r*$,b+=(r=t[15])*K,s+=38*(E+=r*U),a+=38*(_+=r*B),c+=38*(C+=r*j),l+=38*(N+=r*H),u+=38*(A+=r*W),h+=38*(R+=r*X),d+=38*(S+=r*F),f+=38*(T+=r*J),p+=38*(P+=r*G),g+=38*(D+=r*q),m+=38*(k+=r*V),y+=38*(I+=r*z),v+=38*(x+=r*Q),w+=38*(M+=r*$),o=(r=(o+=38*(O+=r*L))+(i=1)+65535)-65536*(i=Math.floor(r/65536)),s=(r=s+i+65535)-65536*(i=Math.floor(r/65536)),a=(r=a+i+65535)-65536*(i=Math.floor(r/65536)),c=(r=c+i+65535)-65536*(i=Math.floor(r/65536)),l=(r=l+i+65535)-65536*(i=Math.floor(r/65536)),u=(r=u+i+65535)-65536*(i=Math.floor(r/65536)),h=(r=h+i+65535)-65536*(i=Math.floor(r/65536)),d=(r=d+i+65535)-65536*(i=Math.floor(r/65536)),f=(r=f+i+65535)-65536*(i=Math.floor(r/65536)),p=(r=p+i+65535)-65536*(i=Math.floor(r/65536)),g=(r=g+i+65535)-65536*(i=Math.floor(r/65536)),m=(r=m+i+65535)-65536*(i=Math.floor(r/65536)),y=(r=y+i+65535)-65536*(i=Math.floor(r/65536)),v=(r=v+i+65535)-65536*(i=Math.floor(r/65536)),w=(r=w+i+65535)-65536*(i=Math.floor(r/65536)),b=(r=b+i+65535)-65536*(i=Math.floor(r/65536)),o=(r=(o+=i-1+37*(i-1))+(i=1)+65535)-65536*(i=Math.floor(r/65536)),s=(r=s+i+65535)-65536*(i=Math.floor(r/65536)),a=(r=a+i+65535)-65536*(i=Math.floor(r/65536)),c=(r=c+i+65535)-65536*(i=Math.floor(r/65536)),l=(r=l+i+65535)-65536*(i=Math.floor(r/65536)),u=(r=u+i+65535)-65536*(i=Math.floor(r/65536)),h=(r=h+i+65535)-65536*(i=Math.floor(r/65536)),d=(r=d+i+65535)-65536*(i=Math.floor(r/65536)),f=(r=f+i+65535)-65536*(i=Math.floor(r/65536)),p=(r=p+i+65535)-65536*(i=Math.floor(r/65536)),g=(r=g+i+65535)-65536*(i=Math.floor(r/65536)),m=(r=m+i+65535)-65536*(i=Math.floor(r/65536)),y=(r=y+i+65535)-65536*(i=Math.floor(r/65536)),v=(r=v+i+65535)-65536*(i=Math.floor(r/65536)),w=(r=w+i+65535)-65536*(i=Math.floor(r/65536)),b=(r=b+i+65535)-65536*(i=Math.floor(r/65536)),o+=i-1+37*(i-1),e[0]=o,e[1]=s,e[2]=a,e[3]=c,e[4]=l,e[5]=u,e[6]=h,e[7]=d,e[8]=f,e[9]=p,e[10]=g,e[11]=m,e[12]=y,e[13]=v,e[14]=w,e[15]=b}function _(e,t){E(e,t,t)}function C(e,t){const n=i();let r;for(r=0;r<16;r++)n[r]=t[r];for(r=253;r>=0;r--)_(n,n),2!==r&&4!==r&&E(n,n,t);for(r=0;r<16;r++)e[r]=n[r]}function N(e,t){const n=i();let r;for(r=0;r<16;r++)n[r]=t[r];for(r=250;r>=0;r--)_(n,n),1!==r&&E(n,n,t);for(r=0;r<16;r++)e[r]=n[r]}function A(e,t){const n=i(),r=i(),o=i(),s=i(),a=i(),l=i(),u=i(),h=i(),d=i();O(n,e[1],e[0]),O(d,t[1],t[0]),E(n,n,d),b(r,e[0],e[1]),b(d,t[0],t[1]),E(r,r,d),E(o,e[3],t[3]),E(o,o,c),E(s,e[2],t[2]),b(s,s,s),O(a,r,n),O(l,s,o),b(u,s,o),b(h,r,n),E(e[0],a,l),E(e[1],h,u),E(e[2],u,l),E(e[3],a,h)}function R(e,t,n){for(let r=0;r<4;r++)p(e[r],t[r],n)}function S(e,t){const n=i(),r=i(),o=i();C(o,t[2]),E(n,t[0],o),E(r,t[1],o),g(e,r),e[31]^=v(n)<<7}function T(e,t,n){d(e[0],o),d(e[1],s),d(e[2],s),d(e[3],o);for(let r=255;r>=0;--r){const i=n[r/8|0]>>(7&r)&1;R(e,t,i),A(t,e),A(e,e),R(e,t,i)}}function P(e,t){const n=[i(),i(),i(),i()];d(n[0],l),d(n[1],u),d(n[2],s),E(n[3],l,u),T(e,n,t)}function D(t){if(t.length!==e.SEED_LENGTH)throw new Error(`ed25519: seed must be ${e.SEED_LENGTH} bytes`);const r=(0,n.hash)(t);r[0]&=248,r[31]&=127,r[31]|=64;const o=new Uint8Array(32),s=[i(),i(),i(),i()];P(s,r),S(o,s);const a=new Uint8Array(64);return a.set(t),a.set(o,32),{publicKey:o,secretKey:a}}e.generateKeyPairFromSeed=D,e.generateKeyPair=function(e){const n=(0,t.randomBytes)(32,e),i=D(n);return(0,r.wipe)(n),i},e.extractPublicKeyFromSecretKey=function(t){if(t.length!==e.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${e.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(t.subarray(32))};const k=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function I(e,t){let n,r,i,o;for(r=63;r>=32;--r){for(n=0,i=r-32,o=r-12;i<o;++i)t[i]+=n-16*t[r]*k[i-(r-32)],n=Math.floor((t[i]+128)/256),t[i]-=256*n;t[i]+=n,t[r]=0}for(n=0,i=0;i<32;i++)t[i]+=n-(t[31]>>4)*k[i],n=t[i]>>8,t[i]&=255;for(i=0;i<32;i++)t[i]-=n*k[i];for(r=0;r<32;r++)t[r+1]+=t[r]>>8,e[r]=255&t[r]}function x(e){const t=new Float64Array(64);for(let n=0;n<64;n++)t[n]=e[n];for(let n=0;n<64;n++)e[n]=0;I(e,t)}function M(e,t){const n=i(),r=i(),c=i(),l=i(),u=i(),f=i(),p=i();return d(e[2],s),w(e[1],t),_(c,e[1]),E(l,c,a),O(c,c,e[2]),b(l,e[2],l),_(u,l),_(f,u),E(p,f,u),E(n,p,c),E(n,n,l),N(n,n),E(n,n,c),E(n,n,l),E(n,n,l),E(e[0],n,l),_(r,e[0]),E(r,r,l),y(r,c)&&E(e[0],e[0],h),_(r,e[0]),E(r,r,l),y(r,c)?-1:(v(e[0])===t[31]>>7&&O(e[0],o,e[0]),E(e[3],e[0],e[1]),0)}e.sign=function(e,t){const r=new Float64Array(64),o=[i(),i(),i(),i()],s=(0,n.hash)(e.subarray(0,32));s[0]&=248,s[31]&=127,s[31]|=64;const a=new Uint8Array(64);a.set(s.subarray(32),32);const c=new n.SHA512;c.update(a.subarray(32)),c.update(t);const l=c.digest();c.clean(),x(l),P(o,l),S(a,o),c.reset(),c.update(a.subarray(0,32)),c.update(e.subarray(32)),c.update(t);const u=c.digest();x(u);for(let n=0;n<32;n++)r[n]=l[n];for(let n=0;n<32;n++)for(let e=0;e<32;e++)r[n+e]+=u[n]*s[e];return I(a.subarray(32),r),a},e.verify=function(t,r,o){const s=new Uint8Array(32),a=[i(),i(),i(),i()],c=[i(),i(),i(),i()];if(o.length!==e.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${e.SIGNATURE_LENGTH} bytes`);if(M(c,t))return!1;const l=new n.SHA512;l.update(o.subarray(0,32)),l.update(t),l.update(r);const u=l.digest();return x(u),T(a,c,u),P(c,o.subarray(32)),A(a,c),S(s,a),!m(o,s)},e.convertPublicKeyToX25519=function(e){let t=[i(),i(),i(),i()];if(M(t,e))throw new Error("Ed25519: invalid public key");let n=i(),r=i(),o=t[1];b(n,s,o),O(r,s,o),C(r,r),E(n,n,r);let a=new Uint8Array(32);return g(a,n),a},e.convertSecretKeyToX25519=function(e){const t=(0,n.hash)(e.subarray(0,32));t[0]&=248,t[31]&=127,t[31]|=64;const i=new Uint8Array(t.subarray(0,32));return(0,r.wipe)(t),i}}(_b)),_b)),c=tv(),l=cb(),u=s(lp()),h=i(ev()),d=ov();function f(t){return(0,c.safeJsonParse)((0,d.okxtoString)((0,d.okxfromString)(t,e.JWT_ENCODING),e.JSON_ENCODING))}function p(t){return(0,d.okxtoString)((0,d.okxfromString)((0,c.safeJsonStringify)(t),e.JSON_ENCODING),e.JWT_ENCODING)}function g(t){h.logDebug(`publicKey: ${(0,l.toHexString)(t)}`);var n=(0,d.okxtoString)(t,e.MULTICODEC_ED25519_ENCODING);return[e.DID_PREFIX,e.DID_METHOD,n].join(e.DID_DELIMITER)}function m(t){const[n,r,i]=t.split(e.DID_DELIMITER);if(n!==e.DID_PREFIX||r!==e.DID_METHOD)throw new Error('Issuer must be a DID with method "key"');if(void 0===i)throw new Error("multicodec is undefined");const o=(0,d.okxfromString)(i,e.MULTICODEC_ED25519_ENCODING);if(void 0===o||o.length!==e.MULTICODEC_ED25519_LENGTH)throw new Error("Issuer must be a public key with length 32 bytes");return o}function y(t){return(0,d.okxtoString)(t,e.JWT_ENCODING)}function v(t){return(0,d.okxfromString)(t,e.JWT_ENCODING)}function w(t){return(0,d.okxfromString)([p(t.header),p(t.payload)].join(e.JWT_DELIMITER),e.DATA_ENCODING)}function b(t){return[p(t.header),p(t.payload),y(t.signature)].join(e.JWT_DELIMITER)}function O(t){var n,r,i;const o=t.split(e.JWT_DELIMITER);return{header:f(null!==(n=o[0])&&void 0!==n?n:"{}"),payload:f(null!==(r=o[1])&&void 0!==r?r:"{}"),signature:v(null!==(i=o[2])&&void 0!==i?i:"{}"),data:(0,d.okxfromString)(o.slice(0,2).join(e.JWT_DELIMITER),e.DATA_ENCODING)}}e.JWTHeaderType="dapp",e.JWT_IRIDIUM_ALG="EdDSA",e.JWT_IRIDIUM_TYP="JWT",e.JWT_DELIMITER=".",e.JWT_ENCODING="base64url",e.JSON_ENCODING="utf8",e.DATA_ENCODING="utf8",e.KEY_PAIR_SEED_LENGTH=32,e.DID_DELIMITER=":",e.DID_PREFIX="did",e.DID_METHOD="key",e.MULTICODEC_ED25519_ENCODING="base58btc",e.MULTICODEC_ED25519_BASE="z",e.MULTICODEC_ED25519_HEADER="K36",e.MULTICODEC_ED25519_LENGTH=32}(Eb)),Eb}var Bb,jb,Hb={};function Wb(){if(Bb)return Hb;Bb=1;var e,t=Hb&&Hb.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=Hb&&Hb.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=Hb&&Hb.__importStar||(e=function(t){return(e=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t})(t)},function(r){if(r&&r.__esModule)return r;var i={};if(null!=r)for(var o=e(r),s=0;s<o.length;s++)"default"!==o[s]&&t(i,r,o[s]);return n(i,r),i}),i=Hb&&Hb.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})},o=Hb&&Hb.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Hb,"__esModule",{value:!0}),Hb.ConnectionSplitPackages=void 0;const s=rp(),a=o(zy()),c=cb(),l=tv(),u=r(ev()),h=ev(),d="ConnectionReceiveKey",f="ConnectionSendKey",p="ConnectionSenderVersionKey";return Hb.ConnectionSplitPackages=class{constructor(e){this.splitMessageSendArray=new Map,this.splitMessageReceivedArray=new Map,this.splitMessageSenderVersionMap=new Map,this.splitPackageCache=a.default.createInstance({name:s.OKXCONNECTOR_STORAGE_PROTOCOL_CACHE+e})}init(e){return i(this,void 0,void 0,function*(){if(yield this.recoverFromCache(),this.splitMessageSendArray.size>0){for(const[n,r]of this.splitMessageSendArray.entries())for(let i=0;i<r.length;){const o=r[i];try{yield e((0,l.safeJsonStringify)(o),n),u.logDebug(`Successfully sent payload: ${(0,l.safeJsonStringify)(o)} to topic: ${n}`),r.splice(i,1)}catch(t){u.logError(`Failed to send payload: ${(0,l.safeJsonStringify)(o)} to topic: ${n}`,t),o.retryCount=(o.retryCount||0)+1,o.retryCount>3?(u.logError(`Payload failed after 3 retries: ${(0,l.safeJsonStringify)(o)}`),r.splice(i,1)):i++}}yield this.syncCache()}})}tryParseMessageSplitPayload(e){var t;let n;try{if(e.trimStart().startsWith("{")){let r=(0,l.safeJsonParse)(e);if(r&&r.protocol_version&&r.protocol_version>=2){let e=r;e.package_group_id&&(null===(t=e.package_group_id)||void 0===t?void 0:t.length)>0&&(n=r)}}else(0,h.logDebug)("not split packages")}catch{(0,h.logDebug)("not split packages")}return n}updateTopicSenderVersion(e,t){return i(this,void 0,void 0,function*(){this.splitMessageSenderVersionMap.set(e,t),yield this.syncCache(),(0,h.logDebug)("get update topic sender version: ",e,t)})}sendSplitPackages(e,t,n,r){return i(this,void 0,void 0,function*(){if(!e)return void u.logError("sendSplitPackages invalid topic");let i=this.splitMessageSenderVersionMap.get(e),o=t.length;try{if(o<63e3)throw new Error(`no need to split (size:${o})`);if(!i||i&&i<2)throw new Error(`version not support split (version: ${i})`);const d=[];let f=63e3;for(let e=0;e<t.length;e+=f)e+f<t.length?d.push(t.slice(e,e+f)):d.push(t.slice(e));let p=(0,c.generateGroupId)(),g=d.map((t,n)=>({topicId:e,protocol_version:2,total_count:d.length,package_index:n,package_group_id:p,content:t}));this.mergePackageArray(!0,g);for(let t=0;t<g.length;){const n=g[t],i=(0,l.safeJsonStringify)(n);try{yield r(i,e),u.logDebug(`Successfully sent payload: ${i} to topic: ${e}`),g.splice(t,1)}catch(s){u.logError(`Failed to send payload: ${i} to topic: ${e}`,s),n.retryCount=(n.retryCount||0)+1,n.retryCount>3?(u.logError(`Payload failed after 3 retries: ${i}`),g.splice(t,1)):t++}}this.splitMessageSendArray.set(e,[]),yield this.syncCache()}catch(a){(0,h.logDebug)("send split packages no split"),(0,h.logDebug)(a),yield n(e,t)}})}onReceivedPackageCheck(e){return i(this,void 0,void 0,function*(){this.mergePackageArray(!1,[e]);let t=new Map,n=e.topicId;this.splitMessageReceivedArray.forEach((n,r)=>{r==e.topicId&&n.forEach(e=>{if(e.messageObject.package_group_id){let n=t.get(e.messageObject.package_group_id);n||(n=new Array),n.push(e),t.set(e.messageObject.package_group_id,n)}})}),(0,h.logDebug)("on received message, check message cache");let r={isSplitPackage:!1};if(e.messageObject.package_group_id){r.isSplitPackage=!0;let i=t.get(e.messageObject.package_group_id);if(null!=i&&i.length){let t=new Set;if(i.forEach(e=>{void 0!==e.messageObject.package_index&&t.add(e.messageObject.package_index)}),t.size==e.messageObject.total_count){i.sort((e,t)=>!e.messageObject.package_index&&0!==e.messageObject.package_index||!t.messageObject.package_index&&0!==t.messageObject.package_index?0:e.messageObject.package_index-t.messageObject.package_index);let e=i.reduce((e,t)=>(e.push(t.messageObject.content),e),[]),t=i.reduce((e,t)=>(e.push(t.messageId),e),[]);r.isSplitPackage=!0,r.finalMessage=e.join(""),r.completeMessageIdList=t;let o=this.splitMessageReceivedArray.get(n);o&&(o=o.filter(e=>!t.includes(e.messageId)),this.splitMessageReceivedArray.set(n,o)),yield this.syncCache()}}}return r})}mergePackageArray(e,t){return i(this,void 0,void 0,function*(){if((0,h.logDebug)("append sending array"),e){let e=t.filter(e=>{let t=e.topicId,n=!0,r=this.splitMessageSendArray.get(t);return null==r||r.forEach(t=>{t.package_group_id==e.package_group_id&&t.total_count==e.total_count&&t.package_index==e.package_index&&(n=!1)}),n});if(e.length>0){let t=e[0].topicId,n=this.splitMessageSendArray.get(t);n||(n=new Array),n=n.concat(e),this.splitMessageSendArray.set(t,n),(0,h.logDebug)("append sending array (after filted): ",n)}}else{let e=t.filter(e=>{let t=e.topicId,n=!0,r=this.splitMessageReceivedArray.get(t);return null==r||r.forEach(t=>{t.messageId==e.messageId&&(n=!1)}),n});if(e.length>0){let t=e[0].topicId,n=this.splitMessageReceivedArray.get(t);n||(n=new Array),n=n.concat(e),this.splitMessageReceivedArray.set(t,n),(0,h.logDebug)("append received array (after filted): ",n)}}})}syncCache(){return i(this,void 0,void 0,function*(){(0,h.logDebug)("sync split message cache"),yield this.splitPackageCache.setItem(d,this.splitMessageReceivedArray),yield this.splitPackageCache.setItem(f,this.splitMessageSendArray),yield this.splitPackageCache.setItem(p,this.splitMessageSenderVersionMap)})}recoverFromCache(){return i(this,void 0,void 0,function*(){let e=yield this.splitPackageCache.getItem(d);this.splitMessageReceivedArray=e||new Map;let t=yield this.splitPackageCache.getItem(f);this.splitMessageSendArray=t||new Map;let n=yield this.splitPackageCache.getItem(p);this.splitMessageSenderVersionMap=n||new Map})}},Hb}function Xb(){if(jb)return db;jb=1;var e,t=db&&db.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=db&&db.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=db&&db.__importStar||(e=function(t){return(e=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t})(t)},function(r){if(r&&r.__esModule)return r;var i={};if(null!=r)for(var o=e(r),s=0;s<o.length;s++)"default"!==o[s]&&t(i,r,o[s]);return n(i,r),i}),i=db&&db.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(db,"__esModule",{value:!0}),db.ConnectionManager=void 0;const o=ub(),s=pb(),a=rp(),c=yb(),l=ep(),u=oy(),h=lb(),d=cb(),f=bb(),p=Ub(),g=tv(),m=r(ev()),y=ev(),v=Qy(),w=xy(),b=Wb();return db.ConnectionManager=class{constructor(e){this.events=new u.EventEmitter,this.splitManager=new b.ConnectionSplitPackages("dapp"),this.connectorEnable=!1,this.connectStorage=new h.Storage(a.OKXCONNECTOR_CACHE_KEY_DAPP+e,a.OKXCONNECTOR_CACHE_KEY_DAPP),this.tonsdkConnectStorage=new h.Storage(a.OKXCONNECTOR_TON_KEY+e,a.OKXCONNECTOR_TON_KEY),this.crypto=new f.SessionCrypto;let t=(0,w.isInTMA)();if((0,y.logDebug)("do init:",t),m.reportLog("connection manager do init"),t)try{const e=this.getCachedCryptoKeyPair();(0,y.logDebug)("use same pk:",e),this.crypto=new f.SessionCrypto(e)}catch{this.connectStorage.clearCache(),m.reportEvent(v.OKXReportType.LOG,"cache_fail","cache failed")}this.jwtKeyPair=this.getCachedJWTKeyPair(),this.saveJWTKeyPair(this.jwtKeyPair),this.connector=new o.OKXWalletConnector(l.OKXCONNECTOR_WS_URL_1),this.packageId=Date.now(),this.connectedWalletPK="",this.currentTopic="",m.logDebug(`this.connectedWalletPK  constructor   ${this.connectedWalletPK}`)}refreshPackageId(){let e=Date.now();e==this.packageId&&(this.packageId=e+1),this.packageId=e}saveCryptoKeyPair(e){let t=(0,g.safeJsonStringify)(e);this.connectStorage.encryptStoreMsg(t,a.OKXCONNECTOR_CRYPTO_KEY)}getCachedCryptoKeyPair(){const e=this.connectStorage.getAndDecrypt(a.OKXCONNECTOR_CRYPTO_KEY);return"string"==typeof e?(m.logDebug("get cached crypto key:"),m.logDebug(e),(0,g.safeJsonParse)(e)):(this.connectStorage.clearCache(),null)}saveJWTKeyPair(e){var t={publicKey:(0,d.toHexString)(e.publicKey),secretKey:(0,d.toHexString)(e.secretKey)};m.logDebug("save jwt kp");let n=(0,g.safeJsonStringify)(t);m.logDebug(n),this.connectStorage.encryptStoreMsg(n,a.OKXCONNECTOR_JWT_KEY)}getCachedJWTKeyPair(){try{const e=this.connectStorage.getAndDecrypt(a.OKXCONNECTOR_JWT_KEY);if("string"==typeof e){m.logDebug("get cached jwt kp:"),m.logDebug(e);let t=(0,g.safeJsonParse)(e);return m.logDebug("save jwt kp"),m.logDebug(t),{publicKey:(0,d.hexToByteArray)(t.publicKey),secretKey:(0,d.hexToByteArray)(t.secretKey)}}return(0,p.generateKeyPair)()}catch{return m.reportEvent(v.OKXReportType.LOG,"cache_fail","cache failed"),(0,p.generateKeyPair)()}}isWalletPKReady(){return m.logDebug(`isWalletPKReady  ===> ${this.connectedWalletPK}`),this.connectedWalletPK.length>0}makeJWT(e){return i(this,void 0,void 0,function*(){return yield(0,p.signJWT)(e,c.OKXCONNECTOR_JWT_SIDE,c.OKXCONNECTOR_JWT_TTL,this.jwtKeyPair)})}parsePackage(e){return i(this,arguments,void 0,function*(e,t=!1){var n,r,o,c,l,u,h,d,f,p,g,m,v;if(this.events.emit(e.id,e),!t){yield this.sendACK(e.id,!0);let t=null===(n=this.connectStorage.getItem(a.OKXCONNECTOR_TOKEN_CACHE))||void 0===n?void 0:n.content;if(t){let n=e;if(null!==(o=null===(r=n.params)||void 0===r?void 0:r.data)&&void 0!==o&&o.messageId){n.method&&n.method===s.CONNECT_METHOD_PUSH&&((0,y.logDebug)("checkExpire: update expire when get push"),this.updateExpireLimit(t));let e=this.splitManager.tryParseMessageSplitPayload(null===(l=null===(c=n.params)||void 0===c?void 0:c.data)||void 0===l?void 0:l.message);if(e){let r={topicId:null===(h=null===(u=n.params)||void 0===u?void 0:u.data)||void 0===h?void 0:h.topic,messageId:null===(f=null===(d=n.params)||void 0===d?void 0:d.data)||void 0===f?void 0:f.messageId,messageObject:e,publishedAt:null===(g=null===(p=n.params)||void 0===p?void 0:p.data)||void 0===g?void 0:g.publishedAt},o=yield this.splitManager.onReceivedPackageCheck(r);o.completeMessageIdList&&o.completeMessageIdList.forEach(e=>i(this,void 0,void 0,function*(){this.refreshPackageId(),yield this.sendReceive(this.packageId.toString(),e,t)}))}else this.refreshPackageId(),yield this.sendReceive(this.packageId.toString(),null===(v=null===(m=n.params)||void 0===m?void 0:m.data)||void 0===v?void 0:v.messageId,t)}}}})}restoreConnect(e){return i(this,void 0,void 0,function*(){if(m.reportLog("connection manager restore connection"),m.logDebug(`connectionManager  restoreConenct   ${e}`),"string"!=typeof e||0===e.length)throw new Error("CONNECTION: invalid topic");m.logDebug("connectionManager  restoreConenct   disconnect"),yield this.disconnect(!0),this.connectStorage.saveContent(e,a.OKXCONNECTOR_TOKEN_CACHE),m.logDebug("connectionManager  restoreConenct   conect"),yield this.connect(!0)})}getConnectInfo(){var e=(0,d.generateTopic)();return m.logDebug(`generate topic token: ${e}`),m.reportLog("connection manager generate connection info"),this.currentTopic=e,{channelId:e,clientId:this.crypto.stringifyKeypair().publicKey}}connect(){return i(this,arguments,void 0,function*(e=!1){this.timeLog=(new Date).getTime(),(0,y.logDebug)("ConnectTime---enter->",this.timeLog),m.reportLog("connection manager begin connect");let t=this.connectStorage.getItem(a.OKXCONNECTOR_TOKEN_CACHE);var n=this.currentTopic;if(m.logDebug(`generate topic token: ${n}`),e){null!=t&&(m.logDebug(`read last connect id: ${t}`),n=t.content);var r=this.connectStorage.getItem(a.OKXCONNECTOR_CRYPTO_SENDER_PK_CACHE);r&&(this.connectedWalletPK=r.content,(0,y.logDebug)(`connectionManager connect() this.connectedWalletPK : ${this.connectedWalletPK}`)),m.reportLog("connection manager do restore connection")}if(e)try{const e=this.getCachedCryptoKeyPair();e&&(this.crypto=new f.SessionCrypto(e))}catch{throw m.logError("get crypto key pair from cache failed"),m.reportEvent(v.OKXReportType.LOG,"cache_fail","cache failed"),this.connectStorage.clearCache(),new Error("crypto cache failed")}m.logDebug(`use crypto client id: ${this.crypto.stringifyKeypair().publicKey}`),this.connectStorage.saveContent(n,a.OKXCONNECTOR_TOKEN_CACHE);var o=yield this.makeJWT(n);return m.logDebug(`generate jwt token: ${o}`),this.connectStorage.saveContent(o,"jwt"),new Promise((t,r)=>{this.connector.onOpen(()=>i(this,void 0,void 0,function*(){m.logDebug("1. connector on open"),m.reportLog("1. connect ws open");const c=(new Date).getTime();(0,y.logDebug)("ConnectTime---open->",c-this.timeLog),this.events.once(this.packageId.toString(),o=>i(this,void 0,void 0,function*(){if(o&&o.error){m.logError("failed when login"),m.reportLog("2. connect login failed"),yield this.connector.disconnect();var a=new Error;a.message=o.error.message,a.name=o.error.code.toString(),r(a)}this.refreshPackageId(),this.events.once(this.packageId.toString(),o=>i(this,void 0,void 0,function*(){if(o&&o.error){m.logError("failed when subscribe"),m.reportLog("3. connect subscribe failed"),yield this.connector.disconnect();var i=new Error;i.message=o.error.message,i.name=o.error.code.toString(),r(i)}this.refreshPackageId(),m.logDebug(`4. subscribe callback then send fetch: ${this.packageId}`),m.reportLog("4. subscribe callback then send fetch");const s=(new Date).getTime();(0,y.logDebug)("ConnectTime--subscribe callback->",s-this.timeLog),yield this.sendFetchAndConsumeMessages(this.packageId.toString(),n),m.logDebug(`5. splitmanager init: ${this.packageId}`),m.reportLog("5. splitmanager init"),yield this.splitManager.init(this.sendRaw.bind(this)),e&&(this.checkExpire(n)?((0,y.logDebug)("disconnect From topic expire"),setTimeout(()=>{this.activateDisconnect()},1e3)):((0,y.logDebug)("extends expire check"),this.updateExpireLimit(n))),t()})),m.logDebug(`3. login callback then send subscribe: ${this.packageId}`),m.reportLog("3. connect subscribe failed");const c=(new Date).getTime();(0,y.logDebug)("ConnectTime---login callback->",c-this.timeLog),yield this.connector.send(()=>i(this,void 0,void 0,function*(){m.logDebug("CONNECT: reconnect before send"),yield this.connector.connect().catch(e=>{(0,y.logDebug)("ConnectionManager connect error",e),r(e)})}),{id:this.packageId.toString(),jsonrpc:l.CONNECT_JSONRPC_VER,method:s.CONNECT_METHOD_SUB,params:{topic:n}})})),m.logDebug("2. login called"),m.reportLog("2. connection manager connect call login"),yield this.connector.send(()=>i(this,void 0,void 0,function*(){m.logDebug("CONNECT: reconnect before send"),yield this.connector.connect().catch(e=>{(0,y.logDebug)("ConnectionManager connect error",e),r(e)})}),{id:this.packageId.toString(),jsonrpc:l.CONNECT_JSONRPC_VER,method:s.CONNECT_METHOD_LOGIN,params:{token:o}}),this.connector.addPackageParse(e=>{var t;if(m.logDebug("connect: parse package"),m.logDebug(e),!("params"in e&&"data"in e.params))return void this.parsePackage(e,!0);let n=null===(t=e.params.data)||void 0===t?void 0:t.message;if(void 0!==n&&n.length>0){n=n.replace(/'/g,'"');let e=(0,g.safeJsonParse)(n);"string"!=typeof e&&"clientId"in e&&e.clientId&&e.clientId.length>0&&(this.connectedWalletPK=e.clientId,m.logDebug(`this.connectedWalletPK  addPackageParse   ${this.connectedWalletPK}`),this.connectStorage.saveContent(this.connectedWalletPK,a.OKXCONNECTOR_CRYPTO_SENDER_PK_CACHE),this.saveCryptoKeyPair(this.crypto.stringifyKeypair()))}this.parsePackage(e,e.method===s.CONNECT_METHOD_RECEIVE)})})),this.connector.connect().catch(e=>{(0,y.logDebug)("ConnectionManager connect error",e),r(e)}),this.connectorEnable=!0})})}sendSubscribe(e){return i(this,void 0,void 0,function*(){this.refreshPackageId(),yield this.connector.send(()=>i(this,void 0,void 0,function*(){}),{id:this.packageId.toString(),jsonrpc:l.CONNECT_JSONRPC_VER,method:s.CONNECT_METHOD_SUB,params:{topic:e}})})}sendDisconnect(e){return i(this,void 0,void 0,function*(){return new Promise(t=>i(this,void 0,void 0,function*(){if(this.refreshPackageId(),!this.connectorEnable)return m.logDebug("skip disconnect before connected relay"),void t();this.events.once(this.packageId.toString(),()=>i(this,void 0,void 0,function*(){m.logDebug("CONNECT: disconnect command send"),this.connectorEnable=!1,t()}));const n={id:this.packageId.toString(),jsonrpc:l.CONNECT_JSONRPC_VER,method:s.CONNECT_METHOD_DISCONNECT,params:{message:{topic:e,ttl:l.OKXCONNECTOR_MESSAGE_DISCONNECT_TTL}}};yield this.connector.send(()=>i(this,void 0,void 0,function*(){m.logDebug("CONNECT: skip reconnect send")}),n)}))})}sendRecvDisconnect(e){return i(this,void 0,void 0,function*(){this.refreshPackageId();const t={id:this.packageId.toString(),jsonrpc:l.CONNECT_JSONRPC_VER,method:s.CONNECT_METHOD_RECV_DISCONNECT,params:{topic:e}};yield this.connector.send(()=>i(this,void 0,void 0,function*(){return m.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}),t)})}disconnect(){return i(this,arguments,void 0,function*(e=!1){try{yield this.sendDisconnect(this.currentTopic)}catch(t){m.logError("send disconnect command failed",t)}yield this.connector.disconnect(),m.reportLog("connect disconnect"),this.connectStorage.clearCache(a.OKXCONNECTOR_TOKEN_CACHE),e||(this.connectStorage.clearCache(a.OKXCONNECTOR_CRYPTO_SENDER_PK_CACHE),this.connectedWalletPK="",(0,y.logDebug)(`connectionManager disconnect() this.connectedWalletPK : ${this.connectedWalletPK}`))})}updateProtocolVersion(e,t){this.splitManager.updateTopicSenderVersion(e,t)}addListener(e,t,n){this.connector.addListener((0,g.safeJsonStringify)(e),e=>{if(e=e.replace(/'/g,'"'),m.logDebug(`addListener ===> ${e}`),void 0!==e&&e.length>0){var t=(0,g.safeJsonParse)(e),n=t.message;let r;return n.trimStart().startsWith("{")?r=n:(t.clientId&&t.clientId.length>0&&(this.connectedWalletPK=t.clientId,this.connectStorage.saveContent(this.connectedWalletPK,a.OKXCONNECTOR_CRYPTO_SENDER_PK_CACHE),m.logDebug(`this.connectedWalletPK  addListener   ${this.connectedWalletPK}`),m.logDebug(`this.cryptoKey  addListener   ${(0,d.toHexString)(this.crypto.keyPair.publicKey)}`),this.saveCryptoKeyPair(this.crypto.stringifyKeypair())),r=this.crypto.decrypt(n,this.connectedWalletPK)),m.logDebug(`addListener ===> ${r}`),r}},t,n,e=>new Promise(t=>i(this,void 0,void 0,function*(){let n=this.splitManager.tryParseMessageSplitPayload(e.message);if(n){let r={topicId:e.topic,messageId:null==e?void 0:e.messageId,messageObject:n,publishedAt:null==e?void 0:e.publishedAt},i=yield this.splitManager.onReceivedPackageCheck(r);t(i)}else t({isSplitPackage:!1})})))}sendRaw(e){return i(this,void 0,void 0,function*(){m.logDebug(`message send =====> ${e}`),m.reportLog("connect send raw msg");let t=e;m.logDebug(`message send =====encrypt message.length>>>> ${t.length}`);let n=this.connectStorage.getItem(a.OKXCONNECTOR_TOKEN_CACHE);m.logDebug(`message send =====topic>>>> ${null==n?void 0:n.content}`),this.refreshPackageId();const r={id:this.packageId.toString(),method:s.CONNECT_METHOD_PUBLISH,jsonrpc:l.CONNECT_JSONRPC_VER,params:{message:{topic:null==n?void 0:n.content,message:t,ttl:l.OKXCONNECTOR_MESSAGE_TTL}}};return this.events.once(this.packageId.toString(),e=>i(this,void 0,void 0,function*(){e&&e.error?m.logError(`@${(new Date).toUTCString()} >>> failed when send msg`):e&&!e.error&&m.logDebug(`CONNECTION @[${(new Date).toUTCString()}] >>> send msg with id ${this.packageId} successed`)})),yield this.connector.send(()=>i(this,void 0,void 0,function*(){return m.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}),r),this.packageId})}sendEncryptedMsg(e,t){return i(this,arguments,void 0,function*(e,t,n=l.OKXCONNECTOR_MESSAGE_TTL){this.refreshPackageId();const r={id:this.packageId.toString(),method:s.CONNECT_METHOD_PUBLISH,jsonrpc:l.CONNECT_JSONRPC_VER,params:{message:{topic:e,message:t,ttl:n}}};this.events.once(this.packageId.toString(),e=>i(this,void 0,void 0,function*(){e&&e.error?m.logError(`@${(new Date).toUTCString()} >>> failed when send msg`):e&&!e.error&&m.logDebug(`CONNECTION @[${(new Date).toUTCString()}] >>> send msg with id ${this.packageId} successed`)})),yield this.connector.send(()=>i(this,void 0,void 0,function*(){return m.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}),r)})}send(e){return i(this,arguments,void 0,function*(e){if(m.logDebug(`message send =====> ${e}`),m.reportLog("connect send msg"),!this.isWalletPKReady())throw new Error("connection not finish");let t=this.crypto.encrypt(e,this.connectedWalletPK);m.logDebug(`message send =====encrypt message.length>>>> ${t.length}`),m.reportEvent(v.OKXReportType.LOG,"msg_size",t.length.toString());let n=this.connectStorage.getItem(a.OKXCONNECTOR_TOKEN_CACHE);return m.logDebug(`message send =====topic>>>> ${null==n?void 0:n.content}`),yield this.splitManager.sendSplitPackages(null==n?void 0:n.content,t,this.sendEncryptedMsg.bind(this),this.sendRaw.bind(this)),this.packageId})}sendACK(e,t){return i(this,arguments,void 0,function*(e,t,n){if(!0===t){const t={id:e,jsonrpc:l.CONNECT_JSONRPC_VER,result:!0};yield this.connector.send(()=>i(this,void 0,void 0,function*(){return m.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}),t)}else if(n){const t={id:e,jsonrpc:l.CONNECT_JSONRPC_VER,error:{code:n.code,message:n.message}};yield this.connector.send(()=>i(this,void 0,void 0,function*(){return m.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}),t)}})}sendReceive(e,t,n){return i(this,void 0,void 0,function*(){const r={id:e,jsonrpc:l.CONNECT_JSONRPC_VER,method:s.CONNECT_METHOD_RECEIVE,params:{data:{messageId:t,topic:n}}};yield this.connector.send(()=>i(this,void 0,void 0,function*(){return m.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}),r)})}sendFetchAndConsumeMessages(e,t){return i(this,void 0,void 0,function*(){this.events.once(e,e=>i(this,void 0,void 0,function*(){var n,r;if(e.result){var i=e.result.hasMore,o=e.result.data;const n=e.result.disconnectedTopics;if(n)try{for(let e=0;e<n.length;e++){const t=n[e];if(t.topic){(0,y.logDebug)("send receive disconnect:",t.topic),yield this.sendRecvDisconnect(t.topic);let e=(0,g.safeJsonStringify)({requestId:t.publishedAt.toString(),method:"disconnect"}),n={messageId:t.publishedAt.toString(),message:(0,g.safeJsonStringify)({message:e}),topic:t.topic,publishedAt:t.publishedAt};yield this.connector.getMsgPayloadFromHistory(n)}}}catch(s){m.logError("disconnect topic fails",s)}if(o)for(let e=0;e<o.length;e++){let n=o[e];if(n&&n.topic==t){let e=n.messageId;m.reportLog("5. get fetch result"),this.splitManager.tryParseMessageSplitPayload(n.message)?(yield this.connector.getMsgPayloadFromHistory(n),m.logDebug("skip receive")):(yield this.connector.getMsgPayloadFromHistory(n),this.refreshPackageId(),yield this.sendReceive(this.packageId.toString(),e,t))}}i&&(this.refreshPackageId(),yield this.sendFetchAndConsumeMessages(this.packageId.toString(),t))}else m.logDebug(`CONNECT: get error rsp ${null===(n=e.error)||void 0===n?void 0:n.code} : ${null===(r=e.error)||void 0===r?void 0:r.message}`)})),m.logDebug("5. send fetch more"),m.reportLog("5. send fetch more");const n=(new Date).getTime();(0,y.logDebug)("ConnectTime---5->",n-this.timeLog);const r={id:e,jsonrpc:l.CONNECT_JSONRPC_VER,method:s.CONNECT_METHOD_FETCHMSG,params:{data:{topic:t}}};yield this.connector.send(()=>i(this,void 0,void 0,function*(){return m.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}),r)})}cleanCache(){m.reportLog("connection cache clean called"),this.connectStorage.clearCache()}saveSessionContent(e,t){t||this.connectStorage.clearCache(a.OKXCONNECTOR_SESSION_PREFIX_KEY+e);let n=(0,g.safeJsonStringify)(t);this.connectStorage.encryptStoreMsg(n,a.OKXCONNECTOR_SESSION_PREFIX_KEY+e)}getSessionContent(e){try{let t=this.connectStorage.getAndDecrypt(a.OKXCONNECTOR_SESSION_PREFIX_KEY+e);if(t)return(0,g.safeJsonParse)(t)}catch{this.connectStorage.clearCache(a.OKXCONNECTOR_SESSION_PREFIX_KEY+e)}}getCurrentConnectionReady(){let e=!1;try{this.getCachedCryptoKeyPair()&&(e=!0)}catch{m.logError("check connection ready failed")}return this.isWalletPKReady()&&e}getCryptoKeyEnable(){let e=!1;try{this.getCachedCryptoKeyPair()&&(e=!0)}catch{m.logError("check connection ready failed")}return e}checkExpire(e){let t=!1;if(0==e.length)return(0,y.logDebug)("checkExpire: invalid topic"),t;let n=this.getSessionContent(a.OKXCONNECTOR_STORAGE_TOPIC_EXPIRE_CACHE);return n&&n.topic?n.topic==e?Date.now()>n.timestamp&&((0,y.logDebug)("checkExpire: connection is Expired"),t=!0):((0,y.logDebug)("checkExpire: not same connection"),t=!1):((0,y.logDebug)("checkExpire: not topic records"),this.updateExpireLimit(e),t=!1),t}updateExpireLimit(e){(0,y.logDebug)(`update expire limit for topic: ${e}`);let t={topic:e,timestamp:Date.now()+l.OKXCONNECTOR_SESSION_LIVE_TTL};this.saveSessionContent(a.OKXCONNECTOR_STORAGE_TOPIC_EXPIRE_CACHE,t)}activateDisconnect(){return i(this,void 0,void 0,function*(){let e=(0,g.safeJsonStringify)({requestId:"",method:"disconnect"}),t={messageId:"",message:(0,g.safeJsonStringify)({message:e}),topic:this.currentTopic,publishedAt:0};yield this.connector.getMsgPayloadFromHistory(t)})}},db}var Fb,Jb,Gb={},qb={};function Vb(){if(Jb)return Gb;Jb=1;var e,t=Gb&&Gb.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=Gb&&Gb.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=Gb&&Gb.__importStar||(e=function(t){return(e=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t})(t)},function(r){if(r&&r.__esModule)return r;var i={};if(null!=r)for(var o=e(r),s=0;s<o.length;s++)"default"!==o[s]&&t(i,r,o[s]);return n(i,r),i}),i=Gb&&Gb.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(Gb,"__esModule",{value:!0}),Gb.WalletConnectionManager=void 0;const o=ub(),s=pb(),a=rp(),c=yb(),l=ep(),u=(Fb||(Fb=1,Object.defineProperty(qb,"__esModule",{value:!0}),qb.WalletConnectionManagerEvent=qb.WalletConnectionManagerTopicInfoCacheKey=void 0,qb.WalletConnectionManagerTopicInfoCacheKey="wcmtic",qb.WalletConnectionManagerEvent={RECEIVE_REQUEST:"payload"}),qb),h=Wb(),d=oy(),f=lb(),p=cb(),g=bb(),m=Ub(),y=tv(),v=r(ev()),w=ev(),b=Jy();return Gb.WalletConnectionManager=class{constructor(){this.events=new d.EventEmitter,this.communicateEvents=new d.EventEmitter,this.splitManager=new h.ConnectionSplitPackages("wallet"),v.logDebug("connect manager construct"),this.connectStorage=new f.Storage(a.OKXCONNECTOR_CACHE_KEY),this.jwtKeyPair=this.getCachedJWTKeyPair(),this.saveJWTKeyPair(this.jwtKeyPair),this.connector=new o.OKXWalletConnector(l.OKXCONNECTOR_WS_URL_1),this.packageId=Date.now(),this.sessionCryptoInfoMap=new Map,this.inLogin=!1,this.isLogined=!1}refreshPackageId(e=0){let t=Date.now()+e;t==this.packageId&&(this.packageId=t+1),this.packageId=t}saveCryptoKeyPair(e,t){let n=(0,y.safeJsonStringify)(t);this.connectStorage.encryptStoreMsg(n,a.OKXCONNECTOR_CRYPTO_KEY+e)}getCachedCryptoKeyPair(e){const t=this.connectStorage.getAndDecrypt(a.OKXCONNECTOR_CRYPTO_KEY+e);return"string"==typeof t?(v.logDebug("get cached crypto key:"),v.logDebug(t),(0,y.safeJsonParse)(t)):(this.connectStorage.clearCache(),null)}saveJWTKeyPair(e){var t={publicKey:(0,p.toHexString)(e.publicKey),secretKey:(0,p.toHexString)(e.secretKey)};v.logDebug("save jwt kp");let n=(0,y.safeJsonStringify)(t);v.logDebug(n),this.connectStorage.encryptStoreMsg(n,a.OKXCONNECTOR_JWT_KEY),v.logDebug("after save jwt kp")}getCachedJWTKeyPair(){const e=this.connectStorage.getAndDecrypt(a.OKXCONNECTOR_JWT_KEY);if("string"==typeof e){v.logDebug("get cached jwt kp:"),v.logDebug(e);let t=(0,y.safeJsonParse)(e);return v.logDebug("save jwt kp"),v.logDebug(t),{publicKey:(0,p.hexToByteArray)(t.publicKey),secretKey:(0,p.hexToByteArray)(t.secretKey)}}return(0,m.generateKeyPair)()}isTopicPublicKeyExist(e){return v.logDebug(`isTopicPublicKeyExist  ===> ${e}`),this.sessionCryptoInfoMap.get(e)}makeJWT(e){return i(this,void 0,void 0,function*(){return yield(0,m.signJWT)(e,c.OKXCONNECTOR_JWT_WALLET_SIDE,c.OKXCONNECTOR_JWT_TTL,this.jwtKeyPair)})}parseInternalMsg(e){try{let n=(0,y.safeJsonParse)(e)["ivur-igbfft-ptjip"];if(n&&n.length>0)return(0,b.base64decode)(n,!0).toString()}catch(t){v.logError("parse internal msg",t)}}updateClientId(e,t){let n=this.sessionCryptoInfoMap.get(e);if((0,w.logDebug)("updateClientId",n,e,t),n&&t&&t.length>0){if(n.cid){let r=(0,p.getLastSixMd5Hash)(t);n.cid==r?n.dappPublicKey=t:v.logError("cid check failed",n,e,t)}else n.dappPublicKey=t;this.syncCacheSessionInfo()}return!1}parsePackage(e,t){return i(this,arguments,void 0,function*(e,t,n=!1){var r,o,a,c,l,u,h,d,f,p,g,m,O,E,_,C,N;this.events.emit(t.id,t);let A=this.sessionCryptoInfoMap.get(e);v.logDebug("get sessionInfo for decrypt topic:",e),v.logDebug("get sessionInfo for decrypt:",t.id,e,A,this.sessionCryptoInfoMap);let R=!1;if(A&&t.params.data&&null!==(r=t.params.data)&&void 0!==r&&r.message)if(null!==(o=t.params.data)&&void 0!==o&&o.isInternalData){let e=null===(a=t.params.data)||void 0===a?void 0:a.message,n=null===(c=t.params.data)||void 0===c?void 0:c.topic,r=this.parseInternalMsg(e);(0,w.logDebug)("parse internal origin: ",r),r&&r.length>0&&this.communicateEvents.emit("origin",r,n)}else try{let n=null===(l=t.params.data)||void 0===l?void 0:l.message;if(t.method&&t.method===s.CONNECT_METHOD_PUSH&&((0,w.logDebug)("checkExpire: update expire when get push"),this.updateExpireLimit(e)),n.trimStart().startsWith("{")){let r=this.splitManager.tryParseMessageSplitPayload(n);if(r){(0,w.logDebug)("parse split msg object: ",r),R=!0;let n={topicId:null===(h=null===(u=t.params)||void 0===u?void 0:u.data)||void 0===h?void 0:h.topic,messageId:null===(f=null===(d=t.params)||void 0===d?void 0:d.data)||void 0===f?void 0:f.messageId,messageObject:r,publishedAt:null===(g=null===(p=t.params)||void 0===p?void 0:p.data)||void 0===g?void 0:g.publishedAt},o=yield this.splitManager.onReceivedPackageCheck(n);if(o.completeMessageIdList&&o.completeMessageIdList.forEach(t=>i(this,void 0,void 0,function*(){this.refreshPackageId(),yield this.sendReceive(this.packageId.toString(),t,e)})),o.finalMessage){let t=A.crypto.decryptWallet(o.finalMessage,A.dappPublicKey);(0,w.logDebug)("<<< receive msg from split:",e,t),this.communicateEvents.emit(e,t)}}else{let t=(0,y.safeJsonParse)(n);if(t.method){if("session_info"==t.method){let n=t.params.sessionInfo,r=(0,b.base64decode)(n,!1);(0,w.logDebug)("wallet connection manager requset base64Content:",r),(0,w.logDebug)("base64Content:"+r);let i=r.toObject();this.updateClientId(e,i.clientId)}(0,w.logDebug)("<<< parse raw msg:",e,t),this.communicateEvents.emit(e,n)}}}else{let n=A.crypto.decryptWallet(null===(m=t.params.data)||void 0===m?void 0:m.message,A.dappPublicKey);(0,w.logDebug)("<<< receive msg:",e,n),this.communicateEvents.emit(e,n)}}catch{let n=A.crypto.decryptWallet(null===(O=t.params.data)||void 0===O?void 0:O.message,A.dappPublicKey);(0,w.logDebug)("<<< receive msg:",e,n),this.communicateEvents.emit(e,n)}if(!n&&(yield this.sendACK(t.id,!0),e&&!R)){let n=t;null!==(_=null===(E=n.params)||void 0===E?void 0:E.data)&&void 0!==_&&_.messageId&&(this.refreshPackageId(),yield this.sendReceive(this.packageId.toString(),null===(N=null===(C=n.params)||void 0===C?void 0:C.data)||void 0===N?void 0:N.messageId,e))}})}recovrySessionInfoFromCache(){let e=this.connectStorage.getAndDecrypt(u.WalletConnectionManagerTopicInfoCacheKey);if(v.logDebug("get cached sessionInfos:",e),e){let t=(0,y.safeJsonParse)(e);for(let e in t){let n=t[e];v.logDebug("make topicItem:",n);let r={topic:e,crypto:new g.SessionCrypto({publicKey:n.cryptoKeyPair.publicKey,secretKey:n.cryptoKeyPair.secretKey}),dappPublicKey:n.dappPublicKey,cid:n.cid};this.sessionCryptoInfoMap.set(e,r)}}v.logDebug("get cached sessionInfos map:",this.sessionCryptoInfoMap)}syncCacheSessionInfo(){let e={};for(let[n,r]of this.sessionCryptoInfoMap)v.logDebug("for each Keys",n),r&&(e[n]={cryptoKeyPair:r.crypto.stringifyKeypair(),dappPublicKey:r.dappPublicKey,cid:r.cid});let t=(0,y.safeJsonStringify)(e);v.logDebug("sync cache sessionInfos:",t),this.connectStorage.encryptStoreMsg(t,u.WalletConnectionManagerTopicInfoCacheKey)}cacheSessionInfo(e,t,n=!0){let r=t.dappPublicKey,i=[];for(let[o,s]of this.sessionCryptoInfoMap)v.logDebug("for each Keys",o),s.dappPublicKey==r&&(v.logDebug("duplicated dapp public key:",o,r),i.push(o));for(let[o,s]of this.sessionCryptoInfoMap)i.includes(o)&&this.sessionCryptoInfoMap.delete(o);return v.logDebug("cleaned connect session cache:",this.sessionCryptoInfoMap),this.sessionCryptoInfoMap.set(e,t),v.logDebug("cache sessionInfo:",e,t,this.sessionCryptoInfoMap),n&&this.syncCacheSessionInfo(),i}updateProtocolVersion(e,t){this.splitManager.updateTopicSenderVersion(e,t)}appendTopic(e,t,n){return i(this,void 0,void 0,function*(){return(0,w.logDebug)("4.1. get append Topic:",e),new Promise((r,o)=>i(this,void 0,void 0,function*(){if(!this.isLogined){var i=new Error;return i.message="connection is not logined",i.name="append error",void o(i)}let s={topic:e,crypto:new g.SessionCrypto,dappPublicKey:t||"",cid:n},a=this.cacheSessionInfo(e,s,!1);yield this.subscribeTopics(Array.from([e])),this.refreshPackageId(),v.logDebug(`5. subscribe callback then fetch append message: ${this.packageId}, ${e}`),v.reportLog("5. subscribe callback then fetch append message");const c=(new Date).getTime();(0,w.logDebug)("Append --subscribe callback->",c-this.timeLog),r(a)}))})}confirmAppendingTopics(){this.syncCacheSessionInfo()}connect(){return i(this,void 0,void 0,function*(){this.timeLog=(new Date).getTime(),(0,w.logDebug)("[Wallet] ConnectTime---enter->",this.timeLog),v.reportLog("wallet connect connect called");let e=Date.now().toString();var t=yield this.makeJWT(e);return v.logDebug(`generate jwt token: ${t}`),this.connectStorage.saveContent(t,"jwt"),this.recovrySessionInfoFromCache(),new Promise((e,n)=>{this.inLogin=!0,this.connector.onOpen(()=>i(this,void 0,void 0,function*(){v.logDebug("1. connector on open"),v.reportLog("1. wallet connect connect on open");const r=(new Date).getTime();(0,w.logDebug)("ConnectTime---open->",r-this.timeLog),this.events.once(this.packageId.toString(),t=>i(this,void 0,void 0,function*(){if(t&&t.error){v.logError("failed when login"),yield this.connector.disconnect();var r=new Error;r.message=t.error.message,r.name=t.error.code.toString(),n(r)}else this.isLogined=!0,e(),v.logDebug("3. subscribe cached topics",this.sessionCryptoInfoMap),v.reportLog("3. wallet connect connect subscribe cached topics"),this.sessionCryptoInfoMap.size>0&&(yield this.subscribeTopics(Array.from(this.sessionCryptoInfoMap.keys())))})),v.logDebug("2. login called"),v.reportLog("2. wallet connect login called"),yield this.connector.send(()=>i(this,void 0,void 0,function*(){return v.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}),{id:this.packageId.toString(),jsonrpc:l.CONNECT_JSONRPC_VER,method:s.CONNECT_METHOD_LOGIN,params:{token:t}})})),this.connector.connect().catch(e=>{(0,w.logDebug)("WalletConnectionManager connect error",e),n(e)}),this.connector.addPackageParse(e=>{var t,n;v.logDebug("connect: parse package"),v.logDebug(e),"params"in e&&"data"in e.params?null!==(t=e.params.data)&&void 0!==t&&t.topic&&this.parsePackage(null===(n=e.params.data)||void 0===n?void 0:n.topic,e,e.method===s.CONNECT_METHOD_RECEIVE):this.parsePackage("",e,!0)})})})}getSessionPublicKey(e){if(this.isTopicPublicKeyExist(e)){let t=this.sessionCryptoInfoMap.get(e);if(t)return(0,p.toHexString)(t.crypto.keyPair.publicKey)}}getCurrentCachedTopicIdList(){return Array.from(this.sessionCryptoInfoMap.keys())}sendDisconnect(e){return i(this,void 0,void 0,function*(){this.refreshPackageId();const t={id:this.packageId.toString(),jsonrpc:l.CONNECT_JSONRPC_VER,method:s.CONNECT_METHOD_DISCONNECT,params:{message:{topic:e,ttl:l.OKXCONNECTOR_MESSAGE_DISCONNECT_TTL}}};yield this.connector.send(()=>i(this,void 0,void 0,function*(){return v.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}),t)})}sendRecvDisconnect(e){return i(this,void 0,void 0,function*(){this.refreshPackageId();const t={id:this.packageId.toString(),jsonrpc:l.CONNECT_JSONRPC_VER,method:s.CONNECT_METHOD_RECV_DISCONNECT,params:{topic:e}};yield this.connector.send(()=>i(this,void 0,void 0,function*(){return v.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}),t)})}disconnect(){return i(this,arguments,void 0,function*(e=!1){yield this.connector.disconnect(),this.connectStorage.clearCache(a.OKXCONNECTOR_TOKEN_CACHE),e||this.connectStorage.clearCache(a.OKXCONNECTOR_CRYPTO_SENDER_PK_CACHE)})}sendRaw(e,t){return i(this,void 0,void 0,function*(){t&&(yield this.sendMsg(t,e,l.OKXCONNECTOR_MESSAGE_TTL))})}sendMsg(e,t,n){return i(this,void 0,void 0,function*(){if(t){this.refreshPackageId();const r={id:this.packageId.toString(),method:s.CONNECT_METHOD_PUBLISH,jsonrpc:l.CONNECT_JSONRPC_VER,params:{message:{topic:e,message:t,ttl:n}}};this.events.once(this.packageId.toString(),e=>i(this,void 0,void 0,function*(){e&&e.error?v.logError(`@${(new Date).toUTCString()} >>> failed when send msg`):e&&!e.error&&v.logDebug(`CONNECTION @[${(new Date).toUTCString()}] >>> send msg with id ${this.packageId} successed`)})),yield this.connector.send(()=>i(this,void 0,void 0,function*(){return v.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}),r)}})}send(e,t){return i(this,arguments,void 0,function*(e,t,n=!1,r=l.OKXCONNECTOR_MESSAGE_TTL,i=!1){var o,s;if(v.logDebug(`message send =====> ${t}`),!this.isTopicPublicKeyExist(e))throw new Error("connection not finish");let a,c=null===(o=this.sessionCryptoInfoMap.get(e))||void 0===o?void 0:o.dappPublicKey,u=null===(s=this.sessionCryptoInfoMap.get(e))||void 0===s?void 0:s.crypto;i&&(a={message:t});let h=!1;if(u&&c&&!i&&(h=!0,a={message:u.encryptWallet(t,c)}),a){n&&u&&(a.clientId=(0,p.toHexString)(u.keyPair.publicKey));let t=(0,y.safeJsonStringify)(a);!i&&h?yield this.splitManager.sendSplitPackages(e,t,this.sendMsg.bind(this),this.sendRaw.bind(this)):yield this.sendMsg(e,t,r)}})}sendACK(e,t){return i(this,arguments,void 0,function*(e,t,n){if(!0===t){const t={id:e,jsonrpc:l.CONNECT_JSONRPC_VER,result:!0};yield this.connector.send(()=>i(this,void 0,void 0,function*(){return v.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}),t)}else if(n){const t={id:e,jsonrpc:l.CONNECT_JSONRPC_VER,error:{code:n.code,message:n.message}};yield this.connector.send(()=>i(this,void 0,void 0,function*(){return v.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}),t)}})}sendReceive(e,t,n){return i(this,void 0,void 0,function*(){const r={id:e,jsonrpc:l.CONNECT_JSONRPC_VER,method:s.CONNECT_METHOD_RECEIVE,params:{data:{messageId:t,topic:n}}};yield this.connector.send(()=>i(this,void 0,void 0,function*(){return v.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}),r)})}sendUnsubscribe(e){return i(this,void 0,void 0,function*(){yield this.connector.send(()=>i(this,void 0,void 0,function*(){return v.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}),{id:this.packageId.toString(),jsonrpc:l.CONNECT_JSONRPC_VER,method:s.CONNECT_METHOD_UNSUB,params:{topic:e}});try{yield this.sendDisconnect(e)}catch(t){v.logError("send disconnect command failed",t)}this.sessionCryptoInfoMap.delete(e),this.syncCacheSessionInfo()})}sendFetchAndConsumeMessages(e,t){return i(this,void 0,void 0,function*(){this.events.once(e,e=>i(this,void 0,void 0,function*(){var n,r;if(e.result){var i=e.result.hasMore,o=e.result.data;if(o)for(let e=0;e<o.length;e++){let n=o[e];if(n&&n.topic==t){let e=n.messageId;yield this.connector.getMsgPayloadFromHistory(n),this.refreshPackageId(),yield this.sendReceive(this.packageId.toString(),e,t)}}i&&(this.refreshPackageId(),yield this.sendFetchAndConsumeMessages(this.packageId.toString(),t))}else v.logDebug(`CONNECT: get error rsp ${null===(n=e.error)||void 0===n?void 0:n.code} : ${null===(r=e.error)||void 0===r?void 0:r.message}`)})),v.logDebug("5. send fetch more");const n=(new Date).getTime();(0,w.logDebug)("ConnectTime---5->",n-this.timeLog);const r={id:e,jsonrpc:l.CONNECT_JSONRPC_VER,method:s.CONNECT_METHOD_FETCHMSG,params:{data:{topic:t}}};yield this.connector.send(()=>i(this,void 0,void 0,function*(){return v.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}),r)})}sendBatchFetchAndConsumeMessages(e,t){return i(this,void 0,void 0,function*(){this.events.once(e,e=>i(this,void 0,void 0,function*(){var n,r;if(e.result){var i=e.result.hasMore,o=e.result.data;const n=e.result.disconnectedTopics;if(n)try{for(let e=0;e<n.length;e++){const t=n[e];if(t.topic){(0,w.logDebug)("send receive disconnect:",t.topic),yield this.sendRecvDisconnect(t.topic);let e=(0,y.safeJsonStringify)({requestId:t.publishedAt.toString(),method:s.CONNECT_METHOD_DISCONNECT}),n={messageId:t.publishedAt.toString(),message:(0,y.safeJsonStringify)({message:e}),topic:t.topic,publishedAt:t.publishedAt};yield this.connector.getMsgPayloadFromHistory(n)}}}catch(a){v.logError("disconnect topic fails",a)}if(o)for(let e=0;e<o.length;e++){let t=o[e];if(t&&t.topic)if(this.splitManager.tryParseMessageSplitPayload(t.message))yield this.connector.getMsgPayloadFromHistory(t);else{let n=t.messageId;yield this.connector.getMsgPayloadFromHistory(t),this.refreshPackageId(e),yield this.sendReceive(this.packageId.toString(),n,t.topic)}}i&&(this.refreshPackageId(),yield this.sendBatchFetchAndConsumeMessages(this.packageId.toString(),t))}else v.logDebug(`CONNECT: get error rsp ${null===(n=e.error)||void 0===n?void 0:n.code} : ${null===(r=e.error)||void 0===r?void 0:r.message}`)})),v.logDebug("5. send fetch more"),v.reportLog("5. send fetch more");const n=(new Date).getTime();(0,w.logDebug)("ConnectTime---5->",n-this.timeLog);const r={id:e,jsonrpc:l.CONNECT_JSONRPC_VER,method:s.CONNECT_METHOD_BATCH_FETCHMSG,params:{topics:t,withInternalData:!0}};yield this.connector.send(()=>i(this,void 0,void 0,function*(){v.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}),r)})}cleanCache(){return i(this,void 0,void 0,function*(){this.connectStorage.clearCache()})}saveSessionContent(e,t){t||this.connectStorage.clearCache(a.OKXCONNECTOR_SESSION_PREFIX_KEY+e);let n=(0,y.safeJsonStringify)(t);this.connectStorage.encryptStoreMsg(n,a.OKXCONNECTOR_SESSION_PREFIX_KEY+e)}getSessionContent(e){let t=this.connectStorage.getAndDecrypt(a.OKXCONNECTOR_SESSION_PREFIX_KEY+e);if(t)return(0,y.safeJsonParse)(t)}subscribeTopics(e){return i(this,void 0,void 0,function*(){(0,w.logDebug)("4. topicid list",e),v.reportLog("4. topicid list"),this.refreshPackageId();const t=(new Date).getTime();return(0,w.logDebug)("ConnectTime--subscribe callback->",t-this.timeLog),new Promise(t=>i(this,void 0,void 0,function*(){let n=0;for(let r=0;r<e.length;++r){let o=e[r];this.refreshPackageId(r),this.events.once(this.packageId.toString(),s=>i(this,void 0,void 0,function*(){if(s&&s.error){v.logError("failed when subscribe"),yield this.connector.disconnect();var i=new Error;i.message=s.error.message,i.name=s.error.code.toString(),(n+=1)==e.length&&t()}this.refreshPackageId(r);const a=(new Date).getTime();(0,w.logDebug)("ConnectTime--subscribe callback->",a-this.timeLog),(n+=1)==e.length&&(v.logDebug(`5. send fetch msg: ${this.packageId}, ${o}`),yield this.sendBatchFetchAndConsumeMessages(this.packageId.toString(),e),yield this.splitManager.init(this.sendRaw.bind(this)),this.checkExpire(o)?((0,w.logDebug)("disconnect From topic expire"),yield this.activateDisconnect(o)):((0,w.logDebug)("extends expire check"),this.updateExpireLimit(o)),t())})),v.logDebug(`3. login callback then send subscribe: ${this.packageId}, ${o}`),v.reportLog("3. login callback then send subscribe");const a=(new Date).getTime();(0,w.logDebug)("ConnectTime---login callback->",a-this.timeLog),yield this.connector.send(()=>i(this,void 0,void 0,function*(){return v.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}),{id:this.packageId.toString(),jsonrpc:l.CONNECT_JSONRPC_VER,method:s.CONNECT_METHOD_SUB,params:{topic:o}})}}))})}checkExpire(e){let t=!1;if(0==e.length)return(0,w.logDebug)("checkExpire: invalid topic"),t;let n=this.getSessionContent(a.OKXCONNECTOR_STORAGE_TOPIC_WALLET_EXPIRE_CACHE);if(n&&n instanceof Object)try{let r=new Map(Object.entries(n)).get(e);r?Date.now()>r&&((0,w.logDebug)("checkExpire: connection is Expired"),t=!0):((0,w.logDebug)("checkExpire: not same connection"),t=!1)}catch{(0,w.logDebug)("checkExpire: cache error"),t=!1}else(0,w.logDebug)("checkExpire: not topic records"),this.updateExpireLimit(e),t=!1;return t}updateExpireLimit(e){(0,w.logDebug)(`update expire limit for topic: ${e}`);try{let t=this.getSessionContent(a.OKXCONNECTOR_STORAGE_TOPIC_WALLET_EXPIRE_CACHE),n=new Map;t&&(n=new Map(Object.entries(t)));let r=Date.now()+l.OKXCONNECTOR_SESSION_LIVE_TTL;n.set(e,r),this.saveSessionContent(a.OKXCONNECTOR_STORAGE_TOPIC_WALLET_EXPIRE_CACHE,Object.fromEntries(n))}catch{(0,w.logDebug)("update cache failed")}}activateDisconnect(e){return i(this,void 0,void 0,function*(){let t=(0,y.safeJsonStringify)({requestId:"",method:s.CONNECT_METHOD_DISCONNECT}),n={messageId:"",message:(0,y.safeJsonStringify)({message:t}),topic:e,publishedAt:0};yield this.connector.getMsgPayloadFromHistory(n)})}},Gb}var zb,Qb={},$b={};function Yb(){return zb||(zb=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CONNECTOR_TYPE=e.STANDARD_INJECT_WALLET=e.OTHER_INJECT_WALLET=e.OKX_TG_WALLET=e.OKX_APP_WALLET=e.OKX_INJECT_WALLET=void 0,e.getTagByappName=function(r){var i="";if(r)switch(r){case t.OKXWalletName:i=e.OKX_APP_WALLET;break;case n.OKXMiniWalletName:i=e.OKX_TG_WALLET;break;case n.OKXInjectWalletName:i=e.OKX_INJECT_WALLET}return i||r||""};const t=Ey(),n=vy();e.OKX_INJECT_WALLET="okx_inject_wallet",e.OKX_APP_WALLET="okx_app_wallet",e.OKX_TG_WALLET="okx_tg_wallet",e.OTHER_INJECT_WALLET="other_inject_wallet",e.STANDARD_INJECT_WALLET="standard_inject_wallet",e.CONNECTOR_TYPE={WS:{OKX_APP_WALLET:100,OKX_TG_WALLET:110},INJECT:{OKX_INJECT_WALLET:200,STANDARD_INJECT_WALLET:210},KEYLESS:{APPLE_WALLET:300,GOOGLE_WALLET:310}}}($b)),$b}var Zb,eO,tO,nO={};function rO(){if(Zb)return nO;Zb=1,Object.defineProperty(nO,"__esModule",{value:!0}),nO.buildNameSpacesByConnectResponse=function(e){return t(e)},nO.buildRequestAccountNameSpacesByConnectResponse=t,nO.buildAccountNameSpaces=n;const e=ev();function t(t){let r={};(0,e.logDebug)("buildRequestAccountNameSpacesByConnectResponse start connectResponse111>>",JSON.stringify(t));let i=t.payload.responses.find(e=>"requestAccounts"===e.name);if(i&&i.accounts){let t=[];for(const n of i.accounts)"ton"===n.namespace?n.data&&n.data.ton_addr&&n.data.ton_addr.address&&n.data.ton_addr.address.length>0&&((0,e.logDebug)("buildRequestAccountNameSpacesByConnectResponse start TON>>",JSON.stringify(n)),t.push(n)):((0,e.logDebug)("buildRequestAccountNameSpacesByConnectResponse start other>>",JSON.stringify(n)),t.push(n));i.accounts=t}const o=t.payload.responses.find(e=>"ton_addr"===e.name),s=t.payload.responses.find(e=>"ton_proof"===e.name);if(o&&!i){(0,e.logDebug)("buildRequestAccountNameSpacesByConnectResponse adapt ton data >>");let t=o.address;t="ton:"+o.network+":"+t;let n={ton_addr:o};s&&(n.ton_proof=s),i={name:"requestAccounts",accounts:[{namespace:"ton",addresses:[t],methods:["ton_sendTransaction"],extra:{},data:n}]}}return(0,e.logDebug)("buildRequestAccountNameSpacesByConnectResponse end universalResponse>>>",JSON.stringify(i)),n(i.accounts,r),r}function n(t,n){t.forEach(t=>{var r=[],i=[];t.addresses.forEach(t=>{var n=t.split(":");if((0,e.logDebug)("buildRequestAccountNameSpacesByConnectResponse addressArr>>",n.length),n.length>=3){let o=n.slice(0,2).join(":");r.push(o),i.push(t),(0,e.logDebug)("buildRequestAccountNameSpacesByConnectResponse chain:>>",o,"addressItem:",t)}}),t.data&&t.data.ton_addr&&(t.data.ton_addr.name="ton_addr"),t.data&&t.data.ton_proof&&(t.data.ton_proof.name="ton_proof"),n[t.namespace]={chains:r,accounts:i,methods:t.methods,extra:t.extra,payload:t.data},(0,e.logDebug)("buildRequestAccountNameSpacesByConnectResponse result>>",JSON.stringify(n))})}return nO}function iO(){if(eO)return Qb;eO=1;var e=Qb&&Qb.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(Qb,"__esModule",{value:!0}),Qb.Engine=void 0;const t=Ey(),n=ep(),r=Jy(),i=Yb(),o=Xb(),s=rO(),a=vy();return Qb.Engine=class{constructor(e){this.connectors=[],this.useConnector=void 0,this.sessionRetryTimer=null,this.connectionManager=new o.ConnectionManager(e),this.addConnectionListener()}getConnector(){if(this.useConnector)return this.useConnector}setAccountChangeListener(e){this.accountChangeListener=e,(0,r.logDebug)("setAccountChangeListener: engine",e);for(const t of this.connectors)t.setAccountChangeListener(e)}registerConnector(e){this.connectors=e;for(const t of e)t.setConnectionManager(this.connectionManager)}getAllConnectors(){return this.connectors}hasWsConnector(){for(const e of this.connectors)if(this.isWsConnector(e))return!0;return!1}isWsConnector(e){return!!e&&Object.values(i.CONNECTOR_TYPE.WS).includes(e.getType())}isInjectedConnector(e){return!!e&&(Object.values(i.CONNECTOR_TYPE.INJECT).includes(e.getType())||Object.values(i.CONNECTOR_TYPE.KEYLESS).includes(e.getType()))}universalConnect(n,o,c){return e(this,void 0,void 0,function*(){return this.addConnectionListener(),new Promise((l,u)=>e(this,void 0,void 0,function*(){var e,h,d,f,p;try{(0,r.logDebug)("engine universalConnect request :",JSON.stringify(n)),(0,r.logDebug)("engine universalConnect sessionConfig :",JSON.stringify(o));let y=[];n.forEach(e=>{let t=e.name;(t.startsWith("requestAccounts")||t.startsWith("ton"))&&y.push(e)}),(0,r.logDebug)("engine universalConnect universalRequest :",JSON.stringify(y));const v=this.connectionManager.getConnectInfo(),w=Date.now().toString();let b=null!==(e=o.openUniversalUrl)&&void 0!==e&&e,O=null!==(h=o.openAppLinkType)&&void 0!==h?h:t.OpenAppLinkType.UniversalLink;const E={protocolVer:Number(t.tonConnectSdkVersion),topic:v.channelId,clientId:v.clientId,requestId:w,dAppInfo:this.fixDappName(o.dappInfo),requests:y,redirect:null!==(d=null==o?void 0:o.redirect)&&void 0!==d?d:"none"},_=(0,r.encodeConnectParams)(E);E.redirect=null!==(f=null==o?void 0:o.redirect)&&void 0!==f?f:"none",(0,r.logDebug)("engine universalConnect ==>>universalConnectRequest:",JSON.stringify(E));let C="",N="";if(b){let e=(0,r.getOKXLink)(E,o.useMini,o.tmaReturnUrl);C=e.universalLink,N=e.deepLink||"",(0,r.logDebug)("engine universalConnect ==>>openOKXLink:",C)}const A=()=>1==this.connectors.length&&this.isInjectedConnector(this.connectors[0])?this.connectors[0].openWallet({connectRequest:E},O):o.useMini?(0,r.openOKXTMAWalletlinkWithFallback)(C):(0,r.openOKXDeeplinkWithFallback)(N,C,O);(0,r.logDebug)("engine universalConnect ==>>openOKXLink:",C);const R=(0,r.isIos)();if(R&&b&&((0,r.logDebug)(`engine universalConnect ==>>isIOS: ${R}   openUniversalLink: ${b}`),A()),this.addOnConnectResultListener((e,n)=>{var c,h,d,f;try{this.stopSendSessionRetry(),this.addOnConnectResultListener(void 0);let y=e;if("connect"==y.method){(0,r.logDebug)("engin  universalConnect success connectResponse:>>>",JSON.stringify(y));let e=(0,s.buildNameSpacesByConnectResponse)(y);if(!e)throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR);{let s;null!==(h=null===(c=y.payload)||void 0===c?void 0:c.responses)&&void 0!==h&&h[0]&&"walletName"in y.payload.responses[0]&&(s=y.payload.responses[0].walletName);let u=null===(d=y.payload)||void 0===d?void 0:d.wallet.appName;var p,g="";switch(u){case a.OKXWalletName:g=i.OKX_APP_WALLET;break;case a.OKXMiniWalletName:g=i.OKX_TG_WALLET}if(n?p=n:g&&(p=this.connectors.find(e=>e.getTag()===g)),!p)throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR);let f=Object.assign({topic:v.channelId,sessionConfig:o,namespaces:e},y.payload&&{wallet:Object.assign(Object.assign({},y.payload.wallet),{walletName:s})}),m=y.payload.responses.find(e=>"requestAccounts"===e.name);m&&m.connectRequestMethods&&(f.signResponse=m.connectRequestMethods),(0,r.logDebug)("engin  universalConnect success session:>>>",JSON.stringify(f)),this.isWsConnector(p)&&((0,r.logDebug)("engine update protocol version"),this.connectionManager.updateProtocolVersion(v.channelId,y.payload.wallet.maxProtocolVersion)),this.deviceInfo=Object.assign({},f.wallet),l(f),this.setUseConnector(p),(0,r.reportEvent)(r.OKXReportType.PAGE_IN,r.Report_OKXConnectSDKExtension_ConnectDapp_ConnectSuccess_View,g)}}else if("connect_error"==y.method&&null!=(null===(f=y.payload)||void 0===f?void 0:f.code))throw new t.OKXConnectError(y.payload.code)}catch(m){u(m)}}),this.hasWsConnector()){yield null===(p=this.connectionManager)||void 0===p?void 0:p.disconnect(!1);try{yield this.connectionManager.connect()}catch(g){throw(0,r.logDebug)("Engine universalConnect error",g),g}(0,r.logDebug)("engin  universalConnect ==>> connectInfoAndUrl:",c),this.sendSession(_,E.topic,b)}if(!R&&b&&A(),(0,r.logDebug)("engin  universalConnect ==>> connectInfoAndUrl:",c),c){const e={connectRequest:E,redirect:o.redirect,tmaReturnUrl:o.tmaReturnUrl};(0,r.logDebug)("universalConnect connectInfoAndUrl info :",JSON.stringify(e)),c(e)}}catch(m){(0,r.logDebug)("Engine universalConnect catch error",m),u(m)}}))})}fixDappName(e){try{if("dapp portal"===e.name.toLowerCase()){let t=document.title;if(t||(t=this.getOGSiteName()),t)return Object.assign(Object.assign({},e),{name:e.name+" - "+t})}return e}catch{return e}}getOGSiteName(){let e=document.getElementsByTagName("meta"),t=["og:site_name","og:title","twitter:title"];for(let n of e){let e=n.getAttribute("property");for(let r of t)if(e==r)return n.getAttribute("content")}}addOnConnectResultListener(e){for(const t of this.connectors)this.isInjectedConnector(t)&&t.setOnConnectResultListener(e);this.connectResultListener=e}openWallet(e,t,n){var r;t?t.openWallet(e,n):null===(r=this.getConnector())||void 0===r||r.openWallet(e,n)}send(n,i,o){return e(this,void 0,void 0,function*(){var e,o,s,a,c,l,u,h,d;let f;"chainId"in n&&null!=n.chainId&&(f=n.chainId.toString());try{if((0,r.reportEvent)(r.OKXReportType.LOG,r.Report_OKXConnectSDK_RequestStart_Log,"",null!==(o=null===(e=this.getConnector())||void 0===e?void 0:e.getTag())&&void 0!==o?o:"",n.method,null!==(a=null===(s=this.deviceInfo)||void 0===s?void 0:s.platform)&&void 0!==a?a:"",f),!this.getConnector())throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.NOT_CONNECTED_ERROR);null===(c=this.getConnector())||void 0===c||c.send(n,{resolve:e=>{var t,o,s,a,c,l,u,h,d;null===(t=null==i?void 0:i.resolve)||void 0===t||t.call(i,e),"error"in e&&e.error?(0,r.reportEvent)(r.OKXReportType.LOG,r.Report_OKXConnectSDK_RequestError_Log,"",null!==(s=null===(o=this.getConnector())||void 0===o?void 0:o.getTag())&&void 0!==s?s:"",n.method,null!==(c=null===(a=this.deviceInfo)||void 0===a?void 0:a.platform)&&void 0!==c?c:"",f):(0,r.reportEvent)(r.OKXReportType.LOG,r.Report_OKXConnectSDK_RequestSuccess_Log,"",null!==(u=null===(l=this.getConnector())||void 0===l?void 0:l.getTag())&&void 0!==u?u:"",n.method,null!==(d=null===(h=this.deviceInfo)||void 0===h?void 0:h.platform)&&void 0!==d?d:"",f)},onAck:()=>{var e;null===(e=null==i?void 0:i.onAck)||void 0===e||e.call(i)}})}catch(p){throw(0,r.reportEvent)(r.OKXReportType.LOG,r.Report_OKXConnectSDK_RequestError_Log,"",null!==(u=null===(l=this.getConnector())||void 0===l?void 0:l.getTag())&&void 0!==u?u:"",n.method,null!==(d=null===(h=this.deviceInfo)||void 0===h?void 0:h.platform)&&void 0!==d?d:"",f),p}})}clearData(){var e;null===(e=this.getConnector())||void 0===e||e.clearData()}addDisconnectListener(e){var t;null===(t=this.getConnector())||void 0===t||t.addDisconnectListener(e)}saveSessionContent(e,t){this.connectionManager.saveSessionContent(e,t)}getSessionContent(e){var t,n=this.connectionManager.getSessionContent(e);if(n){var r="";if("object"==typeof n&&(r=(0,i.getTagByappName)(null===(t=n.wallet)||void 0===t?void 0:t.appName)),this.connectors.find(e=>e.getTag()===r))return n}}setConnectConnector(e){var t=(0,i.getTagByappName)(null==e?void 0:e.appName);t&&this.setUseConnector(this.connectors.find(e=>e.getTag()===t))}setUseConnector(e){this.useConnector=e,this.isWsConnector(e)&&e.addConnectionListener()}setSessionConnectingListener(e){this.sessionConnectingListener=e}restoreconnect(t,n){return e(this,void 0,void 0,function*(){this.getConnector()?this.getConnector().restoreconnect(t,e=>{var t,i;n(e),e&&(this.deviceInfo=Object.assign({},e.wallet),(0,r.reportEvent)(r.OKXReportType.PAGE_IN,r.Report_OKXConnectSDKExtension_ConnectDapp_ConnectSuccess_View,null!==(i=null===(t=this.getConnector())||void 0===t?void 0:t.getTag())&&void 0!==i?i:""))}):n(null)})}restoreconnectFromTopic(t){return e(this,void 0,void 0,function*(){this.isWsConnector(this.getConnector())&&(yield this.getConnector().restoreconnectFromTopic(t))})}getCurrentConnectionReady(e){var t;return!(null===(t=this.getConnector())||void 0===t||!t.getCurrentConnectionReady(e))}connectManagerDisconnect(){return e(this,arguments,void 0,function*(e=!1){var t,n;this.getConnector()?null===(t=this.getConnector())||void 0===t||t.connectManagerDisconnect(e):yield null===(n=this.connectors.find(e=>this.isWsConnector(e)))||void 0===n?void 0:n.connectManagerDisconnect(e),this.stopSendSessionRetry(),this.setUseConnector(void 0)})}sendSession(t,i,o){return e(this,void 0,void 0,function*(){(0,r.logDebug)("[Connect] sendSession called:",t);const s=Date.now().toString();let a={method:"session_info",params:{protocolVersion:n.CONNECT_PROTOCOL_VER,sessionInfo:t}};yield this.connectionManager.sendRaw(JSON.stringify(Object.assign(Object.assign({},a),{requestId:s}))),this.sessionRetryTimer&&clearInterval(this.sessionRetryTimer),o||(this.sessionRetryTimer=setInterval(()=>e(this,void 0,void 0,function*(){const e=Date.now().toString();(0,r.logDebug)("[Connect] Retrying sendSession..."),yield this.connectionManager.sendSubscribe(i),yield this.connectionManager.sendRaw(JSON.stringify(Object.assign(Object.assign({},a),{requestId:e})))}),n.OKXCONNECTOR_MESSAGE_TTL))})}stopSendSessionRetry(){this.sessionRetryTimer&&(clearInterval(this.sessionRetryTimer),this.sessionRetryTimer=null,(0,r.logDebug)("[Connect] Stopped retry for session"))}addConnectionListener(){var e;null===(e=this.connectionManager)||void 0===e||e.addListener("sdk_response",(e,t)=>{var n=(0,r.safeJsonParse)(t);(0,r.logDebug)(`Engine ==>> addListener ==> success ==> ${n}`),"connect"===n.method?this.connectResultListener&&this.connectResultListener(n):"connect_error"===n.method?this.connectManagerDisconnect(!1).catch(()=>{}).finally(()=>{this.connectResultListener&&this.connectResultListener(n)}):"session_connecting"===n.method&&((0,r.logDebug)("Engine ==>> handleResponse_4  ===> sessionConnectingListener"),this.sessionConnectingListener&&((0,r.logDebug)("Engine ==>> handleResponse_4  ===> sessionConnectingListener not null"),this.sessionConnectingListener(),this.sessionConnectingListener=void 0))},function(){})}},Qb}var oO,sO={},aO={};function cO(){if(oO)return aO;function e(e){const t=(e,n)=>{const[r,...i]=n.split("."),o=e[r];if(o)return 0===i.length?o:t(o,i.join("."))};if("undefined"!=typeof window)return t(window,e)}return oO=1,Object.defineProperty(aO,"__esModule",{value:!0}),aO.BtcMethods=aO.SuiMethods=aO.TONMethods=aO.AptosMethods=aO.SOLANAMethods=aO.Eip55Methods=void 0,aO.hasOKXInjectedProvider=function(){return void 0!==e("okxwallet")},aO.Eip55Methods=["personal_sign","eth_signTypedData_v4","eth_sendTransaction","wallet_addEthereumChain","wallet_watchAsset","wallet_switchEthereumChain","eth_requestAccounts","eth_accounts","eth_chainId"],aO.SOLANAMethods=["solana_signTransaction","solana_signMessage","solana_signAllTransactions","solana_signAndSendTransaction"],aO.AptosMethods=["aptos_signMessage","aptos_signTransaction","aptos_signAndSubmitTransaction"],aO.TONMethods=["ton_sendTransaction"],aO.SuiMethods=["sui_signMessage","sui_signPersonalMessage","sui_signTransactionBlock","sui_signAndExecuteTransactionBlock"],aO.BtcMethods=["btc_signMessage","btc_signPsbts","btc_send","btc_sendInscription","btc_signAndPushPsbt","btc_inscribeTransfer","btc_sendRunes"],aO}var lO,uO,hO,dO={},fO={},pO={};function gO(){return lO||(lO=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.mediaNotTouch=e.mediaTouch=e.maxWidth=void 0,e.isDevice=function(o){var s;const a=(0,r.getWindow)();if(!a)return"desktop"===o;if((0,n.isTmaPlatform)("weba"))return!0;const c=a.innerWidth;switch(o){case"desktop":return c>e.maxWidth.tablet;case"tablet":return c>e.maxWidth.mobile;default:case"mobile":let n=c<=e.maxWidth.mobile||(0,t.isOS)("ios","android","ipad");if(n){const e=!(null===(s=(0,r.getWindow)())||void 0===s||!s.TelegramWebviewProxy),t=navigator.maxTouchPoints||0;e&&0===t&&(n=!1),(0,i.logDebug)("isDevice mobile isTelegram and maxTouchPoints:",n,e,t)}return n}},e.media=function(t){switch(t){case"mobile":return`@media (max-width: ${e.maxWidth.mobile}px)`;case"tablet":return`@media (max-width: ${e.maxWidth.tablet}px) (min-width: ${e.maxWidth.mobile}px)`;default:case"desktop":return`@media (min-width: ${e.maxWidth.tablet}px)`}},e.mediaMin=function(e){return`@media (min-width: ${e}px)`},e.mediaMax=function(e){return`@media (max-width: ${e}px)`},e.mediaMinMax=function(e,t){return`@media (min-width: ${e}px) and (max-width: ${t}px)`};const t=ky(),n=Iy(),r=xy(),i=ev();e.maxWidth={mobile:440,tablet:1020},e.mediaTouch="@media (hover: none)",e.mediaNotTouch="@media not all and (hover: none)"}(pO)),pO}function mO(){if(uO)return fO;uO=1;var e=fO&&fO.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(fO,"__esModule",{value:!0}),fO.Eip155Provider=void 0;const t=Ey(),n=Jy(),r=gO(),i=cO();return fO.Eip155Provider=class{constructor(){this.accountChangedEVMHandler=null}send(r){return e(this,void 0,void 0,function*(){var e;try{(0,n.logDebug)("Eip155Provider send request:",(0,n.safeJsonStringify)(r)),yield this.restoreConnect();let o=null;switch(r.method){case"personal_sign":r.params&&"message"in r.params&&(o={method:r.method,params:[r.params.message,r.address]});break;case"eth_sendTransaction":case"wallet_addEthereumChain":case"wallet_switchEthereumChain":r.params&&(o={method:r.method,params:[r.params]});break;case"eth_signTypedData_v4":r.params&&"typedDataJson"in r.params&&null!==(e=r.params)&&void 0!==e&&e.typedDataJson&&"string"==typeof r.params.typedDataJson&&(o={method:r.method,params:[r.address,r.params.typedDataJson]});break;case"wallet_watchAsset":r.params&&(o={method:r.method,params:r.params});break;default:o={method:r.method,params:r.injectParams}}if(!o)throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.METHOD_NOT_SUPPORTED);if(("wallet_switchEthereumChain"===r.method||"wallet_addEthereumChain"===r.method)&&r.params&&"chainId"in r.params){(0,n.logDebug)("Eip155Provider send request switch requestParams:",(0,n.safeJsonStringify)(o));const e=parseInt(r.params.chainId,16).toString();yield window.okxwallet.request(o);const t=`eip155:${e}:${r.address}`;return(0,n.logDebug)("Eip155Provider send request switch result:",t),{result:t,method:r.method}}{const e=(0,n.getChainId)(r.chainId),t=`0x${Number(e).toString(16)}`;if((0,n.logDebug)("Eip155Provider current chainId:",e,t),t){yield window.okxwallet.request({method:"wallet_switchEthereumChain",params:[{chainId:t}]}),(0,n.logDebug)("Eip155Provider send request requestParams:",t,(0,n.safeJsonStringify)(o));const e=yield window.okxwallet.request(o);return(0,n.logDebug)("Eip155Provider send request result:",(0,n.safeJsonStringify)(e)),{result:e,method:r.method}}}}catch(i){throw(0,n.logDebug)("Eip155Provider encountered an error:",i),i}})}restoreConnect(){return(0,r.isDevice)("mobile")?window.okxwallet.request({method:"eth_requestAccounts"}):Promise.resolve()}parseConnectResponse(r,o,s,a,c,l){return e(this,void 0,void 0,function*(){try{let r=[];a.forEach(e=>{e.namespace===t.NameSpaceKeyEip155&&r.push(...e.chains)});let o=[],s={};return r.forEach(e=>{let t=(0,n.getChainId)(e),r=c.address.find(n=>n.chainId===t&&60===n.coinType||n.namespaceChainId===e);r&&(o.push(e+":"+r.address),s[e]={publicKey:r.publicKey})}),o&&o.length>0?{namespace:t.NameSpaceKeyEip155,addresses:o,methods:[...i.Eip55Methods],extra:s}:void 0}catch(e){throw e}})}connect(){return e(this,void 0,void 0,function*(){return window.okxwallet.request({method:"eth_requestAccounts"})})}singleConnect(){return this.connect()}addAccountChangedListener(e){console.log("window.okxwallet configEventWithKey: eip155"),this.accountChangedEVMHandler=t=>{console.log("window.okxwallet configEventWithKey_evm:",Date.now(),"eip155",t),t&&t.length>0&&e()},window.okxwallet.on("accountsChanged",this.accountChangedEVMHandler)}removeListener(){this.accountChangedEVMHandler&&window.okxwallet.removeListener("accountsChanged",this.accountChangedEVMHandler)}},fO}function yO(){return hO||(hO=1,e=dO,t=dO&&dO.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=dO&&dO.__exportStar||function(e,n){for(var r in e)"default"!==r&&!Object.prototype.hasOwnProperty.call(n,r)&&t(n,e,r)},Object.defineProperty(e,"__esModule",{value:!0}),n(mO(),e)),dO;var e,t,n}var vO,wO,bO,OO={},EO={},_O={};function CO(){return bO||(bO=1,e=OO,t=OO&&OO.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=OO&&OO.__exportStar||function(e,n){for(var r in e)"default"!==r&&!Object.prototype.hasOwnProperty.call(n,r)&&t(n,e,r)},Object.defineProperty(e,"__esModule",{value:!0}),n((vO||(vO=1,Object.defineProperty(EO,"__esModule",{value:!0})),EO),e),n((wO||(wO=1,Object.defineProperty(_O,"__esModule",{value:!0})),_O),e)),OO;var e,t,n}var NO,AO={},RO={};function SO(){if(NO)return RO;NO=1;var e=RO&&RO.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(RO,"__esModule",{value:!0}),RO.SuiStandardProvider=void 0;const t=Ey(),n=Jy(),r=gO();return RO.SuiStandardProvider=class{constructor(e){this.wallet=e}getVersion(){return this.wallet.version}supportChains(e){return 1===e.length&&e[0]===t.SUI_CHAINS.MAINNET}send(r){return e(this,void 0,void 0,function*(){try{(0,n.logDebug)("suiProvider send request:",JSON.stringify(r));const i=r.method;let o;if(r.injectParams&&this.wallet){let e=r.injectParams;switch(i){case"sui_signTransactionBlock":let n;if(this.wallet.features["sui:signTransaction"])n=yield this.wallet.features["sui:signTransaction"].signTransaction(e);else{if(!this.wallet.features["sui:signTransactionBlock"])throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.METHOD_NOT_SUPPORTED);n=yield this.wallet.features["sui:signTransactionBlock"].signTransactionBlock(e)}o={method:"sui_signTransactionBlock",result:null==n?void 0:n.signature};break;case"sui_signAndExecuteTransactionBlock":let r;if(this.wallet.features["sui:signAndExecuteTransaction"])r=yield this.wallet.features["sui:signAndExecuteTransaction"].signAndExecuteTransaction(e);else{if(!this.wallet.features["sui:signAndExecuteTransactionBlock"])throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.METHOD_NOT_SUPPORTED);r=yield this.wallet.features["sui:signAndExecuteTransactionBlock"].signAndExecuteTransactionBlock(e)}o={method:"sui_signAndExecuteTransactionBlock",result:r.digest};break;case"sui_signMessage":o={method:"sui_signMessage",result:(yield this.wallet.features["sui:signMessage"].signMessage(e)).signature};break;case"sui_signPersonalMessage":o={method:"sui_signPersonalMessage",result:(yield this.wallet.features["sui:signPersonalMessage"].signPersonalMessage(e)).signature}}}return o}catch(e){throw(0,n.logDebug)("suiProvider send error:",e),e}})}addAccountChangedListener(){}removeListener(){}disconnect(){return e(this,void 0,void 0,function*(){})}connect(){return e(this,void 0,void 0,function*(){return this.wallet.features["standard:connect"].connect()})}restoreConnect(){return(0,r.isDevice)("mobile")?this.connect():Promise.resolve()}getAccount(){return e(this,void 0,void 0,function*(){var e;let n=yield this.connect();if(!n)throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR);null==n||n.address;let r=null!==(e=null==n?void 0:n.publicKey)&&void 0!==e?e:"";r instanceof Uint8Array&&(r=this.normalizeUint8Array(r),r=btoa(String.fromCharCode(...r)));let i={};return i[t.SUI_CHAINS.MAINNET]={publicKey:r},{namespace:t.NameSpaceKeySui,addresses:[`${t.SUI_CHAINS.MAINNET}:${n.address}`],methods:n.features,extra:i}})}normalizeUint8Array(e){return 33===e.length&&0===e[0]?e.slice(1):e}},RO}var TO,PO,DO={},kO={},IO={};function xO(){if(TO)return IO;TO=1,Object.defineProperty(IO,"__esModule",{value:!0}),IO.AptosNetwork=IO.UserResponseStatus=void 0,IO.getArgs=function(n){if("object"==typeof n&&null!==n&&"status"in n){if(n.status===t.REJECTED)throw new e.OKXConnectError(e.OKX_CONNECT_ERROR_CODES.USER_REJECTS_ERROR);return n.args}return n};const e=Ey();var t,n,r;return(n=t||(IO.UserResponseStatus=t={})).APPROVED="Approved",n.REJECTED="Rejected",function(e){e.MAINNET="mainnet",e.TESTNET="testnet",e.DEVNET="devnet"}(r||(IO.AptosNetwork=r={})),IO}function MO(){if(PO)return kO;PO=1;var e=kO&&kO.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(kO,"__esModule",{value:!0}),kO.AptosStandardProvider=void 0;const t=Ey(),n=Jy(),r=xO();return kO.AptosStandardProvider=class{constructor(e){this.wallet=e,this.mainNetWorkInfo={chainId:"1",name:r.AptosNetwork.MAINNET}}getVersion(){return this.wallet.version}supportChains(e){return 1===e.length&&e[0]===t.APTOS_CHAINS.MAINNET}send(i){return e(this,void 0,void 0,function*(){var e,o,s,a,c;try{try{(0,n.logDebug)("AptosStandardProvider send request:",JSON.stringify(i))}catch{}yield this.confirmNetwrok(i.chainId);const u=i.method;let h;if(i.injectParams&&this.wallet){let n=i.injectParams;switch(u){case"aptos_signTransaction":let l;if(!this.wallet.features["aptos:signTransaction"])throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.METHOD_NOT_SUPPORTED);if("rawTransaction"in n)yield this.wallet.features["aptos:signTransaction"].signTransaction(n),l=(0,r.getArgs)(h);else{if("1.1"!==this.wallet.features["aptos:signTransaction"].version)throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.METHOD_NOT_SUPPORTED);{const t=n,i={payload:t.data,expirationTimestamp:null===(e=t.options)||void 0===e?void 0:e.expirationTimestamp,expirationSecondsFromNow:null===(o=t.options)||void 0===o?void 0:o.expirationSecondsFromNow,gasUnitPrice:null===(s=null==t?void 0:t.options)||void 0===s?void 0:s.gasUnitPrice,maxGasAmount:null===(a=null==t?void 0:t.options)||void 0===a?void 0:a.maxGasAmount,sequenceNumber:null===(c=null==t?void 0:t.options)||void 0===c?void 0:c.accountSequenceNumber,sender:t.sender};yield this.wallet.features["aptos:signTransaction"].signTransaction(i),l=(0,r.getArgs)(h)}}h={method:"aptos_signTransaction",injectResult:l};break;case"aptos_signMessage":let d;if(!this.wallet.features["aptos:signMessage"])throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.METHOD_NOT_SUPPORTED);{let e=yield this.wallet.features["aptos:signMessage"].signMessage(n);d=(0,r.getArgs)(e)}h={method:"aptos_signMessage",injectResult:d};break;case"aptos_signAndSubmitTransaction":let f;if(!this.wallet.features["aptos:signAndSubmitTransaction"])throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.METHOD_NOT_SUPPORTED);if("1.0.0"==this.wallet.features["aptos:signAndSubmitTransaction"].version){if("standardV1Transaction"in n){let e=yield this.wallet.features["aptos:signAndSubmitTransaction"].signAndSubmitTransaction(n.standardV1Transaction);f=(0,r.getArgs)(e)}}else{if("1.1.0"!=this.wallet.features["aptos:signAndSubmitTransaction"].version)throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.METHOD_NOT_SUPPORTED);if("standardV11Transaction"in n){i.params;let e=yield this.wallet.features["aptos:signAndSubmitTransaction"].signAndSubmitTransaction(n.standardV11Transaction);f=(0,r.getArgs)(e)}}h={method:"aptos_signAndSubmitTransaction",result:f.hash.toString()}}}return h}catch(l){throw(0,n.logDebug)("aptosProvider send error:",l),l}})}removeListener(){this.wallet.features["aptos:onAccountChange"]&&this.wallet.features["aptos:onAccountChange"].onAccountChange(()=>{})}addAccountChangedListener(e){this.accountChangedListener=e}setAccountChangedListener(){if(this.wallet.features["aptos:onAccountChange"]&&this.accountChangedListener)try{this.wallet.features["aptos:onAccountChange"].onAccountChange(e=>{var t,n;try{this.accountChangedListener(null===(n=null===(t=(0,r.getArgs)(e))||void 0===t?void 0:t.address)||void 0===n?void 0:n.toString())}catch{this.accountChangedListener(void 0)}})}catch(e){(0,n.logDebug)(`aptosStandardProvider addAccountChangedListener: error ${e.toString()}`)}}connect(){return e(this,void 0,void 0,function*(){return this.wallet.features["aptos:connect"].connect()})}getAccount(){return e(this,void 0,void 0,function*(){let e=(0,r.getArgs)(yield this.connect()),n=e.address;"object"==typeof n&&n.toString&&(n=n.toString()),n instanceof Uint8Array&&(n=this.normalizeUint8Array(n),n=btoa(String.fromCharCode(...n)));let i=e.publicKey.toString();this.setAccountChangedListener();let o={};return o[t.APTOS_CHAINS.MAINNET]={publicKey:i},{namespace:t.NameSpaceKeyAptos,addresses:[`${t.APTOS_CHAINS.MAINNET}:${n}`],methods:[],extra:o}})}normalizeUint8Array(e){return 33===e.length&&0===e[0]?e.slice(1):e}disconnect(){return e(this,void 0,void 0,function*(){if(this.wallet.features["aptos:disconnect"])return this.wallet.features["aptos:disconnect"].disconnect()})}confirmNetwrok(i){return e(this,void 0,void 0,function*(){if(i!==n.chainName2IdMap.get(t.APTOS_CHAINS.MAINNET))throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.CHAIN_NOT_SUPPORTED);if(!this.wallet.features["aptos:network"])throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.METHOD_NOT_SUPPORTED);{let e=yield this.wallet.features["aptos:network"].network();if(1==e.chainId&&e.name.toLowerCase()==r.AptosNetwork.MAINNET)return Promise.resolve();yield this.changeMainNetwork()}})}changeMainNetwork(){return e(this,void 0,void 0,function*(){if(!this.wallet.features["aptos:changeNetwork"])throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.METHOD_NOT_SUPPORTED);{let e=yield this.wallet.features["aptos:changeNetwork"].changeNetwork(this.mainNetWorkInfo);if((0,r.getArgs)(e).success)return Promise.resolve()}})}},kO}var KO,LO={},UO={},BO={};function jO(){return KO?BO:(KO=1,Object.defineProperty(BO,"__esModule",{value:!0}),BO.WalletReadyState=void 0,(t=e||(BO.WalletReadyState=e={})).Installed="Installed",t.NotDetected="NotDetected",t.Loadable="Loadable",t.Unsupported="Unsupported",BO);var e,t}var HO,WO,XO={},FO={};function JO(){if(HO)return FO;HO=1,Object.defineProperty(FO,"__esModule",{value:!0}),FO.BaseAptosWalletAdapter=void 0;const e=oy();return FO.BaseAptosWalletAdapter=class extends e.EventEmitter{get connected(){return!!this.publicAccount.publicKey}},FO}function GO(){if(WO)return XO;WO=1;var e=XO&&XO.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(XO,"__esModule",{value:!0}),XO.MartainWalletAdapter=void 0;const t=JO(),n=jO(),r=Ey(),i=cb(),o=Jy();return XO.MartainWalletAdapter=class extends t.BaseAptosWalletAdapter{get readyState(){throw new Error("Method not implemented.")}constructor(){super(),this.name="Martian",this.icon="https://raw.githubusercontent.com/hippospace/aptos-wallet-adapter/main/logos/martian.png",this.url="",this._version="unknown",this._readyState="undefined"==typeof window||"undefined"==typeof document?n.WalletReadyState.Unsupported:n.WalletReadyState.NotDetected,this._provider="undefined"!=typeof window?window.martian:void 0,this._network=void 0,this._connecting=!1,this._wallet=null,"undefined"!=typeof window&&this._readyState!==n.WalletReadyState.Unsupported&&(0,i.scopePollingDetectionStrategy)(()=>!!window.martian&&(this._readyState=n.WalletReadyState.Installed,this.emit("readyStateChange",this._readyState),!0))}get publicAccount(){var e,t,n;return{publicKey:(null===(e=this._wallet)||void 0===e?void 0:e.publicKey)||null,address:(null===(t=this._wallet)||void 0===t?void 0:t.address)||null,authKey:(null===(n=this._wallet)||void 0===n?void 0:n.authKey)||null}}get connecting(){return this._connecting}get version(){return this._version}get network(){return{name:this._network,chainId:this._chainId}}onAccountChange(t){return e(this,void 0,void 0,function*(){try{const n=this._wallet,i=this._provider||window.martian;if(!n||!i)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.WALLET_NOT_SUPPORTED);const o=t=>e(this,void 0,void 0,function*(){const{publicKey:e}=yield null==i?void 0:i.account();this._wallet=Object.assign(Object.assign({},this._wallet),{address:t,publicKey:e})});yield null==i?void 0:i.onAccountChange(o)}catch(t){throw t.message,t}(0,o.logDebug)("MartainWalletAdapter.onAccountChange()")})}onNetworkChange(){return e(this,void 0,void 0,function*(){(0,o.logDebug)("MartainWalletAdapter.onNetworkChange()")})}connect(){return e(this,void 0,void 0,function*(){try{if(this._readyState!==n.WalletReadyState.Loadable&&this._readyState!==n.WalletReadyState.Installed)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.WALLET_NOT_SUPPORTED);if(this.connecting)return;if(this.connected)return void(yield this.initNetWork());this._connecting=!0;const t=this._provider||window.martian;if((yield null==t?void 0:t.isConnected())&&(yield null==t?void 0:t.disconnect()),!(yield null==t?void 0:t.connect()))throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR);yield this.initNetWork()}catch(e){throw e}finally{this._connecting=!1}})}initNetWork(){return e(this,void 0,void 0,function*(){const e=this._provider||window.martian,t=yield null==e?void 0:e.account();if(t){this._wallet=Object.assign(Object.assign({},t),{isConnected:!0});const n=yield null==e?void 0:e.network(),{chainId:r}=yield e.getChainId();this._network=n,this._chainId=r.toString()}})}disconnect(){return e(this,void 0,void 0,function*(){const e=this._wallet,t=this._provider||window.martian;if(e){this._wallet=null;try{yield null==t?void 0:t.disconnect()}catch{}}})}signAndSubmitTransaction(t,n){return e(this,void 0,void 0,function*(){try{const i=this._wallet,o=this._provider||window.martian;if(!i||!o)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.WALLET_NOT_SUPPORTED);const s=yield o.generateTransaction(i.address||"",t,n);if(!s)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.BAD_REQUEST_ERROR,"generate transaction error");const a=yield null==o?void 0:o.signAndSubmitTransaction(s);if(!a)throw new Error("No response");return{hash:a}}catch(e){throw e}})}signTransaction(t,n){return e(this,void 0,void 0,function*(){try{const i=this._wallet,o=this._provider||window.martian;if(!i||!o)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.WALLET_NOT_SUPPORTED);const s=yield o.generateTransaction(i.address||"",t,n);if(!s)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.BAD_REQUEST_ERROR,"generate transaction error");const a=yield null==o?void 0:o.signTransaction(s);if(!a)throw new Error("No response");return a}catch(e){throw e}})}signMessage(t){return e(this,void 0,void 0,function*(){try{const n=this._wallet,i=this._provider||window.martian;if(!n||!i)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.WALLET_NOT_SUPPORTED);if("object"!=typeof t||!t.nonce)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.BAD_REQUEST_ERROR,"Invalid signMessage Payload");const o=yield null==i?void 0:i.signMessage(t);if(o)return o;throw new Error("Sign Message failed")}catch(e){throw e}})}},XO}var qO,VO,zO,QO,$O,YO,ZO={};function eE(){if(qO)return ZO;qO=1;var e=ZO&&ZO.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(ZO,"__esModule",{value:!0}),ZO.PetraWalletAdapter=void 0;const t=JO(),n=jO(),r=cb(),i=Ey();return ZO.PetraWalletAdapter=class extends t.BaseAptosWalletAdapter{get readyState(){return this._readyState}getPerta(){var e;if(this._provider)return this._provider;if(!window.petra)return;let t=window.petra;return t&&(t.isOKExWallet||t.isOkxWallet||(null===(e=window.okxwallet)||void 0===e?void 0:e.aptos)===t)?void 0:(this._provider=t,t)}constructor(){super(),this.name="Petra",this.icon="https://raw.githubusercontent.com/hippospace/aptos-wallet-adapter/main/logos/petra.png",this.url="",this._version="unknown",this._readyState="undefined"==typeof window||"undefined"==typeof document?n.WalletReadyState.Unsupported:n.WalletReadyState.NotDetected,this._network=void 0,this._connecting=!1,this._wallet=null,"undefined"!=typeof window&&this._readyState!==n.WalletReadyState.Unsupported&&(0,r.scopePollingDetectionStrategy)(()=>!!this.getPerta()&&(this._readyState=n.WalletReadyState.Installed,!0))}get publicAccount(){var e,t,n;return{publicKey:(null===(e=this._wallet)||void 0===e?void 0:e.publicKey)||null,address:(null===(t=this._wallet)||void 0===t?void 0:t.address)||null,authKey:(null===(n=this._wallet)||void 0===n?void 0:n.authKey)||null}}get connecting(){return this._connecting}get version(){return this._version}get network(){return{name:this._network}}connect(){return e(this,void 0,void 0,function*(){try{if(this._readyState!==n.WalletReadyState.Loadable&&this._readyState!==n.WalletReadyState.Installed)throw new i.OKXConnectError(i.OKX_CONNECT_ERROR_CODES.WALLET_NOT_SUPPORTED);if(this.connected)return void(yield this.initNetWork());this._connecting=!0;const t=this.getPerta(),r=yield null==t?void 0:t.connect();this._wallet={address:null==r?void 0:r.address,publicKey:null==r?void 0:r.publicKey,isConnected:!0},yield this.initNetWork()}catch(e){throw e}finally{this._connecting=!1}})}initNetWork(){return e(this,void 0,void 0,function*(){const e=this.getPerta(),t=yield null==e?void 0:e.network();this._network=t})}disconnect(){return e(this,void 0,void 0,function*(){const e=this._wallet,t=this.getPerta();if(e){this._wallet=null;try{yield null==t?void 0:t.disconnect()}catch{}}})}signAndSubmitTransaction(t,n){return e(this,void 0,void 0,function*(){try{const r=this._wallet,o=this.getPerta();if(!r||!o)throw new i.OKXConnectError(i.OKX_CONNECT_ERROR_CODES.WALLET_NOT_SUPPORTED);const s=yield o.signAndSubmitTransaction(t,n);if(s.code)throw new Error(s.message);return s}catch(e){throw e}})}signTransaction(t,n){return e(this,void 0,void 0,function*(){try{const n=this._wallet,r=this.getPerta();if(!n||!r)throw new i.OKXConnectError(i.OKX_CONNECT_ERROR_CODES.WALLET_NOT_SUPPORTED);const o=yield null==r?void 0:r.signTransaction(t);if(o.code)throw new Error(o.message);return o}catch(e){throw e}})}signMessage(t){return e(this,void 0,void 0,function*(){try{const n=this._wallet,r=this.getPerta();if(!n||!r)throw new i.OKXConnectError(i.OKX_CONNECT_ERROR_CODES.WALLET_NOT_SUPPORTED);const o=yield null==r?void 0:r.signMessage(t);if(o)return o;throw new Error("Sign Message failed")}catch(e){throw e}})}onAccountChange(t){return e(this,void 0,void 0,function*(){try{this._wallet;const r=this.getPerta(),i=n=>e(this,void 0,void 0,function*(){var e,i,o,s,a,c;if(null!=n&&n.publicKey)this._wallet=Object.assign(Object.assign({},this._wallet),{publicKey:n.publicKey||(null===(e=this._wallet)||void 0===e?void 0:e.publicKey),authKey:n.authKey||(null===(i=this._wallet)||void 0===i?void 0:i.authKey),address:n.address||(null===(o=this._wallet)||void 0===o?void 0:o.address)});else{const e=yield null==r?void 0:r.connect();this._wallet=Object.assign(Object.assign({},this._wallet),{authKey:(null==e?void 0:e.authKey)||(null===(s=this._wallet)||void 0===s?void 0:s.authKey),address:(null==e?void 0:e.address)||(null===(a=this._wallet)||void 0===a?void 0:a.address),publicKey:(null==e?void 0:e.publicKey)||(null===(c=this._wallet)||void 0===c?void 0:c.publicKey)})}null==t||t(this._wallet)});null==r||r.onAccountChange(i)}catch(n){throw n}})}onNetworkChange(){return e(this,void 0,void 0,function*(){try{this._wallet,this.getPerta()}catch(e){throw e}})}},ZO}function tE(){return VO||(VO=1,e=UO,t=UO&&UO.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=UO&&UO.__exportStar||function(e,n){for(var r in e)"default"!==r&&!Object.prototype.hasOwnProperty.call(n,r)&&t(n,e,r)},Object.defineProperty(e,"__esModule",{value:!0}),n(jO(),e),n(GO(),e),n(eE(),e)),UO;var e,t,n}function nE(){if(zO)return LO;zO=1;var e=LO&&LO.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(LO,"__esModule",{value:!0}),LO.AptosThirdpartInjectProvider=void 0;const t=Ey(),n=tE(),r=Jy(),i=xO();return LO.AptosThirdpartInjectProvider=class{constructor(e){this.walletAdapter=e}disconnect(){return e(this,void 0,void 0,function*(){yield this.walletAdapter.disconnect()})}getVersion(){return this.walletAdapter.version}getAccount(){return e(this,void 0,void 0,function*(){yield this.walletAdapter.connect();let e=this.walletAdapter.publicAccount,n=e.address,r=e.publicKey.toString(),i={};return i[t.APTOS_CHAINS.MAINNET]={publicKey:r},{namespace:t.NameSpaceKeyAptos,addresses:[`${t.APTOS_CHAINS.MAINNET}:${n}`],methods:[],extra:i}})}supportChains(e){return this.walletAdapter.readyState===n.WalletReadyState.Installed&&1===e.length&&e[0]===t.APTOS_CHAINS.MAINNET}send(t){return e(this,void 0,void 0,function*(){try{try{(0,r.logDebug)("AptosStandardProvider send request:",JSON.stringify(t))}catch{}this.confirmNetwrok(t.chainId);const n=t.method;let i;if(t.injectParams&&this.walletAdapter){let e=t.injectParams;switch(n){case"aptos_signTransaction":i={method:"aptos_signTransaction",result:yield this.walletAdapter.signTransaction(t.params)};break;case"aptos_signMessage":let r=yield this.walletAdapter.signMessage(e);"object"==typeof r&&"signature"in r&&(r=r.signature),i={method:"aptos_signMessage",result:r};break;case"aptos_signAndSubmitTransaction":i={method:"aptos_signAndSubmitTransaction",result:(yield this.walletAdapter.signAndSubmitTransaction(t.params)).hash}}}return i}catch(e){throw(0,r.logDebug)("aptosProvider send error:",e),e}})}removeListener(){}addAccountChangedListener(e){this.walletAdapter.onAccountChange(t=>{null==e||e(null==t?void 0:t.address)})}confirmNetwrok(e){var n;if(e!==r.chainName2IdMap.get(t.APTOS_CHAINS.MAINNET))throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.CHAIN_NOT_SUPPORTED);if((null===(n=this.walletAdapter.network.name)||void 0===n?void 0:n.toLowerCase())!=i.AptosNetwork.MAINNET)throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.CHAIN_NOT_SUPPORTED)}},LO}function rE(){return QO||(QO=1,e=DO,t=DO&&DO.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=DO&&DO.__exportStar||function(e,n){for(var r in e)"default"!==r&&!Object.prototype.hasOwnProperty.call(n,r)&&t(n,e,r)},Object.defineProperty(e,"__esModule",{value:!0}),n(MO(),e),n(nE(),e),n(tE(),e)),DO;var e,t,n}function iE(){return $O||($O=1,e=AO,t=AO&&AO.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=AO&&AO.__exportStar||function(e,n){for(var r in e)"default"!==r&&!Object.prototype.hasOwnProperty.call(n,r)&&t(n,e,r)},Object.defineProperty(e,"__esModule",{value:!0}),n(SO(),e),n(rE(),e)),AO;var e,t,n}function oE(){return YO||(YO=1,e=sO,t=sO&&sO.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=sO&&sO.__exportStar||function(e,n){for(var r in e)"default"!==r&&!Object.prototype.hasOwnProperty.call(n,r)&&t(n,e,r)},Object.defineProperty(e,"__esModule",{value:!0}),n(cO(),e),n(yO(),e),n(CO(),e),n(iE(),e)),sO;var e,t,n}var sE,aE,cE={},lE={},uE={};function hE(){if(sE)return uE;sE=1;var e=uE&&uE.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(uE,"__esModule",{value:!0}),uE.WsConnector=void 0;const t=tv(),n=ev();return uE.WsConnector=class{constructor(){this.disconnectListener=[],this.walletName="",this.walletNameKey="",this.enable=!0,this.icon="",this.pendingRequests=new Map,(0,n.getDefaultReporter)().beginReport()}setAccountChangeListener(e){this.accountChangeListener=e}setConnectionManager(e){this.connectionManager=e}addConnectionListener(){var e;null===(e=this.connectionManager)||void 0===e||e.addListener("sdk_response",(e,r)=>{var i=(0,t.safeJsonParse)(r);(0,n.logDebug)(`Engine ==>> addListener ==> success ==> ${i}`),this.handleResponse(e,i)},function(){})}addDisconnectListener(e){this.disconnectListener.push(e)}connectManagerDisconnect(){return e(this,arguments,void 0,function*(e=!1){var t;yield null===(t=this.connectionManager)||void 0===t?void 0:t.disconnect(e)})}openWallet(e,t){}bindRequestForPromise(e,t){this.pendingRequests.set(e,t)}send(r,i,o){return e(this,void 0,void 0,function*(){var e,s;try{delete r.injectParams}catch{}(0,n.logDebug)("Engine ==>> send  request==>",JSON.stringify(r));const a=this.getRequestId();try{let l=yield null===(e=this.connectionManager)||void 0===e?void 0:e.send(JSON.stringify(Object.assign(Object.assign({},r),{requestId:a})),o);l&&(null===(s=this.connectionManager)||void 0===s||s.events.once(l.toString(),e=>{var r;(0,n.logDebug)(`Engine ==> send => onAck => ${(0,t.safeJsonStringify)(e)}`),e&&e.result&&(null===(r=i.onAck)||void 0===r||r.call(i))})),i.resolve&&this.bindRequestForPromise(a,i.resolve)}catch(c){return Promise.reject(c)}})}restoreconnect(t,n){return e(this,void 0,void 0,function*(){var e;yield null===(e=this.connectionManager)||void 0===e?void 0:e.restoreConnect(t.topic),n(t)})}restoreconnectFromTopic(t){return e(this,void 0,void 0,function*(){var e;yield null===(e=this.connectionManager)||void 0===e?void 0:e.restoreConnect(t)})}getRequestId(){const e=Date.now().toString();return(0,n.logDebug)("Engine ==>> getRequestId ==>",e),e}handleResponse(e,r){if((0,n.logDebug)(`Engine ==>> handleResponse_1  ======>response: ${(0,t.safeJsonStringify)(r)}`,e),"requestId"in r){(0,n.logDebug)("Engine ==>> handleResponse_2  ===> in response");let e=r.requestId;const t=this.pendingRequests.get(e);t?((0,n.logDebug)("Engine ==>> handleResponse_3  ===> find resolve:",t),t(r),this.pendingRequests.delete(e)):((0,n.logDebug)("Engine ==>> handleResponse_3  ===> not find resolve:"),"disconnect"===r.method&&(this.disconnectListener.forEach(e=>e()),this.disconnectListener=[],this.clearData()))}}getCurrentConnectionReady(){var e;return!(null===(e=this.connectionManager)||void 0===e||!e.getCurrentConnectionReady())}saveSessionContent(e,t){var n;null===(n=this.connectionManager)||void 0===n||n.saveSessionContent(e,t)}getSessionContent(e){var t;return null===(t=this.connectionManager)||void 0===t?void 0:t.getSessionContent(e)}setOnConnectResultListener(e){this.connectResultListener=e}getTag(){return""}toJSON(){return"ws-connector"}clearData(){this.pendingRequests.clear()}},uE}function dE(){if(aE)return lE;aE=1,Object.defineProperty(lE,"__esModule",{value:!0}),lE.AppwalletConnector=void 0;const e=hE(),t=Yb(),n=Jy(),r=Qm(),i=Ey();return lE.AppwalletConnector=class extends e.WsConnector{getType(){return t.CONNECTOR_TYPE.WS.OKX_APP_WALLET}constructor(){super(),this.walletName="OKX App",this.walletNameKey=""}getTag(){return t.OKX_APP_WALLET}openWallet(e,t){var o;let s=null!=t?t:i.OpenAppLinkType.UniversalLink;if(e&&e.connectRequest){(0,n.logDebug)(`appwallet-connector openwallet before useSHortLink engineConnectInfo.connectRequest JSON ${JSON.stringify(e)}`);let t=e.connectRequest;(0,n.useShortLink)()||(t=Object.assign(Object.assign({},e.connectRequest),{redirect:null!==(o=e.redirect)&&void 0!==o?o:"none"}));let{universalLink:r,deepLink:i}=(0,n.getOKXLink)(t);(0,n.openOKXDeeplinkWithFallback)(i,r,s)}else(0,n.isOS)("android")?(0,n.openDeeplinkWithFallback)(r.stackDeepLink,()=>{}):(0,n.openOKXDeeplinkWithFallback)(r.standardDeeplink,r.shortUniversalLink,s)}},lE}var fE,pE={};function gE(){if(fE)return pE;fE=1;var e=pE&&pE.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(pE,"__esModule",{value:!0}),pE.InjectConnector=void 0;const t=Ey(),n=Jy(),r=Yb();return pE.InjectConnector=class{constructor(){this.disconnectListener=[],this.providerMap=new Map,this.disconnectHandler=null,this.walletName="",this.icon="",this.walletNameKey="",this.enable=!0}setAccountChangeListener(e){(0,n.logDebug)("setAccountChangeListener: inject",e),this.accountChangeListener=e}setConnectionManager(e){this.connectionManager=e}getInjectProvider(e){if(e)for(const[t,n]of this.providerMap.entries())if(e.includes(t))return n}send(r,i){return e(this,void 0,void 0,function*(){var e;try{(0,n.logDebug)("InjectEngine send  > request:",(0,n.safeJsonStringify)(r));let s=r;if("disconnect"===s.method)return yield this.disconnect(),this.disconnectListener.forEach(e=>e()),this.disconnectListener=[],void(null===(e=i.onAck)||void 0===e||e.call(i));yield this.checkWalletMatch();const a=this.getInjectProvider((0,n.getNamespaceKeyByChain)(s.chainId));if(a)return void a.send(s).then(e=>{var t;(0,n.logDebug)("InjectEngine ==>> send > result:",e),null===(t=i.resolve)||void 0===t||t.call(i,e)}).catch(e=>{var o;let s=e.code;4001===s&&(s=t.OKX_CONNECT_ERROR_CODES.USER_REJECTS_ERROR);let a={requestId:Date.now().toString(),method:r.method,error:{code:s,message:e.message}};(0,n.logDebug)("InjectEngine ==>> send > errorResponse:",JSON.stringify(a)),null===(o=i.resolve)||void 0===o||o.call(i,a)});throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.CHAIN_NOT_SUPPORTED)}catch(o){return(0,n.logDebug)("InjectEngine ==>> send  ===> error:",o),Promise.reject(o)}})}checkWalletMatch(){return e(this,void 0,void 0,function*(){return new Promise((e,n)=>{var r;let i=null===(r=this.connectionManager)||void 0===r?void 0:r.getSessionContent("connectSession");i||n(new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.WALLET_NOT_SUPPORTED)),this.restoreconnect(i,r=>{r?e():n(new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.WALLET_NOT_SUPPORTED))})})})}clearData(){this.connectResultListener=void 0}addDisconnectListener(e){this.disconnectListener.push(e)}setOnConnectResultListener(e){this.connectResultListener=e}connectManagerDisconnect(){return e(this,arguments,void 0,function*(){})}getCurrentConnectionReady(e){return!!e}getTag(){return r.OKX_INJECT_WALLET}toJSON(){return"inject-connector"}getSupportNameSpaces(){return Array.from(this.providerMap.keys())}},pE}var mE,yE={};function vE(){if(mE)return yE;mE=1,Object.defineProperty(yE,"__esModule",{value:!0}),yE.TgwalletConnector=void 0;const e=hE(),t=Yb(),n=Jy();return yE.TgwalletConnector=class extends e.WsConnector{getType(){return t.CONNECTOR_TYPE.WS.OKX_TG_WALLET}constructor(){super(),this.walletName="OKX Mini Wallet",this.walletNameKey=""}getTag(){return t.OKX_TG_WALLET}openWallet(e,t){var r,i;e&&e.connectRequest&&(i=(0,n.encodeTWAConnectURLParams)(Object.assign(Object.assign({},e.connectRequest),{redirect:"none"})));var o=(0,n.getTelegramWalletTWAUrl)(i,null!==(r=null==e?void 0:e.tmaReturnUrl)&&void 0!==r?r:"back");(0,n.openOKXTMAWalletlinkWithFallback)(o)}},yE}var wE,bE,OE,EE,_E,CE={},NE={};function AE(){return EE||(EE=1,OE=(bE?wE:(bE=1,wE=function(e){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var r=0;r<e.length;r++){var i=e.charAt(r),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=r}var s=e.length,a=e.charAt(0),c=Math.log(s)/Math.log(256),l=Math.log(256)/Math.log(s);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;for(var n=0,r=0,i=0;e[n]===a;)r++,n++;for(var o=(e.length-n)*c+1>>>0,l=new Uint8Array(o);e[n];){var u=e.charCodeAt(n);if(u>255)return;var h=t[u];if(255===h)return;for(var d=0,f=o-1;(0!==h||d<i)&&-1!==f;f--,d++)h+=s*l[f]>>>0,l[f]=h%256>>>0,h=h/256>>>0;if(0!==h)throw new Error("Non-zero carry");i=d,n++}for(var p=o-i;p!==o&&0===l[p];)p++;for(var g=new Uint8Array(r+(o-p)),m=r;p!==o;)g[m++]=l[p++];return g}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,i=0,o=t.length;i!==o&&0===t[i];)i++,n++;for(var c=(o-i)*l+1>>>0,u=new Uint8Array(c);i!==o;){for(var h=t[i],d=0,f=c-1;(0!==h||d<r)&&-1!==f;f--,d++)h+=256*u[f]>>>0,u[f]=h%s>>>0,h=h/s>>>0;if(0!==h)throw new Error("Non-zero carry");r=d,i++}for(var p=c-r;p!==c&&0===u[p];)p++;for(var g=a.repeat(n);p<c;++p)g+=e.charAt(u[p]);return g},decodeUnsafe:u,decode:function(e){var t=u(e);if(t)return t;throw new Error("Non-base"+s+" character")}}}))("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz")),OE}function RE(){if(_E)return NE;_E=1;var e=NE&&NE.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})},t=NE&&NE.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(NE,"__esModule",{value:!0}),NE.SolProvider=void 0;const n=Ey(),r=Jy(),i=t(AE()),o=gO(),s=cO();return NE.SolProvider=class{constructor(){this.accountChangedSolanaPublicKeyHandler=null}send(t){return e(this,void 0,void 0,function*(){var e;try{yield this.restoreConnect(),(0,r.logDebug)("SolProvider send request:",JSON.stringify(t));const c=t.method;let l;if(!t.injectParams)throw new n.OKXConnectError(n.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`param is error method: '${c}'`);switch(c){case"solana_signMessage":if(t.injectParams&&"object"==typeof t.injectParams&&"message"in t.injectParams){var o=null===(e=t.injectParams)||void 0===e?void 0:e.message;const n=(new TextEncoder).encode(o),s=yield window.okxwallet.solana.signMessage(n,"utf8");return l={method:t.method,result:i.default.encode(s.signature)},(0,r.logDebug)("SolProvider send result:",JSON.stringify(s)),l}throw new n.OKXConnectError(n.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`param is error method: '${c}'`);case"solana_signTransaction":{let e=yield window.okxwallet.solana.signTransaction(t.injectParams);return(0,r.logDebug)("SolProvider send bufferResult:",JSON.stringify(e)),l={method:t.method,injectResult:e},(0,r.logDebug)("SolProvider send result:",(0,r.safeJsonStringify)(l)),l}case"solana_signAllTransactions":{let e=yield window.okxwallet.solana.signAllTransactions(t.injectParams);return(0,r.logDebug)("SolProvider send result:",(0,r.safeJsonStringify)(e)),l={method:t.method,injectResult:e}}case"solana_signAndSendTransaction":var s=yield window.okxwallet.solana.signAndSendTransaction(t.injectParams);return(0,r.logDebug)("SolProvider send result:",(0,r.safeJsonStringify)(s)),l={method:t.method,injectResult:s};default:throw new n.OKXConnectError(n.OKX_CONNECT_ERROR_CODES.METHOD_NOT_SUPPORTED,`method: '${c}'`)}}catch(a){throw(0,r.logDebug)("SolProvider send error:",a),a}})}disconnect(){}restoreConnect(){return(0,o.isDevice)("mobile")?this.connect():Promise.resolve()}parseConnectResponse(t,i,o,a,c,l){return e(this,void 0,void 0,function*(){let e=[];a.forEach(t=>{t.namespace===n.NameSpaceKeySOL&&e.push(...t.chains)});let t=[],i={},o={};if(e.forEach(e=>{let n=c.address.find(t=>"501"===t.chainId&&501===t.coinType||t.namespaceChainId===e);n&&(t.push(e+":"+n.address),i[e]=o&&"publicKey"in o?o:{publicKey:n.publicKey})}),t&&t.length>0){let e={namespace:n.NameSpaceKeySOL,addresses:t,methods:[...s.SOLANAMethods],extra:i};return(0,r.logDebug)("parseConnectResponse nameSpaceResponse :",JSON.stringify(e)),e}})}connect(){return e(this,void 0,void 0,function*(){return window.okxwallet.solana.connect()})}singleConnect(){return this.connect()}addAccountChangedListener(e){console.log("window.okxwallet configEventWithKey:","sol"),this.accountChangedSolanaPublicKeyHandler=t=>{console.log("window.okxwallet configEventWithKey_solana:",Date.now(),"sol",t),t&&e()},window.okxwallet.solana.on("accountChanged",this.accountChangedSolanaPublicKeyHandler)}removeListener(){this.accountChangedSolanaPublicKeyHandler&&window.okxwallet.solana.removeListener("accountChanged",this.accountChangedSolanaPublicKeyHandler)}},NE}var SE,TE={};function PE(){if(SE)return TE;SE=1;var e=TE&&TE.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(TE,"__esModule",{value:!0}),TE.AptosProvider=void 0;const t=Ey(),n=Jy(),r=cO(),i=gO(),o=zy(),s=Object.freeze(["637","70000060","70000066"]),a=new Map;return a.set("aptos:637","Mainnet"),a.set("aptos:70000060","Movement Testnet"),a.set("aptos:70000066","Movement Mainnet"),TE.AptosProvider=class{send(r){return e(this,void 0,void 0,function*(){try{(0,n.logDebug)("AptosProvider send request:",(0,n.safeJsonStringify)(r)),yield this.restoreConnect();let i=yield window.okxwallet.aptos.network(),o=this.searchChainIdToInjectChainName(r.chainId);if((0,n.logDebug)("AptosProvider send network and searchNetwork:",i,"-----",o),!i||!o||i.toLowerCase()!==o.toLowerCase())throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`Please switch your wallet link to '${o}'`);const s=r.method;let a;switch(s){case"aptos_signMessage":if(r.injectParams){let e=yield window.okxwallet.aptos.signMessage(r.injectParams);return a={method:r.method,result:e.signature,injectResult:e},(0,n.logDebug)("AptosProvider send result:",(0,n.safeJsonStringify)(a)),a}throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`param is error method: '${s}'`);case"aptos_signTransaction":{(0,n.logDebug)("AptosProvider Method>>>> :",s);let e=yield window.okxwallet.aptos.signTransaction(r.params);return a={method:r.method,result:e},(0,n.logDebug)("AptosProvider send result:",(0,n.safeJsonStringify)(a)),a}case"aptos_signAndSubmitTransaction":{(0,n.logDebug)("AptosProvider Method>>>> :",s);let e=yield window.okxwallet.aptos.signAndSubmitTransaction(r.params);return a={method:r.method,result:e.hash},(0,n.logDebug)("AptosProvider send result:",(0,n.safeJsonStringify)(a)),a}default:throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.METHOD_NOT_SUPPORTED,` method: '${s}'`)}}catch(e){throw(0,n.logDebug)("AptosProvider send error:",e),e}})}searchChainIdToInjectChainName(e){let t=e;return a.forEach((n,r)=>{e.includes(r)&&(t=n)}),t}disconnect(){}restoreConnect(){return(0,i.isDevice)("mobile")?this.connect():Promise.resolve()}parseConnectResponse(o,a,c,l,u,h){return e(this,void 0,void 0,function*(){let e=[];l.forEach(n=>{n.namespace===t.NameSpaceKeyAptos&&e.push(...n.chains)});let o,a=[],c={};if((0,n.logDebug)("AptosProvider parseConnectResponse connectChain",JSON.stringify(e)),!(0,i.isDevice)("mobile")&&e&&e.length>0&&(o=(yield window.okxwallet.aptos.connect()).publicKey),e.forEach(e=>{let t=u.address.find(t=>s.includes(t.chainId)&&637===t.coinType||t.namespaceChainId===e);t&&(a.push(e+":"+t.address),c[e]={publicKey:t.publicKey?t.publicKey:o})}),(0,n.logDebug)("AptosProvider parseConnectResponse addresses",JSON.stringify(a)),a&&a.length>0)return{namespace:t.NameSpaceKeyAptos,addresses:a,methods:[...r.AptosMethods],extra:c}})}connect(){return e(this,void 0,void 0,function*(){return window.okxwallet.aptos.connect()})}singleConnect(){return this.connect()}addAccountChangedListener(e){window.okxwallet.aptos.onAccountChange(t=>{console.log("window.okxwallet configEventWithKey_aptos:",Date.now(),o.key,JSON.stringify(t)),t&&e()})}removeListener(){}},TE}var DE,kE={};function IE(){if(DE)return kE;DE=1;var e=kE&&kE.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(kE,"__esModule",{value:!0}),kE.TONProvider=void 0;const t=Ey(),n=Jy(),r=gO(),i=cO();return kE.TONProvider=class{constructor(){this.signalChainConnectResult=void 0,this.accountChangedTONHandler=null}send(r){return e(this,void 0,void 0,function*(){try{(0,n.logDebug)("TONProvider send request:",(0,n.safeJsonStringify)(r));let i=null;switch(r.method){case"ton_sendTransaction":r.params&&(i={method:"sendTransaction",params:[JSON.stringify(r.params)],id:Date.now().toString()},(0,n.logDebug)("TONProvider tonParams first:",JSON.stringify(i)));break;default:throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.METHOD_NOT_SUPPORTED)}if(i){const e=yield window.okxTonWallet.tonconnect.send(i);if((0,n.logDebug)("TONProvider send request result:",(0,n.safeJsonStringify)(e)),e.error)throw new t.OKXConnectError(e.error.code,e.error.message);return{result:e.result,method:r.method}}throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.METHOD_NOT_SUPPORTED)}catch(e){throw(0,n.logDebug)("TONProvider encountered an error:",e),e}})}restoreConnect(){return Promise.resolve()}parseConnectResponse(o,s,a,c,l,u){return e(this,void 0,void 0,function*(){try{let h=[];c.forEach(e=>{e.namespace===t.NameSpaceKeyTON&&h.push(...e.chains)});let d=[],f={};if(h.forEach(e=>{(0,n.getChainId)(e);let t=l.address.find(t=>"607"===t.chainId&&607===t.coinType||t.namespaceChainId===e);t&&(d.push(e+":"+t.address),f[e]={publicKey:t.publicKey})}),(0,n.logDebug)("tonprovider parseConnectResponse needPop and addresses: ",o,JSON.stringify(d)),d&&d.length>0){let e,l=c.find(e=>e.namespace===t.NameSpaceKeyTON);if((0,n.logDebug)("tonprovider parseConnectResponse ton: ",JSON.stringify(l)),!(l&&l.params&&u&&u.manifestUrl))throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"manifestUrl is nil");{this.dappInfo=u;let t=[l.params.ton_addr],i={manifestUrl:u.manifestUrl,items:t};(o||s)&&l.params.ton_proof&&t.push(l.params.ton_proof),(0,n.logDebug)("parseConnectResponse ton connect params: ",JSON.stringify(i)),e=(0,r.isDevice)("mobile")?yield window.okxTonWallet.tonconnect.connect(2,i):o||s?yield window.okxTonWallet.tonconnect.connect(2,i):yield window.okxTonWallet.tonconnect.restoreConnection()}if(a&&this.signalChainConnectResult&&(e=this.signalChainConnectResult,this.signalChainConnectResult=void 0),(0,n.logDebug)("parseConnectResponse ton connect result: ",JSON.stringify(e)),e&&l){if("connect_error"===e.event)throw new t.OKXConnectError(e.payload.code,e.payload.message);{let r=e.payload.items.find(e=>"ton_addr"===e.name),o=e.payload.items.find(e=>"ton_proof"===e.name);return(0,n.logDebug)("tonprovider connect isSignalChain: ",a),{namespace:t.NameSpaceKeyTON,addresses:d,methods:[...i.TONMethods],extra:f,data:{ton_addr:r,ton_proof:o,manifestUrl:u.manifestUrl}}}}}return}catch(e){throw(0,n.logDebug)("tonprovider parseConnectResponse error: ",JSON.stringify(e)),e}})}connect(r,i){return e(this,void 0,void 0,function*(){if(!(r&&i&&i.manifestUrl&&r.params))throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"manifestUrl or params is nil");{this.dappInfo=i;let o=[r.params.ton_addr],s={manifestUrl:i.manifestUrl,items:o};r.params.ton_proof&&o.push(r.params.ton_proof),(0,n.logDebug)("tonprovider connect params: ",JSON.stringify(s));try{let r=yield window.okxTonWallet.tonconnect.connect(2,s);return(0,n.logDebug)("tonprovider connect tonResult: ",JSON.stringify(r)),this.signalChainConnectResult=r,r}catch(e){throw(0,n.logDebug)("tonprovider connect error: ",JSON.stringify(e)),new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"tonconnect error")}}})}singleConnect(e,t){return this.connect(e,t)}addAccountChangedListener(e){console.log("window.okxwallet configEventWithKey:","ton"),this.accountChangedTONHandler=()=>{console.log("window.okxwallet configEventWithKey_TON:",Date.now(),"ton"),e()},window.okxTonWallet.tonconnect.on("accountChanged",this.accountChangedTONHandler)}removeListener(){this.accountChangedTONHandler&&window.okxTonWallet.tonconnect.off("accountChanged",this.accountChangedTONHandler)}},kE}var xE,ME={};function KE(){if(xE)return ME;xE=1;var e=ME&&ME.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(ME,"__esModule",{value:!0}),ME.SuiProvider=void 0;const t=Ey(),n=Jy(),r=gO(),i=cO();return ME.SuiProvider=class{constructor(e=window.okxwallet.sui){this.accountChangedHandler=null,this.wallet=e}getSuiPublicKey(){return e(this,void 0,void 0,function*(){return(yield this.connect()).accounts[0].publicKey})}parseConnectResponse(r,o,s,a,c,l){return e(this,void 0,void 0,function*(){try{let r=[];a.forEach(e=>{e.namespace===t.NameSpaceKeySui&&r.push(...e.chains)});let o=[],s={};if(0==r.length)return;const l=yield this.getSuiPublicKey();return r.forEach(e=>{var t;(0,n.getChainId)(e);let r=c.address.find(t=>784===t.coinType||t.namespaceChainId===e);r&&(o.push(e+":"+r.address),s[e]={publicKey:null!==(t=r.publicKey)&&void 0!==t?t:l})}),o&&o.length>0?{namespace:t.NameSpaceKeySui,addresses:o,methods:[...i.SuiMethods],extra:s}:void 0}catch(e){throw e}})}restoreConnect(){return(0,r.isDevice)("mobile")?this.connect():Promise.resolve()}getSuiWallet(){return this.wallet}send(r){return e(this,void 0,void 0,function*(){try{yield this.restoreConnect(),(0,n.logDebug)("suiProvider send request:",JSON.stringify(r));const i=r.method;let o;if(r.injectParams&&this.getSuiWallet()){let e=r.injectParams;switch(i){case"sui_signTransactionBlock":let n;if(this.getSuiWallet().features["sui:signTransaction"])n=yield this.getSuiWallet().features["sui:signTransaction"].signTransaction(e);else{if(!this.getSuiWallet().features["sui:signTransactionBlock"])throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.METHOD_NOT_SUPPORTED);n=yield this.getSuiWallet().features["sui:signTransactionBlock"].signTransactionBlock(e)}o={method:"sui_signTransactionBlock",result:null==n?void 0:n.signature};break;case"sui_signAndExecuteTransactionBlock":let r;if(this.getSuiWallet().features["sui:signAndExecuteTransaction"])r=yield this.getSuiWallet().features["sui:signAndExecuteTransaction"].signAndExecuteTransaction(e);else{if(!this.getSuiWallet().features["sui:signAndExecuteTransactionBlock"])throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.METHOD_NOT_SUPPORTED);r=yield this.getSuiWallet().features["sui:signAndExecuteTransactionBlock"].signAndExecuteTransactionBlock(e)}o={method:"sui_signAndExecuteTransactionBlock",result:r.digest};break;case"sui_signMessage":o={method:"sui_signMessage",result:(yield this.getSuiWallet().features["sui:signMessage"].signMessage(e)).signature};break;case"sui_signPersonalMessage":o={method:"sui_signPersonalMessage",result:(yield this.getSuiWallet().features["sui:signPersonalMessage"].signPersonalMessage(e)).signature}}}return o}catch(e){throw(0,n.logDebug)("suiProvider send error:",e),e}})}connect(){return e(this,void 0,void 0,function*(){var e;return null===(e=this.getSuiWallet())||void 0===e?void 0:e.features["standard:connect"].connect()})}singleConnect(){return this.connect()}addStandardEventListener(e){var t,r;null!==(t=this.getSuiWallet())&&void 0!==t&&t.features["standard:events"]?((0,n.logDebug)("sui-provider standard:events change"),null===(r=this.getSuiWallet())||void 0===r||r.features["standard:events"].on("change",t=>{e(t)})):(0,n.logDebug)("sui-provider standard:events null")}addAccountChangedListener(e){var t;console.log("configEventWithKey:","sui"),this.getSuiWallet().on&&(this.accountChangedHandler=t=>{console.log("configEventWithKey_sui:",Date.now(),"sui",t),t&&e()},null===(t=this.getSuiWallet())||void 0===t||t.on("accountChanged",this.accountChangedHandler))}removeListener(){var e;this.accountChangedHandler&&(null===(e=this.getSuiWallet())||void 0===e||e.removeListener("accountChanged",this.accountChangedHandler))}},ME}var LE,UE,BE={};function jE(){if(LE)return BE;LE=1;var e=BE&&BE.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(BE,"__esModule",{value:!0}),BE.BtcProvider=void 0;const t=Ey(),n=Jy(),r=cO(),i=gO();return BE.BtcProvider=class{constructor(){this.accountChangedBtcHandler=null}connect(){return window.okxwallet.unisat.connect()}switchChain(n){return e(this,void 0,void 0,function*(){let e=window.okxwallet.unisat;switch(n){case t.BTC_CHAINS.MAINNET:yield e.switchChain("BITCOIN_MAINNET");break;case t.BTC_CHAINS.FRACTAL:yield e.switchChain("FRACTAL_BITCOIN_MAINNET")}})}parseConnectResponse(n,i,o,s,a){return e(this,void 0,void 0,function*(){try{let i=[];s.forEach(e=>{e.namespace===t.NameSpaceKeyBtc&&i.push(...e.chains)});let o=[],c={};if(0==i.length)return;const l=(e,n)=>e.find(e=>{const r="bitcoin"===e.name&&n===t.BTC_CHAINS.MAINNET||"fractalbitcoin"===e.name&&n===t.BTC_CHAINS.FRACTAL;return 0===e.coinType&&r||e.namespaceChainId===n}),u=t=>e(this,void 0,void 0,function*(){let e=l(a.address,t);if(!e)return;o.push(t+":"+e.address);let n=yield this.connect();c[t]={publicKey:n.publicKey,compressedPublicKey:n.compressedPublicKey}}),h=i.map(u);return yield Promise.all(h),o&&o.length>0?{namespace:t.NameSpaceKeyBtc,addresses:o,methods:[...r.BtcMethods],extra:c}:void 0}catch(n){throw n}})}restoreConnect(){return e(this,void 0,void 0,function*(){return(0,i.isDevice)("mobile")?this.connect():Promise.resolve()})}send(r){return e(this,void 0,void 0,function*(){try{(0,n.logDebug)("btcProvider send request:",JSON.stringify(r));const i=r.method,o=r.chainId;if(yield this.restoreConnect(),yield this.switchChain(o),!r.params)throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.BAD_REQUEST_ERROR,`param is error method: '${i}'`);switch(i){case"btc_signMessage":{const{signStr:e,type:t}=r.params||{},n=yield window.okxwallet.unisat.signMessage(e,t);return{method:r.method,result:n}}case"btc_send":{const{from:e,to:t,value:n,satBytes:i}=r.params||{},o=yield window.okxwallet.unisat.send({from:e,to:t,value:n,satBytes:i});return{method:r.method,result:o}}case"btc_signPsbts":{const{psbtHexs:e,options:t}=r.params||{};let i;if(Array.isArray(e)&&1===e.length){let n;i=[n=Array.isArray(t)?yield window.okxwallet.unisat.signPsbt(e[0],t.length>0&&"object"==typeof t[0]?t[0]:void 0):yield window.okxwallet.unisat.signPsbt(e[0])]}else i=yield window.okxwallet.unisat.signPsbts(e,t);return{method:r.method,result:(0,n.safeJsonStringify)(i)}}case"btc_signAndPushPsbt":{const{psbtHex:e,options:t}=r.params||{},i=yield window.okxwallet.unisat.signPsbt(e,t),o=yield window.okxwallet.unisat.pushPsbt(i);return{method:r.method,result:(0,n.safeJsonStringify)({signedPsbt:i,txHash:o})}}case"btc_sendInscription":{const{address:e,inscriptionId:t,options:n}=r.injectParams||{},i=yield window.okxwallet.unisat.sendInscription(e,t,n);return{method:r.method,result:i}}case"btc_inscribeTransfer":if(this.hasFunction("inscribeTransfer")){const{ticker:e,amount:t}=r.params||{},n=yield window.okxwallet.unisat.inscribeTransfer(e,t);return{method:r.method,result:n}}case"btc_sendRunes":if(this.hasFunction("sendRunes")){const{address:e,runeid:t,amount:n,options:i}=r.injectParams||{},o=yield window.okxwallet.unisat.sendRunes(e,t,n,i);return{method:r.method,result:o}}default:throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.METHOD_NOT_SUPPORTED,`method: '${i}' not support`)}}catch(e){throw(0,n.logDebug)("BtcProvider send error:",e),e}})}hasFunction(e){return!(!window.okxwallet||!window.okxwallet.unisat||"function"!=typeof window.okxwallet.unisat[e])}singleConnect(t){return e(this,void 0,void 0,function*(){return 1==t.chains.length&&this.connect()})}addAccountChangedListener(e){this.accountChangedBtcHandler=t=>{console.log("window.okxwallet btc:",Date.now(),"btc",t),t&&t.length>0&&e()},window.okxwallet.unisat.on("accountsChanged",this.accountChangedBtcHandler)}removeListener(){window.okxwallet.unisat.removeListener("accountsChanged",this.accountChangedBtcHandler)}},BE}function HE(){if(UE)return CE;UE=1;var e=CE&&CE.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(CE,"__esModule",{value:!0}),CE.OkxwalletInjectConnector=void 0;const t=gE(),n=Ey(),r=oE(),i=RE(),o=PE(),s=IE(),a=KE(),c=jE(),l=Jy(),u=vy(),h=gO(),d=rO(),f=Yb();return CE.OkxwalletInjectConnector=class extends t.InjectConnector{getType(){return f.CONNECTOR_TYPE.INJECT.OKX_INJECT_WALLET}constructor(){super(),this.walletName="OKX Wallet",this.walletNameKey="walletModal.mobileConnectionModal.connectInjected",this.providerMap.set(n.NameSpaceKeyEip155,new r.Eip155Provider),this.providerMap.set(n.NameSpaceKeySOL,new i.SolProvider),this.providerMap.set(n.NameSpaceKeyAptos,new o.AptosProvider),this.providerMap.set(n.NameSpaceKeyTON,new s.TONProvider),this.providerMap.set(n.NameSpaceKeySui,new a.SuiProvider),this.providerMap.set(n.NameSpaceKeyBtc,new c.BtcProvider)}openWallet(t,r){return e(this,void 0,void 0,function*(){var e,r,i;if((0,l.logDebug)("InjectEngine connect begin:",JSON.stringify(t)),!t)throw new n.OKXConnectError(n.OKX_CONNECT_ERROR_CODES.BAD_REQUEST_ERROR);this.dappInfo=t.connectRequest.dAppInfo;var o=t.connectRequest;try{if(!window||!window.okxwallet)throw new n.OKXConnectError(n.OKX_CONNECT_ERROR_CODES.BAD_REQUEST_ERROR);if(o.requests){let t=o.requests.find(e=>"requestAccounts"===e.name),a=yield window.okxwallet.getVersion(),c={method:"connect",requestId:o.requestId,payload:{wallet:{platform:null!==(e=navigator.platform)&&void 0!==e?e:"/",appName:u.OKXInjectWalletName,appVersion:null!=a?a:"1.0.0",maxProtocolVersion:1},responses:[]}},l={name:"requestAccounts",accounts:[]};c.payload.responses.push(l),yield this.disconnect();const d=null!==(r=t.requiredNamespaces)&&void 0!==r?r:[],f=null!==(i=t.optionalNamespaces)&&void 0!==i?i:[];let p=!0,g=!1;if(d.length+f.length===1&&!(0,h.isDevice)("mobile")){const e=1===d.length?d[0]:f[0],t=this.getInjectProvider(e.namespace);(yield null==t?void 0:t.singleConnect(e,this.dappInfo))&&(g=!0,p=!1)}var s=yield this.getAccountByRequestWallets(p,!1,g,d,f);if(!s)throw new n.OKXConnectError(n.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"connect requestWallets is null");if(l.accounts.push(...s),0===l.accounts.length)throw new n.OKXConnectError(n.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"connect connectAccounts is null");this.connectResultListener&&(this.disconnectHandler&&window.okxwallet.removeListener("disconnect",this.disconnectHandler),this.disconnectHandler=()=>{console.log("window.okxwallet disconnect:"),this.disconnectListener.forEach(e=>e()),this.disconnectListener=[]},window.okxwallet.on("disconnect",this.disconnectHandler),this.connectResultListener(c,this))}}catch(c){var a=n.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR;c instanceof n.OKXConnectError&&(a=c.code,c.message),this.connectResultListener&&this.connectResultListener({requestId:"-1",method:"connect_error",payload:{code:a}},this)}})}checkAccountChanged(){return e(this,void 0,void 0,function*(){var e;try{let r=null===(e=this.connectionManager)||void 0===e?void 0:e.getSessionContent("connectSession");if(!r)throw new n.OKXConnectError(n.OKX_CONNECT_ERROR_CODES.WALLET_NOT_SUPPORTED);(0,l.logDebug)("inject-connector checkAccountChanged --sessionInfo:",JSON.stringify(r));let i=this.getRequireNameSpaceFromSession(r);(0,l.logDebug)("inject-connector checkAccountChanged --requiredNamespaces:",JSON.stringify(i));let o=yield this.getAccountByRequestWallets(!1,!0,!1,i,[]);if((0,l.logDebug)("inject-connector checkAccountChanged --accounts:",JSON.stringify(o)),!o)throw new n.OKXConnectError(n.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"connect requestWallets is null");{let e={};(0,d.buildAccountNameSpaces)(o,e),this.compareAndModifyNamespaces(r.namespaces,e)||((0,l.logDebug)("inject-connector checkAccountChanged --result sessionLocal:",JSON.stringify(r)),this.accountChangeListener?((0,l.logDebug)("inject-connector checkAccountChanged -accountChangeListener:",this.accountChangeListener),this.accountChangeListener(r)):((0,l.logDebug)("inject-connector checkAccountChanged disconnect:"),yield this.disconnect()))}}catch(t){throw(0,l.logDebug)("inject-connector restoreconnect catch error",JSON.stringify(t)),t}})}compareAndModifyNamespaces(e,t){let n=!0;for(const r in e)if(t[r]){const i=e[r],o=t[r];(0,l.logDebug)("inject-connector checkAccountChanged ns1:",JSON.stringify(i)),(0,l.logDebug)("inject-connector checkAccountChanged ns2:",JSON.stringify(o)),JSON.stringify([...i.accounts].sort())===JSON.stringify([...o.accounts].sort())||(n=!1,i.accounts=[...o.accounts],i.extra=Object.assign({},o.extra),i.payload=Object.assign({},o.payload)),(0,l.logDebug)("inject-connector checkAccountChanged new ns1:",JSON.stringify(i))}return(0,l.logDebug)(`inject-connector checkAccountChanged compareAndModifyNamespaces ===> ${n}`),n}restoreconnect(e,t){var r;if(window.okxwallet){this.dappInfo=null===(r=e.sessionConfig)||void 0===r?void 0:r.dappInfo,(0,l.logDebug)("inject-connector restoreconnect --sessionInfo:",JSON.stringify(e));var i=this.getRequireNameSpaceFromSession(e);(0,l.logDebug)("inject-connector restoreconnect --requiredNamespaces:",JSON.stringify(i)),this.getAccountByRequestWallets(!1,!1,!1,i,[]).then(r=>{(0,l.logDebug)("inject-connector restoreconnect --accounts:",JSON.stringify(r));let i=!0;for(let t in e.namespaces){var o=r.find(e=>e.namespace===t),s=e.namespaces[t].accounts;if(!o)throw new n.OKXConnectError(n.OKX_CONNECT_ERROR_CODES.BAD_REQUEST_ERROR,"resotreconnect error: accountItem error");let a=s;t===n.NameSpaceKeyAptos&&a&&a.length>0&&(a=s.map(e=>(0,l.replaceChainNameToChainId)(e))),o.addresses.length===a.length&&o.addresses.slice().sort().every((e,r)=>{if(t===n.NameSpaceKeyAptos){let t=a.slice().sort()[r];return(0,l.logDebug)("check aptos address -value and aptosAdd--",e,t),t===e}return e===a.slice().sort()[r]})||(i=!1)}if(!i)throw new n.OKXConnectError(n.OKX_CONNECT_ERROR_CODES.BAD_REQUEST_ERROR,"resotreconnect error: address not as same as session");t(e)}).catch(e=>{(0,l.logDebug)("inject-connector restoreconnect catch error",JSON.stringify(e)),t(null)})}else t(null)}getRequireNameSpaceFromSession(e){var t,r,i=[];for(let o in e.namespaces){let s=e.namespaces[o],a={namespace:o,chains:s.chains};if(o===n.NameSpaceKeyAptos){let e=[];s.chains.forEach(t=>{let n=(0,l.replaceChainNameToChainId)(t);e.push(n)}),a={namespace:o,chains:e}}else if(o===n.NameSpaceKeyTON){let e,n;!(null===(t=s.payload)||void 0===t)&&t.ton_proof&&(e=null===(r=s.payload)||void 0===r?void 0:r.ton_proof).proof.payload&&(n={name:"ton_proof",payload:e.proof.payload}),a={namespace:o,chains:s.chains,params:{ton_addr:{name:"ton_addr"},ton_proof:n}}}i.push(a)}return i}getAccountByRequestWallets(t,r,i,o,s){return e(this,void 0,void 0,function*(){try{var e=[],a=[];if((0,h.isDevice)("mobile")){var c=yield window.okxwallet.connectWallet(t,{requiredNamespaces:o,optionalNamespaces:s});e.push(c)}else e=yield window.okxwallet.requestWallets(t);var u=[...null!=o?o:[],...null!=s?s:[]];let f,p=e[0];if((0,l.logDebug)(" InjectEngine connect connectAccounts:",JSON.stringify(p)),u&&p&&p.address)for(const[e,n]of this.providerMap.entries()){let o=yield n.parseConnectResponse(t,r,i,u,p,this.dappInfo);o&&(f=e,a.push(o))}let g=o.every(e=>{let t=a.find(t=>t.namespace===e.namespace);return!!t&&e.chains.every(e=>!!t.addresses.find(t=>t.startsWith(e+":")))});if((0,l.logDebug)("InjectEngine connect requiredNamespaces:",JSON.stringify(o)),(0,l.logDebug)("InjectEngine connect accountResult:",JSON.stringify(a)),!g)throw yield this.disconnect(),new n.OKXConnectError(n.OKX_CONNECT_ERROR_CODES.CHAIN_NOT_SUPPORTED);return(0,h.isDevice)("mobile")||(this.configEventWithKey(f),yield window.okxwallet.requestWallets(t)),a}catch(d){throw d&&"object"==typeof d&&"code"in d&&4001===d.code?new n.OKXConnectError(n.OKX_CONNECT_ERROR_CODES.USER_REJECTS_ERROR):new n.OKXConnectError(n.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR)}})}configEventWithKey(e){var t,n;for(let r in this.providerMap)null===(t=this.providerMap.get(r))||void 0===t||t.removeListener();null===(n=this.getInjectProvider(e))||void 0===n||n.addAccountChangedListener(()=>{this.checkAccountChanged().catch(e=>{console.log("window.okxwallet configEventWithKey error: ",e)})})}disconnect(){return e(this,void 0,void 0,function*(){(0,l.logDebug)("InjectEngine ==>> disconnect  okxwallet.disconnect()"),window.okxwallet&&(yield window.okxwallet.disconnect(),(0,l.logDebug)("InjectEngine ==>> disconnect end okxwallet.disconnect()"))})}},CE}var WE,XE={};function FE(){if(WE)return XE;WE=1;var e=XE&&XE.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(XE,"__esModule",{value:!0}),XE.OkxwalletInjectTonsdkConnector=void 0;const t=Ey(),n=Jy(),r=gO(),i=HE(),o=Yb();return XE.OkxwalletInjectTonsdkConnector=class extends i.OkxwalletInjectConnector{getType(){return o.CONNECTOR_TYPE.INJECT.OKX_INJECT_WALLET}constructor(){super(),this.walletName="OKX Wallet extension",this.walletNameKey="walletModal.mobileConnectionModal.connectInjected"}checkWalletMatch(){return e(this,void 0,void 0,function*(){var e,i,o;null===(e=this.connectionManager)||void 0===e||e.tonsdkConnectStorage.synchronizedCache();let s=null===(i=this.connectionManager)||void 0===i?void 0:i.tonsdkConnectStorage.getItem("ton_connect_info_adapter_universal");if(!s||null==s||!s.content)throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.NOT_CONNECTED_ERROR);const a=null==s?void 0:s.content;let c,l=JSON.parse(a),u=l.connectEvent.payload.items.find(e=>"name"in e&&"ton_addr"===e.name);if(this.dappInfo=l.dappInfo,u&&"address"in u&&(c=u.address),!c)throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.WALLET_NOT_SUPPORTED);if((0,n.logDebug)(`inject-connector localTonaddress : ${c}`),(0,r.isDevice)("mobile")){let e;e={namespace:t.NameSpaceKeyTON,chains:[t.TON_CHAINS.MAINNET],params:{ton_addr:{name:"ton_addr"}}};let n=yield this.getAccountByRequestWallets(!1,!1,!1,[e],[]);if(n&&1==n.length){let e=null===(o=n[0].data)||void 0===o?void 0:o.ton_addr;if(c===(null==e?void 0:e.address))return}}else{let e=yield window.okxTonWallet.tonconnect.restoreConnection();if("connect"===e.event&&e.payload.items.find(e=>"ton_addr"===e.name).address==c)return}throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.WALLET_NOT_SUPPORTED)})}},XE}var JE,GE,qE,VE={};function zE(){if(JE)return VE;JE=1;var e=VE&&VE.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(VE,"__esModule",{value:!0}),VE.ThirdpartInjectConnector=void 0;const t=gE(),n=Ey(),r=Yb(),i=Jy();return VE.ThirdpartInjectConnector=class extends t.InjectConnector{getType(){return this.walletName===n.AptosGoogleWalletName?r.CONNECTOR_TYPE.KEYLESS.GOOGLE_WALLET:this.walletName===n.AptosAppleWalletName?r.CONNECTOR_TYPE.KEYLESS.APPLE_WALLET:r.CONNECTOR_TYPE.INJECT.STANDARD_INJECT_WALLET}constructor(e){super(),this.walletName=e.walletName,e.wallets.forEach((e,t)=>{this.providerMap.set(t,e)}),this.icon=e.icon}registerWallet(e,t){this.providerMap.set(e,t)}getTag(){var e;return r.STANDARD_INJECT_WALLET+(null!==(e=this.walletName)&&void 0!==e?e:"")}getWalletVersion(){return e(this,void 0,void 0,function*(){const e=this.providerMap.values().next().value;if(!e)throw new n.OKXConnectError(n.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR);return e.getVersion()})}openWallet(t,r){return e(this,void 0,void 0,function*(){var e,r;if((0,i.logDebug)("InjectEngine connect begin:",JSON.stringify(t)),!t)throw new n.OKXConnectError(n.OKX_CONNECT_ERROR_CODES.BAD_REQUEST_ERROR);this.dappInfo=t.connectRequest.dAppInfo;var o=t.connectRequest;try{if(o.requests){let t=o.requests.find(e=>"requestAccounts"===e.name);const i=null!==(e=t.requiredNamespaces)&&void 0!==e?e:[],s=null!==(r=t.optionalNamespaces)&&void 0!==r?r:[];let a;if(i.length+s.length===1){const e=1===i.length?i[0]:s[0],t=this.providerMap.get(e.namespace);if(this.addListener(e.namespace),!t)throw new n.OKXConnectError(n.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"openWallet: provider not found");a=yield this.getResponseByConnect(t)}this.connectResultListener&&a&&this.connectResultListener(a,this)}}catch(a){var s=n.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR;a instanceof n.OKXConnectError&&(s=a.code,a.message),this.connectResultListener&&this.connectResultListener({requestId:"-1",method:"connect_error",payload:{code:s}})}})}getResponseByConnect(t){return e(this,void 0,void 0,function*(){var e,n;let i={method:"connect",requestId:Date.now().toString(),payload:{wallet:{platform:null!==(e=navigator.platform)&&void 0!==e?e:"/",appName:r.STANDARD_INJECT_WALLET+this.walletName,appVersion:null!==(n=this.getWalletVersion())&&void 0!==n?n:"1.0.0",maxProtocolVersion:1},responses:[]}},o={name:"requestAccounts",accounts:[]};return i.payload.responses.push(o),o.accounts.push(yield this.getAccount(t)),i})}getAccount(t){return e(this,void 0,void 0,function*(){return t.getAccount()})}disconnect(){return e(this,void 0,void 0,function*(){yield Promise.all([...this.providerMap.values()].map(e=>e.disconnect()))})}onDisconnect(){this.disconnectListener.forEach(e=>e()),this.disconnectListener=[]}restoreconnect(e,t){const n=Object.keys(e.namespaces);if(1!==n.length)return void t(null);const r=this.getInjectProvider(n[0]);if(!r)return t(null);r.getAccount().then(r=>{var i;let o=null!==(i=null==r?void 0:r.addresses)&&void 0!==i?i:[""];e.namespaces[n[0]].accounts[0].includes(o[0])?t(e):t(null)}).catch(()=>{t(null)})}checkAccountChanged(t,n){return e(this,void 0,void 0,function*(){var e,r;try{let i=null===(e=this.connectionManager)||void 0===e?void 0:e.getSessionContent("connectSession");if(n&&i.namespaces[t].accounts.includes(n))return;let o=this.getInjectProvider(t);if(o){let e=yield this.getResponseByConnect(o);if(e&&i){let n=e.payload.responses[0].accounts[0];i.namespaces[t].accounts=n.addresses,i.namespaces[t].extra=n.extra,i.namespaces[t].rpcMap=void 0,i.namespaces[t].methods=n.methods,null===(r=this.accountChangeListener)||void 0===r||r.call(this,i)}}}catch{yield this.disconnect()}})}addListener(e){var t,n;for(let r in this.providerMap)null===(t=this.providerMap.get(r))||void 0===t||t.removeListener();null===(n=this.getInjectProvider(e))||void 0===n||n.addAccountChangedListener(t=>{t?this.checkAccountChanged(e,t).catch(()=>{}):this.onDisconnect()})}supportNamespaceAndChains(e,t){let n=this.providerMap.get(e);return!!n&&n.supportChains(t)}},VE}function QE(){return qE||(qE=1,e=Qf,t=Qf&&Qf.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=Qf&&Qf.__exportStar||function(e,n){for(var r in e)"default"!==r&&!Object.prototype.hasOwnProperty.call(n,r)&&t(n,e,r)},Object.defineProperty(e,"__esModule",{value:!0}),n((tO||(tO=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Storage=e.Engine=e.WalletConnectionManager=e.ConnectionManager=e.OKXWalletConnector=void 0;var t=ub();Object.defineProperty(e,"OKXWalletConnector",{enumerable:!0,get:function(){return t.OKXWalletConnector}});var n=Xb();Object.defineProperty(e,"ConnectionManager",{enumerable:!0,get:function(){return n.ConnectionManager}});var r=Vb();Object.defineProperty(e,"WalletConnectionManager",{enumerable:!0,get:function(){return r.WalletConnectionManager}});var i=iO();Object.defineProperty(e,"Engine",{enumerable:!0,get:function(){return i.Engine}});var o=lb();Object.defineProperty(e,"Storage",{enumerable:!0,get:function(){return o.Storage}})}($f)),$f),e),n(Ey(),e),n(Jy(),e),n(oE(),e),n((GE||(GE=1,function(e){var t=cE&&cE.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=cE&&cE.__exportStar||function(e,n){for(var r in e)"default"!==r&&!Object.prototype.hasOwnProperty.call(n,r)&&t(n,e,r)};Object.defineProperty(e,"__esModule",{value:!0}),e.ThirdpartInjectConnector=e.OkxwalletInjectTonsdkConnector=e.OkxwalletInjectConnector=e.WsConnector=e.TgwalletConnector=e.InjectConnector=e.AppwalletConnector=void 0;var r=dE();Object.defineProperty(e,"AppwalletConnector",{enumerable:!0,get:function(){return r.AppwalletConnector}}),n(Yb(),e);var i=gE();Object.defineProperty(e,"InjectConnector",{enumerable:!0,get:function(){return i.InjectConnector}});var o=vE();Object.defineProperty(e,"TgwalletConnector",{enumerable:!0,get:function(){return o.TgwalletConnector}});var s=hE();Object.defineProperty(e,"WsConnector",{enumerable:!0,get:function(){return s.WsConnector}});var a=HE();Object.defineProperty(e,"OkxwalletInjectConnector",{enumerable:!0,get:function(){return a.OkxwalletInjectConnector}});var c=FE();Object.defineProperty(e,"OkxwalletInjectTonsdkConnector",{enumerable:!0,get:function(){return c.OkxwalletInjectTonsdkConnector}});var l=zE();Object.defineProperty(e,"ThirdpartInjectConnector",{enumerable:!0,get:function(){return l.ThirdpartInjectConnector}})}(cE)),cE),e)),Qf;var e,t,n}var $E,YE={},ZE={},e_={};function t_(){if($E)return e_;$E=1,Object.defineProperty(e_,"__esModule",{value:!0}),e_.getRpcUrl=function(e,t){var r;const i=n(e);return(null===(r=t.rpcMap)||void 0===r?void 0:r[i.reference])||""},e_.getChainId=function(e){return e.includes(":")?e.split(":")[1]:e},e_.fromAccountToAddress=function(t){if(!t)return"";try{let n=t.split(":").slice(2),r=n.length>0?n.join(":"):"";return(0,e.logDebug)("fromAccountToAddress address and account:",r,t),r}catch{return(0,e.logError)("fromAccountToAddress error:",t),""}},e_.convertChainIdToNumber=function(e){return"number"==typeof e?e:e.includes("0x")?parseInt(e,16):(e=e.includes(":")?e.split(":")[1]:e,isNaN(Number(e))?e:Number(e))},e_.parseChainId=n,e_.mergeArrays=function(e=[],t=[]){return[...new Set([...e,...t])]},e_.syncAddressAvailable=function(t){return!(!t||"OKX Wallet"!==t.appName||(0,e.versionCompare)("6.97.0",t.appVersion)>0)&&r()},e_.syncAddressHostAvailable=r;const e=QE(),t=":";function n(e){const[n,r]=e.split(t);return{namespace:n,reference:r}}function r(){try{return!!window.okxGlobal}catch{return!1}}return e_}var n_,r_,i_,o_,s_,a_,c_={};function l_(){if(n_)return c_;n_=1,Object.defineProperty(c_,"__esModule",{value:!0}),c_.setGlobal=c_.getGlobal=void 0;const e={};return c_.getGlobal=t=>e[t],c_.setGlobal=(t,n)=>{e[t]=n},c_}function u_(){return r_||(r_=1,e=ZE,t=ZE&&ZE.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=ZE&&ZE.__exportStar||function(e,n){for(var r in e)"default"!==r&&!Object.prototype.hasOwnProperty.call(n,r)&&t(n,e,r)},Object.defineProperty(e,"__esModule",{value:!0}),n(t_(),e),n(l_(),e)),ZE;var e,t,n}function h_(){return i_||(i_=1,e=YE,t=YE&&YE.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=YE&&YE.__exportStar||function(e,n){for(var r in e)"default"!==r&&!Object.prototype.hasOwnProperty.call(n,r)&&t(n,e,r)},Object.defineProperty(e,"__esModule",{value:!0}),n(Jf(),e),n(u_(),e)),YE;var e,t,n}function d_(){return o_||(o_=1,function(e){var t=zf&&zf.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})},n=zf&&zf.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0}),e.connectSupportMethods=void 0,e.creatNotSupportMethodItemReplay=function(e){let t=new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.METHOD_NOT_SUPPORTED);return{method:e.method,chainId:e.chainId,error:{code:t.code,message:t.message}}},e.isMobileDiscover=function(){return!!window.okxwallet&&window.okxwallet.mobileDiscoverWallet},e.connectMethodsAdaptOldVersion=function(e,n){return t(this,void 0,void 0,function*(){var t,s,a,c,l;try{(0,r.logDebug)("connectMethodsAdaptOldVersion start params :",JSON.stringify(e));let d={};if("solana_signMessage"===e.method){let a=null===(t=n.namespaces[r.NameSpaceKeySOL])||void 0===t?void 0:t.accounts.filter(function(t){return t.startsWith(e.chainId)})[0];const c=(0,o.fromAccountToAddress)(a);if(e.params&&c&&"message"in e.params){let t=e.params.message;if("OKX Wallet"==(null===(s=n.wallet)||void 0===s?void 0:s.appName)){let e=(new TextEncoder).encode(t);t=i.default.encode(e)}return e.params={message:t,pubkey:c},e.injectParams=e.params,d={publicKey:c},(0,r.logDebug)("solana_signMessage account and address:",JSON.stringify(a),c),(0,r.logDebug)("solana_signMessage callBackParams:",JSON.stringify(d)),d}throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.METHOD_NOT_SUPPORTED)}if("sui_signMessage"===e.method||"sui_signPersonalMessage"===e.method){if("message"in e.params&&e.params.message){let t=JSON.parse(JSON.stringify(e.params.message)),n=Object.values(t),i=new Uint8Array(n),o=new TextDecoder("utf8"),s=btoa(o.decode(i));return e.params={message:atob(s)},e.injectParams={message:i},console.log("sui_signMessag suiMessagee suiMessageb64:>>>>",JSON.stringify(e.params),s),"sui_signMessage"===e.method?d={messageBytes:s,signature:""}:"sui_signPersonalMessage"===e.method&&(d={bytes:s,signature:""}),(0,r.logDebug)("sui_signMessage/sui_signPersonalMessage callBackParams:",JSON.stringify(d)),d}throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.METHOD_NOT_SUPPORTED)}if("btc_signMessage"===e.method){let t=(null===(a=n.namespaces[r.NameSpaceKeyBtc])||void 0===a?void 0:a.accounts.filter(function(t){return t.startsWith(e.chainId)}))[0];const i=(0,o.fromAccountToAddress)(t);if((0,r.logDebug)("btc_signMessage account and address:",JSON.stringify(t),i),i){if(!("message"in e.params&&e.params.message&&"string"==typeof e.params.message))throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.METHOD_NOT_SUPPORTED);return e.params={from:i,signStr:e.params.message},e.params.from=i,(0,r.logDebug)("btc_signMessage callBackParams:",JSON.stringify(d)),d}throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.METHOD_NOT_SUPPORTED)}if("aptos_signMessage"===e.method){let t=e.params,i=null===(c=n.namespaces[r.NameSpaceKeyAptos])||void 0===c?void 0:c.accounts.filter(function(t){return t.startsWith(e.chainId)})[0],s=(0,o.fromAccountToAddress)(i);if(t&&s){let n="APTOS",i="",o="";var u=n;let a=window.location.protocol+"//"+window.location.hostname;"address"in t&&t.address&&(u+="\naddress: "+s),"application"in t&&t.application&&(u+="\napplication: "+a);let c=1;"chainId"in t&&t.chainId&&("aptos:mainnet"==t.chainId?c=1:"movement:testnet"==t.chainId&&(c=2),u+="\nchainId: "+c),"message"in t&&(u+="\nmessage: "+t.message,i=t.message),"nonce"in t&&(u+="\nnonce: "+t.nonce,o=t.nonce);const l=(new TextEncoder).encode(u),h=Array.from(l).map(e=>e.toString(16).padStart(2,"0")).join("");return e.params={message:h},e.injectParams=t,(0,r.logDebug)("aptos_signMessage requestParams:",JSON.stringify(e)),d={address:s,application:a,chainId:c,fullMessage:u,message:i,nonce:o,prefix:n,signature:""},(0,r.logDebug)("aptos_signMessage callBackParams:",JSON.stringify(d)),d}throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.METHOD_NOT_SUPPORTED)}if("cosmos_signArbitrary"===e.method){let t=null===(l=null==n?void 0:n.namespaces[r.NameSpaceKeyCosmos])||void 0===l?void 0:l.accounts.filter(function(t){return t.startsWith(e.chainId)})[0];const i=(0,o.fromAccountToAddress)(t);let s=e.params.message;const a=btoa(s);if((0,r.logDebug)("cosmos_signArbitrary account and address:",JSON.stringify(t),i),(0,r.logDebug)("cosmos_signArbitrary cosmosBase64Encoded:",a),s&&i){const t={chain_id:"",account_number:"0",sequence:"0",fee:{gas:"0",amount:[]},msgs:[{type:"sign/MsgSignData",value:{signer:i,data:a}}],memo:""};return e.params={signer:i,chain_id:e.chainId.split(":")[1],data:t},(0,r.logDebug)("cosmos_signArbitrary callBackParams:",JSON.stringify(d)),d}throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.METHOD_NOT_SUPPORTED)}(0,r.logDebug)("sol_handleSignatureData end params:",JSON.stringify(e))}catch(h){throw h}})},e.connectMethodsResponseUpdate=function(e,n){return t(this,void 0,void 0,function*(){var t;try{if(e.signResponse){(0,r.logDebug)("connectMethodsResponseUpdate signResponse:",JSON.stringify(e.signResponse)),(0,r.logDebug)("connectMethodsResponseUpdate session.namespaces:",JSON.stringify(e.namespaces));for(const s of e.signResponse)if((0,r.logDebug)("connectMethodsResponseUpdate methodItem:",JSON.stringify(s)),"result"in s)if("solana_signMessage"===s.method){let n=s.result;(0,r.logDebug)("solana_signMessage methodItem.chainId:",s.chainId);let a=null===(t=e.namespaces[r.NameSpaceKeySOL])||void 0===t?void 0:t.accounts.filter(function(e){return(0,r.logDebug)("solana_signMessage account:",e),e.startsWith(s.chainId)})[0];(0,r.logDebug)("solana_signMessage result account:",n,a),n&&a&&(s.result={signature:i.default.decode(n),publicKey:(0,o.fromAccountToAddress)(a)})}else if("sui_signMessage"===s.method||"sui_signPersonalMessage"===s.method){let e=n.filter(function(e){return e.method===s.method})[0];if(e&&e.params&&"message"in e.params){let t=e.params.message,n=btoa(t);console.log("sui_signMessag suiMessagee suiMessageb64:>>>>",t,n),"sui_signMessage"===s.method?s.result={messageBytes:n,signature:s.result}:"sui_signPersonalMessage"===s.method&&(s.result={bytes:n,signature:s.result})}}else if("aptos_signMessage"===s.method){if(s.chainId=(0,r.replaceChainIdToChainName)(s.chainId),s.result=JSON.parse(s.result),console.log("aptos_signMessage result methodItem.result before:>>>>",JSON.stringify(s.result)),s.result&&"signature"in s.result){let e=s.result.signature;e&&e.startsWith("0x")&&(e=e.slice(2,e.length),s.result.signature=e)}console.log("aptos_signMessage result methodItem.result after:>>>>",JSON.stringify(s.result))}else if("cosmos_signArbitrary"===s.method)s.result=JSON.parse(s.result);else if("starknet_signMessage"==s.method){let e=s.result;"string"==typeof e&&(e=JSON.parse(e)),s.result=[e.signedDataR,e.signedDataS]}else"sync_all_addresses"==s.method&&(s.result=l(s.result))}}catch(s){throw(0,r.logDebug)("connectMethodsResponseUpdate signResponse Error:",JSON.stringify(s)),s}})},e.connectMethodsToConnectWalletMethods=function(n,l){return t(this,void 0,void 0,function*(){try{(0,r.logDebug)("connectMethodsToConnectWalletMethods requestMethods:",JSON.stringify(n));const d=[];if(n&&n.length>1)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"connectAndSign/openModalAndSign signRequest only support one data");if(!l&&n&&n.length>0)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"Connect request params error , RequestMethods cannot be added when the NameSpace is empty");for(const e of n)if("aptos_signMessage"===e.method&&(e.chainId=(0,r.replaceChainNameToChainId)(e.chainId)),"wallet_addEthereumChain"===e.method){if(!(null==l?void 0:l.some(e=>e.namespace.includes("eip155"))))throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`Connect request params error, When using '${e.method}', the EVM chain needs to be included in the NameSpace`)}else if("sync_all_addresses"===e.method){if(!(0,o.syncAddressHostAvailable)())throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.METHOD_NOT_SUPPORTED);e.chainId=""}else if(null==l||!l.some(t=>t.chains.some(t=>t.includes(`${e.chainId}`))))throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`Connect request params error, When using '${e.method}', NameSpace must contain '${e.chainId}'`);for(const o of n){if(!e.connectSupportMethods.includes(o.method))throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`connect requestMethods not support method, method: '${o.method}'`);if("wallet_addEthereumChain"===o.method){if(Array.isArray(o.params)){const e=o.params;if(!e||1!==e.length)throw e&&e.length>1?new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`connect request params only support one data, method: '${o.method}'`):new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`connect request params is nil, method: '${o.method}'`);{const t=e[0];a(t)&&(o.params=t)}}}else if("personal_sign"===o.method){if(s(o.params)){if(o.params&&1!==o.params.length)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`connect request params error,  method: '${o.method}' `);let e=o.params[0];if(!e||"string"!=typeof e)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`connect request params is error,  method: '${o.method}' `);o.params={message:e}}}else if("sui_signMessage"===o.method||"sui_signPersonalMessage"===o.method){if(!(a(o.params)&&"message"in o.params))throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`connect request params is error,  method: '${o.method}' `);if(!o.params.message)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`connect request params is error,  method: '${o.method}' `);{(0,r.logDebug)("sui_signMessage item.params.message :",o.params.message);let e=JSON.parse(JSON.stringify(o.params.message)),t=Object.values(e),n=new Uint8Array(t),i=new TextDecoder("utf8"),s=btoa(i.decode(n));o.params.message=atob(s)}}else if("solana_signMessage"===o.method){if(!(a(o.params)&&"message"in o.params))throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`connect request params is error,  method: '${o.method}' `);if(!o.params.message||"string"!=typeof o.params.message)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`connect request params is error,  method: '${o.method}' `);{let e=(new TextEncoder).encode(o.params.message);o.params.bs58Message=i.default.encode(e)}}else if("aptos_signMessage"===o.method){if(!a(o.params))throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`connect request params is error,  method: '${o.method}' `);if(!o.chainId)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`connect request params chainId is error,  method: '${o.method}' `);{var t=o.params,u=window.location.protocol+"//"+window.location.hostname;let e=1;"aptos:637"===o.chainId||"aptos:70000060"===o.chainId&&(e=2),o.params={data:t,applicationUrl:u,prefix:"APTOS",aptosChainId:e}}}else if("cosmos_signArbitrary"===o.method){if(!a(o.params))throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`connect request params is error,  method: '${o.method}' `);if(!o.params.message||"string"!=typeof o.params.message)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`connect request params message is error,  method: '${o.method}' `);{const e=btoa(o.params.message);let t=o.chainId.split(":")[1];if(!t)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`connect request params chainId is error,  method: '${o.method}' `);o.params={chain_id:t,data:{chain_id:"",account_number:"0",sequence:"0",fee:{gas:"0",amount:[]},msgs:[{type:"sign/MsgSignData",value:{signer:"",data:e}}],memo:""}}}}else if("tron_signMessage"==o.method){if(!a(o.params))throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`connect request params is error,  method: '${o.method}' `);if(!("message"in o.params&&o.params.message&&"string"==typeof o.params.message))throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`connect request params is error,  method: '${o.method}' `);o.params.message=c(o.params.message)}else if("btc_signMessage"==o.method){if(!a(o.params))throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`connect request params is error,  method: '${o.method}' `);if(!("message"in o.params&&o.params.message&&"string"==typeof o.params.message))throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`connect request params is error,  method: '${o.method}' `);o.params={signStr:o.params.message}}(0,r.logDebug)("connectMethodsToConnectWalletMethods item:",JSON.stringify(o)),d.push(o)}return d}catch(h){throw h}})},e.syncResoonseToRequire=l;const r=QE(),i=n(AE()),o=h_();function s(e){return"object"==typeof e&&null!==e&&Array.isArray(e)}function a(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function c(e){let t="";for(let n=0;n<e.length;n++)t+=e.charCodeAt(n).toString(16).padStart(2,"0");return t}function l(e){const t=JSON.parse(e);return{type:t.type,isEvm:t.isEvm,walletName:t.walletName,deriveName:t.deriveName,addresses:t.addresses.map(e=>({coinId:e.ci,address:e.a&&"null"!==e.a?e.a:t.evmAddress}))}}e.connectSupportMethods=Object.freeze(["personal_sign","sui_signMessage","sui_signPersonalMessage","btc_signMessage","aptos_signMessage","cosmos_signArbitrary","tron_signMessage","tron_signMessageV2","starknet_signMessage","sync_all_addresses"])}(zf)),zf}function f_(){return a_||(a_=1,e=qf,t=qf&&qf.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=qf&&qf.__exportStar||function(e,n){for(var r in e)"default"!==r&&!Object.prototype.hasOwnProperty.call(n,r)&&t(n,e,r)},Object.defineProperty(e,"__esModule",{value:!0}),n((s_||(s_=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.isMobileDiscover=e.creatNotSupportMethodItemReplay=e.connectMethodsAdaptOldVersion=void 0;var t=d_();Object.defineProperty(e,"connectMethodsAdaptOldVersion",{enumerable:!0,get:function(){return t.connectMethodsAdaptOldVersion}}),Object.defineProperty(e,"creatNotSupportMethodItemReplay",{enumerable:!0,get:function(){return t.creatNotSupportMethodItemReplay}}),Object.defineProperty(e,"isMobileDiscover",{enumerable:!0,get:function(){return t.isMobileDiscover}})}(Vf)),Vf),e)),qf;var e,t,n}var p_,g_={},m_={},y_={},v_={};function w_(){return p_||(p_=1,e=v_,Object.defineProperty(e,"__esModule",{value:!0}),e.GENERIC_SUBPROVIDER_NAME=e.RPC_URL=e.STORAGE=e.CONTEXT=e.WC_VERSION=e.PROTOCOL=e.RELAY_URL=e.LOGGER=void 0,e.LOGGER="error",e.RELAY_URL="wss://relay.walletconnect.com",e.PROTOCOL="wc",e.WC_VERSION=2,e.CONTEXT="universal_provider",e.STORAGE=`${e.PROTOCOL}@${e.WC_VERSION}:${e.CONTEXT}:`,e.RPC_URL="https://rpc.walletconnect.com/v1/",e.GENERIC_SUBPROVIDER_NAME="generic"),v_;var e}var b_,O_,E_={};function __(){return O_||(O_=1,e=y_,t=y_&&y_.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=y_&&y_.__exportStar||function(e,n){for(var r in e)"default"!==r&&!Object.prototype.hasOwnProperty.call(n,r)&&t(n,e,r)},Object.defineProperty(e,"__esModule",{value:!0}),n(w_(),e),n((b_||(b_=1,Object.defineProperty(E_,"__esModule",{value:!0}),E_.PROVIDER_EVENTS=void 0,E_.PROVIDER_EVENTS={DEFAULT_CHAIN_CHANGED:"default_chain_changed",UPDATE_NAMESPACES:"update_name_spaces",SESSION_CONNECTING:"session_connecting"}),E_),e)),y_;var e,t,n}var C_,N_={};function A_(){if(C_)return N_;C_=1;var e=N_&&N_.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(N_,"__esModule",{value:!0}),N_.JsonRpcProvider=void 0;const t=oy(),n=Jf(),r=QE(),i=QE();return N_.JsonRpcProvider=class extends n.IJSONRpcProvider{constructor(e){super(e),this.events=new t.EventEmitter,this.connected=!1,this.connecting=!1,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}connect(){return e(this,arguments,void 0,function*(e=this.connection){yield this.open(e)})}disconnect(){return e(this,void 0,void 0,function*(){yield this.close()})}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}request(t,n){return e(this,void 0,void 0,function*(){return this.requestStrict((0,r.formatJsonRpcRequest)(t.method,t.params||[],(0,r.getBigIntRpcId)().toString()),n)})}requestStrict(t,n){return e(this,void 0,void 0,function*(){return new Promise((o,s)=>e(this,void 0,void 0,function*(){if(!this.connection.connected)try{yield this.open()}catch(e){s(e)}this.events.on(`${t.id}`,e=>{(0,r.isJsonRpcError)(e)?s(e.error):o(e.result)});try{(0,i.logDebug)("[RPC] >>> send request",t,n),yield this.connection.send(t,n)}catch(e){s(e)}}))})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),(0,r.isJsonRpcResponse)(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&3e3===e.code&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}open(){return e(this,arguments,void 0,function*(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),"string"==typeof e&&(yield this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),yield this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))})}close(){return e(this,void 0,void 0,function*(){yield this.connection.close()})}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",()=>this.onClose()),this.hasRegisteredEventListeners=!0)}},N_}var R_,S_,T_,P_={},D_={exports:{}};function k_(){if(S_)return P_;S_=1;var e=P_&&P_.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})},t=P_&&P_.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(P_,"__esModule",{value:!0}),P_.JsonRpcConnection=void 0;const n=oy(),r=t((R_||(R_=1,function(e,t){var n,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||void 0!==Kf&&Kf,i=function(){function e(){this.fetch=!1,this.DOMException=r.DOMException}return e.prototype=r,new e}();n=i,function(e){var t=void 0!==n&&n||"undefined"!=typeof self&&self||void 0!==Kf&&Kf||{},r={searchParams:"URLSearchParams"in t,iterable:"Symbol"in t&&"iterator"in Symbol,blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};function i(e){return e&&DataView.prototype.isPrototypeOf(e)}if(r.arrayBuffer)var o=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],s=ArrayBuffer.isView||function(e){return e&&o.indexOf(Object.prototype.toString.call(e))>-1};function a(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||""===e)throw new TypeError('Invalid character in header field name: "'+e+'"');return e.toLowerCase()}function c(e){return"string"!=typeof e&&(e=String(e)),e}function l(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return r.iterable&&(t[Symbol.iterator]=function(){return t}),t}function u(e){this.map={},e instanceof u?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){if(2!=e.length)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+e.length);this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function h(e){if(!e._noBody){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}}function d(e){return new Promise(function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function f(e){var t=new FileReader,n=d(t);return t.readAsArrayBuffer(e),n}function p(e){var t=new FileReader,n=d(t),r=/charset=([A-Za-z0-9_-]+)/.exec(e.type),i=r?r[1]:"utf-8";return t.readAsText(e,i),n}function g(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}function m(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function y(){return this.bodyUsed=!1,this._initBody=function(e){this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:r.blob&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:r.formData&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:r.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():r.arrayBuffer&&r.blob&&i(e)?(this._bodyArrayBuffer=m(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):r.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(e)||s(e))?this._bodyArrayBuffer=m(e):this._bodyText=e=Object.prototype.toString.call(e):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):r.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},r.blob&&(this.blob=function(){var e=h(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer)return h(this)||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer));if(r.blob)return this.blob().then(f);throw new Error("could not read as ArrayBuffer")},this.text=function(){var e=h(this);if(e)return e;if(this._bodyBlob)return p(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(g(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},r.formData&&(this.formData=function(){return this.text().then(O)}),this.json=function(){return this.text().then(JSON.parse)},this}u.prototype.append=function(e,t){e=a(e),t=c(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},u.prototype.delete=function(e){delete this.map[a(e)]},u.prototype.get=function(e){return e=a(e),this.has(e)?this.map[e]:null},u.prototype.has=function(e){return this.map.hasOwnProperty(a(e))},u.prototype.set=function(e,t){this.map[a(e)]=c(t)},u.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},u.prototype.keys=function(){var e=[];return this.forEach(function(t,n){e.push(n)}),l(e)},u.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),l(e)},u.prototype.entries=function(){var e=[];return this.forEach(function(t,n){e.push([n,t])}),l(e)},r.iterable&&(u.prototype[Symbol.iterator]=u.prototype.entries);var v=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function w(e){var t=e.toUpperCase();return v.indexOf(t)>-1?t:e}function b(e,n){if(!(this instanceof b))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var r=(n=n||{}).body;if(e instanceof b){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,n.headers||(this.headers=new u(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,!r&&null!=e._bodyInit&&(r=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=n.credentials||this.credentials||"same-origin",(n.headers||!this.headers)&&(this.headers=new u(n.headers)),this.method=w(n.method||this.method||"GET"),this.mode=n.mode||this.mode||null,this.signal=n.signal||this.signal||function(){if("AbortController"in t)return(new AbortController).signal}(),this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(r),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==n.cache&&"no-cache"!==n.cache)){var i=/([?&])_=[^&]*/;i.test(this.url)?this.url=this.url.replace(i,"$1_="+(new Date).getTime()):this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}function O(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}}),t}function E(e){var t=new u;return e.replace(/\r?\n[\t ]+/g," ").split("\r").map(function(e){return 0===e.indexOf("\n")?e.substr(1,e.length):e}).forEach(function(e){var n=e.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();try{t.append(r,i)}catch(o){console.warn("Response "+o.message)}}}),t}function _(e,t){if(!(this instanceof _))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=void 0===t.statusText?"":""+t.statusText,this.headers=new u(t.headers),this.url=t.url||"",this._initBody(e)}b.prototype.clone=function(){return new b(this,{body:this._bodyInit})},y.call(b.prototype),y.call(_.prototype),_.prototype.clone=function(){return new _(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new u(this.headers),url:this.url})},_.error=function(){var e=new _(null,{status:200,statusText:""});return e.ok=!1,e.status=0,e.type="error",e};var C=[301,302,303,307,308];_.redirect=function(e,t){if(-1===C.indexOf(t))throw new RangeError("Invalid status code");return new _(null,{status:t,headers:{location:e}})},e.DOMException=t.DOMException;try{new e.DOMException}catch{e.DOMException=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function N(n,i){return new Promise(function(o,s){var l=new b(n,i);if(l.signal&&l.signal.aborted)return s(new e.DOMException("Aborted","AbortError"));var h=new XMLHttpRequest;function d(){h.abort()}if(h.onload=function(){var e={statusText:h.statusText,headers:E(h.getAllResponseHeaders()||"")};0===l.url.indexOf("file://")&&(h.status<200||h.status>599)?e.status=200:e.status=h.status,e.url="responseURL"in h?h.responseURL:e.headers.get("X-Request-URL");var t="response"in h?h.response:h.responseText;setTimeout(function(){o(new _(t,e))},0)},h.onerror=function(){setTimeout(function(){s(new TypeError("Network request failed"))},0)},h.ontimeout=function(){setTimeout(function(){s(new TypeError("Network request timed out"))},0)},h.onabort=function(){setTimeout(function(){s(new e.DOMException("Aborted","AbortError"))},0)},h.open(l.method,function(e){try{return""===e&&t.location.href?t.location.href:e}catch{return e}}(l.url),!0),"include"===l.credentials?h.withCredentials=!0:"omit"===l.credentials&&(h.withCredentials=!1),"responseType"in h&&(r.blob?h.responseType="blob":r.arrayBuffer&&(h.responseType="arraybuffer")),i&&"object"==typeof i.headers&&!(i.headers instanceof u||t.Headers&&i.headers instanceof t.Headers)){var f=[];Object.getOwnPropertyNames(i.headers).forEach(function(e){f.push(a(e)),h.setRequestHeader(e,c(i.headers[e]))}),l.headers.forEach(function(e,t){-1===f.indexOf(t)&&h.setRequestHeader(t,e)})}else l.headers.forEach(function(e,t){h.setRequestHeader(t,e)});l.signal&&(l.signal.addEventListener("abort",d),h.onreadystatechange=function(){4===h.readyState&&l.signal.removeEventListener("abort",d)}),h.send(void 0===l._bodyInit?null:l._bodyInit)})}N.polyfill=!0,t.fetch||(t.fetch=N,t.Headers=u,t.Request=b,t.Response=_),e.Headers=u,e.Request=b,e.Response=_,e.fetch=N,Object.defineProperty(e,"__esModule",{value:!0})}({}),i.fetch.ponyfill=!0,delete i.fetch.polyfill;var o=r.fetch?r:i;(t=o.fetch).default=o.fetch,t.fetch=o.fetch,t.Headers=o.Headers,t.Request=o.Request,t.Response=o.Response,e.exports=t}(D_,D_.exports)),D_.exports)),i=QE(),o=QE(),s={headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST"};return P_.JsonRpcConnection=class{constructor(e,t=!1){if(this.url=e,this.disableProviderPing=t,this.events=new n.EventEmitter,this.isAvailable=!1,this.registering=!1,!(0,o.isHttpUrl)(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}open(){return e(this,arguments,void 0,function*(e=this.url){yield this.register(e)})}close(){return e(this,void 0,void 0,function*(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()})}send(t){return e(this,void 0,void 0,function*(){this.isAvailable||(yield this.register());try{const n=(0,i.safeJsonStringify)(t),o=yield(yield(0,r.default)(this.url,Object.assign(Object.assign({},s),{body:n}))).json();this.onPayload({data:o})}catch(e){this.onError(t.id,e)}})}register(){return e(this,arguments,void 0,function*(e=this.url){if(!(0,o.isHttpUrl)(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering)return new Promise((e,t)=>{this.events.once("register_error",e=>{t(e)}),this.events.once("open",()=>{if(void 0===this.isAvailable)return t(new Error("HTTP connection is missing or invalid"));e()})});this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const t=(0,i.safeJsonStringify)({id:1,jsonrpc:"2.0",method:"test",params:[]});yield(0,r.default)(e,Object.assign(Object.assign({},s),{body:t}))}this.onOpen()}catch(t){const e=this.parseError(t);throw this.events.emit("register_error",e),this.onClose(),e}})}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(void 0===e.data)return;const t="string"==typeof e.data?(0,i.safeJsonParse)(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const n=this.parseError(t),r=n.message||n.toString(),i=(0,o.formatJsonRpcError)(e,r);this.events.emit("payload",i)}parseError(e,t=this.url){return(0,o.parseConnectionError)(e,t,"HTTP")}},P_}function I_(){if(T_)return m_;T_=1;var e=m_&&m_.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(m_,"__esModule",{value:!0}),m_.Eip155Provider=void 0;const t=u_(),n=__(),r=QE(),i=A_(),o=k_();class s{constructor(e,t,n){this.name="eip155",this.namespace=e.namespace,this.events=n,this.client=t,this.chainId=parseInt(this.getDefaultChain()),this.httpProviders=this.createHttpProviders(),(0,r.logDebug)("eip155 constructor --opts.namespace--\x3e",e.namespace)}isRecord(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}isArray(e){return"object"==typeof e&&null!==e&&Array.isArray(e)}updateRequestParams(e){let t=e.params&&"object"==typeof e.params&&!Array.isArray(e.params);if("wallet_switchEthereumChain"===e.method){const n=e.chainId.split(":")[1],i=parseInt(n,10);if(isNaN(i))throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.NOT_CONNECTED_ERROR,`Invalid decimal number,  chainId: '${n}' `);if(e.params){if(!t)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.NOT_CONNECTED_ERROR,`Request params error ,  method: '${e.method}' `);{let t=e.params;"chainId"in t||(t.chainId="0x"+i.toString(16),e.params=t)}}else e.params={chainId:"0x"+i.toString(16)}}else if("personal_sign"===e.method||"eth_signTypedData_v4"===e.method||"eth_sendTransaction"===e.method||"wallet_watchAsset"===e.method){if(!e.params)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.NOT_CONNECTED_ERROR,`Request params is nil, method: '${e.method}'`);if(!this.isRecord(e.params))throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.NOT_CONNECTED_ERROR,`Invalid request params type, method: '${e.method}'`);{let t=e.params;if((0,r.logDebug)("eip155 updateRequestParams params>",JSON.stringify(t)),"chainId"in t){const n=e.chainId.split(":")[1],i=parseInt(n,10);let o,s=String(t.chainId);if(s.startsWith(this.name)&&e.chainId===s)o=i;else if(s.startsWith("0x"))o=parseInt(s,16);else{if(isNaN(Number(s)))throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.NOT_CONNECTED_ERROR,`Invalid params.chainId format, method: '${e.method}'`);o=parseInt(s,10)}if(i!==o)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.NOT_CONNECTED_ERROR,`Request params.chainId not equal chain,  method: '${e.method}' `)}}}}adaptArray(e){if("wallet_switchEthereumChain"===e.method||"wallet_addEthereumChain"===e.method||"wallet_watchAsset"===e.method||"eth_sendTransaction"===e.method||"kaia_signTransaction"===e.method||"klay_signTransaction"===e.method){if(this.isArray(e.params)){let t=e.params;if(t){if(1!==t.length)throw t.length>1?new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`Request params only Support one data,  method: '${e.method}' `):new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`Request params is nil,  method: '${e.method}' `);{let t=e.params[0];this.isRecord(t)&&(e.params=t)}}}}else if("eth_signTypedData_v4"===e.method){if(this.isArray(e.params)){let n=e.params;if(n&&n.length>2)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`Request params only Support one data,  method: '${e.method}' `);if(n&&0===n.length)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`Request params is nil,  method: '${e.method}' `);let i={};if(n&&2===n.length){let n=e.params[0];if(!n||"string"!=typeof n)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`Request params address error , not string,  method: '${e.method}' `);{let o=!1;if(this.namespace.accounts.forEach(e=>{(0,t.fromAccountToAddress)(e).toLowerCase()===n.toLowerCase()&&(o=!0)}),(0,r.logDebug)("eip155 adaptArray eth_signTypedData_v4 >>>isEqual: ",o),!o)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`Request params address error, not equal,  method: '${e.method}' `);if(!this.isRecord(e.params[1]))throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`Request params message data error,  method: '${e.method}' `);i=e.params[1]}}else if(n&&1===n.length){if(!this.isRecord(e.params[0]))throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`Request params message data error,  method: '${e.method}' `);i=e.params[0]}try{let t=JSON.stringify(i);e.params={typedDataJson:t}}catch{throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`Request params call JSON.stringify() failed,  method: '${e.method}' `)}}}else if("personal_sign"===e.method&&this.isArray(e.params)){if(e.params&&e.params.length>2)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`Request params error,  method: '${e.method}' `);if(e.params&&0===e.params.length)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`Request params is nil,  method: '${e.method}' `);let n=e.params[0],i=e.params[1];if(i&&"string"==typeof i){let n=!1;if(this.namespace.accounts.forEach(e=>{(0,t.fromAccountToAddress)(e).toLowerCase()===i.toLowerCase()&&(n=!0)}),(0,r.logDebug)("eip155 adaptArray personal_sign >>>isEqual: ",n),!n)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`Request params address error,  method: '${e.method}' `)}if(!n||"string"!=typeof n)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`Request params is error,  method: '${e.method}' `);e.params={message:n}}}showRequestModal(e){switch(e.method){case"eth_requestAccounts":case"eth_accounts":case"eth_chainId":return!1;case"eth_sendTransaction":case"eth_signTransaction":case"eth_sign":case"personal_sign":case"eth_signTypedData":case"wallet_addEthereumChain":case"wallet_watchAsset":case"eth_signTypedData_v4":return!0;case"wallet_switchEthereumChain":{this.adaptArray(e),this.updateRequestParams(e);const{parsedChainId:t,hexChainId:n}=this.getHexChainIdFromRequest(e);return!this.isChainApproved(t)}default:return!1}return!1}configAddressAdaptInjectWallet(e){this.namespace.accounts.forEach(n=>{n.includes(e.chainId)&&(e.address=(0,t.fromAccountToAddress)(n))})}request(t){return e(this,void 0,void 0,function*(){if("eth_signLegacy"===t.method||"eth_sign"===t.method)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.METHOD_NOT_SUPPORTED,`${t.method} method not supported`);switch(t.injectParams=t.params,this.adaptArray(t),this.client.needCheckRequestMethod()&&"klay_signTransaction"===t.method&&(t.method="kaia_signTransaction"),(0,r.logDebug)("eip155 request --args--string>",JSON.stringify(t)),this.updateRequestParams(t),(0,r.logDebug)("eip155 request --params--string>",JSON.stringify(t)),this.configAddressAdaptInjectWallet(t),t.method){case"eth_requestAccounts":case"eth_accounts":return this.getAccounts();case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_switchEthereumChain":return yield this.handleSwitchChain(t);case"wallet_addEthereumChain":return this.addEthereumChain(t)}if(this.client.needCheckRequestMethod()&&!this.namespace.methods.includes(t.method))return(0,r.logDebug)("[RPC] request begin"),yield this.getHttpProvider().request(t);if(this.client.needCheckRequestMethod()&&("eth_sendTransaction"===t.method||"kaia_signTransaction"===t.method))try{if(t.params&&"object"==typeof t.params&&!Array.isArray(t.params)){const e=t.params;"string"==typeof e.input&&""!==e.input.trim()?!e.data||"string"==typeof e.data&&""===e.data.trim()?(e.data=e.input,(0,r.logDebug)("eip155 sendTransaction:  replace data with input")):(0,r.logDebug)("eip155 sendTransaction:  data not empty"):(0,r.logDebug)("eip155 sendTransaction:  input empty")}}catch{(0,r.logDebug)("eip155 sendTransaction:  replace error")}try{const n=yield this.client.request(t);if((0,r.logDebug)("eip155 request --response----string>",JSON.stringify(n)),this.isRecord(n)&&"result"in n){let e=n.result;return!e||"string"!=typeof e||"true"!==e&&"false"!==e?n.result:((0,r.logDebug)("eip155 request --wallet_watchAsset>>>>","true"===e),"true"===e)}return n}catch(e){throw(0,r.logDebug)(`eip155 request --response --error--string> e instanceof OKXConnectError ${e instanceof r.OKXConnectError}`,JSON.stringify(e)),e}})}addEthereumChain(t){return e(this,void 0,void 0,function*(){let e=yield this.client.request(t);try{if("result"in e){let r=e.result;if(r){const e=r.split(":")[0],i=r.split(":")[1],o=e+":"+i;if(this.namespace,this.namespace.accounts.push(r),this.namespace.chains.push(o),this.isRecord(t.params)&&"rpcUrls"in t.params){let e=t.params.rpcUrls,n=e?e[0]:void 0;n&&(this.namespace.rpcMap?this.namespace.rpcMap[i]=n:this.namespace.rpcMap={[i]:n},this.setHttpProvider(i,n))}this.events.emit(n.PROVIDER_EVENTS.UPDATE_NAMESPACES,{eip155:this.namespace})}}else new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`the method ${t.method} request error`)}catch{throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`the method ${t.method} request  error`)}return null})}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,i){if(this.chainId=parseInt(e),!this.httpProviders[e]){const n=i||(0,t.getRpcUrl)(`${this.name}:${e}`,this.namespace);n?this.setHttpProvider(e,n):(0,r.logDebug)(`No RPC url provided for chainId: ${e}`)}this.events.emit(n.PROVIDER_EVENTS.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return(0,r.logDebug)("eip155 getAccounts ",e,this.chainId),e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>(0,t.fromAccountToAddress)(e)))]:[]}getHexChainIdFromRequest(e){let t=e.params,n="0x0";t&&"chainId"in t&&(n=t.chainId),n=n.startsWith("0x")?n:`0x${n}`,(0,r.logDebug)("handleSwitchChain --\x3eargs ",e),(0,r.logDebug)("handleSwitchChain --\x3ehexChainId ",n);const i=parseInt(n,16);return(0,r.logDebug)("handleSwitchChain --\x3eparsedChainId ",i),{parsedChainId:i,hexChainId:n}}handleSwitchChain(t){return e(this,void 0,void 0,function*(){const{parsedChainId:e,hexChainId:n}=this.getHexChainIdFromRequest(t);if(!this.isChainApproved(e))throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.CHAIN_NOT_SUPPORTED,`the method ${t.method} request  error`);this.setDefaultChain(`${e}`)})}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}createHttpProvider(e,n){const s=n;if(s)return new i.JsonRpcProvider(new o.JsonRpcConnection(s,(0,t.getGlobal)("disableProviderPing")));(0,r.logDebug)(`No RPC url provided for chainId: ${e}`)}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{const i=(0,t.getChainId)(n),o=(0,t.getRpcUrl)(n,this.namespace);(0,r.logDebug)("get parsed chain and rpc:",i,o);let s=this.createHttpProvider(i,o);s&&(e[i]=s)}),(0,r.logDebug)("get http providermap:",e),e}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}getHttpProvider(){const e=`${this.chainId}`,t=this.httpProviders[e];if((0,r.logDebug)("[RPC] get http provider:",e,t),void 0===t)throw new Error(`JSON-RPC provider for ${e} not found`);return t}}return m_.Eip155Provider=s,m_.default=s,m_}var x_,M_={};function K_(){if(x_)return M_;x_=1;var e=M_&&M_.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(M_,"__esModule",{value:!0}),M_.SuiProvider=void 0;const t=__(),n=QE(),r=u_(),i=k_(),o=A_();class s{constructor(e,t,r){this.name=n.NameSpaceKeySui,this.namespace=e.namespace,this.events=r,this.client=t,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}request(t){return e(this,void 0,void 0,function*(){if((0,n.logDebug)("sui request --args--string>",JSON.stringify(t)),(0,n.logDebug)("sui provider namespace: ",this.namespace),t.injectParams){if("chain"in t&&n.SUI_CHAINS.MAINNET!=t.chain)throw new n.OKXConnectError(n.OKX_CONNECT_ERROR_CODES.CHAIN_NOT_SUPPORTED);if(t.injectParams.chain=n.SUI_CHAINS.MAINNET,"account"in t&&t.account.address!=this.getAccounts[0])throw new n.OKXConnectError(n.OKX_CONNECT_ERROR_CODES.BAD_REQUEST_ERROR);t.injectParams.account={address:this.getAccounts()[0]}}return!this.client.needCheckRequestMethod()||this.namespace.methods.includes(t.method)?this.client.request(t):this.getHttpProvider().request(t)})}requestAccounts(){return this.getAccounts()}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(t.PROVIDER_EVENTS.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const n=(0,r.getChainId)(t),i=(0,r.getRpcUrl)(t,this.namespace);let o=this.createHttpProvider(n,i);o&&(e[n]=o)}),e}getHttpProvider(){const e=`${this.chainId}`,t=this.httpProviders[e];if((0,n.logDebug)("[RPC] get http provider:",e,t),void 0===t)throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&((0,n.logDebug)("setHttpProvider",e,t),this.httpProviders[e]=r)}createHttpProvider(e,t){const s=t;if(s)return new o.JsonRpcProvider(new i.JsonRpcConnection(s,(0,r.getGlobal)("disableProviderPing")));(0,n.logDebug)(`No RPC url provided for chainId: ${e}`)}getPubkey(e){return this.getWalletAddress(e)}getWalletAddress(e){return e||null!=(e=this.namespace.defaultChain)&&e.startsWith("sui")||(e=`sui:${e}`),this.namespace.accounts.filter(function(t){return t.split(":").length>2&&t.startsWith(e)}).map(function(e){return e.split(":")[2]})[0]}showRequestModal(e){switch(e.method){case"sui_signMessage":case"sui_signPersonalMessage":case"sui_signTransactionBlock":case"sui_signAndExecuteTransactionBlock":return!0;default:return!1}return!1}}return M_.SuiProvider=s,M_.default=s,M_}var L_,U_,B_={},j_={};function H_(){if(L_)return j_;L_=1,Object.defineProperty(j_,"__esModule",{value:!0}),j_.getAccountsChains=function(e){const t=[];return e.forEach(e=>{const[n,r]=e.split(":");t.push(`${n}:${r}`)}),t},j_.nameSpaceToConnectWalletNameSpace=function(t){var n=[];return t&&Object.keys(t).forEach(r=>{(r===e.NameSpaceKeyEip155||r===e.NameSpaceKeySOL||r===e.NameSpaceKeySui||r===e.NameSpaceKeyAptos||r==e.NameSpaceKeyBtc||r===e.NameSpaceKeyTON||r===e.NameSpaceKeyCosmos||r===e.NameSpaceKeyTron||r===e.NameSpaceKeyStarknet)&&t[r].chains&&n.push({namespace:r,chains:t[r].chains,params:t[r].params})}),n},j_.fillParamsToSession=function(n,r,i,o){const s=(e,t)=>{Object.assign(e,t)},a=(e,t)=>{for(const n in t)t.hasOwnProperty(n)&&t[n].rpcMap&&(t[n].rpcMap&&(e[n].rpcMap||(e[n].rpcMap={}),s(e[n].rpcMap,t[n].rpcMap)),t[n].defaultChain&&void 0===e[n].defaultChain&&e[n].chains.some(e=>e.split(":")[1]===t[n].defaultChain)&&(e[n].defaultChain=t[n].defaultChain))};r&&a(n.namespaces,r),i&&a(n.namespaces,i);for(const e in n.namespaces){const t=n.namespaces[e];(null==t||!t.accounts||0===t.accounts.length)&&delete n.namespaces[e]}n.namespaces[e.NameSpaceKeyBtc]&&n.wallet.appName===e.OKXWalletName&&t(n.namespaces[e.NameSpaceKeyBtc]),n.sessionConfig=o},j_.isCaipNamespace=n,j_.parseNamespaceKey=function(e){return n(e)?e.split(":")[0]:e};const e=QE();function t(t){try{if(t&&t.extra){var n=t.extra;Object.keys(n).forEach(e=>{const t=n[e];6===Number(t.addressType)?t.publicKey=t.compressedPublicKey.slice(2):t.publicKey=t.compressedPublicKey})}}catch{(0,e.logDebug)("namespaces fixMobileBtcSession error")}}function n(e){return e.includes(":")}return j_}function W_(){if(U_)return B_;U_=1;var e=B_&&B_.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(B_,"__esModule",{value:!0}),B_.SignClient=void 0;const t=QE(),n=H_(),r=d_(),i=__();return B_.SignClient=class extends t.ISignClient{constructor(o,s,a){super(o),this.connect=o=>e(this,void 0,void 0,function*(){return new Promise((s,a)=>e(this,void 0,void 0,function*(){try{var c=[];(0,t.logDebug)("client connect params >>>",JSON.stringify(o));var l={name:"requestAccounts",requiredNamespaces:(0,n.nameSpaceToConnectWalletNameSpace)(o.namespaces),optionalNamespaces:(0,n.nameSpaceToConnectWalletNameSpace)(o.optionalNamespaces)};this.engine.setSessionConnectingListener(()=>{(0,t.logDebug)("sessionConnectingListener >>>"),this.events.emit(i.PROVIDER_EVENTS.SESSION_CONNECTING)}),o.signRequest&&(l.connectRequestMethods=yield(0,r.connectMethodsToConnectWalletMethods)(o.signRequest,l.requiredNamespaces)),c.push(l),(0,t.logDebug)("client connect connectRequest >>>",JSON.stringify(c)),this.engine.universalConnect(c,Object.assign({dappInfo:this.metadata},o.sessionConfig),e=>{e&&e.connectRequest&&((0,t.logDebug)("universalConect info.connectRequest :",e.connectRequest),(0,t.logDebug)("universalConect url:",(0,t.getOKXLink)(e.connectRequest,this.sessionConfig.useMini)),this.events.emit("display_uri",(0,t.getOKXLink)(e.connectRequest,this.sessionConfig.useMini).universalLink),this.events.emit("short_display_uri",(0,t.getAppWalletShortDeepLink)(e.connectRequest.topic,e.connectRequest.clientId)),(0,t.logDebug)(`universalConect EngineConnectInfo  ${JSON.stringify(e)}`),this.events.emit("okx_engine_connect_params",e))}).then(i=>e(this,void 0,void 0,function*(){(0,n.fillParamsToSession)(i,o.namespaces,o.optionalNamespaces,this.sessionConfig),(0,t.logDebug)(`signClient: connect: session ${JSON.stringify(i)}`),o.signRequest&&(yield(0,r.connectMethodsResponseUpdate)(i,o.signRequest)),s(i)})).catch(e=>{(0,t.logDebug)(`signClient: connect: catch ${JSON.stringify(e)}`),this.events.emit("connect_error",e),a(e)})}catch(u){(0,t.logDebug)(`signClient: connect:  ${JSON.stringify(u)}`),a(u)}}))}),this.restoreconnect=t=>e(this,void 0,void 0,function*(){return new Promise((e,n)=>{this.engine.restoreconnect(t,t=>{t?e(t):n()})})}),this.reject=()=>e(this,void 0,void 0,function*(){}),this.request=n=>e(this,void 0,void 0,function*(){return new Promise((r,i)=>e(this,void 0,void 0,function*(){var e,o;(0,t.logDebug)("clint request --params>>>> >",null===(e=this.sessionConfig)||void 0===e?void 0:e.openUniversalUrl,(0,t.safeJsonStringify)(n));try{!(null===(o=this.sessionConfig)||void 0===o)&&o.openUniversalUrl&&(0,t.isIos)()&&this.openOKXWallet(),yield this.engine.send(n,{resolve:e=>{if(delete e.requestId,(0,t.logDebug)("clint request --response >",(0,t.safeJsonStringify)(e)),"error"in e&&e.error){let n=e.error;i(new t.OKXConnectError(e.error.code,e.method+":"+n.message))}else r(e)},onAck:()=>{var e;!(0,t.isIos)()&&null!==(e=this.sessionConfig)&&void 0!==e&&e.openUniversalUrl&&this.openOKXWallet()}})}catch(s){(0,t.logDebug)("clint request --error:",s),i(s)}}))}),this.disconnect=()=>e(this,void 0,void 0,function*(){return new Promise((e,t)=>{this.engine.send({method:"disconnect"},{onAck:()=>{e()}},864e5).catch(e=>{console.log(`disconnect : ${JSON.stringify(e)}`),t(e)})})}),this.engine=new t.Engine(o.name),this.events=s,this.metadata=o,this.openAppLineType=null!=a?a:t.OpenAppLinkType.UniversalLink}setAccountChangeListener(e){this.engine.setAccountChangeListener(e)}openOKXWallet(){(0,t.logDebug)("bridge-provider ==>> connect_5"),this.engine.openWallet({tmaReturnUrl:this.sessionConfig.tmaReturnUrl},null,this.openAppLineType)}syncAllAddress(){return e(this,void 0,void 0,function*(){return new Promise((e,n)=>{this.engine.send({method:"sync_all_addresses"},{resolve:i=>{if(delete i.requestId,(0,t.logDebug)("clint syncAllAddress --response >",JSON.stringify(i)),"error"in i&&i.error){let e=i.error;n(new t.OKXConnectError(i.error.code,i.method+":"+e.message))}else{let t=i.result;e((0,r.syncResoonseToRequire)(t))}}}).catch(e=>{console.log(`disconnect : ${JSON.stringify(e)}`),n(e)})})})}registerConnector(e){this.engine.registerConnector(e)}openWallet(e,t){this.engine.openWallet(e,t,this.openAppLineType)}setConnectConnector(e){this.engine.setConnectConnector(e)}needCheckRequestMethod(){try{return!Object.values(t.CONNECTOR_TYPE.INJECT).includes(this.engine.getConnector().getType())&&!Object.values(t.CONNECTOR_TYPE.KEYLESS).includes(this.engine.getConnector().getType())}catch{return!0}}},B_}var X_,F_={};function J_(){if(X_)return F_;X_=1;var e=F_&&F_.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(F_,"__esModule",{value:!0}),F_.SolanaProvider=void 0;const t=__(),n=QE(),r=u_(),i=k_(),o=A_();class s{constructor(e,t,n,r){this.name="solana",this.namespace=e.namespace,this.events=r,this.client=n,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders(),this.name=t}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(t){return e(this,void 0,void 0,function*(){if((0,n.logDebug)("solana request --args--string>",JSON.stringify(t)),(0,n.logDebug)("solana provider namespace: ",this.namespace),!this.client.needCheckRequestMethod()||this.namespace.methods.includes(t.method))return this.client.request(t);throw new n.OKXConnectError(n.OKX_CONNECT_ERROR_CODES.METHOD_NOT_SUPPORTED,"Please upgrade OKX APP")})}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(t.PROVIDER_EVENTS.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const n=(0,r.getChainId)(t),i=(0,r.getRpcUrl)(t,this.namespace);let o=this.createHttpProvider(n,i);o&&(e[n]=o)}),e}getHttpProvider(){const e=`${this.chainId}`,t=this.httpProviders[e];if(void 0===t)throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t;if(n)return new o.JsonRpcProvider(new i.JsonRpcConnection(n,(0,r.getGlobal)("disableProviderPing")))}getPubkey(e){return this.getWalletAddress(e)}getWalletAddress(e){return e||null!=(e=this.namespace.defaultChain)&&e.startsWith("solana")||(e=`solana:${e}`),this.namespace.accounts.filter(function(t){return t.split(":").length>2&&t.startsWith(e)}).map(function(e){return e.split(":")[2]})[0]}showRequestModal(e){return!0}}return F_.SolanaProvider=s,F_.default=s,F_}var G_,q_={};function V_(){if(G_)return q_;G_=1;var e=q_&&q_.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(q_,"__esModule",{value:!0});const t=__(),n=QE(),r=u_(),i=k_(),o=A_();return q_.default=class{constructor(e,t,r,i){this.name=n.NameSpaceKeyBtc,this.namespace=e.namespace,this.events=i,this.client=r,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders(),this.name=t}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(t){return e(this,void 0,void 0,function*(){return(0,n.logDebug)("btc request --args--string>",JSON.stringify(t)),(0,n.logDebug)("btc provider namespace: ",JSON.stringify(this.namespace)),!this.client.needCheckRequestMethod()||this.namespace.methods.includes(t.method)?this.client.request(t):this.getHttpProvider().request(t)})}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(t.PROVIDER_EVENTS.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const n=(0,r.getChainId)(t),i=(0,r.getRpcUrl)(t,this.namespace);let o=this.createHttpProvider(n,i);o&&(e[n]=o)}),e}getHttpProvider(){const e=`${this.chainId}`,t=this.httpProviders[e];if(void 0===t)throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const s=t;if(s)return new o.JsonRpcProvider(new i.JsonRpcConnection(s,(0,r.getGlobal)("disableProviderPing")));(0,n.logDebug)(`No RPC url provided for chainId: ${e}`)}showRequestModal(e){return!0}},q_}var z_,Q_={};function $_(){if(z_)return Q_;z_=1;var e=Q_&&Q_.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(Q_,"__esModule",{value:!0});const t=__(),n=QE(),r=u_(),i=k_(),o=A_();return Q_.default=class{constructor(e,t,n,r){this.name="aptos",this.namespace=e.namespace,this.events=r,this.client=n,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders(),this.name=t}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(t){return e(this,void 0,void 0,function*(){if((0,n.logDebug)("aptos request --args--string>",(0,n.safeJsonStringify)(t)),(0,n.logDebug)("aptos provider namespace: ",this.namespace),!this.client.needCheckRequestMethod()||this.namespace.methods.includes(t.method))return this.client.request(t);throw new n.OKXConnectError(n.OKX_CONNECT_ERROR_CODES.METHOD_NOT_SUPPORTED,"Please upgrade OKX APP")})}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(t.PROVIDER_EVENTS.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const n=(0,r.getChainId)(t),i=(0,r.getRpcUrl)(t,this.namespace);let o=this.createHttpProvider(n,i);o&&(e[n]=o)}),e}getHttpProvider(){const e=`${this.chainId}`,t=this.httpProviders[e];if(void 0===t)throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t;if(n)return new o.JsonRpcProvider(new i.JsonRpcConnection(n,(0,r.getGlobal)("disableProviderPing")))}showRequestModal(e){return!0}},Q_}var Y_,Z_={};function eC(){if(Y_)return Z_;Y_=1;var e=Z_&&Z_.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})},t=Z_&&Z_.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};Object.defineProperty(Z_,"__esModule",{value:!0});const n=__(),r=QE(),i=u_(),o=k_(),s=A_();return Z_.default=class{constructor(e,t,n){this.name=r.NameSpaceKeyTON,this.namespace=e.namespace,this.events=n,this.client=t,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}isRecord(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}request(n){return e(this,void 0,void 0,function*(){var e,i,o,s;if((0,r.logDebug)("TONProvider request --args--string>",JSON.stringify(n)),(0,r.logDebug)("TONProvider request provider namespace: ",this.namespace),!this.client.needCheckRequestMethod()||this.namespace.methods.includes(n.method)){if(!n.params)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"ton request params is nil");if(this.isRecord(n.params)){const a=n.params,{validUntil:c}=a,l=t(a,["validUntil"]);let u=null===(i=null===(e=this.namespace.payload)||void 0===e?void 0:e.ton_addr)||void 0===i?void 0:i.address;"from"in l&&(u=l.from||(null===(s=null===(o=this.namespace.payload)||void 0===o?void 0:o.ton_addr)||void 0===s?void 0:s.address)),n.params.from=u,n.params.network=this.getDefaultChain(),n.params.valid_until=c;let h=yield this.client.request(n);if(this.isRecord(h)&&"result"in h){const e={boc:h.result.toString()};return(0,r.logDebug)("TONProvider request provider response: ",JSON.stringify(h)),(0,r.logDebug)("TONProvider request provider result: ",JSON.stringify(e)),e}throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"ton_send request response is nil")}throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"ton request params type add nil")}return this.getHttpProvider().request(n)})}requestAccounts(){return this.getAccounts()}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(n.PROVIDER_EVENTS.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){var e,t;const n=this.namespace.accounts;if((0,r.logDebug)("ton getAccounts accounts :",n),(0,r.logDebug)("ton getAccounts .namespace :",JSON.stringify(this.namespace)),!n)return[];let i=null===(t=null===(e=this.namespace.payload)||void 0===e?void 0:e.ton_addr)||void 0===t?void 0:t.address;return(0,r.logDebug)("ton getAccounts address :",i),i?[i]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const n=(0,i.getChainId)(t),r=(0,i.getRpcUrl)(t,this.namespace);let o=this.createHttpProvider(n,r);o&&(e[n]=o)}),e}getHttpProvider(){const e=`${this.chainId}`,t=this.httpProviders[e];if((0,r.logDebug)("[RPC] get http provider:",e,t),void 0===t)throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&((0,r.logDebug)("setHttpProvider",e,t),this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t;if(n)return new s.JsonRpcProvider(new o.JsonRpcConnection(n,(0,i.getGlobal)("disableProviderPing")));(0,r.logDebug)(`No RPC url provided for chainId: ${e}`)}showRequestModal(e){switch(e.method){case"ton_sendTransaction":return!0;default:return!1}}},Z_}var tC,nC={};function rC(){if(tC)return nC;tC=1;var e=nC&&nC.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(nC,"__esModule",{value:!0});const t=__(),n=QE(),r=u_(),i=k_(),o=A_();return nC.default=class{constructor(e,t,r){this.name=n.NameSpaceKeyCosmos,this.namespace=e.namespace,this.events=r,this.client=t,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(t){return e(this,void 0,void 0,function*(){if((0,n.logDebug)("cosmos request --args--string>",JSON.stringify(t)),(0,n.logDebug)("cosmos provider namespace: ",JSON.stringify(this.namespace)),!this.client.needCheckRequestMethod()||this.namespace.methods.includes(t.method))return this.client.request(t);throw new n.OKXConnectError(n.OKX_CONNECT_ERROR_CODES.METHOD_NOT_SUPPORTED,"Please upgrade OKX APP")})}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(t.PROVIDER_EVENTS.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const n=(0,r.getChainId)(t),i=(0,r.getRpcUrl)(t,this.namespace);let o=this.createHttpProvider(n,i);o&&(e[n]=o)}),e}getHttpProvider(){const e=`${this.chainId}`,t=this.httpProviders[e];if(void 0===t)throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t;if(n)return new o.JsonRpcProvider(new i.JsonRpcConnection(n,(0,r.getGlobal)("disableProviderPing")))}showRequestModal(e){return!0}},nC}var iC,oC={};function sC(){if(iC)return oC;iC=1;var e=oC&&oC.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(oC,"__esModule",{value:!0});const t=__(),n=QE(),r=u_(),i=k_(),o=A_();return oC.default=class{constructor(e,t,r){this.name=n.NameSpaceKeyTron,this.namespace=e.namespace,this.events=r,this.client=t,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(t){return e(this,void 0,void 0,function*(){if((0,n.logDebug)("tron request --args--string>",JSON.stringify(t)),(0,n.logDebug)("tron provider namespace: ",JSON.stringify(this.namespace)),!this.client.needCheckRequestMethod()||this.namespace.methods.includes(t.method))return this.client.request(t);throw new n.OKXConnectError(n.OKX_CONNECT_ERROR_CODES.METHOD_NOT_SUPPORTED,"Please upgrade OKX APP")})}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(t.PROVIDER_EVENTS.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const n=(0,r.getChainId)(t),i=(0,r.getRpcUrl)(t,this.namespace);let o=this.createHttpProvider(n,i);o&&(e[n]=o)}),e}getHttpProvider(){const e=`${this.chainId}`,t=this.httpProviders[e];if(void 0===t)throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t;if(n)return new o.JsonRpcProvider(new i.JsonRpcConnection(n,(0,r.getGlobal)("disableProviderPing")))}showRequestModal(e){return!0}},oC}var aC,cC,lC={};function uC(){if(aC)return lC;aC=1;var e=lC&&lC.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(lC,"__esModule",{value:!0});const t=__(),n=QE(),r=u_(),i=k_(),o=A_();return lC.default=class{constructor(e,t,n,r){this.name="starknet",this.namespace=e.namespace,this.events=r,this.client=n,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders(),this.name=t}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(t){return e(this,void 0,void 0,function*(){if((0,n.logDebug)("starknet request --args--string>",JSON.stringify(t)),(0,n.logDebug)("starknet provider namespace: ",this.namespace),!this.client.needCheckRequestMethod()||this.namespace.methods.includes(t.method))return this.client.request(t);throw new n.OKXConnectError(n.OKX_CONNECT_ERROR_CODES.METHOD_NOT_SUPPORTED,"Wallet doesn't support"+t.method)})}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(t.PROVIDER_EVENTS.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const n=(0,r.getChainId)(t),i=(0,r.getRpcUrl)(t,this.namespace);let o=this.createHttpProvider(n,i);o&&(e[n]=o)}),e}getHttpProvider(){const e=`${this.chainId}`,t=this.httpProviders[e];if(void 0===t)throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t;if(n)return new o.JsonRpcProvider(new i.JsonRpcConnection(n,(0,r.getGlobal)("disableProviderPing")))}showRequestModal(e){return!0}},lC}function hC(){if(cC)return g_;cC=1;var e=g_&&g_.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})},t=g_&&g_.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(g_,"__esModule",{value:!0}),g_.OKXUniversalProvider=void 0;const n=I_(),r=K_(),i=__(),o=t(oy()),s=W_(),a=QE(),c=H_(),l=t(J_()),u=t(V_()),h=t($_()),d=t(eC()),f=t(rC()),p=t(sC()),g=u_(),m=f_(),y=f_(),v=h_(),w=t(uC());let b=class t{static init(n){return e(this,void 0,void 0,function*(){let e;return(0,a.logDebug)("OKXUniversalProvider init() called"),(0,a.checkMetaData)(n.dappMetaData),(0,g.setGlobal)("disableProviderPing",!0),(0,a.getDefaultReporter)().configVersionAndSide("universalprovider","dapp",n.dappMetaData.name),window&&window.okxConnectUniversalinwindow&&window.okxConnectUniversalinwindow instanceof t?((0,a.logDebug)("OKXUniversalConnect init() old called"),e=window.okxConnectUniversalinwindow):((0,a.logDebug)("OKXUniversalConnect init() new called"),e=new t(n),window&&(window.okxConnectUniversalinwindow=e),yield e.initialize()),e})}constructor(e){this.rpcProviders={},this.events=new o.default,(!e.connector||0==e.connector.length)&&((0,m.isMobileDiscover)()?e.connector=[new a.OkxwalletInjectConnector]:e.connector=[new a.AppwalletConnector,new a.TgwalletConnector]),this.providerOpts=e,this.specialDAppLineType(this.providerOpts),(0,a.logDebug)("constructor this.providerOpts>>",JSON.stringify(this.providerOpts));let t=a.OpenAppLinkType.UniversalLink;switch(e.openAppLinkType){case"universallink":t=a.OpenAppLinkType.UniversalLink;break;case"deeplink":t=a.OpenAppLinkType.DeepLink;break;default:t=a.OpenAppLinkType.UniversalLink}this.providerOpts.openAppLinkType=t,(0,a.logDebug)("OKXUniversalProvider constructor() linkType:",t)}specialDAppLineType(e){let t=window.location.host;t&&(t.includes("dappportal.io")||t.includes("connect.oker.vip"))&&!e.openAppLinkType&&((0,a.logDebug)("specialDAppLineType --\x3e host:",t),e.openAppLinkType=a.OpenAppLinkType.DeepLink)}getOpenAppLinkType(){var e;return null!==(e=this.providerOpts.openAppLinkType)&&void 0!==e?e:a.OpenAppLinkType.UniversalLink}request(t,n){return e(this,void 0,void 0,function*(){if((0,a.logDebug)("OKXUniversalProvider request() called"),(0,a.reportLog)("OKXUniversalProvider request() called"),!this.connected())throw new a.OKXConnectError(a.OKX_CONNECT_ERROR_CODES.NOT_CONNECTED_ERROR);(0,a.logDebug)("OKXUniversalProvider request()  connected ");const{namespace:e,requestParam:r}=this.buildRequestParamFromRequest(t,n);return yield this.getProvider(e).request(r)})}buildRequestParamFromRequest(e,t){var n;(0,a.logDebug)("UniversalProvider request args >>>>>>>: ",t,(0,a.safeJsonStringify)(e));let[r,i]=this.validateChain(t);if(!this.session)throw new a.OKXConnectError(a.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"Please call connect() before request()");let o=Object.keys(this.session.namespaces);if(!t&&o&&o.length>1)throw new a.OKXConnectError(a.OKX_CONNECT_ERROR_CODES.NOT_CONNECTED_ERROR,"Multiple chains have been linked, the request method requires chain");let s=(0,a.replaceChainNameToChainId)(`${r}:${i}`);return null!=s&&(r=s.split(":")[0],i=s.split(":")[1]),{namespace:r,requestParam:Object.assign(Object.assign({},e),{chainId:`${r}:${i}`,redirect:null!==(n=e.redirect)&&void 0!==n?n:this.sessionConfig.redirect})}}enable(){return e(this,void 0,void 0,function*(){if(!this.client)throw new a.OKXConnectError(a.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"Sign Client not initialized");if(!this.session){if(!this.connectOpts)throw new a.OKXConnectError(a.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"Sign Client not initialized");yield this.connect(this.connectOpts)}return yield this.requestAccounts()})}disconnect(){return e(this,void 0,void 0,function*(){return(0,a.logDebug)("OKXUniversalProvider disconnect() called"),(0,a.reportLog)("provider disconnect called"),new Promise(t=>e(this,void 0,void 0,function*(){let n=!1;const r=()=>e(this,void 0,void 0,function*(){n||(n=!0,yield this.disconnectAndEmit(),yield this.cleanup(),t(),(0,a.logDebug)("UniversalProvider disconnect Disconnected"),(0,a.reportLog)("provider disconnect disconnected"))});try{yield this.client.disconnect(),yield r()}catch{yield r()}}))})}disconnectAndEmit(){var e,t;this.client.engine.connectManagerDisconnect(),this.events.emit("disconnect",{topic:null===(e=this.session)||void 0===e?void 0:e.topic}),this.events.emit("session_delete",{topic:null===(t=this.session)||void 0===t?void 0:t.topic})}replaceNamespace(e,t){var n,r;let i=null===(n=e.namespaces)||void 0===n?void 0:n[t];if(null!=i){let n=this.replaceNamespaceInner(i);null!=e.namespaces&&t in e.namespaces&&null!=n&&(e.namespaces[t]=n)}let o=null===(r=e.optionalNamespaces)||void 0===r?void 0:r[t];if(null!=o){let n=this.replaceNamespaceInner(o);null!=e.optionalNamespaces&&t in e.optionalNamespaces&&null!=n&&(e.optionalNamespaces[t]=n)}return e}replaceNamespaceInner(e){var t;return null!=e&&(e.chains=null===(t=e.chains)||void 0===t?void 0:t.map(e=>(0,a.replaceChainNameToChainId)(e)),null!=e.defaultChain&&(e.defaultChain=(0,a.replaceChainNameToChainId)(e.defaultChain))),e}replaceSessionAptos(e,t){var n;let r=null===(n=null==e?void 0:e.namespaces)||void 0===n?void 0:n[t];if(null!=r&&null!=r.chains){r.chains=r.chains.map(e=>(0,a.replaceChainIdToChainName)(e)),r.accounts=r.accounts.map(e=>(0,a.replaceChainIdToChainName)(e));let n={};Object.keys(r.extra||{}).forEach((r,i)=>{(0,a.replaceChainIdToChainName)(r),n[(0,a.replaceChainIdToChainName)(r)]=Object.values((null==e?void 0:e.namespaces[t].extra)||{})[i]}),r.extra=n}(0,a.logDebug)("replaceSessionAptos",e)}connected(){(0,a.logDebug)("OKXUniversalProvider connected() called"),(0,a.reportLog)("provider connected called");let e=()=>{try{this.cleanup(),this.client.engine.connectManagerDisconnect()}catch(e){(0,a.logDebug)("Error during disconnect:",e)}};try{return!(!this.session||!this.client.engine.getCurrentConnectionReady(Object.keys(this.session.namespaces))&&(e(),1))}catch{return e(),!1}}connectAndSign(t,n){return e(this,void 0,void 0,function*(){(0,a.logDebug)("OKXUniversalProvider connectAndSign() called");const e=Object.assign(Object.assign({},t),n);return(0,a.logDebug)("OKXUniversalProvider connectAndSign() opts:",JSON.stringify(t)),(0,a.logDebug)("OKXUniversalProvider connectAndSign() signRequest:",JSON.stringify(n)),yield this.connect(e)})}connect(t){return e(this,void 0,void 0,function*(){if((0,a.logDebug)("OKXUniversalProvider connect() called"),(0,a.reportLog)("provider connect called"),!this.client)throw new a.OKXConnectError(a.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"Sign Client not initialized");if(this.connected())return this.session;t=this.replaceNamespace(t,"aptos"),t=this.replaceNamespace(t,"solana"),(0,a.logDebug)("OKXUniversalProvider connect >>>>",JSON.stringify(t)),void 0===t.sessionConfig&&(t.sessionConfig={}),void 0===t.sessionConfig.openUniversalUrl&&(t.sessionConfig.openUniversalUrl=(0,a.isMobileUserAgent)()),t.sessionConfig.openAppLinkType=this.providerOpts.openAppLinkType,this.setNamespaces(t);try{(0,a.logDebug)(`UniversalProvider connect opts.stringify ====> ${JSON.stringify(t)}`);let n=yield this.client.connect(t);if((0,a.logDebug)(`UniversalProvider connect success ====> ${JSON.stringify(n)}`),n){if(this.replaceSessionAptos(n,"aptos"),this.replaceSessionAptos(n,"solana"),this.session=n,this.client.session=n,this.setConnectConnector(),(0,a.logDebug)("OKXUniversalProvider connect success opts>>>>",JSON.stringify(t)),this.onConnect(),t.signRequest&&t.signRequest.length>0){let e=t.signRequest[0],n=[];"undefined"!=typeof window&&window&&window.okxConnectUniversalUIinwindow?((0,a.logDebug)("OKXUniversalProvider connect success, us UI SDK>>>>"),this.session.signResponse&&this.session.signResponse.length>0&&(n=this.session.signResponse)):((0,a.logDebug)("OKXUniversalProvider connect success, us Universal SDK>>>>"),this.session.signResponse&&this.session.signResponse.length>0?n=this.session.signResponse:n.push((0,y.creatNotSupportMethodItemReplay)(e))),(0,a.logDebug)(`UniversalProvider connect success connectRequestReply ====> ${JSON.stringify(n)}`),setTimeout(()=>{this.events.emit("connect_signResponse",n)},100)}return n}return}catch(e){throw(0,a.logDebug)("UniversalProvider connect error ====> ",JSON.stringify(e)),e}})}syncAllAddresses(){return e(this,void 0,void 0,function*(){if((0,v.syncAddressAvailable)(this.session.wallet))return this.client.syncAllAddress();throw new a.OKXConnectError(a.OKX_CONNECT_ERROR_CODES.METHOD_NOT_SUPPORTED)})}setConnectConnector(){var e;this.client.setConnectConnector(null===(e=this.session)||void 0===e?void 0:e.wallet)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}setDefaultChain(e,t){(0,a.logDebug)("OKXUniversalProvider setDefaultChain() called");try{if(!this.connected())return;const[r,i]=this.validateChain(e);this.getProvider(r).setDefaultChain(i,t)}catch(n){if(!/Please call connect/.test(n.message))throw n}}tryToReconnect(){return e(this,void 0,void 0,function*(){yield this.checkStorage()})}checkStorage(){return e(this,void 0,void 0,function*(){if(this.connected())return;let e=yield this.getFromStore("connectSession");if((0,a.logDebug)(e),e){(0,a.logDebug)("checkStorage error start");try{let n=e;if(this.session=n,this.client.session=this.session,this.setConnectConnector(),yield this.client.restoreconnect(n),!this.connected())throw new a.OKXConnectError(a.OKX_CONNECT_ERROR_CODES.NOT_CONNECTED_ERROR);this.sessionConfig=n.sessionConfig,this.client.sessionConfig=this.sessionConfig,(0,a.logDebug)("[evm u-provider] do reconnection",this.session),this.createProviders(),this.registerEventListeners(),setTimeout(()=>{this.events.emit("reconnect",{session:this.session})},100)}catch(t){yield this.cleanup(!1),(0,a.logDebug)(`checkStorage error ${JSON.stringify(t)}`)}}})}initialize(){return e(this,void 0,void 0,function*(){(0,a.logDebug)("OKXUniversalProvider initialize() called"),(0,a.reportLog)("provider initialize called");const e=Object.assign({url:window.location.hostname,origin:window.location.origin},this.providerOpts.dappMetaData);this.client=new s.SignClient(e,this.events,this.providerOpts.openAppLinkType),this.registerConnector(this.providerOpts.connector),yield this.tryToReconnect()})}createProviders(){if(!this.client)throw new a.OKXConnectError(a.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"Sign Client not initialized");if(!this.connected())throw new a.OKXConnectError(a.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).filter(e=>{var t,n;return(null===(n=null===(t=this.session.namespaces[e])||void 0===t?void 0:t.accounts)||void 0===n?void 0:n.length)>0}).map(e=>(0,c.parseNamespaceKey)(e)))];this.rpcProviders={},e.forEach(e=>{if(!this.session)return;const t=this.session.namespaces[e];switch((0,a.logDebug)("init eip155 >> ",t),e){case"eip155":const i={namespace:t};this.rpcProviders[e]=new n.Eip155Provider(i,this.client,this.events);break;case"solana":const o={namespace:t};let s=new l.default(o,"solana",this.client,this.events);this.rpcProviders[e]=s;let c=new l.default(o,"sonic",this.client,this.events);this.rpcProviders.sonic=c;let g=new l.default(o,"svm",this.client,this.events);this.rpcProviders.svm=g;let m=new l.default(o,"soon",this.client,this.events);this.rpcProviders.soon=m;let y=new l.default(o,"eclipse",this.client,this.events);this.rpcProviders.eclipse=y;break;case"ton":const v={namespace:t};let b=new d.default(v,this.client,this.events);this.rpcProviders[e]=b;break;case"sui":const O={namespace:t};let E=new r.SuiProvider(O,this.client,this.events);E.name="sui",this.rpcProviders[e]=E;break;case"btc":const _={namespace:t};let C=new u.default(_,"btc",this.client,this.events);this.rpcProviders.btc=C;let N=new u.default(_,"fractal",this.client,this.events);this.rpcProviders.fractal=N;break;case"aptos":let A=new h.default({namespace:t},"aptos",this.client,this.events);this.rpcProviders[e]=A;let R=new h.default({namespace:t},"movement",this.client,this.events);this.rpcProviders.movement=R;break;case"cosmos":let S=new f.default({namespace:t},this.client,this.events);this.rpcProviders[e]=S;break;case"tron":let T=new p.default({namespace:t},this.client,this.events);this.rpcProviders[e]=T;break;case"starknet":let P=new w.default({namespace:t},"starknet",this.client,this.events);this.rpcProviders[e]=P}})}registerEventListeners(){if(void 0===this.client)throw new a.OKXConnectError(a.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"Sign Client is not initialized");this.client.engine.addDisconnectListener(()=>{this.disconnectAndEmit(),this.cleanup()}),this.on(i.PROVIDER_EVENTS.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e)}),this.on(i.PROVIDER_EVENTS.UPDATE_NAMESPACES,e=>{if(e){const t=Object.keys(e)[0];this.session&&(this.session.namespaces[t]=e[t],this.session&&(this.persist("connectSession",this.session),this.events.emit("session_update",this.session)),(0,a.logDebug)("PROVIDER_EVENTS.UPDATE_NAMESPACES this.session... ->>>",JSON.stringify(this.session)))}})}getProvider(e){return(0,a.logDebug)("current get providers",this.rpcProviders),(0,a.logDebug)("query namespace: ",e),this.rpcProviders[e]}setNamespaces(e){this.connectOpts=e;const{namespaces:t,sessionConfig:n}=e,r={origin:window.location.origin,url:window.location.hostname,name:this.providerOpts.dappMetaData.name,icon:this.providerOpts.dappMetaData.icon,manifestUrl:this.providerOpts.dappMetaData.manifestUrl};this.sessionConfig=Object.assign({dappInfo:r},n),(0,a.logDebug)("setNamespaces sessionConfig>>>",this.sessionConfig),this.client.sessionConfig=this.sessionConfig,this.persist("sessionConfig",n)}validateChain(e){var t;let[n,r]=(null==e?void 0:e.split(":"))||["",""];if(!this.session||!this.session.namespaces||!Object.keys(this.session.namespaces).length)return(0,a.logDebug)("get name & chain",n,r),[n,r];if(n){if(!this.isChainNamespaceInSession(n))throw new a.OKXConnectError(a.OKX_CONNECT_ERROR_CODES.NOT_CONNECTED_ERROR,`Namespace '${n}' is not configured. Please call connect() first with namespace config.`);if(r&&e){(0,a.logDebug)("this.session.namespaces --\x3e> ",n,JSON.stringify(this.session.namespaces));const r=null===(t=this.session.namespaces[n])||void 0===t?void 0:t.chains;if((0,a.logDebug)("get chainsArr & chain",JSON.stringify(r),e),r&&!r.includes(e))throw new a.OKXConnectError(a.OKX_CONNECT_ERROR_CODES.NOT_CONNECTED_ERROR,`Namespace not include the chain '${e}'`)}}if(n&&r)return(0,a.logDebug)("get name & chain",n,r),[n,r];let i=(0,c.parseNamespaceKey)(Object.keys(this.session.namespaces)[0]);const o=this.rpcProviders[i].getDefaultChain();return(0,a.logDebug)("get default chain:",o),[i,o]}isChainNamespaceInSession(e){var t,n;if(Object.keys((null===(t=this.session)||void 0===t?void 0:t.namespaces)||{}).map(e=>(0,c.parseNamespaceKey)(e)).includes(e))return!0;let r=!1;return Object.values((null===(n=this.session)||void 0===n?void 0:n.namespaces)||{}).forEach(t=>{t.chains.forEach(t=>{t.split(":")[0]==e&&(r=!0)})}),r}requestAccountsWithNamespace(e){return this.getProvider(e).requestAccounts()}requestDefaultChainWithNamespace(e){return this.getProvider(e).getDefaultChain()}requestAccounts(){return e(this,void 0,void 0,function*(){const[e]=this.validateChain();return yield this.getProvider(e).requestAccounts()})}onChainChanged(e){var t;if(null===(t=this.session)||void 0===t||!t.namespaces)return;const[n,r]=this.validateChain(e);r&&(this.session.namespaces[n]&&(this.session.namespaces[n].defaultChain=r,this.persist("connectSession",this.session)),this.events.emit("chainChanged",r))}onConnect(){this.createProviders(),this.session&&(this.persist("connectSession",this.session),console.log("window.okxwallet save session:",Date.now())),this.events.emit("connect",{session:this.session}),this.registerEventListeners()}cleanup(){return e(this,arguments,void 0,function*(e=!0){this.session=void 0,this.client.session=void 0,this.setConnectConnector(),this.sessionProperties=void 0,this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),e&&this.persist("connectSession",void 0)})}persist(e,t){return(0,a.logDebug)("[evm u-provider] persisit data",e,t),this.client.engine.saveSessionContent(e,t)}getFromStore(t){return e(this,void 0,void 0,function*(){return this.client.engine.getSessionContent(t)})}showRequestModal(e,t){try{const{namespace:n,requestParam:r}=this.buildRequestParamFromRequest(e,t);return this.getProvider(n).showRequestModal(r)}catch{return!1}}openWallet(e,t){this.client.openWallet(e,t)}registerConnector(e){this.client.registerConnector(e),this.client.setAccountChangeListener(e=>{(0,a.logDebug)("accountChangeListener session\uff1a",this.events.listenerCount("accountChanged"),JSON.stringify(e));try{e&&this.events.listenerCount("accountChanged")&&(this.replaceSessionAptos(e,"aptos"),this.replaceSessionAptos(e,"solana"),this.session=e,this.client.session=e,this.session&&(this.persist("connectSession",this.session),console.log("window.okxwallet save session:",Date.now())),this.setConnectConnector(),this.createProviders(),this.events.emit("accountChanged",this.session))}catch(t){(0,a.logDebug)("setAccountChangeListener error:",JSON.stringify(t))}})}getEngine(){return this.client.engine}};return g_.OKXUniversalProvider=b,g_.default=b,g_}var dC,fC={};function pC(){if(dC)return fC;dC=1;var e=fC&&fC.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(fC,"__esModule",{value:!0}),fC.OKXBtcProvider=void 0;const t=SC(),n=QE();let r=class{constructor(e){this.caip=["btc:mainnet","fractal:mainnet"],this.provider=e}getAddressForChainId(e){var n,r;if(null==this.checkChainId(e))throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"invalid chainId");let i=null===(r=null===(n=this.provider.session)||void 0===n?void 0:n.namespaces.btc)||void 0===r?void 0:r.accounts.filter(function(t){return t.startsWith(e)});if(null==i||i.length<0)throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"no connected account");return i[0].split(":")[2]}getAccount(e){var n,r,i;if(null==this.checkChainId(e))throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"invalid chainId");let o=null===(i=null===(r=null===(n=this.provider.session)||void 0===n?void 0:n.namespaces.btc)||void 0===r?void 0:r.extra)||void 0===i?void 0:i[e],s="";return null!=o&&(s=o.compressedPublicKey),{address:this.getAddressForChainId(e),publicKey:s}}signMessage(n,r,i){return e(this,void 0,void 0,function*(){if(null==this.checkChainId(n))throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"invalid chainId");if("undefined"===r)throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"the method signMessage parmas error");let e={signStr:r,from:this.getAddressForChainId(n)};i&&(e.type=i);try{const r=yield this.provider.request({method:"btc_signMessage",params:e},n);return"result"in r?r.result:r.error}catch(o){throw o instanceof t.OKXConnectError?o:new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"the method signTransaction request error")}})}sendBitcoin(n,r,i,o){return e(this,void 0,void 0,function*(){if(null==this.checkChainId(n))throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"invalid chainId");let e={from:this.getAddressForChainId(n),to:r,value:(i/1e8).toString()};null!=o&&o.feeRate&&(e.satBytes=o.feeRate.toString());let s=yield this.send(n,e);return void 0!==s&&"txhash"in s?s.txhash:s})}send(n,r){return e(this,void 0,void 0,function*(){if(null==this.checkChainId(n))throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"invalid chainId");if(!this.checkParameters(r,"to","value"))throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"the method send parmas  error");r.from=this.getAddressForChainId(n);try{const i=yield this.provider.request({method:"btc_send",params:r},n);return"result"in i?{txhash:i.result}:i.error}catch(e){throw e instanceof t.OKXConnectError?e:new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`the method send request error: ${e}`)}})}signPsbt(t,n,r){return e(this,void 0,void 0,function*(){return new Promise((e,i)=>{this.signPsbts(t,[n],[r]).then(t=>{let n=JSON.parse(t);e(n[0])}).catch(e=>{i(e)})})})}signPsbts(n,r,i){return e(this,void 0,void 0,function*(){if(null==this.checkChainId(n))throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"invalid chainId");if(void 0===r)throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"the method signPsbts params error");let e={psbtHexs:r,options:i};e.from=this.getAddressForChainId(n);try{const r=yield this.provider.request({method:"btc_signPsbts",params:e},n);if("result"in r)return r.result}catch(o){throw o instanceof t.OKXConnectError?o:new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`the method send request error: ${o}`)}})}signAndPushPsbt(n,r,i){return e(this,void 0,void 0,function*(){if(null==this.checkChainId(n))throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"invalid chainId");if(void 0===r)throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"the method signPsbts params error");let e={psbtHex:r,options:i};e.from=this.getAddressForChainId(n);try{const r=yield this.provider.request({method:"btc_signAndPushPsbt",params:e},n);return"result"in r?JSON.parse(r.result):r.error}catch(o){throw o instanceof t.OKXConnectError?o:new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`the method send request error: ${o}`)}})}sendInscription(n,r,i,o){return e(this,void 0,void 0,function*(){let e={address:r,inscriptionId:i,options:o};if(null==this.checkChainId(n))throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"invalid chainId");if("undefined"===r)throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"the method sendInscription params error");var s=0;o&&"feeRate"in o&&(s=o.feeRate);let a=this.getAddressForChainId(n);var c=7;if("undefined"!==i){let e="-Atomicals",t="-Ordinals";null!=i&&i.toLowerCase().endsWith(e.toLowerCase())?(c=8,i=this.removeSuffix(i,e)):null!=i&&i.toLowerCase().endsWith(t.toLowerCase())&&(i=this.removeSuffix(i,t))}let l={scenario:5,feeRate:s,txType:"20",to:r,batchBean:[{coinAmount:"1",nftId:i,protocolId:c,coinId:"",inscriptionId:"",from:a}],extension:e};try{const e=yield this.provider.request({method:"btc_sendInscription",params:l,injectParams:{address:r,inscriptionId:i,options:o}},n);return"result"in e?e.result:e.error}catch(u){throw u instanceof t.OKXConnectError?u:new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"the method signTransaction request error")}})}sendRunes(r,i,o,s,a){return e(this,void 0,void 0,function*(){try{if(!(r&&i&&o&&s))throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"The parameter is empty. Please check");let c,l=this.checkChainId(r);if(null!=l&&(l.startsWith("btc")?c=13:l.startsWith("fractal")&&(c=16)),null==l||null==c)throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"invalid chainId");let u={fromAddress:this.getAddressForChainId(r),protocolId:c,address:i,runeid:o,amount:s,options:a};return(0,n.logDebug)("OKXBtcProvider sendRunes --\x3e",JSON.stringify(u)),(yield this.provider.request({method:"btc_sendRunes",params:u,injectParams:{address:i,runeid:o,amount:s,options:a}},r)).result}catch(e){throw e}})}inscribeTransfer(r,i,o){return e(this,void 0,void 0,function*(){try{if(!r||!i||!o)throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"The parameter is empty. Please check");let s,a=this.checkChainId(r);if(null!=a&&(a.startsWith("btc")?s=1:a.startsWith("fractal")&&(s=14)),null==a||null==s)throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"invalid chainId");let c={fromAddress:this.getAddressForChainId(r),protocolId:s,ticker:i,amount:o};(0,n.logDebug)("OKXBtcProvider inscribeTransfer --\x3e",JSON.stringify(c)),yield this.provider.request({method:"btc_inscribeTransfer",params:c},r)}catch(e){throw e}})}removeSuffix(e,t){return e.endsWith(t)?e.slice(0,e.length-t.length):e}checkParameters(e,...t){var n=[];return t.forEach(t=>{`${t}`in e||n.push(t)}),!(n.length>0&&(console.log("not find key: ",n.join(",")),1))}checkChainId(e){if(this.caip.includes(e)){let[t,n]=e.split(":");return t}}};return fC.OKXBtcProvider=r,fC.default=r,fC}var gC,mC={};function yC(){if(gC)return mC;gC=1;var e=mC&&mC.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(mC,"__esModule",{value:!0}),mC.OKXCosmosProvider=void 0;const t=QE();return mC.OKXCosmosProvider=class{constructor(e){this.provider=e}getAccount(e){var n,r,i,o,s,a;(0,t.logDebug)("OKXCosmosProvider getAccount chainId:",e),(0,t.logDebug)("OKXCosmosProvider getAccount namespaces:",JSON.stringify(null===(n=this.provider.session)||void 0===n?void 0:n.namespaces));let c=null===(i=null===(r=this.provider.session)||void 0===r?void 0:r.namespaces[t.NameSpaceKeyCosmos])||void 0===i?void 0:i.accounts.filter(function(t){return t.startsWith(e)})[0];if((0,t.logDebug)("OKXCosmosProvider getAccount account:",JSON.stringify(c)),!c)return;const l=c.split(":"),u=c.split(":")[2];(0,t.logDebug)("OKXCosmosProvider getAccount address:",u);let h=null===(a=null===(s=null===(o=this.provider.session)||void 0===o?void 0:o.namespaces[t.NameSpaceKeyCosmos])||void 0===s?void 0:s.extra)||void 0===a?void 0:a[`${l[0]}:${l[1]}`],d="";return null!=h&&(d=h.publicKey,console.log("aptos_publicKey",d)),u?{algo:"secp256k1",address:u,bech32Address:u,pubKey:this.hexToUint8Array(d)}:void 0}signArbitrary(t,n,r){return e(this,void 0,void 0,function*(){const e=window.btoa(r),i={chain_id:"",account_number:"0",sequence:"0",fee:{gas:"0",amount:[]},msgs:[{type:"sign/MsgSignData",value:{signer:n,data:e}}],memo:""};let o={chainId:t,method:"cosmos_signArbitrary",params:{signer:n,chain_id:t.split(":")[1],data:i}};try{const e=yield this.provider.request(o,t);return"result"in e?"string"==typeof e.result?JSON.parse(e.result):e.result:e.error}catch(s){return s}})}signAmino(t,n,r,i){return e(this,void 0,void 0,function*(){if("sign/MsgSignData"==r.msgs[0].type){let i={chainId:t,method:"cosmos_signArbitrary",params:{signer:n,chain_id:t.split(":")[1],data:r}};try{const n=yield this.provider.request(i,t);return"result"in n?n.result:n.error}catch(e){return e}}else{let o={chainId:t,method:"cosmos_signAmino",params:{signer:n,chainId:t.split(":")[1],sign_doc:r,signOptions:i}};try{const n=yield this.provider.request(o,t);if("result"in n){const e=JSON.parse(n.result);return console.log("signdoc",r,e.signDoc),r.fee=e.signDoc.fee,{signed:r,signature:e.signature}}return n.error}catch(e){return e}}})}signDirect(t,n,r,i){return e(this,void 0,void 0,function*(){const e={bodyBytes:this.bufferToHex(r.bodyBytes),authInfoBytes:this.bufferToHex(r.authInfoBytes),chainId:r.chainId,accountNumber:r.accountNumber?r.accountNumber.toString():null,signOptions:i||null};let o={chainId:t,method:"cosmos_signDirect",params:{signer:n,chainId:t.split(":")[1],sign_doc:e}};try{const e=yield this.provider.request(o,t);if("result"in e){const t=JSON.parse(e.result);return console.log("signdirect result",t),r.authInfoBytes=this.messageToBuffer(t.signDoc.authInfoBytes),{signed:r,signature:t.signature}}}catch(s){return s}})}messageToBuffer(e){var t=Uint8Array.from([]);try{t="string"==typeof e?this.hexToUint8Array(e.replace("0x","")):Uint8Array.from(e)}catch(n){console.log(`messageToBuffer error: ${n}`)}return t}bufferToHex(e){return"0x"+[...new Uint8Array(e)].map(e=>e.toString(16).padStart(2,"0")).join("")}hexToUint8Array(e){if(e.length%2!=0)throw"Invalid hexString";for(var t=new Uint8Array(e.length/2),n=0;n<e.length;n+=2){var r=parseInt(e.substr(n,2),16);if(isNaN(r))throw"Invalid hexString";t[n/2]=r}return t}},mC}var vC,wC={};function bC(){if(vC)return wC;vC=1;var e=wC&&wC.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(wC,"__esModule",{value:!0}),wC.OKXTonProvider=void 0;const t=SC(),n=QE();let r=class{constructor(e){this.statusChangeSubscriptions=[],this.statusChangeErrorSubscriptions=[],this.provider=e,this.provider.on("connect",()=>{let e=this.wallet();(0,n.logDebug)("OKXTONProvider event connect:",JSON.stringify(e)),this.statusChangeSubscriptions.forEach(t=>t(e))}),this.provider.on("reconnect",()=>{let e=this.wallet();(0,n.logDebug)("OKXTONProvider event reconnect:",JSON.stringify(e)),this.statusChangeSubscriptions.forEach(t=>t(e))}),this.provider.on("disconnect",()=>{(0,n.logDebug)("OKXTONProvider event disconnect:"),this.statusChangeSubscriptions.forEach(e=>e(null))}),this.provider.on("connect_error",e=>{(0,n.logDebug)("OKXTONProvider event connect_error:",JSON.stringify(e)),this.statusChangeErrorSubscriptions.forEach(t=>t(e))})}connected(){return!!this.provider.connected()&&!!this.provider.session.namespaces.ton}account(){try{if(!this.provider.session)return null;let t=this.provider.session.namespaces.ton;if(!t||!t.payload||!t.payload.ton_addr)return null;let r=t.payload.ton_addr;return{address:r.address,chain:r.network,walletStateInit:r.walletStateInit,publicKey:r.publicKey}}catch(e){return(0,n.logDebug)("OKXTONProvider account  error:",JSON.stringify(e)),null}}wallet(){if(this.connected())try{let t=this.provider.session.wallet;const r={device:{platform:t.platform,appName:t.appName,appVersion:t.appVersion,maxProtocolVersion:t.maxProtocolVersion,features:["ton_sendTransaction"]},provider:"http",account:this.account()};let i=this.provider.session.namespaces.ton;return i&&i.payload&&i.payload.ton_proof&&(r.connectItems={tonProof:i.payload.ton_proof}),(0,n.logDebug)("OKXTONProvider wallet :",JSON.stringify(r)),r}catch(e){return(0,n.logDebug)("OKXTONProvider wallet  error:",JSON.stringify(e)),null}return null}onStatusChange(e,t){return this.statusChangeSubscriptions.push(e),t&&this.statusChangeErrorSubscriptions.push(t),()=>{this.statusChangeSubscriptions=this.statusChangeSubscriptions.filter(t=>t!==e),t&&(this.statusChangeErrorSubscriptions=this.statusChangeErrorSubscriptions.filter(e=>e!==t))}}sendTransaction(r){return e(this,void 0,void 0,function*(){if(r.network&&r.network!==n.TONCHAIN.MAINNET)throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"OKXTONProvider sendTransaction network error");if(r.network||(r.network=n.TONCHAIN.MAINNET),this.provider.session&&!r.from){const e=this.provider.requestAccountsWithNamespace("ton");r.from=e[0]}const e={method:"ton_sendTransaction",params:r};let i="ton:"+n.TONCHAIN.MAINNET;return(0,n.logDebug)("OKXTONProvider sendTransaction transaction----:",i,JSON.stringify(e)),this.provider.request(e,i)})}};return wC.OKXTonProvider=r,wC.default=r,wC}var OC,EC={};function _C(){if(OC)return EC;OC=1;var e=EC&&EC.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(EC,"__esModule",{value:!0}),EC.OKXTronProvider=void 0;const t=QE();return EC.OKXTronProvider=class{constructor(e){this.TRON_CHAIN_ID="tron:mainnet",this.provider=e}getChain(e){if(null==e&&(e=this.TRON_CHAIN_ID),e!=this.TRON_CHAIN_ID)throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.CHAIN_NOT_SUPPORTED,"The chainId:"+e+"is wrong for OKXTronProvider");return e}getAccount(e){var n,r,i,o,s;e=this.getChain(e);let a=null===(r=null===(n=this.provider.session)||void 0===n?void 0:n.namespaces[t.NameSpaceKeyTron])||void 0===r?void 0:r.accounts.filter(function(t){return t.startsWith(e)})[0];if(!a)return;const c=a.split(":"),l=a.split(":")[2];let u=null===(s=null===(o=null===(i=this.provider.session)||void 0===i?void 0:i.namespaces[t.NameSpaceKeyTron])||void 0===o?void 0:o.extra)||void 0===s?void 0:s[`${c[0]}:${c[1]}`];return null!=u&&u.publicKey,l?{address:l}:void 0}stringToHex(e){let t="";for(let n=0;n<e.length;n++)t+=e.charCodeAt(n).toString(16).padStart(2,"0");return t}signMessage(t,n){return e(this,void 0,void 0,function*(){let e={chainId:n=this.getChain(n),method:"tron_signMessage",params:{message:this.stringToHex(t)}};try{const t=yield this.provider.request(e,n);return"result"in t?t.result:t.error}catch(r){return r}})}signMessageV2(t,n){return e(this,void 0,void 0,function*(){let e={chainId:n=this.getChain(n),method:"tron_signMessageV2",params:{message:t}};try{const t=yield this.provider.request(e,n);return"result"in t?t.result:t.error}catch(r){return r}})}signTransaction(t,n){return e(this,void 0,void 0,function*(){n=this.getChain(n);let e={method:"tron_signTransaction",params:t};try{const t=yield this.provider.request(e,n);if("result"in t){let e;e="string"==typeof t.result?JSON.parse(t.result):t.result;let n={};n.visible=e.visible,n.txID=e.txID;let r={};return r.contract=e.raw_data.contract,r.expiration=e.raw_data.expiration,r.ref_block_bytes=e.raw_data.ref_block_bytes,r.fee_limit=e.raw_data.fee_limit,r.ref_block_hash=e.raw_data.ref_block_hash,r.timestamp=e.raw_data.timestamp,n.raw_data=r,n.raw_data_hex=e.raw_data_hex,n.signature=e.signature,n}}catch(r){return r}})}signAndSendTransaction(t,n){return e(this,void 0,void 0,function*(){n=this.getChain(n);let e={method:"tron_signAndSendTransaction",params:t};try{const t=yield this.provider.request(e,n);if("result"in t)return t.result}catch(r){return r}})}},EC}var CC,NC,AC={};function RC(){if(CC)return AC;CC=1;var e=AC&&AC.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(AC,"__esModule",{value:!0}),AC.OKXStarknetProvider=void 0;const t=QE();return AC.OKXStarknetProvider=class{constructor(e){this.STARKNET_CHAIN_ID="starknet:mainnet",this.provider=e}getChain(e){if(null==e&&(e=this.STARKNET_CHAIN_ID),e!=this.STARKNET_CHAIN_ID)throw new t.OKXConnectError(t.OKX_CONNECT_ERROR_CODES.CHAIN_NOT_SUPPORTED,"The chainId:"+e+"is wrong for OKXStarknetProvider");return e}getAccount(e){var n,r,i,o,s;let a=null===(r=null===(n=this.provider.session)||void 0===n?void 0:n.namespaces[t.NameSpaceKeyStarknet])||void 0===r?void 0:r.accounts.filter(function(t){return t.startsWith(e)})[0];if(!a)return;const c=a.split(":"),l=a.split(":")[2];let u=null===(s=null===(o=null===(i=this.provider.session)||void 0===i?void 0:i.namespaces[t.NameSpaceKeyStarknet])||void 0===o?void 0:o.extra)||void 0===s?void 0:s[`${c[0]}:${c[1]}`],h="";return null!=u&&(h=u.publicKey),l?{address:l,pubKey:h}:void 0}signMessage(t,n,r){return e(this,void 0,void 0,function*(){r=this.getChain(r),0==t.length&&(t=this.getAccount(r).address);let e={chainId:r,method:"starknet_signMessage",params:{accountAddress:t,typedData:n}};try{const t=yield this.provider.request(e,r);if("result"in t){let e=t.result;return"string"==typeof e&&(e=JSON.parse(e)),[e.signedDataR,e.signedDataS]}return t.error}catch(i){return i}})}sendTransaction(t,n,r){return e(this,void 0,void 0,function*(){r=this.getChain(r);let e={method:"starknet_sendTransaction",params:{data:JSON.stringify({accountAddress:t,executionRequest:n}),from:t}};try{const t=yield this.provider.request(e,r);return"result"in t?{transaction_hash:t.result}:t.error}catch(i){return i}})}signMessageDeclareContractPayload(t,n){return e(this,void 0,void 0,function*(){n=this.getChain(n);try{let r={method:"starknet_signMessage",params:t};const i=yield this.provider.request(r,n);return"result"in i?{transaction_hash:i.result.txHash,class_hash:i.result.classHash}:i.error}catch(e){return e}})}sendMessageExecuteTransactionDetail(t,n,r,i,o){return e(this,void 0,void 0,function*(){o=this.getChain(o);const e={calls:Array.isArray(n)?n:[n],abis:r,transactionsDetail:{nonce:null==i?void 0:i.nonce,maxFee:null==i?void 0:i.nonce,version:null==i?void 0:i.version}};return this.sendTransaction(t,e,o)})}},AC}function SC(){return NC||(NC=1,function(e){var t=Bf&&Bf.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=Bf&&Bf.__exportStar||function(e,n){for(var r in e)"default"!==r&&!Object.prototype.hasOwnProperty.call(n,r)&&t(n,e,r)};Object.defineProperty(e,"__esModule",{value:!0}),e.OKXStarknetProvider=e.OKXTronProvider=e.OKXTonProvider=e.OKXCosmosProvider=e.OKXBtcProvider=e.OKXUniversalProvider=void 0,n(Jf(),e),n(f_(),e);var r=hC();Object.defineProperty(e,"OKXUniversalProvider",{enumerable:!0,get:function(){return r.OKXUniversalProvider}});var i=pC();Object.defineProperty(e,"OKXBtcProvider",{enumerable:!0,get:function(){return i.OKXBtcProvider}});var o=yC();Object.defineProperty(e,"OKXCosmosProvider",{enumerable:!0,get:function(){return o.OKXCosmosProvider}});var s=bC();Object.defineProperty(e,"OKXTonProvider",{enumerable:!0,get:function(){return s.OKXTonProvider}});var a=_C();Object.defineProperty(e,"OKXTronProvider",{enumerable:!0,get:function(){return a.OKXTronProvider}});var c=RC();Object.defineProperty(e,"OKXStarknetProvider",{enumerable:!0,get:function(){return c.OKXStarknetProvider}}),n(QE(),e)}(Bf)),Bf}var TC=SC();const PC=class e extends If{constructor(){super(...arguments),yn(this,"okxUniversalProvider")}static get instance(){return this._instance||(this._instance=new e),this._instance}async init(){this.okxUniversalProvider=await TC.OKXUniversalProvider.init({dappMetaData:{name:"Coinop",icon:"https://cdn.sei.io/web/logotype.svg"}}),this.okxUniversalProvider.on("display_uri",e=>{console.log("display_uri",e);const t=new CustomEvent("walletLibOkxUriEvent",{detail:{uri:e}});window.dispatchEvent(t)}),await this.connect()}async isConnected(){if(!this.okxUniversalProvider)return!1;let e=!1;try{e=this.okxUniversalProvider.connected(),console.log("isConnected suceess",e)}catch(t){console.log("isConnected error",t)}return e}async connect(){await this.okxUniversalProvider.connect({namespaces:{eip155:{chains:["eip155:1329"],defaultChain:"1329",rpcMap:{1329:"https://evm-rpc.sei-apis.com"}}}}),this._provider=new kf(this.okxUniversalProvider),this._signer=await this._provider.getSigner()}async getAddress(){return await this._signer.getAddress()}async sign(e,t){let n={method:"personal_sign",params:["Welcome to Coinop Game!",e]};try{var r=await this.okxUniversalProvider.request(n,"eip155:56");console.log("personalSignResult",r),t(e)}catch(i){this.errorHandler(i)}}async transferToken(e,t,n){let r=this.amountToWei(n);try{let n=await e.transfer(t,r);return await n.wait(),n}catch(i){return console.log("transferToken error",i),null}}};yn(PC,"_instance");let DC=PC;const kC=class e extends If{static get instance(){return this._instance||(this._instance=new e),this._instance}async init(){try{"undefined"!==window.okxwallet&&void 0!==window.okxwallet&&(window.okxwallet.on("disconnect",this.disconnectHandler.bind(this)),window.okxwallet.on("accountsChanged",this.accountChangedHandler.bind(this)),window.okxwallet.on("chainChanged",this.chainChangedHandler.bind(this)))}catch(e){console.log("error: ",e)}}async connect(e,t){try{if("undefined"===window.okxwallet||void 0===window.okxwallet)return void console.log("okxwallet  not installed");{let n=await window.okxwallet.request({method:"eth_accounts"});if(n.length>0)this._address=n[0];else{let e=await window.okxwallet.request({method:"eth_requestAccounts"});this._address=e[0]}""!=this._address?(this._provider=new kf(window.okxwallet),this._signer=await this._provider.getSigner(),await this.getChainId()==this.curChainId?this.sign(this._address,e):this.changeChain(()=>{this.sign(this._address,e)})):t&&t()}}catch{t&&t()}}async getAddress(){return this._address}async isConnected(){return(await window.okxwallet.request({method:"eth_accounts"})).length>0}async sign(e,t){try{await window.okxwallet.request({method:"personal_sign",params:[e,"Welcome to Coinop Game!"]}),t(e)}catch(n){this.errorHandler(n)}}async getChainId(){try{return(await this._provider.getNetwork()).chainId}catch(e){return console.error("error:",e),0}}async changeChain(e){try{await this.getChainId()!=this.curChainId&&window.okxwallet.request({method:"wallet_switchEthereumChain",params:[{chainId:"0x"+Number(this.curChainId).toString(16)}]}).then(()=>{console.log("\u6210\u529f")}).catch(async e=>{console.error(`ERROR:${e.message}`),4902===e.code?window.okxwallet.request({method:"wallet_addEthereumChain",params:[this.providerConfig[this.curChainId]]}).then(()=>{}).catch(e=>{this.errorHandler(e)}):(console.log("error: \u5207\u94fe\u5931\u8d25",e),this.errorHandler(""))})}catch(t){console.log("error: \u5207\u94fe\u5931\u8d25",t),this.errorHandler("")}}async transferToken(e,t,n,r){let i=this.amountToWei(n);try{let n=await e.transfer(t,i);console.log("tx",n);const s=await n.wait();return console.log("receipt",s),n}catch(o){return console.log("transferToken error",o),r&&r(o),null}}};yn(kC,"_instance");let IC=kC;const xC=class e{constructor(){yn(this,"apiScript",Mf.instance),yn(this,"curProvider","MetaMask")}static get instance(){return this._instance||(this._instance=new e),this._instance}async init(e){e&&(this.curProvider=e),await this.setProviderApi()}async setProviderApi(){switch(this.curProvider){case"MetaMask":this.apiScript=Mf.instance;break;case"OkxDapp":this.apiScript=DC.instance;break;case"Okx":this.apiScript=IC.instance}await this.apiScript.init()}async initCurChainId(e){this.apiScript.initCurChainId(e)}async initConfig(e,t){this.apiScript.initProviderConfig(e),this.apiScript.initTokenConfig(t)}async connect(e,t){await this.apiScript.connect(e,t)}async isConnected(){return await this.apiScript.isConnected()}async getAddress(){return await this.apiScript.getAddress()}async sign(e){let t=await this.getAddress();await this.apiScript.sign(t,e)}async getWalletConfig(){return this.apiScript.tokenConfig}async getCurChainId(){return this.apiScript.curChainId}async allowanceNum(e,t,n){return await this.apiScript.allowanceNum(e,t,n)}async approveContract(e,t,n,r=!1){await this.apiScript.approveContract(e,t,n,r)}async contractBalance(e,t,n=!1){return await this.apiScript.contractBalance(e,t,n)}async transferToken(e,t,n){return await this.apiScript.transferToken(e,t,n)}async setContractMap(e,t,n){await this.apiScript.setContractMap(e,t,n)}async getContractMap(e){return await this.apiScript.getContractMap(e)}async setContractReadMap(e,t,n){await this.apiScript.setContractReadMap(e,t,n)}async getContractReadMap(e){return await this.apiScript.getContractReadMap(e)}};yn(xC,"_instance");let MC=xC;window.WalletManage=MC,e.WalletManage=MC,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});